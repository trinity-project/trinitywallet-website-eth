webpackJsonp([1],{"+K3l":function(e,t){},"05Aw":function(e,t){},"0NEh":function(e,t,a){"use strict";a("TXMN"),a("qKYu");var s={name:"config",data:()=>({}),computed:{isTestNet(){return this.$store.state.vuexStore.isTestNet},address(){return"ETH"==this.$store.state.vuexStore.baseChain?this.$store.state.vuexStore.walletInfo.address:"NEO"==this.$store.state.vuexStore.baseChain?this.$store.state.vuexStore.NEOwalletInfo.address:void 0},baseChain(){return this.$store.state.vuexStore.baseChain}},watch:{"$store.state.vuexStore.baseChain":"UpdateConfig","$store.state.vuexStore.isTestNet":"UpdateConfig","$store.state.vuexStore.walletInfo.address":"getAddressInfo","$store.state.vuexStore.NEOwalletInfo.address":"getAddressInfo"},mounted(){this.$nextTick(function(){let e=this;e.$store.state.vuexStore.isLogin||e.$router.push("/start"),e.$store.state.vuexStore.isTestNet=e.$parent.fetchAsString("isTestNet")||!0,e.isTestNet?e.$store.state.vuexStore.isTestNet=!0:e.$store.state.vuexStore.isTestNet=!1,e.$store.state.vuexStore.baseChain=e.$parent.fetchAsString("baseChain")||"ETH",console.log(e.isTestNet),console.log(e.baseChain),""!=e.isTestNet&&""!=e.baseChain&&(console.log("更新当前参数"),e.getConfig())})},methods:{getConfig(){let e=this;if(configData){let t;t=e.$store.state.vuexStore.isTestNet?"testNet":"mainNet","ETH"==e.baseChain?(console.log("切换到ETH"),web3=new Web3(new Web3.providers.HttpProvider(configData.ETH[t].web3)),e.$store.state.vuexStore.NodeUriWebSocketIp=configData.ETH[t].NodeUriWebSocketIp,e.$store.state.vuexStore.NetMagic=configData.ETH[t].NetMagic,e.$store.state.vuexStore.spvPort=configData.ETH[t].spvPort,e.$store.state.vuexStore.tncContractAddress=configData.ETH[t].tncContractAddress,e.$store.state.vuexStore.trinityDataContractAddress=configData.ETH[t].trinityDataContractAddress,e.$store.state.vuexStore.trinityContractAddress=configData.ETH[t].trinityContractAddress,e.$store.state.vuexStore.tncContractAbi=configData.ETH.tncContractAbi,e.$store.state.vuexStore.trinityContractAbi=configData.ETH.trinityContractAbi):"NEO"==e.baseChain&&(console.log("切换到NEO"),e.$store.state.vuexStore.NetMagic=configData.NEO[t].NetMagic,e.$store.state.vuexStore.NodeRpcUri=configData.NEO[t].NodeRpcUri,e.$store.state.vuexStore.spvPort=configData.NEO[t].spvPort),setTimeout(function(){e.$parent.connectWebSocketForNodeUri()},1500),"ETH"==e.baseChain&&setTimeout(function(){1==e.$store.state.vuexStore.isLogin&&e.getAddressInfo()},3e3),e.$parent.saveAsString("baseChain",e.$store.state.vuexStore.baseChain),e.$parent.saveAsString("isTestNet",e.$store.state.vuexStore.isTestNet)}else console.log("获取配置文件失败")},UpdateConfig(){console.log(this.address),console.log(this.$store.state.vuexStore.isLogin),console.log(this.$store.state.vuexStore.baseChain),this.$store.state.vuexStore.isLogin&&""!=this.address?this.getConfig():this.$router.push("/start")},getAddressInfo(){let e=this;console.log(e.baseChain);let t=e.$parent.fetchAsArray(e.address+"@channelList");console.log(t);let a=[];if(t.forEach(function(e,t){void 0!=e.transactionHash&&a.push(e)}),e.$store.state.vuexStore.channelList=a,e.$store.state.vuexStore.txList=e.$parent.fetchAsArray(e.address+"@txList"),console.log(e.$store.state.vuexStore.txList),e.$store.state.vuexStore.contactList=e.$parent.fetchAsArray(e.address+"@contactList"),e.$store.state.vuexStore.recordList=e.$parent.fetchAsArray(e.address+"@recordList"),e.$store.state.vuexStore.eventList=e.$parent.fetchAsArray(e.address+"@eventList"),console.log(e.$store.state.vuexStore.eventList),e.$store.state.vuexStore.RList=e.$parent.fetchAsArray(e.address+"@RList"),console.log("HashR:fe9c65053a5ac416b756714e3cba5774572d37b2ea1a15360e51be3617745669"),console.log(e.$store.state.vuexStore.RList),e.getBalance(),"ETH"==e.baseChain){let t={messageType:"init",walletAddress:e.address};e.$store.state.vuexStore.NodeUriWebSocket.send(JSON.stringify(t));let a={messageType:"monitorAddress",walletAddress:e.address,playload:e.address,chainType:"ETH",comments:{}};e.$store.state.vuexStore.NodeUriWebSocket.send(JSON.stringify(a)),e.$parent.blockHeightCycle()}e.BalanceCycle(),e.cycleReconnectWebsocket()},BalanceCycle:function(){setInterval(this.getBalance,2e4)},getBalance(){"ETH"==this.baseChain?web3.utils.isAddress(this.address)&&(this.getEthBalance(),this.getTncBalance(),this.$parent.getChannelBalance()):"NEO"==this.baseChain&&34==this.address.length&&this.NEOgetTncBalance()},getEthBalance(){let e=this;e.address&&web3.utils.checkAddressChecksum(e.address)&&web3.eth.getBalance(e.address).then(function(t){let a=web3.utils.fromWei(web3.utils.hexToNumberString(t));e.$store.state.vuexStore.balanceData.Chain.ETH=e.$parent.keepDecimalPlaces(a,3)})},getTncBalance(){let e=this;web3.eth.getGasPrice().then(function(t){new web3.eth.Contract(e.$store.state.vuexStore.tncContractAbi,e.$store.state.vuexStore.tncContractAddress,{from:e.address,gasPrice:t}).methods.balanceOf(e.address).call({from:e.$store.state.vuexStore.tncContractAddress},function(t,a){if(t)console.log(t);else{let t=a/1e8;e.$store.state.vuexStore.balanceData.Chain.TNC=e.$parent.keepDecimalPlaces(t,3)}})})},NEOgetTncBalance(){let e=this;axios({method:"post",url:e.$store.state.vuexStore.NodeRpcUri,headers:{"Content-Type":"application/json;charset=UTF-8"},data:JSON.stringify({jsonrpc:"2.0",method:"getBalance",params:[e.address],id:1})}).then(function(t){e.$store.state.vuexStore.balanceData.Chain.TNC=e.$parent.keepDecimalPlaces(t.data.result.tncBalance,3),e.$store.state.vuexStore.balanceData.Chain.NEO=e.$parent.keepDecimalPlaces(t.data.result.neoBalance,3),e.$store.state.vuexStore.balanceData.Chain.GAS=e.$parent.keepDecimalPlaces(t.data.result.gasBalance,3)})},cycleReconnectWebsocket(){var e=this;e.$store.state.vuexStore.channelList.forEach(function(t,a){t.isTestNet==e.$store.state.vuexStore.isTestNet&&("ETH"==e.baseChain?e.$parent.reconnectWebsocket(t.Ip+":8866",t.ChannelName):"NEO"==e.baseChain&&e.$parent.reconnectWebsocket(t.Ip+":8766",t.ChannelName))})}}},o={render:function(){var e=this.$createElement;return(this._self._c||e)("div")},staticRenderFns:[]};var n=a("VU/8")(s,o,!1,function(e){a("Ve6V")},"data-v-3bb6d4b6",null);t.a=n.exports},"27kK":function(e,t){},"2b8D":function(e,t){},"5/uQ":function(e,t){e.exports="data:image/png;base64,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"},"5CRf":function(e,t){},"5Znf":function(e,t){},"5vSx":function(e,t){},"6Fyv":function(e,t){},"7xIN":function(e,t){},"8UDB":function(e,t){},"9HGa":function(e,t,a){"use strict";var s={name:"notifyBox",data:()=>({startY:0,endY:0}),filters:{},methods:{touchStart(e){this.startY=e.touches[0].clientY,console.log("开始X:"+this.startY)},touchEnd(e){this.endY=e.changedTouches[0].clientY,console.log("结束X:"+this.endY),this.startY<100&&this.startY-this.endY>10&&this.$store.state.vuexStore.isNotifyShow&&(this.$store.state.vuexStore.isNotifyShow=!1),this.startY=0,this.endY=0}}},o={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("transition",{attrs:{name:"top-show"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.$store.state.vuexStore.isNotifyShow,expression:"$store.state.vuexStore.isNotifyShow"}],staticClass:"notifyBox",on:{"!touchstart":function(t){return e.touchStart(t)},"!touchend":function(t){return e.touchEnd(t)}}},[s("div",{staticClass:"notify-title"},[s("img",{attrs:{src:a("hWNH"),alt:""}}),e._v(" "),s("p",{staticStyle:{display:"inline-block",margin:"0"}},[e._v("标题")])]),e._v(" "),s("div",{staticClass:"notify-label"},[e._v("\n          内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容\n          "),s("div",{staticStyle:{"text-align":"center"}},[s("i",{staticClass:"closeBtn el-icon-ETH-shouqi1",on:{click:function(t){e.$store.state.vuexStore.isNotifyShow=!1}}})])])])])},staticRenderFns:[]};var n=a("VU/8")(s,o,!1,function(e){a("L4uq")},"data-v-7794d028",null);t.a=n.exports},Am27:function(e,t){},GcSp:function(e,t){},JSzE:function(e,t,a){"use strict";var s={name:"channelForm",data(){return{buttonItem:[{name:this.$t("tabbar.channel.addChannel"),iconStyle:"-60px",link:"/channel/addChannel",actionName:"slide-fade1"},{name:this.$t("tabbar.channel.channelList"),iconStyle:"-180px",link:"/channel/channelList",actionName:"slide-fade2"},{name:this.$t("tabbar.channel.payment"),iconStyle:"0px",link:"/channel/payment",actionName:"slide-fade3"},{name:this.$t("tabbar.channel.scan"),iconStyle:"-120px",link:"/scan",actionName:"slide-fade4"}]}},mounted(){this.$nextTick(function(){})},methods:{toOtherForm(e){1==this.$store.state.vuexStore.isChannelFormShow&&this.$router.push(e)}}},o={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("transition",{attrs:{name:"fade"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.$store.state.vuexStore.isChannelFormShow,expression:"$store.state.vuexStore.isChannelFormShow"}],staticClass:"channelForm",on:{click:function(t){e.$store.state.vuexStore.isChannelFormShow=!1}}},[s("div",{staticStyle:{position:"absolute",bottom:"0",left:"0",right:"0",padding:"40px 40px 20px 40px"}},[s("div",{staticClass:"buttonBox",staticStyle:{"text-align":"center"}},e._l(e.buttonItem,function(t,o){return s("transition",{key:o,attrs:{name:t.actionName}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.$store.state.vuexStore.isChannelFormShow,expression:"$store.state.vuexStore.isChannelFormShow"}],staticClass:"button-item",on:{click:function(a){e.toOtherForm(t.link)}}},[s("div",{staticClass:"button-item-img"},[s("img",{style:{marginLeft:t.iconStyle},attrs:{src:a("5/uQ"),alt:""}})]),e._v(" "),s("p",{staticClass:"button-item-label"},[e._v(e._s(t.name))])])])})),e._v(" "),s("div",{staticClass:"closeBox"},[s("span",{on:{click:function(t){e.$store.state.vuexStore.isChannelFormShow=!1}}},[s("i",{staticClass:"el-icon-ETH-guanbi"})])])])])])},staticRenderFns:[]};var n=a("VU/8")(s,o,!1,function(e){a("rmXD")},"data-v-20a51cea",null);t.a=n.exports},Jh4N:function(e,t){},L4uq:function(e,t){},LumP:function(e,t,a){"use strict";var s={name:"headBoxForChild",data:()=>({}),mounted(){this.$nextTick(function(){})},methods:{}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"headBox"},[a("div",{staticClass:"header-button is-left"},[a("i",{staticClass:"el-icon-ETH-fanhui",on:{click:function(t){e.$router.go(-1)}}})]),e._v(" "),a("h1",[e._v(e._s(e.$router.name))]),e._v(" "),a("div",{staticClass:"header-button is-right",staticStyle:{"text-align":"right"}})])},staticRenderFns:[]};var n=a("VU/8")(s,o,!1,function(e){a("sH/u")},"data-v-55ee080f",null);t.a=n.exports},LzvJ:function(e,t){},"N+8p":function(e,t,a){e.exports=a.p+"static/img/Trinity.9d7f65f.png"},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("7+uW"),o=a("xJD8"),n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"appBox",attrs:{id:"app"}},[a("div",{staticStyle:{position:"relative",margin:"0 auto",width:"100%","max-width":"1400px",height:"100%"}},[a("transition-group",{attrs:{name:e.transitionName,mode:"in-out"}},[a("router-view",{key:"router-box"})],1),e._v(" "),a("footer-box")],1),e._v(" "),a("channel"),e._v(" "),a("config"),e._v(" "),a("notify"),e._v(" "),a("dialogBox"),e._v(" "),a("el-dialog",{attrs:{title:e.$t("common.attention"),visible:e.isFeeInfoBoxShow,width:"30%",center:""},on:{"update:visible":function(t){e.isFeeInfoBoxShow=t}}},[a("span",[e._v(e._s(e.$t("common.fee-1"))),a("b",{staticStyle:{color:"#F56C6C"}},[e._v(e._s(e.$store.state.vuexStore.txOnChannelInfo.fee/1e8)+e._s(e.$store.state.vuexStore.txOnChannelInfo.assetType))]),e._v(e._s(e.$t("common.fee-2")))]),a("br"),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$t("common.whyFeeTips"),placement:"top"}},[a("span",{staticStyle:{"margin-top":"20px",display:"inline-block","text-decoration":"underline"}},[e._v(e._s(e.$t("common.whyFee")))])]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.sendHtlcMes()}}},[e._v(e._s(e.$t("common.continue")))]),e._v(" "),a("el-button",{on:{click:function(t){e.isFeeInfoBoxShow=!1}}},[e._v(e._s(e.$t("common.cancel")))])],1)],1),e._v(" "),a("el-dialog",{staticClass:"receiptRsmcInfoBox",attrs:{title:e.$t("common.receive"),visible:e.isReceiptRsmcInfoBox,width:"30%",center:"","modal-append-to-body":!1},on:{"update:visible":function(t){e.isReceiptRsmcInfoBox=t}}},[a("span",[e._v(e._s(e.activeInfo.redata.Sender))]),a("br"),e._v(" "),a("span",{staticStyle:{color:"#F56C6C","font-size":"16px"}},[e._v(e._s(e.$t("common.send-1"))+" "+e._s(e.activeInfo.redata.PaymentCount/1e8)+" "+e._s(e.activeInfo.redata.AssetType)+e._s(e.$t("common.send-2")))]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-form",{ref:"activeInfo",staticClass:"demo-ruleForm",attrs:{model:e.activeInfo,"status-icon":"",rules:e.confirmReceiptRules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:e.$t("common.password"),prop:"keyStorePass"}},[a("el-input",{attrs:{placeholder:e.$t("common.inputPassword"),type:"password","auto-complete":"off"},model:{value:e.activeInfo.keyStorePass,callback:function(t){e.$set(e.activeInfo,"keyStorePass",t)},expression:"activeInfo.keyStorePass"}})],1),e._v(" "),a("el-form-item",{staticStyle:{"text-align":"center","margin-left":"-80px"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.RsmcSign()}}},[e._v(e._s(e.$t("common.continue")))]),e._v(" "),a("el-button",{on:{click:function(t){e.isReceiptRsmcInfoBox=!1}}},[e._v(e._s(e.$t("common.cancel")))])],1)],1)],1)]),e._v(" "),a("el-dialog",{staticClass:"receiptHtlcInfoBox",attrs:{title:e.$t("common.receive"),visible:e.isReceiptHtlcInfoBox,width:"30%",center:"","modal-append-to-body":!1},on:{"update:visible":function(t){e.isReceiptHtlcInfoBox=t}}},[a("span",[e._v(e._s(e.activeInfo.redata.Sender))]),a("br"),e._v(" "),a("span",{staticStyle:{color:"#F56C6C","font-size":"16px"}},[e._v(e._s(e.$t("common.send-1"))+"  "+e._s(e.activeInfo.redata.PaymentCount/1e8)+" "+e._s(e.activeInfo.redata.AssetType)+e._s(e.$t("common.send-2"))+" ")]),e._v(" "),a("br"),a("br"),e._v(" "),a("b",{staticStyle:{color:"#F56C6C","font-size":"13px"}},[e._v(e._s(e.$t("common.twoPassword"))+" ")]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-form",{ref:"activeInfo",staticClass:"demo-ruleForm",attrs:{model:e.activeInfo,"status-icon":"",rules:e.confirmReceiptRules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:e.$t("common.password"),prop:"keyStorePass"}},[a("el-input",{attrs:{placeholder:e.$t("common.inputPassword"),type:"password","auto-complete":"off"},model:{value:e.activeInfo.keyStorePass,callback:function(t){e.$set(e.activeInfo,"keyStorePass",t)},expression:"activeInfo.keyStorePass"}})],1),e._v(" "),a("el-form-item",{staticStyle:{"text-align":"center","margin-left":"-80px"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.HtlcSign()}}},[e._v(e._s(e.$t("common.continue")))]),e._v(" "),a("el-button",{on:{click:function(t){e.isReceiptHtlcInfoBox=!1}}},[e._v(e._s(e.$t("common.cancel")))])],1)],1)],1)]),e._v(" "),a("el-dialog",{staticClass:"settleInfoBox",attrs:{title:e.$t("common.closeChannel"),visible:e.isSettleInfoBox,width:"30%",center:"","modal-append-to-body":!1},on:{"update:visible":function(t){e.isSettleInfoBox=t}}},[a("span",[e._v(e._s(e.activeInfo.redata.Sender)+e._s(e.$t("common.closeChannel-1"))+" ")]),e._v(" "),a("span",{staticStyle:{color:"#F56C6C","font-size":"16px"}},[e._v(e._s(e.$t("common.selfBalance"))+" : "+e._s(e.activeInfo.redata.ReceiverBalance/1e8)+" "+e._s(e.activeInfo.redata.AssetType))]),e._v(" "),a("span",{staticStyle:{color:"#F56C6C","font-size":"16px"}},[e._v(e._s(e.$t("common.otherBalance"))+" : "+e._s(e.activeInfo.redata.SenderBalance/1e8)+" "+e._s(e.activeInfo.redata.AssetType))]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-form",{ref:"activeInfo",staticClass:"demo-ruleForm",attrs:{model:e.activeInfo,"status-icon":"",rules:e.confirmReceiptRules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:e.$t("common.password"),prop:"keyStorePass"}},[a("el-input",{attrs:{placeholder:e.$t("common.inputPassword"),type:"password","auto-complete":"off"},model:{value:e.activeInfo.keyStorePass,callback:function(t){e.$set(e.activeInfo,"keyStorePass",t)},expression:"activeInfo.keyStorePass"}})],1),e._v(" "),a("el-form-item",{staticStyle:{"text-align":"center","margin-left":"-80px"}},[a("el-button",{attrs:{type:"danger"},on:{click:function(t){e.SettleSign()}}},[e._v(e._s(e.$t("common.continue")))]),e._v(" "),a("el-button",{on:{click:function(t){e.isSettleInfoBox=!1}}},[e._v(e._s(e.$t("common.cancel")))])],1)],1)],1)]),e._v(" "),a("el-dialog",{staticClass:"settleInfoBox",attrs:{title:e.$t("common.forceCloseChannel"),visible:e.isSettleTransactionInfoBox,width:"30%",center:"","modal-append-to-body":!1},on:{"update:visible":function(t){e.isSettleTransactionInfoBox=t}}},[a("span",[e._v("强制关闭通道已到达指定块高")]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-form",{ref:"activeInfo",staticClass:"demo-ruleForm",attrs:{model:e.activeInfo,"status-icon":"",rules:e.confirmReceiptRules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:e.$t("common.password"),prop:"keyStorePass"}},[a("el-input",{attrs:{placeholder:e.$t("common.inputPassword"),type:"password","auto-complete":"off"},model:{value:e.activeInfo.keyStorePass,callback:function(t){e.$set(e.activeInfo,"keyStorePass",t)},expression:"activeInfo.keyStorePass"}})],1),e._v(" "),a("el-form-item",{staticStyle:{"text-align":"center","margin-left":"-80px"}},[a("el-button",{attrs:{type:"danger"},on:{click:function(t){e.sendSettleTransaction()}}},[e._v(e._s(e.$t("common.continue")))]),e._v(" "),a("el-button",{on:{click:function(t){e.isSettleTransactionInfoBox=!1}}},[e._v(e._s(e.$t("common.cancel")))])],1)],1)],1)]),e._v(" "),a("el-dialog",{staticClass:"settleInfoBox",attrs:{title:"发送制裁交易",visible:e.isUpdateTransactionInfoBox,width:"30%",center:"","modal-append-to-body":!1},on:{"update:visible":function(t){e.isUpdateTransactionInfoBox=t}}},[a("span",[e._v("对端强制关闭通道数据不正确,发送制裁交易")]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-form",{ref:"activeInfo",staticClass:"demo-ruleForm",attrs:{model:e.activeInfo,"status-icon":"",rules:e.confirmReceiptRules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:e.$t("common.password"),prop:"keyStorePass"}},[a("el-input",{attrs:{placeholder:e.$t("common.inputPassword"),type:"password","auto-complete":"off"},model:{value:e.activeInfo.keyStorePass,callback:function(t){e.$set(e.activeInfo,"keyStorePass",t)},expression:"activeInfo.keyStorePass"}})],1),e._v(" "),a("el-form-item",{staticStyle:{"text-align":"center","margin-left":"-80px"}},[a("el-button",{attrs:{type:"danger"},on:{click:function(t){e.sendUpdateTransaction()}}},[e._v(e._s(e.$t("common.continue")))]),e._v(" "),a("el-button",{on:{click:function(t){e.isUpdateTransactionInfoBox=!1}}},[e._v(e._s(e.$t("common.cancel")))])],1)],1)],1)]),e._v(" "),a("el-dialog",{staticClass:"SendUnlockAmountInfoBox",attrs:{title:"申请解冻资产",visible:e.isSendUnlockAmountInfoBox,width:"30%",center:"","modal-append-to-body":!1},on:{"update:visible":function(t){e.isSendUnlockAmountInfoBox=t}}},[a("span",[e._v("HTLC到达指定块高仍未收到R,正在申请解冻资产")]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-form",{ref:"activeInfo",staticClass:"demo-ruleForm",attrs:{model:e.activeInfo,"status-icon":"",rules:e.confirmReceiptRules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:e.$t("common.password"),prop:"keyStorePass"}},[a("el-input",{attrs:{placeholder:e.$t("common.inputPassword"),type:"password","auto-complete":"off"},model:{value:e.activeInfo.keyStorePass,callback:function(t){e.$set(e.activeInfo,"keyStorePass",t)},expression:"activeInfo.keyStorePass"}})],1),e._v(" "),a("el-form-item",{staticStyle:{"text-align":"center","margin-left":"-80px"}},[a("el-button",{on:{click:function(t){e.SendUnlockAmount()}}},[e._v(e._s(e.$t("common.continue")))]),e._v(" "),a("el-button",{on:{click:function(t){e.isSendUnlockAmountInfoBox=!1}}},[e._v(e._s(e.$t("common.cancel")))])],1)],1)],1)]),e._v(" "),a("el-dialog",{staticClass:"unlockAmountInfoBox",attrs:{title:"解冻资产",visible:e.isUnlockAmountInfoBox,width:"30%",center:"","modal-append-to-body":!1},on:{"update:visible":function(t){e.isUnlockAmountInfoBox=t}}},[a("span",[e._v("您现在可以解冻锁定的资产")]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-form",{ref:"activeInfo",staticClass:"demo-ruleForm",attrs:{model:e.activeInfo,"status-icon":"",rules:e.confirmReceiptRules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:e.$t("common.password"),prop:"keyStorePass"}},[a("el-input",{attrs:{placeholder:e.$t("common.inputPassword"),type:"password","auto-complete":"off"},model:{value:e.activeInfo.keyStorePass,callback:function(t){e.$set(e.activeInfo,"keyStorePass",t)},expression:"activeInfo.keyStorePass"}})],1),e._v(" "),a("el-form-item",{staticStyle:{"text-align":"center","margin-left":"-80px"}},[a("el-button",{on:{click:function(t){e.UnlockAmount()}}},[e._v(e._s(e.$t("common.continue")))]),e._v(" "),a("el-button",{on:{click:function(t){e.isUnlockAmountInfoBox=!1}}},[e._v(e._s(e.$t("common.cancel")))])],1)],1)],1)]),e._v(" "),a("el-dialog",{attrs:{title:"退出",visible:e.isSignOutBoxShow,width:"30%",center:""},on:{"update:visible":function(t){e.isSignOutBoxShow=t}}},[a("span",[e._v(e._s(e.$t("common.signOut"))+" ")]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"danger"},on:{click:function(t){e.SignOut()}}},[e._v(e._s(e.$t("common.continue")))]),e._v(" "),a("el-button",{on:{click:function(t){e.isSignOutBoxShow=!1}}},[e._v(e._s(e.$t("common.cancel")))])],1)])],1)},staticRenderFns:[]};var r=function(e){a("vxah")},i=a("VU/8")(o.a,n,!1,r,null,null).exports,l=a("/ocq"),c={name:"indexForm",data:()=>({assetList:[{name:"TNC",iconStyle:"-53px",baseChain:"all"},{name:"ETH",iconStyle:"-25px",baseChain:"ETH"},{name:"NEO",iconStyle:"3px",baseChain:"NEO"},{name:"GAS",iconStyle:"3px",baseChain:"NEO"}]}),computed:{walletInfo(){return"ETH"==this.$store.state.vuexStore.baseChain?this.$store.state.vuexStore.walletInfo:"NEO"==this.$store.state.vuexStore.baseChain?this.$store.state.vuexStore.NEOwalletInfo:void 0},balanceData(){return this.$store.state.vuexStore.balanceData},baseChain(){return this.$store.state.vuexStore.baseChain}},filters:{formatAddress:function(e){return e.replace(/(.{10}).*(.{10})/,"$1......$2")}},mounted(){this.$nextTick(function(){})},watch:{},methods:{toAssetForm(e){this.$router.push("/chain/asset"),this.$store.state.vuexStore.activeAssetInfo.assetType=e},changeWallet(){console.log(1),"ETH"==this.$store.state.vuexStore.baseChain?this.$store.state.vuexStore.baseChain="NEO":this.$store.state.vuexStore.baseChain="ETH",console.log(this.$store.state.vuexStore.baseChain)}}},d={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"indexBox"},[s("div",{staticClass:"headBox"},[s("div",{staticClass:"header-button is-left"},[s("p",{on:{click:function(t){e.changeWallet()}}},[e._v("ETH/NEO")])]),e._v(" "),s("h1"),e._v(" "),s("div",{staticClass:"header-button is-right",staticStyle:{"text-align":"right"}},[s("router-link",{attrs:{to:"/scan"}},[s("i",{staticClass:"notificationIcon el-icon-ETH-saoyisao",attrs:{click:"$router.push('/scan')"}})])],1)]),e._v(" "),s("div",{staticClass:"assetBox"},[s("div",{staticClass:"amountBox"},[s("h3",[e._v("TNC")]),e._v(" "),s("h1",[e._v(e._s(e.balanceData.Chain.TNC))])]),e._v(" "),s("div",{staticClass:"addressBox"},[s("el-row",{attrs:{gutter:20}},[s("el-col",{staticStyle:{"border-right":"1px solid #8A9199"},attrs:{span:8}},[e._v("\n          "+e._s(e.baseChain)+"\n        ")]),e._v(" "),s("el-col",{attrs:{span:16}},[s("router-link",{attrs:{to:"/chain/receive1"}},[s("i",{staticClass:"el-icon-ETH-erweima"}),e._v("\n            "+e._s(e._f("formatAddress")(e.walletInfo.address))+"\n          ")])],1)],1)],1)]),e._v(" "),s("div",{staticClass:"content1Box"},[s("ul",{staticClass:"listUl"},e._l(e.assetList,function(t,o){return t.baseChain==e.baseChain||"all"==t.baseChain?s("li",{key:o,on:{click:function(a){e.toAssetForm(t.name)}}},[s("div",{staticClass:"assetIcon"},[s("img",{style:{marginLeft:t.iconStyle},attrs:{src:a("yfsC"),alt:""}})]),e._v(" "),s("span",[e._v(e._s(t.name))]),e._v(" "),s("span",[e._v(e._s(e.balanceData.Chain[t.name]))])]):e._e()}))])])},staticRenderFns:[]};var h=a("VU/8")(c,d,!1,function(e){a("GcSp")},"data-v-415fafee",null).exports,u={name:"messageForm",data:()=>({messageList:[{title:"欢迎来到消息中心",messageType:"signFun",isRead:!1,date:1539314320400,imgLink:"./../../../static/Trinity.png",content:"测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试",sender:{type:"channel",name:"1"}},{title:"目前该功能还在开发中",messageType:"showPrivateKey",isRead:!1,date:1539314320400,imgLink:"./../../../static/Trinity.png",content:"测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试",sender:{type:"address",name:"0xADCe15cDEc589f93D25BE13DFa9370F659e78D45"}},{title:"敬请期待",messageType:"testFun",isRead:!0,date:1539314320400,imgLink:"./../../../static/Trinity.png",content:"测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试",sender:{type:"trinity",name:"Trinity"}}],messageList1:[]}),filters:{formatAddress:function(e){return e.replace(/(.{8}).*(.{8})/,"$1...$2")},formatDateTime:function(e){var t=new Date(e),a=t.getMonth()+1;a=a<10?"0"+a:a;var s=t.getDate();return a+"-"+(s=s<10?"0"+s:s)+" "+t.getHours()+":"+t.getMinutes()}},methods:{readMessage(e){switch(console.log(e),e.messageType){case"signFun":this.signFun();break;case"showPrivateKey":this.showPrivateKey();break;case"testFun":this.testFun();break;default:alert("未知消息类型")}},clearAll(){return console.log("清除全部"),this.$store.state.vuexStore.channelList=[],this.$parent.$parent.StoreData("channelList"),this.$store.state.vuexStore.recordList=[],this.$parent.$parent.StoreData("recordList"),this.$store.state.vuexStore.txList=[],this.$parent.$parent.StoreData("txList"),this.$store.state.vuexStore.eventList=[],this.$parent.$parent.StoreData("eventList"),!1},signFun(){let e=web3.utils.soliditySha3({t:"bytes32",v:"0x295722f9ae1a0fe6315a9d7c7b930f5740c8ca8f8163da076e35c1f347f5410e"},{t:"uint256",v:2},{t:"address",v:"0xDc1FF8Ee46f97F6089aa17553F1531f81C33fe7F"},{t:"uint256",v:9e8},{t:"address",v:"0xA5a0640c9542c7621cDA89Cce562580b66333549"},{t:"uint256",v:11e8},{t:"bytes32",v:"0x0000000000000000000000000000000000000000000000000000000000000000"},{t:"bytes32",v:"0x0000000000000000000000000000000000000000000000000000000000000000"});console.log(e);let t=ecSign(e,"0xab669573efbdcaf5f2d88704b41162a77c6090cf908d937979d5c38b44e66741");console.log(t)},showPrivateKey(){let e=this.$parent.$parent.decryptPrivateKey(this.$store.state.vuexStore.walletInfo.keyStore,"123");console.log(e.privateKey)},testFun(){createHr("7e50027b090d8a553203f9da6762b1f7907511a893b61a9fe0da531fdfd957fc")}}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"messageForm"},[a("div",{staticClass:"headBox"},[a("div",{staticClass:"header-button is-left"}),e._v(" "),a("h1",[e._v("消息中心")]),e._v(" "),a("div",{staticClass:"header-button is-right",staticStyle:{"text-align":"right"}},[e.messageList1.length?a("p",{on:{click:function(t){e.clearAll()}}},[e._v("清空全部")]):e._e()])]),e._v(" "),a("div",{staticClass:"contentBox"},[e.messageList1.length?a("ul",{staticClass:"listUl"},e._l(e.messageList,function(t,s){return a("li",{key:s,on:{click:function(a){e.readMessage(t)}}},[a("h2",{staticClass:"title"},[e._v(e._s(t.title)),a("span",{staticClass:"readFlag",class:{isRead:t.isRead}}),a("span",{staticClass:"date"},[e._v(e._s(e._f("formatDateTime")(t.date)))])]),e._v(" "),a("div",{staticClass:"bottomBox"},[a("img",{attrs:{src:t.imgLink,alt:"image"}}),e._v(" "),a("p",[e._v(e._s(t.content))]),e._v(" "),"channel"==t.sender.type?a("p",[e._v("发起人: "+e._s(t.sender.name)+" - 通道")]):e._e(),e._v(" "),"address"==t.sender.type?a("p",[e._v("发起人: "+e._s(e._f("formatAddress")(t.sender.name)))]):e._e(),e._v(" "),"trinity"==t.sender.type?a("p",[e._v("发起人: "+e._s(t.sender.name))]):e._e()])])})):a("p",{staticStyle:{"text-align":"center","margin-top":"20vh","font-size":"14px",color:"#5e6d82","line-height":"1.5em","font-weight":"400"}},[e._v("\n          消息中心功能正在加入中...\n      ")])])])},staticRenderFns:[]};var f=a("VU/8")(u,m,!1,function(e){a("qBZY")},"data-v-663969d7",null).exports,v={name:"descoverForm",data:()=>({}),filters:{},methods:{}},g={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"descoverForm"},[t("div",{staticClass:"headBox"},[t("div",{staticClass:"header-button is-left"}),this._v(" "),t("h1",[this._v("发现")]),this._v(" "),t("div",{staticClass:"header-button is-right",staticStyle:{"text-align":"right"}})]),this._v(" "),t("div",{staticClass:"contentBox"},[t("p",{staticStyle:{"text-align":"center","margin-top":"20vh","font-size":"14px",color:"#5e6d82","line-height":"1.5em","font-weight":"400"}},[this._v("\n          一键资产转换等功能正在加入中...\n      ")])])])}]};var p=a("VU/8")(v,g,!1,function(e){a("jqPu")},"data-v-29e16f06",null).exports,y={name:"settingForm",data:()=>({}),filters:{},methods:{test(){this.$message({type:"success",text:11111,duration:0})}}},S={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"settingForm"},[a("div",{staticClass:"headBox"},[a("div",{staticClass:"header-button is-left"}),e._v(" "),a("h1",[e._v(e._s(e.$t("setting.title")))]),e._v(" "),a("div",{staticClass:"header-button is-right"})]),e._v(" "),a("div",{staticClass:"contentBox"},[a("router-link",{staticClass:"cell",attrs:{to:"/setting/backup"}},[a("div",{staticClass:"cell-wrapper"},[a("div",{staticClass:"cell-title"},[a("span",{staticClass:"cell-text"},[e._v(e._s(e.$t("setting.backup")))])]),e._v(" "),a("div",{staticClass:"cell-right"},[a("i",{staticClass:"el-icon-ETH-qianjin"})])])]),e._v(" "),a("router-link",{staticClass:"cell",attrs:{to:"/setting/changePassword"}},[a("div",{staticClass:"cell-wrapper"},[a("div",{staticClass:"cell-title"},[a("span",{staticClass:"cell-text"},[e._v(e._s(e.$t("setting.changePass")))])]),e._v(" "),a("div",{staticClass:"cell-right"},[a("i",{staticClass:"el-icon-ETH-qianjin"})])])]),e._v(" "),a("router-link",{staticClass:"cell",attrs:{to:"/setting/contact"}},[a("div",{staticClass:"cell-wrapper"},[a("div",{staticClass:"cell-title"},[a("span",{staticClass:"cell-text"},[e._v(e._s(e.$t("setting.contact")))])]),e._v(" "),a("div",{staticClass:"cell-right"},[a("i",{staticClass:"el-icon-ETH-qianjin"})])])]),e._v(" "),a("router-link",{staticClass:"cell",attrs:{to:"/setting/language"}},[a("div",{staticClass:"cell-wrapper"},[a("div",{staticClass:"cell-title"},[a("span",{staticClass:"cell-text"},[e._v(e._s(e.$t("setting.switchLang")))])]),e._v(" "),a("div",{staticClass:"cell-right"},[a("i",{staticClass:"el-icon-ETH-qianjin"})])])]),e._v(" "),a("router-link",{staticClass:"cell",staticStyle:{"margin-top":"30px"},attrs:{to:"/setting/about"}},[a("div",{staticClass:"cell-wrapper"},[a("div",{staticClass:"cell-title"},[a("span",{staticClass:"cell-text"},[e._v(e._s(e.$t("setting.about")))])]),e._v(" "),a("div",{staticClass:"cell-right"},[a("i",{staticClass:"el-icon-ETH-qianjin"})])])]),e._v(" "),a("div",{staticStyle:{"text-align":"center","margin-top":"42px"}},[a("el-button",{staticStyle:{width:"80%"},attrs:{type:"primary"},on:{click:function(t){e.test()}}},[e._v(e._s(e.$t("setting.signOut")))])],1)],1)])},staticRenderFns:[]};var x=a("VU/8")(y,S,!1,function(e){a("fxPf")},"data-v-2cf58598",null).exports,C=a("LumP"),b={name:"scanForm",data:()=>({}),components:{headBox:C.a},computed:{},filters:{},mounted(){this.$nextTick(function(){let e=this;setTimeout(function(){e.startRecognize()},350)})},watch:{},methods:{startRecognize(){scan=new plus.barcode.Barcode("bcid"),scan.onmarked=this.onmarked,this.startScan()},onmarked(e,t){var a="未知";switch(e){case plus.barcode.QR:a="QR";break;case plus.barcode.EAN13:a="EAN13";break;case plus.barcode.EAN8:a="EAN8"}console.log(4),console.log(a+": "+t),this.closeScan(),this.$router.go(-1)},startScan(){scan.start()},closeScan(){scan.close()}}},$={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"scanForm"},[t("headBox"),this._v(" "),t("div",{attrs:{id:"bcid"}})],1)},staticRenderFns:[]};var _=a("VU/8")(b,$,!1,function(e){a("6Fyv")},"data-v-3145045c",null).exports,T={name:"EtherScanForm",data:()=>({clickNum:0}),components:{headBox:C.a},watch:{},filters:{},mounted(){this.$nextTick(function(){})},methods:{}},k={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"EtherScanForm"},[t("headBox"),this._v(" "),this._m(0)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"contentBox",attrs:{id:"EtherScanBox"}},[t("object",{staticStyle:{border:"0px"},attrs:{type:"text/x-scriptlet",data:"https://ropsten.etherscan.io",width:"100%",height:"30"}})])}]};var w=a("VU/8")(T,k,!1,function(e){a("gE2U")},"data-v-1dbe322c",null).exports,N=a("f3u+"),I=a.n(N);s.default.use(I.a);var B={name:"receiveForm",data:()=>({paymentCodeForm:{amount:"",assetType:"",assetContractAddress:"",selfUri:"",R:"",Hr:"",Code:""},paymentCodeRules:{amount:[{validator:(e,t,a)=>{if(!t)return a(new Error("金额不能为空"));t<0?a(new Error("请输入正确的数字值")):a()},trigger:"blur"}],assetType:[{validator:(e,t,a)=>{""===t?a(new Error("请选择资产类型")):a()},trigger:"change"}]},isPaymentCodeBoxShow:!1}),watch:{},mounted(){this.$nextTick(function(){})},methods:{copyfun(){let e=this;clipboard&&clipboard.destroy(),clipboard=new ClipboardJS(".btncopy"),clipboard.on("success",function(t){e.$notify.info({title:"消息",dangerouslyUseHTMLString:!0,message:"复制成功",duration:3e3})}),clipboard.on("error",function(t){e.$notify.info({title:"警告",dangerouslyUseHTMLString:!0,message:"复制失败，请自行复制",duration:3e3,type:"warning"})})},createPaymentCode(){let e=this;e.$refs.paymentCodeForm.validate(t=>{if(!t)return console.log("error submit!!"),!1;{if(console.log("submit!"),"TNC"==e.paymentCodeForm.assetType)e.paymentCodeForm.assetContractAddress=e.$store.state.vuexStore.tncContractAddress;else{if("ETH"!=e.paymentCodeForm.assetType)return e.$notify.info({title:"警告",dangerouslyUseHTMLString:!0,message:"资产类型出错",duration:3e3,type:"warning"}),!1;e.paymentCodeForm.assetContractAddress=""}if(e.paymentCodeForm.R=randomBytes(32),console.log(e.paymentCodeForm.R),e.paymentCodeForm.Hr=web3.utils.keccak256(e.paymentCodeForm.R),console.log(e.paymentCodeForm.Hr),e.$store.state.vuexStore.channelList.forEach(function(t,a){3==t.State&&t.assetType==e.paymentCodeForm.assetType&&(e.paymentCodeForm.selfUri=t.SelfUri)}),""==e.paymentCodeForm.selfUri)return e.$notify.info({title:"警告",dangerouslyUseHTMLString:!0,message:"没有该资产类型的通道",duration:3e3,type:"warning"}),!1;let t=e.paymentCodeForm.selfUri+"&"+e.$store.state.vuexStore.NetMagic+"&"+e.paymentCodeForm.Hr+"&"+e.paymentCodeForm.assetType+"&"+e.paymentCodeForm.amount.mul(1e8)+"&PaymentCode";console.log(t),e.paymentCodeForm.Code="TN"+base58encode(t),console.log(e.paymentCodeForm.Code),e.isPaymentCodeBoxShow=!0;let a={Hr:e.paymentCodeForm.Hr,R:e.paymentCodeForm.R};e.$store.state.vuexStore.RList.push(a),e.$parent.StoreData("RList")}})},resetForm(){this.isPaymentCodeBoxShow=!1,this.paymentCodeForm={amount:"",assetType:"",selfUri:"",R:"",Hr:"",Code:""}}}},O={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"receiveForm",class:{fullPage:!e.$store.state.vuexStore.isNavShow}},[a("div",{staticClass:"contentBox"},[a("h2",[e._v(e._s(e.$t("receive.title")))]),e._v(" "),a("hr",{staticStyle:{height:"2px",border:"none","border-top":"2px dotted #EBEEF5"}}),e._v(" "),a("el-tabs",{staticStyle:{width:"100%","max-width":"440px"},attrs:{type:"border-card",stretch:!0}},[a("el-tab-pane",{attrs:{label:e.$t("receive.chain")}},["ETH"==e.$store.state.vuexStore.baseChain?[a("div",{staticClass:"QRCodeBox QRCodeBox-white"},[a("h3",[e._v(e._s(e.$t("receive.receiveAddress")))]),e._v(" "),a("qriously",{attrs:{value:this.$store.state.vuexStore.walletInfo.address,level:"H",size:210}}),e._v(" "),a("p",{domProps:{textContent:e._s(this.$store.state.vuexStore.walletInfo.address)}})],1),e._v(" "),a("el-input",{attrs:{id:"receiveAddress",placeholder:"Address",readonly:"readonly"},model:{value:this.$store.state.vuexStore.walletInfo.address,callback:function(t){e.$set(this.$store.state.vuexStore.walletInfo,"address",t)},expression:"this.$store.state.vuexStore.walletInfo.address"}},[a("el-button",{staticClass:"btncopy",attrs:{slot:"append","data-clipboard-target":"#receiveAddress",icon:"el-icon-share"},on:{click:function(t){e.copyfun()}},slot:"append"},[e._v(e._s(e.$t("receive.copy")))])],1)]:e._e(),e._v(" "),"NEO"==e.$store.state.vuexStore.baseChain?[a("div",{staticClass:"QRCodeBox QRCodeBox-white"},[a("h3",[e._v(e._s(e.$t("receive.receiveAddress")))]),e._v(" "),a("qriously",{attrs:{value:this.$store.state.vuexStore.NEOwalletInfo.address,level:"H",size:210}}),e._v(" "),a("p",{domProps:{textContent:e._s(this.$store.state.vuexStore.NEOwalletInfo.address)}})],1),e._v(" "),a("el-input",{attrs:{id:"receiveAddress1",placeholder:"Address",readonly:"readonly"},model:{value:this.$store.state.vuexStore.NEOwalletInfo.address,callback:function(t){e.$set(this.$store.state.vuexStore.NEOwalletInfo,"address",t)},expression:"this.$store.state.vuexStore.NEOwalletInfo.address"}},[a("el-button",{staticClass:"btncopy",attrs:{slot:"append","data-clipboard-target":"#receiveAddress1",icon:"el-icon-share"},on:{click:function(t){e.copyfun()}},slot:"append"},[e._v(e._s(e.$t("receive.copy")))])],1)]:e._e()],2),e._v(" "),a("el-tab-pane",{attrs:{label:e.$t("receive.channel")}},[e.isPaymentCodeBoxShow?e._e():a("el-form",{ref:"paymentCodeForm",staticClass:"demo-ruleForm",staticStyle:{"text-align":"center"},attrs:{model:e.paymentCodeForm,"status-icon":"",rules:e.paymentCodeRules,"label-width":"82px"}},[a("el-form-item",{attrs:{label:e.$t("receive.amount"),prop:"amount"}},[a("el-input",{attrs:{type:"number","auto-complete":"off"},model:{value:e.paymentCodeForm.amount,callback:function(t){e.$set(e.paymentCodeForm,"amount",e._n(t))},expression:"paymentCodeForm.amount"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("receive.assetType"),prop:"assetType"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("receive.chooseAssetType")},model:{value:e.paymentCodeForm.assetType,callback:function(t){e.$set(e.paymentCodeForm,"assetType",t)},expression:"paymentCodeForm.assetType"}},[a("el-option",{attrs:{label:"TNC",value:"TNC"}}),e._v(" "),a("el-option",{attrs:{label:"ETH",value:"ETH"}})],1)],1),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.createPaymentCode()}}},[e._v(e._s(e.$t("receive.create")))])],1),e._v(" "),e.isPaymentCodeBoxShow?a("div",[a("el-button",{on:{click:function(t){e.resetForm("ruleForm")}}},[e._v(e._s(e.$t("receive.reset")))]),e._v(" "),a("div",{staticClass:"QRCodeBox QRCodeBox-white"},[a("h3",[e._v(e._s(e.$t("receive.receiveCode")))]),e._v(" "),a("qriously",{attrs:{value:e.paymentCodeForm.Code,level:"H",size:210}}),e._v(" "),a("p",{staticStyle:{width:"378px","text-overflow":"ellipsis","white-space":"nowrap",overflow:"hidden"}},[e._v(e._s(e.paymentCodeForm.Code))])],1),e._v(" "),a("el-input",{attrs:{id:"receivePaymentCode",placeholder:"Receive Payment Code"},model:{value:e.paymentCodeForm.Code,callback:function(t){e.$set(e.paymentCodeForm,"Code",t)},expression:"paymentCodeForm.Code"}},[a("el-button",{staticClass:"btncopy",attrs:{slot:"append","data-clipboard-target":"#receivePaymentCode",icon:"el-icon-search"},on:{click:function(t){e.copyfun()}},slot:"append"},[e._v(e._s(e.$t("receive.copy")))])],1)],1):e._e()],1)],1)],1)])},staticRenderFns:[]};var L=a("VU/8")(B,O,!1,function(e){a("8UDB")},"data-v-71562b3e",null).exports,D={name:"recordForm",data:()=>({isRecordInfoBoxShow:!1,activeInfo:{date:"",name:"",Amount:"",assetType:"",isOnChannel:!0,isPay:!0,isSuccess:!0,transactionHash:""}}),filters:{formatAddress:function(e){return e.replace(/(.{5}).*(.{5})/,"$1......$2")},formatIsOnChannel:function(e){return e?"Channel":"Chain"},formatState:function(e){let t;switch(e){case-1:t="Fail";break;case 0:t="Pending";break;case 1:t="Success"}return t},formatIsPay:function(e){return e?"-":"+"},formatDateTime:function(e){var t=new Date,a=t.getFullYear(),s=t.getMonth()+1;s=s<10?"0"+s:s;var o=t.getDate();return a+"-"+s+"-"+(o=o<10?"0"+o:o)}},computed:{recordList(){return this.$store.state.vuexStore.recordList}},methods:{showRecordInfo(e){this.isRecordInfoBoxShow=!0,this.activeInfo=e,console.log(e)},formatRecordList(e){let t=this,a=[];var s;e.forEach(function(e,s){e.isTestNet==t.$store.state.vuexStore.isTestNet&&a.push(e)});for(var o=0;o<a.length;o++)for(var n=o;n<a.length;n++)a[o].date<a[n].date&&(s=a[n],a[n]=a[o],a[o]=s);return a},testfun(){}}},R={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"recordForm",class:{fullPage:!e.$store.state.vuexStore.isNavShow}},[a("div",{staticClass:"contentBox"},[a("h2",{on:{click:function(t){e.testfun()}}},[e._v(e._s(e.$t("record.title")))]),e._v(" "),a("hr",{staticStyle:{height:"2px",border:"none","border-top":"2px dotted #EBEEF5",margin:"8px 0 0 0"}}),e._v(" "),e.formatRecordList(e.recordList).length?a("ul",e._l(e.formatRecordList(e.recordList),function(t,s){return a("li",{key:s,on:{click:function(a){e.showRecordInfo(t,s)}}},[a("h3",[e._v(e._s(e._f("formatAddress")(t.name))+" - "+e._s(e._f("formatIsOnChannel")(t.isOnChannel)))]),a("br"),e._v(" "),a("p",[e._v(e._s(e._f("formatDateTime")(t.date)))]),e._v(" "),a("p",{staticStyle:{"min-width":"180px"}},[e._v("State："+e._s(e._f("formatState")(t.state)))]),e._v(" "),a("span",[e._v(e._s(e._f("formatIsPay")(t.isPay))+e._s(t.Amount/1e8)),a("sup",[e._v(e._s(t.assetType))])])])})):e._e(),e._v(" "),e.formatRecordList(e.recordList).length?e._e():a("p",{staticStyle:{"text-align":"center","margin-top":"20vh","font-size":"14px",color:"#5e6d82","line-height":"1.5em","font-weight":"400"}},[e._v("\n          "+e._s(e.$t("record.noRecord"))+"\n      ")])]),e._v(" "),a("el-dialog",{staticClass:"recordInfoBox",attrs:{title:e.$t("record.recordInfo"),visible:e.isRecordInfoBoxShow,width:"30%",center:"","modal-append-to-body":!1},on:{"update:visible":function(t){e.isRecordInfoBoxShow=t}}},[a("span",[e._v(e._s(e.$t("record.otherUri"))+": "+e._s(e.activeInfo.name))]),e._v(" "),a("span",[e._v(e._s(e.$t("record.date"))+": "+e._s(e._f("formatDateTime")(e.activeInfo.date)))]),e._v(" "),a("span",[e._v(e._s(e.$t("record.amount"))+": "+e._s(e.activeInfo.Amount/1e8)+e._s(e.activeInfo.assetType))]),e._v(" "),a("span",[e._v(e._s(e.$t("record.isOnChannel"))+": "+e._s(e._f("formatIsOnChannel")(e.activeInfo.isOnChannel)))]),e._v(" "),a("span",[e._v(e._s(e.$t("record.state"))+": "+e._s(e._f("formatState")(e.activeInfo.state)))]),e._v(" "),a("span",[e._v(e._s(e.$t("record.transactionHash"))+": "+e._s(e.activeInfo.transactionHash))]),e._v(" "),a("span",[e._v(e._s(e.$t("record.blockHash"))+": "+e._s(e.activeInfo.blockHash))]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.isRecordInfoBoxShow=!1}}},[e._v(" "+e._s(e.$t("record.close"))+" ")])],1)])],1)},staticRenderFns:[]};var P=a("VU/8")(D,R,!1,function(e){a("5CRf")},"data-v-46d44b1b",null).exports,E=a("qKYu"),F={name:"startForm",data:()=>({}),methods:{toOtherForm(e){this.$router.push(e)},switchLang(){"cn"===this.$i18n.locale?this.$i18n.locale="en":this.$i18n.locale="cn",this.$parent.$parent.saveAsString("lang",this.$i18n.locale)},switchNet(e){let t=this;"object"==typeof t.$store.state.vuexStore.NodeUriWebSocket&&(t.$store.state.vuexStore.NodeUriWebSocket.close(),t.$store.state.vuexStore.NodeUriWebSocket=""),t.$store.state.vuexStore.baseChain=e,t.$parent.$parent.saveAsString("baseChain",t.$store.state.vuexStore.baseChain),E.a.$emit("UpdateConfig",!0)}}},H={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"startForm"},[e._m(0),e._v(" "),a("div",{staticClass:"contentBox"},[a("div",[a("div",{staticClass:"chainIconBox"},[a("p",[e._v("切换主链:")]),e._v(" "),a("i",{staticClass:"el-icon-ETH-ETH",class:{active:"ETH"==e.$store.state.vuexStore.baseChain},on:{click:function(t){e.switchNet("ETH")}}}),e._v(" "),a("i",{staticClass:"el-icon-ETH-NEO",class:{active:"NEO"==e.$store.state.vuexStore.baseChain},on:{click:function(t){e.switchNet("NEO")}}})]),e._v(" "),a("h2",{staticClass:"title_h2"},[e._v(e._s(e.$t("start.title")))])]),e._v(" "),a("hr"),e._v(" "),a("div",{staticClass:"clooseLoginBox clooseLoginBox-blue",on:{click:function(t){e.toOtherForm("./create")}}},[a("h3",[e._v(e._s(e.$t("start.createWallet")))]),e._v(" "),a("p",[e._v(e._s(e.$t("start.createWalletTxt")))])]),e._v(" "),a("div",{staticClass:"clooseLoginBox clooseLoginBox-green",on:{click:function(t){e.toOtherForm("./loginByPrivateKey")}}},[a("h3",[e._v(e._s(e.$t("start.loginByPrivateKey")))]),e._v(" "),a("p",[e._v(e._s(e.$t("start.loginByPrivateKeyTxt")))])]),e._v(" "),a("div",{staticClass:"clooseLoginBox clooseLoginBox-gray",on:{click:function(t){e.toOtherForm("./loginByKeyStore")}}},[a("h3",[e._v(e._s(e.$t("start.loginByKeystore")))]),e._v(" "),a("p",[e._v(e._s(e.$t("start.loginByKeystoreTxt")))])]),e._v(" "),a("a",{staticClass:"backToStartBtn",on:{click:function(t){e.switchLang()}}},[e._v(e._s(e.$t("common.switchLang")))])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"headBox"},[t("div",{staticClass:"header-button is-left"}),this._v(" "),t("h1"),this._v(" "),t("div",{staticClass:"header-button is-right",staticStyle:{"text-align":"right"}})])}]};var M=a("VU/8")(F,H,!1,function(e){a("cdTS")},"data-v-70f0e23c",null).exports,A={name:"createForm",data(){return{createForm:{pass:"",checkPass:""},createRules:{pass:[{validator:(e,t,a)=>{""===t?a(new Error(this.$t("create.callback-1"))):(""!==this.createForm.checkPass&&this.$refs.createForm.validateField("checkPass"),a())},trigger:"blur"}],checkPass:[{validator:(e,t,a)=>{""===t?a(new Error(this.$t("create.callback-2"))):t!==this.createForm.pass?a(new Error(this.$t("create.callback-3"))):a()},trigger:"blur"}]}}},components:{headBox:C.a},mounted(){this.$nextTick(function(){})},methods:{toLoginForm(){this.$refs.createForm.validate(e=>{if(!e)return console.log("error submit!!"),!1;if("ETH"==this.$store.state.vuexStore.baseChain){let e=web3.eth.accounts.create().privateKey.slice(2);console.log(e);let t=web3.eth.accounts.encrypt("0x"+e,this.createForm.pass);console.log(t);let a=web3.utils.toChecksumAddress(t.address);console.log(a),web3.utils.checkAddressChecksum(a)&&(this.$store.state.vuexStore.walletInfo.keyStore=t,this.$store.state.vuexStore.walletInfo.address=a,this.$store.state.vuexStore.isLogin=!0,this.$notify({title:this.$t("create.callback-4"),dangerouslyUseHTMLString:!0,message:this.$t("create.callback-5"),duration:3e3,type:"success"})),this.$router.push("/setting/backup")}else if("NEO"==this.$store.state.vuexStore.baseChain){let e=ab2hexstring(generatePrivateKey());console.log(e);let t=scrypt_module_factory(generateWalletFileBlob,{},{privateKey:e,password:this.createForm.pass});console.log(t);let a=t.accounts[0].address;console.log(a),34==a.length&&(this.$store.state.vuexStore.NEOwalletInfo.keyStore=t,this.$store.state.vuexStore.NEOwalletInfo.publicKey=getPublicKeyEncoded(ab2hexstring(getPublicKey(e,0))),this.$store.state.vuexStore.NEOwalletInfo.address=a,this.$store.state.vuexStore.isLogin=!0,this.$notify({title:this.$t("create.callback-4"),dangerouslyUseHTMLString:!0,message:this.$t("create.callback-5"),duration:3e3,type:"success"})),this.$router.push("/setting/backup")}this.createForm.pass="",this.createForm.checkPass=""})}}},U={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"createForm"},[a("headBox"),e._v(" "),a("div",{staticClass:"contentBox"},[a("h2",{staticClass:"title_h2"},[e._v(e._s(e.$t("create.title")))]),e._v(" "),a("hr"),e._v(" "),a("el-form",{ref:"createForm",staticClass:"demo-ruleForm",attrs:{model:e.createForm,"status-icon":"",rules:e.createRules,"label-position":"top"}},[a("el-form-item",{attrs:{label:e.$t("create.password"),prop:"pass"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.createForm.pass,callback:function(t){e.$set(e.createForm,"pass",t)},expression:"createForm.pass"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("create.checkPass"),prop:"checkPass"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.createForm.checkPass,callback:function(t){e.$set(e.createForm,"checkPass",t)},expression:"createForm.checkPass"}})],1),e._v(" "),a("div",{staticStyle:{"text-align":"center","margin-bottom":"22px"}},[a("el-button",{staticStyle:{width:"80%"},attrs:{type:"primary"},on:{click:function(t){e.toLoginForm()}}},[e._v(e._s(e.$t("create.create")))])],1)],1),e._v(" "),a("a",{staticClass:"backToStartBtn",on:{click:function(t){e.$parent.$parent.backToStart()}}},[e._v(e._s(e.$t("loginByPrivateKey.backToStart")))])],1)],1)},staticRenderFns:[]};var K=a("VU/8")(A,U,!1,function(e){a("uQaT")},"data-v-3c51d86e",null).exports,W={name:"loginByPrivateKeyForm",data(){return{loginByPrivateKeyForm:{privateKey:"",pass:"",checkPass:""},loginByPrivateKeyRules:{privateKey:[{validator:(e,t,a)=>{if(!t)return a(new Error(this.$t("loginByPrivateKey.callback-1")));64!==t.length?66==t.length&&"0x"==t.substr(0,2)?a():a(new Error(this.$t("loginByPrivateKey.callback-2"))):a()},trigger:"blur"}],pass:[{validator:(e,t,a)=>{""===t?a(new Error(this.$t("loginByPrivateKey.callback-3"))):(""!==this.loginByPrivateKeyForm.checkPass&&this.$refs.loginByPrivateKeyForm.validateField("checkPass"),a())},trigger:"blur"}],checkPass:[{validator:(e,t,a)=>{""===t?a(new Error(this.$t("loginByPrivateKey.callback-4"))):t!==this.loginByPrivateKeyForm.pass?a(new Error(this.$t("loginByPrivateKey.callback-5"))):a()},trigger:"blur"}]}}},components:{headBox:C.a},mounted(){this.$nextTick(function(){})},methods:{Login(){this.$refs.loginByPrivateKeyForm.validate(e=>{if(!e)return console.log("error submit!!"),!1;if("ETH"==this.$store.state.vuexStore.baseChain){let e;e=64==this.loginByPrivateKeyForm.privateKey.length?"0x":"";let t=web3.eth.accounts.encrypt(e+this.loginByPrivateKeyForm.privateKey,this.loginByPrivateKeyForm.pass);console.log(t);let a=web3.utils.toChecksumAddress(t.address);console.log(a),web3.utils.checkAddressChecksum(a)?(this.$store.state.vuexStore.walletInfo.keyStore=t,this.$store.state.vuexStore.walletInfo.address=a,this.$store.state.vuexStore.isLogin=!0,this.$notify({title:this.$t("loginByPrivateKey.callback-6"),dangerouslyUseHTMLString:!0,message:this.$t("loginByPrivateKey.callback-7"),duration:3e3,type:"success"}),this.$router.push("/setting/backup")):this.$notify.error({title:this.$t("loginByPrivateKey.callback-8"),dangerouslyUseHTMLString:!0,message:this.$t("loginByPrivateKey.callback-9"),duration:3e3}),this.loginByPrivateKeyForm.privateKey="",this.loginByPrivateKeyForm.pass="",this.loginByPrivateKeyForm.checkPass=""}else if("NEO"==this.$store.state.vuexStore.baseChain){let e=scrypt_module_factory(generateWalletFileBlob,{},{privateKey:this.loginByPrivateKeyForm.privateKey,password:this.loginByPrivateKeyForm.pass});console.log(e),34==e.accounts[0].address.length?(this.$store.state.vuexStore.NEOwalletInfo.keyStore=e,this.$store.state.vuexStore.NEOwalletInfo.publicKey=getPublicKeyEncoded(ab2hexstring(getPublicKey(this.loginByPrivateKeyForm.privateKey,0))),console.log(this.$store.state.vuexStore.NEOwalletInfo.keyStore),this.$store.state.vuexStore.NEOwalletInfo.address=e.accounts[0].address,this.$store.state.vuexStore.isLogin=!0,this.$notify({title:this.$t("loginByPrivateKey.callback-6"),dangerouslyUseHTMLString:!0,message:this.$t("loginByPrivateKey.callback-7"),duration:3e3,type:"success"}),this.$router.push("/setting/backup")):this.$notify.error({title:this.$t("loginByPrivateKey.callback-8"),dangerouslyUseHTMLString:!0,message:this.$t("loginByPrivateKey.callback-9"),duration:3e3}),this.loginByPrivateKeyForm.privateKey="",this.loginByPrivateKeyForm.pass="",this.loginByPrivateKeyForm.checkPass=""}})}}},X={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"loginByPrivateKeyForm"},[a("headBox"),e._v(" "),a("div",{staticClass:"contentBox"},[a("h2",{staticClass:"title_h2"},[e._v(e._s(e.$t("loginByPrivateKey.title")))]),e._v(" "),a("hr"),e._v(" "),a("el-form",{ref:"loginByPrivateKeyForm",staticClass:"demo-ruleForm",attrs:{model:e.loginByPrivateKeyForm,"status-icon":"",rules:e.loginByPrivateKeyRules,"label-position":"top","label-width":"80px"}},[a("el-form-item",{attrs:{label:e.$t("loginByPrivateKey.privateKey"),prop:"privateKey"}},[a("el-input",{model:{value:e.loginByPrivateKeyForm.privateKey,callback:function(t){e.$set(e.loginByPrivateKeyForm,"privateKey",t)},expression:"loginByPrivateKeyForm.privateKey"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("loginByPrivateKey.password"),prop:"pass"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.loginByPrivateKeyForm.pass,callback:function(t){e.$set(e.loginByPrivateKeyForm,"pass",t)},expression:"loginByPrivateKeyForm.pass"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("loginByPrivateKey.checkPass"),prop:"checkPass"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.loginByPrivateKeyForm.checkPass,callback:function(t){e.$set(e.loginByPrivateKeyForm,"checkPass",t)},expression:"loginByPrivateKeyForm.checkPass"}})],1),e._v(" "),a("div",{staticStyle:{"text-align":"center","margin-bottom":"22px"}},[a("el-button",{staticStyle:{width:"80%"},attrs:{type:"primary"},on:{click:function(t){e.Login()}}},[e._v(e._s(e.$t("loginByPrivateKey.import")))])],1)],1),e._v(" "),a("a",{staticClass:"backToStartBtn",on:{click:function(t){e.$parent.$parent.backToStart()}}},[e._v(e._s(e.$t("loginByPrivateKey.backToStart")))])],1)],1)},staticRenderFns:[]};var J=a("VU/8")(W,X,!1,function(e){a("+K3l")},"data-v-70b9cf56",null).exports,G=a("s/ph"),Y={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"loginByKeyStoreForm"},[a("headBox"),e._v(" "),a("div",{staticClass:"contentBox loginByKeyStoreContentBox"},[a("h2",{staticClass:"title_h2"},[e._v(e._s(e.$t("loginByKeyStore.title")))]),e._v(" "),a("hr"),e._v(" "),a("el-form",{ref:"loginByKeyStoreForm",staticClass:"demo-ruleForm",attrs:{"status-icon":"","label-position":"top","label-width":"80px"}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{"on-change":e.handleChange,"file-list":e.fileList,accept:".json","auto-upload":!1,limit:1,action:"/"}},[a("el-button",{attrs:{slot:"trigger"},slot:"trigger"},[e._v(e._s(e.$t("loginByKeyStore.chooseKeyStore")))])],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("loginByKeyStore.password"),prop:"keyStorePass"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.keyStorePass,callback:function(t){e.keyStorePass=t},expression:"keyStorePass"}})],1),e._v(" "),a("div",{staticStyle:{"text-align":"center","margin-bottom":"22px"}},[a("el-button",{staticStyle:{width:"80%"},attrs:{type:"primary"},on:{click:function(t){e.login()}}},[e._v(e._s(e.$t("loginByKeyStore.import")))])],1)],1),e._v(" "),a("a",{staticClass:"backToStartBtn",on:{click:function(t){e.$parent.$parent.backToStart()}}},[e._v(e._s(e.$t("loginByPrivateKey.backToStart")))])],1)],1)},staticRenderFns:[]};var V=function(e){a("X7GO")},j=a("VU/8")(G.a,Y,!1,V,"data-v-df95104a",null).exports,Q={name:"assetForm",data(){return{buttonBoxData:[{name:this.$t("asset.receive"),icon:"el-icon-ETH-shoukuan",link:"receive1"},{name:this.$t("asset.send"),icon:"el-icon-ETH-fukuan",link:"transfer"}],isRecordInfoShow:!1,activeData:{Amount:"",assetType:"",blockHash:"",date:"",isOnChannel:"",isPay:"",isTestNet:"",name:"",state:"",transactionHash:""}}},computed:{assetType(){return this.$store.state.vuexStore.activeAssetInfo.assetType},balanceData(){return this.$store.state.vuexStore.balanceData},recordData(){return this.$store.state.vuexStore.recordList}},filters:{formatAddress:function(e){var t="";return e&&(t=e.replace(/(.{5}).*(.{5})/,"$1......$2")),t},formatIsOnChannel:function(e){return e?"Channel":"Chain"},formatState:function(e){let t;switch(e){case-1:t="Fail";break;case 0:t="Pending";break;case 1:t="Success"}return t},formatIsPay:function(e){return e?"-":"+"},formatDateTime:function(e){var t=new Date(e),a=t.getFullYear(),s=t.getMonth()+1;s=s<10?"0"+s:s;var o=t.getDate();return a+"-"+s+"-"+(o=o<10?"0"+o:o)+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()}},mounted(){this.$nextTick(function(){})},methods:{toOtherForm(e){this.$router.push("/chain/"+e)},formatRecordList(e){let t=this,a=[];var s;console.log(e.length),e.length>0&&e.forEach(function(e,s){0==e.isOnChannel&&e.assetType==t.assetType&&a.push(e)});for(var o=0;o<a.length;o++)for(var n=o;n<a.length;n++)a[o].date<a[n].date&&(s=a[n],a[n]=a[o],a[o]=s);return console.log(a),a},showRecordInfo(e){console.log(e),this.activeData=e,this.isRecordInfoShow=!0},back(){this.isRecordInfoShow?this.isRecordInfoShow=!1:this.$router.go(-1)}}},Z={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"assetForm"},[a("div",{staticClass:"headBox"},[a("div",{staticClass:"header-button is-left"},[a("i",{staticClass:"el-icon-ETH-fanhui",on:{click:function(t){e.back()}}})]),e._v(" "),a("h1",[e._v(e._s(e.assetType))]),e._v(" "),a("div",{staticClass:"header-button is-right"})]),e._v(" "),a("div",{staticStyle:{position:"relative",height:"calc(100% - 56px)"}},[a("div",{staticClass:"assetBox"},[a("div",{staticClass:"amountBox"},[a("h3",[e._v(e._s(e.balanceData.Chain[e.assetType]))])]),e._v(" "),a("div",{staticClass:"buttonBox"},[a("el-row",{attrs:{gutter:20}},e._l(e.buttonBoxData,function(t,s){return a("el-col",{key:s,attrs:{span:12}},[a("a",{staticClass:"button-item",on:{click:function(a){e.toOtherForm(t.link)}}},[a("i",{class:t.icon}),e._v(" "),a("p",[e._v(e._s(t.name))])])])}))],1)]),e._v(" "),a("div",{staticClass:"contentBox"},[a("h2",{staticClass:"title_h2",staticStyle:{margin:"0 30px"}},[e._v(e._s(e.$t("record.title")))]),e._v(" "),a("hr",{staticStyle:{"margin-bottom":"0"}}),e._v(" "),e.formatRecordList(e.recordData).length?a("div",{staticStyle:{"overflow-x":"hidden",height:"100%"}},[a("ul",e._l(e.formatRecordList(e.recordData),function(t,s){return a("li",{key:s,on:{click:function(a){e.showRecordInfo(t,s)}}},[a("h4",[e._v(e._s(e._f("formatIsOnChannel")(t.isOnChannel))+" - "+e._s(e._f("formatAddress")(t.name))+"\n                          "),a("span",{staticStyle:{float:"right"}},[e._v(e._s(e._f("formatIsPay")(t.isPay))+e._s(t.Amount/1e8)+e._s(t.assetType))])]),e._v(" "),a("p",[e._v(e._s(e._f("formatDateTime")(t.date))),a("span",{staticStyle:{float:"right"}},[e._v("State："+e._s(e._f("formatState")(t.state)))])])])}))]):a("p",{staticStyle:{margin:"30% 0 0","text-align":"center"}},[e._v(e._s(e.$t("record.noRecord")))])]),e._v(" "),e.isRecordInfoShow?a("div",{staticClass:"assetInfo"},[a("h2",{staticClass:"title_h2"},[e._v(e._s(e.$t("record.recordInfo")))]),e._v(" "),a("hr",{staticStyle:{margin:"8px 0 0 0"}}),e._v(" "),a("h1",[e._v(e._s(e._f("formatIsPay")(e.activeData.isPay))+e._s(e.activeData.Amount/1e8)+e._s(e.activeData.assetType))]),e._v(" "),a("p",[e._v(e._s(e.$t("record.state"))+": "+e._s(e._f("formatState")(e.activeData.state)))]),e._v(" "),a("p",[e._v(e._s(e.$t("record.otherUri"))+": "+e._s(e.activeData.name))]),e._v(" "),a("p",[e._v(e._s(e.$t("record.date"))+": "+e._s(e._f("formatDateTime")(e.activeData.date)))]),e._v(" "),a("p",[e._v(e._s(e.$t("record.amount"))+": "+e._s(e.activeData.Amount/1e8)+e._s(e.activeData.assetType))]),e._v(" "),a("p",[e._v(e._s(e.$t("record.isOnChannel"))+": "+e._s(e._f("formatIsOnChannel")(e.activeData.isOnChannel)))]),e._v(" "),a("p",[e._v(e._s(e.$t("record.transactionHash"))+": "+e._s(e.activeData.transactionHash))]),e._v(" "),a("p",[e._v(e._s(e.$t("record.blockHash"))+": "+e._s(e.activeData.blockHash))]),e._v(" "),a("div",{staticStyle:{"text-align":"center",margin:"15% 0"}},[a("el-button",{staticStyle:{width:"80%"},on:{click:function(t){e.isRecordInfoShow=!1}}},[e._v(" "+e._s(e.$t("record.close"))+" ")])],1)]):e._e()])])},staticRenderFns:[]};var z=a("VU/8")(Q,Z,!1,function(e){a("T/b+")},"data-v-4657e1df",null).exports;s.default.use(I.a);var q={name:"receiveForm",data:()=>({paymentCodeForm:{amount:"",assetType:"",assetContractAddress:"",selfUri:"",R:"",Hr:"",Code:""},paymentCodeRules:{amount:[{validator:(e,t,a)=>{if(!t)return a(new Error("金额不能为空"));t<0?a(new Error("请输入正确的数字值")):a()},trigger:"blur"}],assetType:[{validator:(e,t,a)=>{""===t?a(new Error("请选择资产类型")):a()},trigger:"change"}]},isPaymentCodeBoxShow:!1}),components:{headBox:C.a},watch:{},mounted(){this.$nextTick(function(){})},computed:{walletInfo(){return"ETH"==this.$store.state.vuexStore.baseChain?this.$store.state.vuexStore.walletInfo:"NEO"==this.$store.state.vuexStore.baseChain?this.$store.state.vuexStore.NEOwalletInfo:void 0}},methods:{copyfun(){let e=this;clipboard&&clipboard.destroy(),clipboard=new ClipboardJS(".btncopy"),clipboard.on("success",function(t){e.$notify.info({title:"消息",dangerouslyUseHTMLString:!0,message:"复制成功",duration:3e3})}),clipboard.on("error",function(t){e.$notify.info({title:"警告",dangerouslyUseHTMLString:!0,message:"复制失败，请自行复制",duration:3e3,type:"warning"})})}}},ee={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"receiveForm"},[a("headBox"),e._v(" "),a("div",{staticClass:"contentBox"},[a("h2",{staticClass:"title_h2"},[e._v(e._s(e.$t("receive.title")))]),e._v(" "),a("hr"),e._v(" "),a("div",{staticClass:"QRCodeBox QRCodeBox-white"},[a("qriously",{attrs:{value:e.walletInfo.address,level:"H",size:210}}),e._v(" "),a("p",[e._v(e._s(e.$t("receive.receiveAddressQRCode")))])],1),e._v(" "),a("hr"),e._v(" "),a("p",[e._v(e._s(e.$t("receive.receiveAddress")))]),e._v(" "),a("h3",{attrs:{id:"receiveAddress"}},[e._v(e._s(e.walletInfo.address))]),e._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{staticClass:"btncopy",attrs:{"data-clipboard-target":"#receiveAddress",type:"primary"},on:{click:function(t){e.copyfun()}}},[e._v(e._s(e.$t("receive.copy")))])],1)])],1)},staticRenderFns:[]};var te=a("VU/8")(q,ee,!1,function(e){a("05Aw")},"data-v-75f5b7a6",null).exports,ae={name:"transferOnChainForm",data(){return{txOnChainInfo:{address:"",assetType:"",amount:"",gasPrice:1,keyStorePass:""},contact:"",txOnChainRules:{address:[{validator:(e,t,a)=>{if(!t)return a(new Error(this.$t("index.callback-1")));"ETH"==this.$store.state.vuexStore.baseChain?42!==t.length?a(new Error(this.$t("index.callback-2"))):a():"NEO"==this.$store.state.vuexStore.baseChain&&(34!==t.length?a(new Error(this.$t("index.callback-2"))):a())},trigger:"blur"}],amount:[{validator:(e,t,a)=>{if(!t)return a(new Error(this.$t("index.callback-3")));isNaN(t)?a(new Error(this.$t("index.callback-4"))):t<0?a(new Error(this.$t("index.callback-5"))):t>this.balanceData.Chain[this.assetType]?a(new Error("转账金额不能大于余额")):a()},trigger:"blur"}],gasPrice:[{validator:(e,t,a)=>{if("ETH"==this.assetType){if(this.Gwei2ETH(t)+this.txOnChainInfo.amount>=this.balanceData.Chain.ETH)return a(new Error("转账金额加矿工费不能大于余额"));a()}else if("TNC"==this.assetType){if(this.Gwei2ETH(t)>=this.balanceData.Chain.ETH)return a(new Error("转账金额加矿工费不能大于余额"));a()}},trigger:"change"}],keyStorePass:[{validator:(e,t,a)=>{if(!t)return a(new Error(this.$t("index.callback-7")));{let e;"ETH"==this.$store.state.vuexStore.baseChain?e=this.$parent.$parent.verifyPassword(this.$store.state.vuexStore.walletInfo.keyStore,t):"NEO"==this.$store.state.vuexStore.baseChain&&(e=scrypt_module_factory(DecryptWalletByPassword,{},{WalletScript:this.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].key,password:t,address:this.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].address})),setTimeout(()=>{if(!e)return a(new Error(this.$t("index.callback-8")));a()},1e3)}},trigger:"blur"}]}}},components:{headBox:C.a},computed:{assetType(){return this.$store.state.vuexStore.activeAssetInfo.assetType},balanceData(){return this.$store.state.vuexStore.balanceData}},filters:{},watch:{},mounted(){this.$nextTick(function(){let e=this;web3.eth.getGasPrice().then(function(t){e.txOnChainInfo.gasPrice=Number(t).div(1e9)})})},methods:{contactChange(){this.txOnChainInfo.address=this.contact},formatTooltip:e=>e+" Gwei",Gwei2ETH(e){let t,a=this;return e?(t=e.mul(22e3).div(1e9),t=a.$parent.$parent.keepDecimalPlaces(t,7)):t="error",t},txOnChain(){let e=this;e.$refs.txOnChainInfo.validate(t=>{if(!t)return console.log("error submit!!"),!1;"ETH"==e.$store.state.vuexStore.baseChain?"ETH"==e.assetType?e.txEthOnChain():e.txTncOnChain():"NEO"==e.$store.state.vuexStore.baseChain&&e.NEOtxOnChain()})},txEthOnChain(){let e=this,t=e.$parent.$parent.decryptPrivateKey(e.$store.state.vuexStore.walletInfo.keyStore,e.txOnChainInfo.keyStorePass);web3.eth.getTransactionCount(e.$store.state.vuexStore.walletInfo.address,web3.eth.defaultBlock.pending).then(function(a){console.log(a);var s={nonce:web3.utils.toHex(a++),gasLimit:web3.utils.toHex(22e3),gasPrice:web3.utils.toHex(e.$store.state.vuexStore.gasPrice),to:e.txOnChainInfo.address,from:e.$store.state.vuexStore.walletInfo.address,value:web3.utils.toHex(e.txOnChainInfo.amount.mul(1e18)),data:""};console.log(s);let o=signData(s,t.privateKey);console.log(o);let n=(new Date).getTime();web3.eth.sendSignedTransaction("0x"+o,function(t,a){if(t)console.log(t);else{console.log(a),e.$notify({title:e.$t("common.success"),dangerouslyUseHTMLString:!0,message:e.$t("common.callback-14"),duration:3e3,type:"success"});let t={date:n,name:e.txOnChainInfo.address,Amount:e.txOnChainInfo.amount.mul(1e8),assetType:"ETH",isOnChannel:!1,isPay:!0,state:0,isTestNet:e.$store.state.vuexStore.isTestNet,transactionHash:a,blockHash:""};e.$store.state.vuexStore.recordList.push(t),e.$parent.$parent.StoreData("recordList"),e.$parent.$parent.cycleGetTransactionReceipt(a),e.clearTxData(),e.$router.go(-1)}})})},async txTncOnChain(){let e=[this.txOnChainInfo.address,this.txOnChainInfo.amount.mul(1e8)],t=await this.$parent.$parent.signDataForERC20Contract(this.$store.state.vuexStore.tncContractAddress,"transfer",["address","uint256"],e,this.txOnChainInfo.keyStorePass,this.txOnChainInfo.gasPrice.mul(1e9));console.log(t),this.sendSignedTransaction(t)},sendSignedTransaction(e){let t=this,a=(new Date).getTime();web3.eth.sendSignedTransaction("0x"+e,function(e,s){if(e)t.$notify({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-25")+e,duration:3e3,type:"error"}),t.$router.go(-1);else{console.log(s),t.$notify({title:t.$t("common.success"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-14"),duration:3e3,type:"success"});let e={date:a,name:t.txOnChainInfo.address,Amount:t.txOnChainInfo.amount.mul(1e8),assetType:"TNC",isOnChannel:!1,isPay:!0,state:0,isTestNet:t.$store.state.vuexStore.isTestNet,transactionHash:s,blockHash:""};console.log(t.txOnChainInfo.address),console.log(e),t.$store.state.vuexStore.recordList.push(e),t.$parent.$parent.StoreData("recordList"),t.$parent.$parent.cycleGetTransactionReceipt(s),t.$router.go(-1)}})},NEOtxOnChain(){let e=this;console.log(e.assetType);let t=e.$parent.$parent.AssetTypeToAssetId(e.assetType);console.log(t),axios({method:"post",url:e.$store.state.vuexStore.NodeRpcUri,headers:{"Content-Type":"application/json;charset=UTF-8"},data:JSON.stringify({jsonrpc:"2.0",method:"constructTx",params:[e.$store.state.vuexStore.NEOwalletInfo.address,e.txOnChainInfo.address,e.txOnChainInfo.amount,t],id:1})}).then(function(t){if(console.log(t.data),t.data.error)e.$notify({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("common.callback-25"),duration:3e3,type:"warning"}),e.$router.go(-1),e.clearTxData();else{let a,s=t.data.result.txData;try{a=scrypt_module_factory(DecryptWalletByPassword,{},{WalletScript:e.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].key,password:e.txOnChainInfo.keyStorePass,address:e.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].address})}catch(t){return e.$notify.error({title:e.$t("loginByKeyStore.callback-9"),dangerouslyUseHTMLString:!0,message:e.$t("loginByKeyStore.callback-8"),duration:3e3}),!1}console.log(a);let o=signatureData(s,a);console.log(o),console.log(e.$store.state.vuexStore.NEOwalletInfo.publicKey);let n=s+t.data.result.witness.replace("{signature}",o).replace("{pubkey}",e.$store.state.vuexStore.NEOwalletInfo.publicKey);axios({method:"post",url:e.$store.state.vuexStore.NodeRpcUri,headers:{"Content-Type":"application/json;charset=UTF-8"},data:JSON.stringify({jsonrpc:"2.0",method:"sendRawTx",params:[n],id:1})}).then(function(a){if(console.log(a),1==a.data.result){e.$notify({title:e.$t("common.success"),dangerouslyUseHTMLString:!0,message:e.$t("common.callback-14"),duration:3e3,type:"success"});let a={date:(new Date).getTime(),name:e.txOnChainInfo.address,Amount:e.txOnChainInfo.amount.mul(1e8),assetType:"TNC",isOnChannel:!1,isPay:!0,state:1,isTestNet:e.$store.state.vuexStore.isTestNet,transactionHash:t.data.result.txid,blockHash:""};console.log(e.txOnChainInfo.address),console.log(a),e.$store.state.vuexStore.recordList.push(a),e.$parent.$parent.StoreData("recordList"),e.$router.go(-1),e.clearTxData()}else e.$notify({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("common.callback-25"),duration:3e3,type:"warning"}),e.$router.go(-1),e.clearTxData()})}})},clearTxData(){this.txOnChainInfo={address:"",assetType:"",amount:"",keyStorePass:""},this.contact=""}}},se={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"transferOnChainForm"},[a("headBox"),e._v(" "),a("div",{staticClass:"contentBox"},[a("h2",{staticClass:"title_h2"},[e._v(e._s(e.$t("transferOnChian.title1"))+e._s(e.assetType)+e._s(e.$t("transferOnChian.title2")))]),e._v(" "),a("hr"),e._v(" "),a("div",{staticClass:"buttonBox clearfloat"},[a("router-link",{staticClass:"button-item",attrs:{to:"/channel/createPayment"}},[a("i",{staticClass:"el-icon-ETH-lianxiren"}),e._v(" "),a("p",[e._v(e._s(e.$t("setting.contact")))])]),e._v(" "),a("a",{staticClass:"button-item"},[a("i",{staticClass:"el-icon-ETH-saoyisao"}),e._v(" "),a("p",[e._v(e._s(e.$t("common.scan")))])])],1),e._v(" "),a("el-form",{ref:"txOnChainInfo",staticClass:"demo-ruleForm",attrs:{model:e.txOnChainInfo,"status-icon":"",rules:e.txOnChainRules}},[a("el-form-item",{attrs:{prop:"address"}},[a("el-input",{attrs:{placeholder:e.$t("transferOnChian.address"),"auto-complete":"off"},model:{value:e.txOnChainInfo.address,callback:function(t){e.$set(e.txOnChainInfo,"address",t)},expression:"txOnChainInfo.address"}})],1),e._v(" "),a("label",{staticStyle:{"font-size":"14px","line-height":"28px"},attrs:{for:""}},[e._v(e._s(e.$t("transferOnChian.amount"))+": ")]),e._v(" "),a("span",{staticStyle:{"font-size":"14px","line-height":"28px",float:"right"}},[e._v(e._s(e.$t("transferOnChian.balance"))+": "+e._s(e.balanceData.Chain[e.assetType])+e._s(e.assetType))]),e._v(" "),a("el-form-item",{attrs:{prop:"amount"}},[a("el-input",{attrs:{placeholder:e.$t("transferOnChian.amount"),"auto-complete":"off"},model:{value:e.txOnChainInfo.amount,callback:function(t){e.$set(e.txOnChainInfo,"amount",e._n("string"==typeof t?t.trim():t))},expression:"txOnChainInfo.amount"}})],1),e._v(" "),"ETH"==e.$store.state.vuexStore.baseChain?[a("span",[e._v(e._s(e.$t("transferOnChian.miningFee"))+": ")]),e._v(" "),a("span",{staticStyle:{float:"right"}},[e._v(" ≈ "+e._s(e.Gwei2ETH(e.txOnChainInfo.gasPrice))+" ETH")]),e._v(" "),a("el-form-item",{attrs:{prop:"gasPrice"}},[a("el-slider",{attrs:{min:1,max:100,step:.1,"format-tooltip":e.formatTooltip},model:{value:e.txOnChainInfo.gasPrice,callback:function(t){e.$set(e.txOnChainInfo,"gasPrice",t)},expression:"txOnChainInfo.gasPrice"}})],1)]:e._e(),e._v(" "),"NEO"==e.$store.state.vuexStore.baseChain?a("span",[e._v("密码: ")]):e._e(),e._v(" "),a("el-form-item",{attrs:{prop:"keyStorePass"}},[a("el-input",{attrs:{type:"password",placeholder:e.$t("index.password"),"auto-complete":"off"},model:{value:e.txOnChainInfo.keyStorePass,callback:function(t){e.$set(e.txOnChainInfo,"keyStorePass",t)},expression:"txOnChainInfo.keyStorePass"}})],1)],2),e._v(" "),a("div",{staticStyle:{"text-align":"center","margin-top":"10%"}},[a("el-button",{staticClass:"transferBtn",attrs:{type:"primary"},on:{click:function(t){e.txOnChain()}}},[e._v(e._s(e.$t("index.transfer")))])],1)],1)],1)},staticRenderFns:[]};var oe=a("VU/8")(ae,se,!1,function(e){a("2b8D")},"data-v-20a44ef6",null).exports,ne={name:"addChannelForm",data(){return{addChannelForm:{uri:"",assetType:"",selfDeposit:0,otherDeposit:0,alice:"",channelName:"",selfSignedData:"",txData:"",keyStorePass:""},addChannelRules:{uri:[{validator:(e,t,a)=>{let s=this;if(!t)return a(new Error(s.$t("addChannel.callback-1")));t.indexOf("@")<=-1||t.indexOf(":")<=-1?a(new Error(s.$t("addChannel.callback-2"))):("ETH"==s.$store.state.vuexStore.baseChain?42!==t.split("@")[0].length&&a(new Error(s.$t("addChannel.callback-2"))):"NEO"==s.$store.state.vuexStore.baseChain&&66!==t.split("@")[0].length&&a(new Error(s.$t("addChannel.callback-2"))),s.$store.state.vuexStore.channelList.forEach(function(e,t){e.OtherUri===s.addChannelForm.uri&&a(new Error(s.$t("addChannel.callback-3")))}),a())},trigger:"blur"}],assetType:[{validator:(e,t,a)=>{""===t?a(new Error(this.$t("index.inputAssetType"))):a()},trigger:"change"}],selfDeposit:[{validator:(e,t,a)=>{if(""===t)a(new Error(this.$t("addChannel.callback-4")));else if(t<=0)a(new Error(this.$t("addChannel.callback-5")));else if(t>this.$store.state.vuexStore.balanceData.Chain[this.addChannelForm.assetType])a(new Error(this.$t("addChannel.callback-6")));else if(String(t).indexOf(".")>-1){let e=String(t).indexOf(".")+1;String(t).length-e>8?a(new Error(this.$t("addChannel.callback-7"))):a()}else a()},trigger:"blur"}],otherDeposit:[{validator:(e,t,a)=>{""===t?a(new Error(this.$t("addChannel.callback-8"))):t<=0?a(new Error(this.$t("addChannel.callback-9"))):a()},trigger:"change"}],alice:[{validator:(e,t,a)=>{""===t?a(new Error(_this.$t("addChannel.callback-10"))):a()},trigger:"blur"}],keyStorePass:[{validator:(e,t,a)=>{if(!t)return a(new Error(this.$t("common.callback-1")));{let e;"ETH"==this.$store.state.vuexStore.baseChain?e=this.$parent.$parent.verifyPassword(this.$store.state.vuexStore.walletInfo.keyStore,t):"NEO"==this.$store.state.vuexStore.baseChain&&(e=scrypt_module_factory(DecryptWalletByPassword,{},{WalletScript:this.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].key,password:t,address:this.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].address})),setTimeout(()=>{if(!e)return a(new Error(_this.$t("common.callback-2")));a()},1e3)}},trigger:"blur"}]}}},components:{headBox:C.a},methods:{addChannel(){let e=this;e.$refs.addChannelForm.validate(t=>{if(!t)return console.log("error submit!!"),!1;if("ETH"==e.$store.state.vuexStore.baseChain){let t=e.$parent.$parent.uri2Ip(e.addChannelForm.uri,e.$store.state.vuexStore.spvPort);const n="ws://"+t+"/";var a=e.$store.state.vuexStore.channelList.length;console.log(a);let r=e.$store.state.vuexStore.walletInfo.address+"@"+t,i=e.addChannelForm.uri.split("@")[0],l=(new Date).getTime(),c=md5encode(e.addChannelForm.uri,l),d=md5encode(r,l);e.addChannelForm.channelName="0x"+c+d,console.log(e.addChannelForm.channelName);var s={websock:new WebSocket(n)};console.log(s),e.$store.state.vuexStore.channelList.push(s),e.$store.state.vuexStore.channelList[a].websock.onmessage=e.$parent.$parent.websocketOnmessage,e.$store.state.vuexStore.channelList[a].websock.onclose=e.$parent.$parent.websocketClose;let h=web3.utils.soliditySha3({t:"bytes32",v:e.addChannelForm.channelName},{t:"uint256",v:1},{t:"address",v:e.$store.state.vuexStore.walletInfo.address},{t:"uint256",v:e.addChannelForm.selfDeposit.mul(1e8)},{t:"address",v:i},{t:"uint256",v:e.addChannelForm.otherDeposit.mul(1e8)});console.log(h),e.addChannelForm.txData=h;let u=e.$parent.$parent.decryptPrivateKey(e.$store.state.vuexStore.walletInfo.keyStore,e.addChannelForm.keyStorePass),m=ecSign(h,u.privateKey);console.log(m),e.addChannelForm.selfSignedData=m;var o={MessageType:"Founder",Sender:r,Receiver:e.addChannelForm.uri,TxNonce:1,ChannelName:e.addChannelForm.channelName,NetMagic:e.$store.state.vuexStore.NetMagic,AssetType:e.addChannelForm.assetType,MessageBody:{FounderDeposit:e.addChannelForm.selfDeposit.mul(1e8),PartnerDeposit:e.addChannelForm.otherDeposit.mul(1e8),Commitment:e.addChannelForm.selfSignedData}};setTimeout(function(){e.$store.state.vuexStore.channelList[a].websock.send(JSON.stringify(o))},2e3),e.$store.state.vuexStore.addChannelInfo=e.addChannelForm,console.log(e.$store.state.vuexStore.addChannelInfo),e.$store.state.vuexStore.channelList[a].ChannelName=e.addChannelForm.channelName,e.$store.state.vuexStore.channelList[a].Alice=e.addChannelForm.alice,e.$store.state.vuexStore.channelList[a].State=2,e.$store.state.vuexStore.channelList[a].isConnect=!0,e.$store.state.vuexStore.channelList[a].SelfBalance=e.addChannelForm.selfDeposit.mul(1e8),e.$store.state.vuexStore.channelList[a].OtherBalance=e.addChannelForm.otherDeposit.mul(1e8),e.$store.state.vuexStore.channelList[a].assetType=e.addChannelForm.assetType,e.$store.state.vuexStore.channelList[a].isTestNet=e.$store.state.vuexStore.isTestNet,e.$store.state.vuexStore.channelList[a].SelfUri=r,e.$store.state.vuexStore.channelList[a].OtherUri=e.addChannelForm.uri,e.$store.state.vuexStore.channelList[a].TxNonce=1,e.$store.state.vuexStore.channelList[a].date=l,e.$store.state.vuexStore.channelList[a].Ip=e.$parent.$parent.uri2Ip(e.addChannelForm.uri,null),e.$parent.$parent.StoreData("channelList"),e.$router.push("/channel/channelList")}else if("NEO"==e.$store.state.vuexStore.baseChain){let t=e.$parent.$parent.uri2Ip(e.addChannelForm.uri,e.$store.state.vuexStore.spvPort);const n="ws://"+t+"/";a=e.$store.state.vuexStore.channelList.length;console.log(a);let r=e.$store.state.vuexStore.NEOwalletInfo.publicKey+"@"+t,i=(e.addChannelForm.uri.split("@")[0],(new Date).getTime());e.addChannelForm.channelName=md5encode(e.addChannelForm.uri,i),console.log(e.addChannelForm.channelName);s={websock:new WebSocket(n)};console.log(s),e.$store.state.vuexStore.channelList.push(s),e.$store.state.vuexStore.channelList[a].websock.onmessage=e.$parent.$parent.websocketOnmessage,e.$store.state.vuexStore.channelList[a].websock.onclose=e.$parent.$parent.websocketClose;o={MessageType:"RegisterChannel",Sender:r,Receiver:e.addChannelForm.uri,ChannelName:e.addChannelForm.channelName,Magic:e.$store.state.vuexStore.NetMagic,MessageBody:{AssetType:e.addChannelForm.assetType,Deposit:parseFloat(e.addChannelForm.selfDeposit)}};setTimeout(function(){e.$store.state.vuexStore.channelList[a].websock.send(JSON.stringify(o))},2e3),e.$store.state.vuexStore.addChannelInfo=e.addChannelForm,console.log(e.$store.state.vuexStore.addChannelInfo),e.$store.state.vuexStore.channelList[a].ChannelName=e.addChannelForm.channelName,e.$store.state.vuexStore.channelList[a].Alice=e.addChannelForm.alice,e.$store.state.vuexStore.channelList[a].State=2,e.$store.state.vuexStore.channelList[a].isConnect=!0,e.$store.state.vuexStore.channelList[a].SelfBalance=e.addChannelForm.selfDeposit.mul(1e8),e.$store.state.vuexStore.channelList[a].OtherBalance=e.addChannelForm.selfDeposit.mul(1e8),e.$store.state.vuexStore.channelList[a].assetType=e.addChannelForm.assetType,e.$store.state.vuexStore.channelList[a].isTestNet=e.$store.state.vuexStore.isTestNet,e.$store.state.vuexStore.channelList[a].SelfUri=r,e.$store.state.vuexStore.channelList[a].OtherUri=e.addChannelForm.uri,e.$store.state.vuexStore.channelList[a].TxNonce=0,e.$store.state.vuexStore.channelList[a].date=i,e.$store.state.vuexStore.channelList[a].Ip=e.$parent.$parent.uri2Ip(e.addChannelForm.uri,null),e.$store.state.vuexStore.channelList[a].blockNumber=0,e.$parent.$parent.StoreData("channelList"),e.$router.push("/channel/channelList")}})},CreateFounder(){},removeAddChannelData(){this.$refs.addChannelForm.resetFields(),this.$router.push("/channel/channelList")}}},re={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"addChannelBox"},[a("headBox"),e._v(" "),a("div",{staticClass:"contentBox"},[a("div",[e.addChannelForm.assetType?a("p",{staticStyle:{float:"right",margin:"5px 30px 5px 0","font-size":"16px"}},[e._v(e._s(e.$t("addChannel.assetBalance"))+"："+e._s(e.$store.state.vuexStore.balanceData.Chain[e.addChannelForm.assetType])+e._s(e.addChannelForm.assetType))]):e._e(),e._v(" "),a("h2",{staticClass:"title_h2",staticStyle:{margin:"0 30px"}},[e._v(e._s(e.$t("addChannel.title")))])]),e._v(" "),a("hr",{staticStyle:{height:"2px",border:"none","border-top":"2px dotted #EBEEF5",margin:"6px 30px"}}),e._v(" "),a("div",{staticClass:"formBox"},[a("el-form",{ref:"addChannelForm",staticClass:"addChannelForm",attrs:{model:e.addChannelForm,"status-icon":"",rules:e.addChannelRules,"label-position":"top"}},[a("el-form-item",{attrs:{label:e.$t("addChannel.otherUri"),prop:"uri"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:e.$t("addChannel.otherUriPlaceHolder")},model:{value:e.addChannelForm.uri,callback:function(t){e.$set(e.addChannelForm,"uri",t)},expression:"addChannelForm.uri"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("addChannel.assetType"),prop:"assetType"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("addChannel.chooseAssetType")},model:{value:e.addChannelForm.assetType,callback:function(t){e.$set(e.addChannelForm,"assetType",t)},expression:"addChannelForm.assetType"}},["ETH"==e.$store.state.vuexStore.baseChain?[a("el-option",{attrs:{label:"TNC",value:"TNC"}}),e._v(" "),a("el-option",{attrs:{label:"ETH",value:"ETH",disabled:""}})]:e._e(),e._v(" "),"NEO"==e.$store.state.vuexStore.baseChain?[a("el-option",{attrs:{label:"TNC",value:"TNC"}}),e._v(" "),a("el-option",{attrs:{label:"NEO",value:"NEO"}}),e._v(" "),a("el-option",{attrs:{label:"GAS",value:"GAS"}})]:e._e()],2)],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("addChannel.selfDeposit"),prop:"selfDeposit"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addChannelForm.selfDeposit,callback:function(t){e.$set(e.addChannelForm,"selfDeposit",e._n(t))},expression:"addChannelForm.selfDeposit"}})],1),e._v(" "),"ETH"==e.$store.state.vuexStore.baseChain?a("el-form-item",{attrs:{label:e.$t("addChannel.otherDeposit"),prop:"otherDeposit"}},[a("el-slider",{attrs:{"show-input-controls":!1,max:e.addChannelForm.selfDeposit,step:1e-5,"show-input":""},model:{value:e.addChannelForm.otherDeposit,callback:function(t){e.$set(e.addChannelForm,"otherDeposit",t)},expression:"addChannelForm.otherDeposit"}})],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:e.$t("addChannel.alice"),prop:"alice"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addChannelForm.alice,callback:function(t){e.$set(e.addChannelForm,"alice",t)},expression:"addChannelForm.alice"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("addChannel.password"),prop:"keyStorePass"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.addChannelForm.keyStorePass,callback:function(t){e.$set(e.addChannelForm,"keyStorePass",t)},expression:"addChannelForm.keyStorePass"}})],1),e._v(" "),a("div",{staticStyle:{"text-align":"center","margin-bottom":"10%"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addChannel()}}},[e._v(e._s(e.$t("addChannel.addChannel")))]),e._v(" "),a("el-button",{on:{click:function(t){e.removeAddChannelData()}}},[e._v(e._s(e.$t("addChannel.cancel")))])],1)],1)],1)])],1)},staticRenderFns:[]};var ie=a("VU/8")(ne,re,!1,function(e){a("5vSx")},"data-v-b3d81872",null).exports,le=a("TXMN"),ce={name:"channelListForm",data:()=>({buttonBoxData:[{name:"收 款",icon:"el-icon-ETH-shoukuan",link:"/channel/createPayment"},{name:"付 款",icon:"el-icon-ETH-fukuan",link:"/channel/payment"},{name:"添 加",icon:"el-icon-plus",link:"/channel/addChannel"}]}),components:{headBox:C.a},computed:{channelList(){return this.$store.state.vuexStore.channelList}},filters:{formatStatus:function(e){let t;switch(e){case 1:t="Closing";break;case 2:t="Opening";break;case 3:t="Open";break;default:t="Error"}return t},formatBalance:function(e){let t;return t=e<0||isNaN(e)?"error":Number(e).div(1e8)},formatDateTime:function(e){let t=new Date;t.setTime(e);let a=t.getFullYear(),s=t.getMonth()+1;s=s<10?"0"+s:s;let o=t.getDate();return a+"-"+s+"-"+(o=o<10?"0"+o:o)},formatConnect:function(e){let t;return t=e?"True":"False"},formatNet:function(e){let t;return t=e?"TestNet":"MainNet"}},mounted(){this.$nextTick(function(){})},watch:{"$store.state.vuexStore.walletInfo.channelList":"getAddressInfo"},methods:{toChannelAssetForm(e,t){console.log(e),e.ChannelName&&(this.$router.push("/channel/channelAsset"),this.$store.state.vuexStore.activeAssetInfo.channelName=e.ChannelName)},formatChannelList(e){let t=this,a=[];return e.forEach(function(e,s){e.isTestNet==t.$store.state.vuexStore.isTestNet&&a.push(e)}),a}}},de={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"channelListForm",class:{fullPage:!e.$store.state.vuexStore.isNavShow}},[a("headBox"),e._v(" "),a("div",{staticClass:"contentBox"},[a("div",[a("h2",{staticClass:"title_h2"},[e._v(e._s(e.$t("channelList.title")))])]),e._v(" "),a("hr",{staticStyle:{margin:"8px 0 0 0"}}),e._v(" "),a("div",{staticClass:"buttonBox"},[a("el-row",{attrs:{gutter:20}},e._l(e.buttonBoxData,function(t,s){return a("el-col",{key:s,attrs:{span:8}},[a("router-link",{staticClass:"button-item",attrs:{to:t.link}},[a("i",{class:t.icon}),e._v(" "),a("p",[e._v(e._s(t.name))])])],1)}))],1),e._v(" "),e.formatChannelList(e.channelList).length?a("div",{staticStyle:{"overflow-x":"hidden",height:"calc(100% - 220px)"}},[a("ul",{staticClass:"listUl"},e._l(e.formatChannelList(e.channelList),function(t,s){return a("li",{key:s,on:{click:function(a){e.toChannelAssetForm(t,s)}}},[a("h3",[e._v(e._s(t.Alice))]),a("br"),e._v(" "),a("p",[e._v(e._s(e._f("formatDateTime")(t.date)))]),e._v(" "),t.isConnect?a("p",{staticStyle:{"min-width":"180px"}},[e._v("State："+e._s(e._f("formatStatus")(t.State)))]):e._e(),e._v(" "),t.isConnect?e._e():a("p",{staticStyle:{"min-width":"180px"}},[e._v("State：NotConnect")]),e._v(" "),a("span",[e._v(e._s(e._f("formatBalance")(t.SelfBalance))),a("sup",[e._v(e._s(t.assetType))])])])}))]):e._e(),e._v(" "),e.formatChannelList(e.channelList).length?e._e():a("p",{staticStyle:{"text-align":"center","margin-top":"20vh","font-size":"14px",color:"#5e6d82","line-height":"1.5em","font-weight":"400"}},[e._v("\n          "+e._s(e.$t("channelList.noChannel"))+"\n      ")])])],1)},staticRenderFns:[]};var he=a("VU/8")(ce,de,!1,function(e){a("rb7I")},"data-v-ffd3edc0",null).exports,ue={name:"assetForm",data:()=>({isRecordInfoShow:!1,activeData:{Amount:"",assetType:"",blockHash:"",date:"",isOnChannel:"",isPay:"",isTestNet:"",name:"",state:"",transactionHash:""}}),computed:{channelName(){return this.$store.state.vuexStore.activeAssetInfo.channelName},Data(){let e=this,t={};return e.$store.state.vuexStore.activeAssetInfo.channelName&&e.$store.state.vuexStore.channelList.forEach(function(a,s){a.ChannelName==e.$store.state.vuexStore.activeAssetInfo.channelName&&(t=a)}),t},recordData(){return this.$store.state.vuexStore.recordList}},filters:{formatAddress:function(e){var t="";return e&&(t=e.replace(/(.{5}).*(.{5})/,"$1......$2")),t},formatBalance:function(e){let t;return t=e<0||isNaN(e)?"error":Number(e).div(1e8)},formatState:function(e){let t;switch(e){case-1:t="Fail";break;case 0:t="Pending";break;case 1:t="Success"}return t},formatIsPay:function(e){return e?"-":"+"},formatDateTime:function(e){var t=new Date(e),a=t.getFullYear(),s=t.getMonth()+1;s=s<10?"0"+s:s;var o=t.getDate();return a+"-"+s+"-"+(o=o<10?"0"+o:o)+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()}},mounted(){this.$nextTick(function(){})},methods:{toOtherForm(e){this.$router.push("/channel/"+e)},formatRecordList(e){let t=this,a=[];var s;console.log(e),console.log(e.length),e.length>0&&e.forEach(function(e,s){1==e.isOnChannel&&e.assetType==t.Data.assetType&&a.push(e)});for(var o=0;o<a.length;o++)for(var n=o;n<a.length;n++)a[o].date<a[n].date&&(s=a[n],a[n]=a[o],a[o]=s);return console.log(a),a},showChannelInfo(){console.log(this.Data),this.$router.push({name:"channelInfo",params:{Data:this.Data}})},showRecordInfo(e){console.log(e),this.activeData=e,this.isRecordInfoShow=!0},back(){this.isRecordInfoShow?this.isRecordInfoShow=!1:this.$router.go(-1)}}},me={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"assetForm"},[a("div",{staticClass:"headBox"},[a("div",{staticClass:"header-button is-left"},[a("i",{staticClass:"el-icon-ETH-fanhui",on:{click:function(t){e.back()}}})]),e._v(" "),a("h1",[e._v("通道 - "+e._s(e.Data.Alice))]),e._v(" "),a("div",{staticClass:"header-button is-right"})]),e._v(" "),a("div",{staticStyle:{position:"relative",height:"calc(100% - 56px)"}},[a("div",{staticClass:"assetBox"},[a("div",{staticClass:"amountBox"},[a("h3",[e._v(e._s(e._f("formatBalance")(e.Data.SelfBalance))+e._s(e.Data.assetType))])]),e._v(" "),a("div",{staticClass:"buttonBox"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("router-link",{staticClass:"button-item",attrs:{to:"/channel/createPayment"}},[a("i",{staticClass:"el-icon-ETH-shoukuan"}),e._v(" "),a("p",[e._v("收款")])])],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("router-link",{staticClass:"button-item",attrs:{to:"/channel/payment"}},[a("i",{staticClass:"el-icon-ETH-fukuan"}),e._v(" "),a("p",[e._v("付款")])])],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("a",{staticClass:"button-item",on:{click:function(t){e.showChannelInfo()}}},[a("i",{staticClass:"el-icon-ETH-xiangqing"}),e._v(" "),a("p",[e._v("详情")])])])],1)],1)]),e._v(" "),a("div",{staticClass:"contentBox"},[a("h2",{staticClass:"title_h2",staticStyle:{margin:"0 30px"}},[e._v("交易记录")]),e._v(" "),a("hr",{staticStyle:{"margin-bottom":"0"}}),e._v(" "),e.formatRecordList(e.recordData).length?a("div",{staticStyle:{"overflow-x":"hidden",height:"100%"}},[a("ul",{staticClass:"listUl"},e._l(e.formatRecordList(e.recordData),function(t,s){return a("li",{key:s,on:{click:function(a){e.showRecordInfo(t,s)}}},[a("h4",[e._v(e._s(t.isOnChannel)+" - "+e._s(e._f("formatAddress")(t.name))+"\n                          "),a("span",{staticStyle:{float:"right"}},[e._v(e._s(e._f("formatIsPay")(t.isPay))+e._s(t.Amount/1e8)+e._s(t.assetType))])]),e._v(" "),a("p",[e._v(e._s(e._f("formatDateTime")(t.date))),a("span",{staticStyle:{float:"right"}},[e._v("State："+e._s(e._f("formatState")(t.state)))])])])}))]):a("p",{staticStyle:{margin:"30% 0 0","text-align":"center"}},[e._v("没有交易记录")])]),e._v(" "),e.isRecordInfoShow?a("div",{staticClass:"channelAssetInfo"},[a("h2",{staticClass:"title_h2"},[e._v("交易详情")]),e._v(" "),a("hr",{staticStyle:{margin:"8px 0 0 0"}}),e._v(" "),a("h1",[e._v(e._s(e._f("formatIsPay")(e.activeData.isPay))+e._s(e.activeData.Amount/1e8)+e._s(e.activeData.assetType))]),e._v(" "),a("p",[e._v(e._s(e.$t("record.state"))+": "+e._s(e._f("formatState")(e.activeData.state)))]),e._v(" "),a("p",[e._v(e._s(e.$t("record.otherUri"))+": "+e._s(e.activeData.name))]),e._v(" "),a("p",[e._v(e._s(e.$t("record.date"))+": "+e._s(e._f("formatDateTime")(e.activeData.date)))]),e._v(" "),a("p",[e._v(e._s(e.$t("record.amount"))+": "+e._s(e.activeData.Amount/1e8)+e._s(e.activeData.assetType))]),e._v(" "),a("p",[e._v(e._s(e.$t("record.isOnChannel"))+": "+e._s(e._f("formatIsOnChannel")(e.activeData.isOnChannel)))]),e._v(" "),a("p",[e._v(e._s(e.$t("record.transactionHash"))+": "+e._s(e.activeData.transactionHash))]),e._v(" "),a("p",[e._v(e._s(e.$t("record.blockHash"))+": "+e._s(e.activeData.blockHash))]),e._v(" "),a("div",{staticStyle:{"text-align":"center",margin:"15%"}},[a("el-button",{staticStyle:{width:"80%"},on:{click:function(t){e.isRecordInfoShow=!1}}},[e._v(" "+e._s(e.$t("record.close"))+" ")])],1)]):e._e()])])},staticRenderFns:[]};var fe=a("VU/8")(ue,me,!1,function(e){a("Jh4N")},"data-v-7cff97f9",null).exports,ve={name:"channelInfoForm",data(){return{isConfirmCloseChannel:!1,channelInfo:{keyStorePass:""},confirmCloseRules:{keyStorePass:[{validator:(e,t,a)=>{if(!t)return a(new Error("钱包密码不能为空，否则将无法交易"));{let e;"ETH"==this.$store.state.vuexStore.baseChain?e=this.$parent.$parent.verifyPassword(this.$store.state.vuexStore.walletInfo.keyStore,t):"NEO"==this.$store.state.vuexStore.baseChain&&(e=scrypt_module_factory(DecryptWalletByPassword,{},{WalletScript:this.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].key,password:t,address:this.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].address})),setTimeout(()=>{if(!e)return a(new Error(this.$t("index.callback-8")));a()},1e3)}},trigger:"blur"}]}}},computed:{Data(){if(this.$route.params.Data)return this.$route.params.Data;return{Alice:"",ChannelName:"",date:"",SelfUri:"",SelfBalance:"",OtherUri:"",OtherBalance:"",State:"",isConnect:"",isTestNet:""}}},mounted(){this.$nextTick(function(){console.log(this.$route.params.Data),this.$route.params.Data||this.$router.push("/start")})},watch:{},filters:{formatStatus:function(e){let t;switch(e){case 1:t="Closing";break;case 2:t="Opening";break;case 3:t="Open";break;default:t="Error"}return t},formatDateTime:function(e){let t=new Date;t.setTime(e);let a=t.getFullYear(),s=t.getMonth()+1;s=s<10?"0"+s:s;let o=t.getDate();return a+"-"+s+"-"+(o=o<10?"0"+o:o)},formatBalance:function(e){let t;return t=e<0||isNaN(e)?"error":e/1e8},formatConnect:function(e){let t;return t=e?"True":"False"},formatNet:function(e){let t;return t=e?"TestNet":"MainNet"}},methods:{reconnectWebsocket(){this.$parent.$parent.reconnectWebsocket(this.Data.Ip+":8866",this.Data.ChannelName)},closeChannel(){let e=this;e.$refs.channelInfo.validate(t=>{if(!t)return console.log("error submit!!"),!1;{let t=e.$parent.$parent.getChannelSerial("ChannelName",e.Data.ChannelName);if(console.log(t),t>=0)if(console.log(e.$store.state.vuexStore.channelList[t].isConnect),void 0==e.$store.state.vuexStore.channelList[t].transactionHash)e.$store.state.vuexStore.channelList.splice(t,1),e.channelInfo.keyStorePass="",e.$router.push("/channel/channelList");else if("ETH"==e.$store.state.vuexStore.baseChain){let a=web3.utils.soliditySha3({t:"bytes32",v:e.Data.ChannelName},{t:"uint256",v:0},{t:"address",v:e.$store.state.vuexStore.walletInfo.address},{t:"uint256",v:e.Data.SelfBalance},{t:"address",v:e.Data.OtherUri.split("@")[0]},{t:"uint256",v:e.Data.OtherBalance});console.log(a);let s=e.$parent.$parent.decryptPrivateKey(e.$store.state.vuexStore.walletInfo.keyStore,e.channelInfo.keyStorePass),o=ecSign(a,s.privateKey);console.log(o);let n={MessageType:"Settle",Sender:e.Data.SelfUri,Receiver:e.Data.OtherUri,TxNonce:0,ChannelName:e.Data.ChannelName,AssetType:e.Data.assetType,NetMagic:e.$store.state.vuexStore.NetMagic,MessageBody:{Commitment:o,SenderBalance:e.Data.SelfBalance,ReceiverBalance:e.Data.OtherBalance},Comments:{}};e.$store.state.vuexStore.channelList[t].websock.send(JSON.stringify(n)),e.$store.state.vuexStore.closeChannelInfo=e.Data,e.$store.state.vuexStore.closeChannelInfo.txData=a,e.$store.state.vuexStore.closeChannelInfo.keyStorePass=e.channelInfo.keyStorePass,console.log(e.$store.state.vuexStore.closeChannelInfo.txData),e.$store.state.vuexStore.closeChannelInfo.selfSignedData=o,e.$store.state.vuexStore.channelList[t].State=1,setTimeout(()=>{e.$router.push("/channel/channelList")},1e3)}else if("NEO"==e.$store.state.vuexStore.baseChain){let a,s,o,n;try{a=scrypt_module_factory(DecryptWalletByPassword,{},{WalletScript:e.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].key,password:e.channelInfo.keyStorePass,address:e.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].address})}catch(t){return e.$notify.error({title:e.$t("loginByKeyStore.callback-9"),dangerouslyUseHTMLString:!0,message:e.$t("loginByKeyStore.callback-8"),duration:3e3}),!1}console.log(a),e.$store.state.vuexStore.txList.forEach(function(t,a){t.channelName==e.Data.ChannelName&&(s=t.history[1].addressFunding,o=t.history[1].scriptFunding,n=t.history[1].txId)}),console.log(s),console.log(o),console.log(n),axios({method:"post",url:e.$store.state.vuexStore.NodeRpcUri,headers:{"Content-Type":"application/json;charset=UTF-8"},data:JSON.stringify({jsonrpc:"2.0",method:"RefoundTrans",params:[s,Number(e.Data.SelfBalance).div(1e8),Number(e.Data.OtherBalance).div(1e8),e.Data.SelfUri.split("@")[0],e.Data.OtherUri.split("@")[0],o,e.Data.assetType],id:1})}).then(function(s){console.log(s);let o={};o[e.Data.SelfUri.split("@")[0]]={},o[e.Data.OtherUri.split("@")[0]]={},o[e.Data.SelfUri.split("@")[0]].TNC=Number(e.Data.SelfBalance).div(1e8),o[e.Data.OtherUri.split("@")[0]].TNC=Number(e.Data.OtherBalance).div(1e8);let n=s.data.result.Settlement;console.log(n);let r=signatureData(n.txData,a);e.$store.state.vuexStore.closeChannelInfo.txData=n.txData,e.$store.state.vuexStore.closeChannelInfo.selfSignedData=r,e.$store.state.vuexStore.closeChannelInfo.witness=n.witness,e.$store.state.vuexStore.closeChannelInfo.keyStorePass=e.channelInfo.keyStorePass,console.log(e.$store.state.vuexStore.closeChannelInfo);let i={MessageType:"Settle",Sender:e.Data.SelfUri,Receiver:e.Data.OtherUri,TxNonce:e.Data.TxNonce,ChannelName:e.Data.ChannelName,MessageBody:{Settlement:n,Balance:o}};e.$store.state.vuexStore.channelList[t].websock.send(JSON.stringify(i)),setTimeout(()=>{e.$router.push("/channel/channelList")},1e3)})}}})},forcedCloseChannel(){this.$refs.channelInfo.validate(e=>{if(e){let e=this.$parent.$parent.getChannelSerial("ChannelName",this.Data.ChannelName);console.log(e),e>=0&&(console.log("\b进入强制拆通道"),this.forcedCloseChannelFun())}})},async forcedCloseChannelFun(){let e,t,a,s,o=this;o.$store.state.vuexStore.txList.forEach(function(n,r){console.log(n.channelName==o.Data.ChannelName),console.log(n.history[n.history.length-1].founderSignedData),console.log(n.history[n.history.length-1].peerSignedData),n.channelName==o.Data.ChannelName&&n.history[n.history.length-1].founderSignedData&&n.history[n.history.length-1].peerSignedData&&(console.log(n.history[n.history.length-1].founder),console.log(o.$store.state.vuexStore.walletInfo.address),n.history[n.history.length-1].founder==o.$store.state.vuexStore.walletInfo.address?(console.log("本端为founder"),e=n.history[n.history.length-1].founderSignedData,t=n.history[n.history.length-1].peerSignedData):(console.log("对端为founder"),t=n.history[n.history.length-1].founderSignedData,e=n.history[n.history.length-1].peerSignedData),a=n.history[n.history.length-1].HashR,s=n.history[n.history.length-1].R)});let n=[o.Data.ChannelName,o.Data.TxNonce,o.$store.state.vuexStore.walletInfo.address,o.Data.SelfBalance,o.Data.OtherUri.split("@")[0],o.Data.OtherBalance,a?"0x"+a:"0x"+addPreZero(0,64),s?"0x"+s:"0x"+addPreZero(0,64),e,t],r=await o.$parent.$parent.signDataForERC20Contract(o.$store.state.vuexStore.trinityContractAddress,"closeChannel",["bytes32","uint256","address","uint256","address","uint256","bytes32","bytes32","bytes","bytes"],n,o.channelInfo.keyStorePass);console.log(r);(new Date).getTime();web3.eth.sendSignedTransaction("0x"+r).on("transactionHash",function(e){console.log(e),o.$notify({title:"成功",dangerouslyUseHTMLString:!0,message:"上链成功，请交易确认",duration:3e3,type:"success"});let t=o.$parent.$parent.getChannelSerial("ChannelName",o.Data.ChannelName),a=o.$store.state.vuexStore.channelList[t];a.State=1,le.a.set(o.$store.state.vuexStore.channelList,t,a),console.log(o.$store.state.vuexStore.channelList[t]),o.$parent.$parent.StoreData("channelList"),o.$router.push("/channel/channelList"),o.$parent.$parent.cycleGetTransactionReceipt(e)}).on("receipt",console.log).on("error",function(e){console.log(e)})}}},ge={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"channelInfoForm"},[a("div",{staticClass:"headBox"},[a("div",{staticClass:"header-button is-left"},[a("i",{staticClass:"el-icon-ETH-fanhui",on:{click:function(t){e.$router.go(-1)}}})]),e._v(" "),a("h1"),e._v(" "),a("div",{staticClass:"header-button is-right",staticStyle:{"text-align":"right"}},[e.isConfirmCloseChannel?a("p",{on:{click:function(t){e.forcedCloseChannel()}}},[e._v("强制关闭")]):e._e()])]),e._v(" "),a("div",{staticClass:"contentBox"},[a("h2",{staticClass:"title_h2"},[e._v(e._s(e.Data.Alice)+" - 通道信息")]),e._v(" "),a("hr"),e._v(" "),a("p",[e._v(e._s(e.$t("channelList.channelName"))+"："+e._s(e.Data.ChannelName))]),e._v(" "),a("p",[e._v(e._s(e.$t("channelList.date"))+"："+e._s(e._f("formatDateTime")(e.Data.date)))]),e._v(" "),a("p",[e._v(e._s(e.$t("channelList.selfUri"))+"："+e._s(e.Data.SelfUri))]),e._v(" "),a("p",[e._v(e._s(e.$t("channelList.selfBalance"))+"："+e._s(e._f("formatBalance")(e.Data.SelfBalance))+e._s(e.Data.assetType))]),e._v(" "),a("p",[e._v(e._s(e.$t("channelList.otherUri"))+"："+e._s(e.Data.OtherUri))]),e._v(" "),a("p",[e._v(e._s(e.$t("channelList.otherBalance"))+"："+e._s(e._f("formatBalance")(e.Data.OtherBalance))+e._s(e.Data.assetType))]),e._v(" "),a("p",[e._v(e._s(e.$t("channelList.channelState"))+"："+e._s(e._f("formatStatus")(e.Data.State)))]),e._v(" "),a("p",[e._v(e._s(e.$t("channelList.isConnect"))+"："+e._s(e._f("formatConnect")(e.Data.isConnect))),e.Data.isConnect?e._e():a("a",{staticStyle:{color:"#F56C6C","margin-left":"10px",cursor:"pointer"},on:{click:function(t){e.reconnectWebsocket()}}},[e._v("Reconnect")])]),e._v(" "),a("hr",{staticStyle:{height:"2px",border:"none","border-top":"2px dotted #EBEEF5"}}),e._v(" "),e.isConfirmCloseChannel?a("div",{staticClass:"closeBox"},[a("el-form",{ref:"channelInfo",staticClass:"demo-ruleForm",attrs:{model:e.channelInfo,"status-icon":"",rules:e.confirmCloseRules}},[a("p",{staticStyle:{"text-align":"left",color:"#F56C6C"}},[e._v("是否确认关闭通道?")]),e._v(" "),a("el-form-item",{attrs:{prop:"keyStorePass"}},[a("el-input",{attrs:{placeholder:e.$t("channelList.inputPassword"),type:"password","auto-complete":"off"},model:{value:e.channelInfo.keyStorePass,callback:function(t){e.$set(e.channelInfo,"keyStorePass",t)},expression:"channelInfo.keyStorePass"}})],1),e._v(" "),a("el-form-item",{staticStyle:{"text-align":"center","margin-left":"-80px"}}),e._v(" "),a("el-form-item",{staticClass:"buttonBox"},[a("div",{staticClass:"button-item",on:{click:function(t){e.closeChannel()}}},[a("i",{staticClass:"el-icon-ETH-zhengque1"}),e._v(" "),a("p",[e._v("确认")])]),e._v(" "),a("div",{staticClass:"button-item",on:{click:function(t){e.isConfirmCloseChannel=!1}}},[a("i",{staticClass:"el-icon-ETH-fanhui1"}),e._v(" "),a("p",[e._v("返回")])])])],1)],1):a("div",{staticClass:"closeBox"},[a("div",{staticClass:"buttonBox"},[a("div",{staticStyle:{height:"88px",width:"100%"}}),e._v(" "),a("div",{staticClass:"button-item",on:{click:function(t){e.isConfirmCloseChannel=!0}}},[a("i",{staticClass:"el-icon-ETH-icon_wrong"}),e._v(" "),a("p",[e._v("关闭通道")])]),e._v(" "),a("div",{staticClass:"button-item",on:{click:function(t){e.$router.go(-1)}}},[a("i",{staticClass:"el-icon-ETH-fanhui1"}),e._v(" "),a("p",[e._v("返回")])])])])])])},staticRenderFns:[]};var pe=a("VU/8")(ve,ge,!1,function(e){a("27kK")},"data-v-ab5dcd4a",null).exports,ye={name:"paymentBox",data(){return{paymentCode:"",txOnChannelInfo:{sendUri:"",receiverUri:"",netMagic:"",hr:"",assetType:"",value:0,fee:0,description:"",ChannelName:"",keyStorePass:""},txOnChannelRules:{keyStorePass:[{validator:(e,t,a)=>{if(!t)return a(new Error(this.$t("index.callback-7")));{let e;"ETH"==this.$store.state.vuexStore.baseChain?e=this.$parent.$parent.verifyPassword(this.$store.state.vuexStore.walletInfo.keyStore,t):"NEO"==this.$store.state.vuexStore.baseChain&&(e=scrypt_module_factory(DecryptWalletByPassword,{},{WalletScript:this.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].key,password:t,address:this.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].address})),setTimeout(()=>{if(!e)return a(new Error(this.$t("index.callback-8")));a()},1e3)}},trigger:"blur"}]},ShowTxOnChannelBox:!1}},components:{headBox:C.a},computed:{baseChain(){return this.$store.state.vuexStore.baseChain},txList(){return this.$store.state.vuexStore.txList},walletInfo(){return"ETH"==this.$store.state.vuexStore.baseChain?this.$store.state.vuexStore.walletInfo:"NEO"==this.$store.state.vuexStore.baseChain?this.$store.state.vuexStore.NEOwalletInfo:void 0}},filters:{formatAddress:function(e){return e.replace(/(.{10}).*(.{10})/,"$1......$2")}},mounted(){this.$nextTick(function(){this.$route.params.address&&(this.paymentCode=this.$route.params.address)})},watch:{},methods:{decryptPaymentCode(){let e=this;if(""!=e.paymentCode.length){if("TN"!=e.paymentCode.substr(0,2))return 42===e.paymentCode.length?e.paymentCode===e.$store.state.vuexStore.walletInfo.address?void e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-10"),duration:3e3}):void console.log("进入链上转账"):void e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-11"),duration:3e3});{let t;console.log("进入通道交易");try{t=base58decode(e.paymentCode.substring(2)).toString()}catch(t){return e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-11")+"1",duration:3e3}),!1}if(console.log(t),!(t.indexOf("&")>-1))return e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-11"),duration:3e3}),!1;{let a=t.split("&");if("ETH"==e.baseChain){if(e.txOnChannelInfo.receiverUri=a[0],e.txOnChannelInfo.netMagic=a[1],e.txOnChannelInfo.hr=a[2],e.txOnChannelInfo.assetType=a[3],e.txOnChannelInfo.value=a[4],e.txOnChannelInfo.description=a[5],console.log(e.txOnChannelInfo),e.txOnChannelInfo.netMagic!=e.$store.state.vuexStore.NetMagic)return void e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-12"),duration:3e3});if(!web3.utils.isAddress(e.txOnChannelInfo.receiverUri.split("@")[0]))return void e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-11")+"2",duration:3e3});if(""==e.txOnChannelInfo.hr)return void e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-11")+"3",duration:3e3});if(""==e.txOnChannelInfo.assetType)return void e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-11")+"4",duration:3e3});if(0==e.txOnChannelInfo.value)return void e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-11")+"5",duration:3e3});if(e.$store.state.vuexStore.walletInfo.address===e.txOnChannelInfo.receiverUri.split("@")[0])return void e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-10"),duration:3e3});e.ShowTxOnChannelBox=!0}else if("NEO"==e.baseChain){if(e.txOnChannelInfo.receiverUri=a[0],e.txOnChannelInfo.hr=a[1],e.txOnChannelInfo.assetType=e.$parent.$parent.AssetIdToAssetType(a[2]),e.txOnChannelInfo.value=Number(a[3]).mul(1e8),e.txOnChannelInfo.description=a[4],console.log(e.txOnChannelInfo),66!==e.txOnChannelInfo.receiverUri.split("@")[0].length)return void e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-11")+"2",duration:3e3});if(""==e.txOnChannelInfo.hr)return void e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-11")+"3",duration:3e3});if(""==e.txOnChannelInfo.assetType)return void e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-11")+"4",duration:3e3});if(0==e.txOnChannelInfo.value)return void e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-11")+"5",duration:3e3});if(e.$store.state.vuexStore.NEOwalletInfo.publicKey==e.txOnChannelInfo.receiverUri.split("@")[0])return void e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-10"),duration:3e3});e.ShowTxOnChannelBox=!0}}}}else e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-9"),duration:3e3})},confirmTx(){let e=this;e.$refs.txOnChannelInfo.validate(t=>{if(!t)return console.log("error submit!!"),!1;"ETH"==e.$store.state.vuexStore.baseChain?"ETH"==e.txOnChannelInfo.assetType?e.txEthOnChannel():"TNC"==e.txOnChannelInfo.assetType&&e.txTncOnChannel():"NEO"==e.$store.state.vuexStore.baseChain&&e.txTncOnChannel()})},txEthOnChannel(){console.log("进入通道交易ETH")},txTncOnChannel(){let e=this;if(console.log("进入通道交易"),"ETH"==e.$store.state.vuexStore.baseChain){let t=e.$parent.$parent.getChannelSerial("OtherUri",e.txOnChannelInfo.receiverUri,"open",!1);if(t>=0)if(e.$store.state.vuexStore.channelList[t].SelfBalance>=e.txOnChannelInfo.value){e.txOnChannelInfo.sendUri=e.$store.state.vuexStore.channelList[t].SelfUri,e.txOnChannelInfo.ChannelName=e.$store.state.vuexStore.channelList[t].ChannelName,console.log(t);let a={MessageType:"Rsmc",Sender:e.txOnChannelInfo.sendUri,Receiver:e.txOnChannelInfo.receiverUri,TxNonce:e.$store.state.vuexStore.channelList[t].TxNonce+1,ChannelName:e.$store.state.vuexStore.channelList[t].ChannelName,NetMagic:e.$store.state.vuexStore.NetMagic,AssetType:e.txOnChannelInfo.assetType,MessageBody:{PaymentCount:e.txOnChannelInfo.value,SenderBalance:Number(e.$store.state.vuexStore.channelList[t].SelfBalance)-Number(e.txOnChannelInfo.value),ReceiverBalance:Number(e.$store.state.vuexStore.channelList[t].OtherBalance)+Number(e.txOnChannelInfo.value),Commitment:"",RoleIndex:0},Comments:{}};e.$store.state.vuexStore.txOnChannelInfo=e.txOnChannelInfo,console.log(e.$store.state.vuexStore.txOnChannelInfo),e.$store.state.vuexStore.channelList[t].websock.send(JSON.stringify(a)),e.ShowTxOnChannelBox=!1,e.clearTxData()}else e.$notify.error({title:e.$t("common.info"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-14"),duration:3e3}),e.ShowTxOnChannelBox=!1,e.clearTxData();else{if(-1!=t)return-2==t?(e.ShowTxOnChannelBox=!1,void e.clearTxData()):void 0;{let t=-1;e.$store.state.vuexStore.channelList.forEach(function(e,a){3!=e.State||1!=e.isConnect||(t=a)});let a=[];if(e.$store.state.vuexStore.channelList.forEach(function(e,t){3==e.State&&1==e.isConnect&&a.push(e.OtherUri)}),console.log(a),t<0)return e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("common.callback-14"),duration:3e3}),e.ShowTxOnChannelBox=!1,e.clearTxData(),!1;{console.log(t),e.txOnChannelInfo.sendUri=e.$store.state.vuexStore.channelList[t].SelfUri,e.txOnChannelInfo.ChannelName=e.$store.state.vuexStore.channelList[t].ChannelName;let s={MessageType:"GetRouterInfo",Sender:e.txOnChannelInfo.sendUri,Receiver:e.txOnChannelInfo.receiverUri,NetMagic:e.$store.state.vuexStore.NetMagic,AssetType:e.txOnChannelInfo.assetType,MessageBody:{NodeList:a}};e.$store.state.vuexStore.txOnChannelInfo=e.txOnChannelInfo,console.log(e.$store.state.vuexStore.txOnChannelInfo),e.$store.state.vuexStore.channelList[t].websock.send(JSON.stringify(s)),e.ShowTxOnChannelBox=!1,e.clearTxData()}}}}else if("NEO"==e.$store.state.vuexStore.baseChain){console.log("NEO通道交易");let t=e.$parent.$parent.getChannelSerial("OtherUri",e.txOnChannelInfo.receiverUri,"open",!1);if(t>=0)if(console.log(e.txOnChannelInfo.value),e.$store.state.vuexStore.channelList[t].SelfBalance>=e.txOnChannelInfo.value){let a,s,o;e.txOnChannelInfo.sendUri=e.$store.state.vuexStore.channelList[t].SelfUri,e.txOnChannelInfo.ChannelName=e.$store.state.vuexStore.channelList[t].ChannelName,console.log(t),e.txList.forEach(function(t,n){t.channelName==e.txOnChannelInfo.ChannelName&&(a=t.history[1].addressFunding,s=t.history[1].scriptFunding,o=t.history[1].txId)}),console.log(a),console.log(s),console.log(o);let n=(Number(e.$store.state.vuexStore.channelList[t].OtherBalance)-Number(e.txOnChannelInfo.value)).div(1e8),r=(Number(e.$store.state.vuexStore.channelList[t].OtherBalance)+Number(e.txOnChannelInfo.value)).div(1e8);axios({method:"post",url:e.$store.state.vuexStore.NodeRpcUri,headers:{"Content-Type":"application/json;charset=UTF-8"},data:JSON.stringify({jsonrpc:"2.0",method:"FunderTransaction",params:[e.txOnChannelInfo.receiverUri.split("@")[0],e.walletInfo.publicKey,a,s,n,r,o,e.txOnChannelInfo.assetType],id:1})}).then(function(a){console.log(a),a.data.error&&(e.$notify.error({title:"构造交易出错",dangerouslyUseHTMLString:!0,message:e.$t("index.callback-14"),duration:3e3}),e.ShowTxOnChannelBox=!1,e.clearTxData());let s={MessageType:"Rsmc",Sender:e.txOnChannelInfo.sendUri,Receiver:e.txOnChannelInfo.receiverUri,TxNonce:e.$store.state.vuexStore.channelList[t].TxNonce+1,ChannelName:e.$store.state.vuexStore.channelList[t].ChannelName,MessageBody:{Commitment:a.data.result.C_TX,RevocableDelivery:a.data.result.R_TX,AssetType:e.txOnChannelInfo.assetType,Value:Number(e.txOnChannelInfo.value).div(1e8),RoleIndex:0,Comments:e.txOnChannelInfo.hr}};console.log(JSON.stringify(s)),e.txOnChannelInfo.BreachRemedy=a.data.result.BR_TX,e.$store.state.vuexStore.txOnChannelInfo=e.txOnChannelInfo,console.log(e.$store.state.vuexStore.txOnChannelInfo),e.$store.state.vuexStore.channelList[t].websock.send(JSON.stringify(s)),e.ShowTxOnChannelBox=!1,e.clearTxData()})}else e.$notify.error({title:e.$t("common.info"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-14"),duration:3e3}),e.ShowTxOnChannelBox=!1,e.clearTxData();else if(-1==t){console.log("H交易");let t=-1;e.$store.state.vuexStore.channelList.forEach(function(e,a){3!=e.State||1!=e.isConnect||(t=a)});let a=[];if(e.$store.state.vuexStore.channelList.forEach(function(e,t){3==e.State&&1==e.isConnect&&a.push(e.OtherUri)}),console.log(a),t<0)return e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("common.callback-14"),duration:3e3}),e.ShowTxOnChannelBox=!1,e.clearTxData(),!1;{console.log(t),e.txOnChannelInfo.sendUri=e.$store.state.vuexStore.channelList[t].SelfUri,e.txOnChannelInfo.ChannelName=e.$store.state.vuexStore.channelList[t].ChannelName;let s={MessageType:"GetRouterInfo",Sender:e.txOnChannelInfo.sendUri,Receiver:e.txOnChannelInfo.receiverUri,Magic:e.$store.state.vuexStore.NetMagic,MessageBody:{NodeList:a,AssetType:e.txOnChannelInfo.assetType}};e.$store.state.vuexStore.txOnChannelInfo=e.txOnChannelInfo,console.log(e.$store.state.vuexStore.txOnChannelInfo),e.$store.state.vuexStore.channelList[t].websock.send(JSON.stringify(s)),e.ShowTxOnChannelBox=!1,e.clearTxData()}}else console.log("l错误")}},clearTxData(){this.txOnChannelInfo={sendUri:"",receiverUri:"",hr:"",assetType:"",value:0,fee:0,description:"",ChannelName:"",keyStorePass:""},this.paymentCode=""}}},Se={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"paymentBox"},[a("headBox"),e._v(" "),a("div",{staticClass:"contentBox"},[a("h2",{staticClass:"title_h2"},[e._v(e._s(e.$t("index.title")))]),e._v(" "),a("hr"),e._v(" "),a("div",{staticClass:"buttonBox clearfloat"},[a("router-link",{staticClass:"button-item",attrs:{to:"/channel/createPayment"}},[a("i",{staticClass:"el-icon-ETH-shoukuan"}),e._v(" "),a("p",[e._v("收款")])]),e._v(" "),e._m(0)],1),e._v(" "),a("el-form",{ref:"form",staticClass:"indexForm"},[a("label",{staticStyle:{"line-height":"28px","font-size":"16px"}},[e._v(e._s(e.$t("index.paymentCode"))+":")]),e._v(" "),a("el-form-item",{staticStyle:{"margin-top":"10px"}},[a("el-input",{attrs:{type:"textarea",rows:"3"},model:{value:e.paymentCode,callback:function(t){e.paymentCode="string"==typeof t?t.trim():t},expression:"paymentCode"}})],1),e._v(" "),a("el-form-item",{staticStyle:{"text-align":"center"}},[a("el-button",{staticClass:"transferBtn",attrs:{type:"primary"},on:{click:function(t){e.decryptPaymentCode()}}},[e._v(e._s(e.$t("index.transfer")))])],1)],1)],1),e._v(" "),a("el-dialog",{staticClass:"txOnChannelBox",attrs:{title:e.$t("index.transferOnChannel"),visible:e.ShowTxOnChannelBox,width:"30%",center:"","modal-append-to-body":!1},on:{"update:visible":function(t){e.ShowTxOnChannelBox=t}}},[a("span",[e._v(e._s(e.$t("index.transfer-1"))+e._s(e.txOnChannelInfo.receiverUri.split("@")[0]))]),e._v(" "),a("span",{staticStyle:{color:"#F56C6C","font-size":"16px"}},[e._v(e._s(e.$t("index.transfer-2"))+" "+e._s(e.txOnChannelInfo.value/1e8)+" "+e._s(e.txOnChannelInfo.assetType))]),e._v(" "),a("el-form",{ref:"txOnChannelInfo",staticClass:"demo-ruleForm",attrs:{model:e.txOnChannelInfo,"status-icon":"",rules:e.txOnChannelRules,"label-width":"90px"}},[a("el-form-item",{attrs:{label:e.$t("index.password"),prop:"keyStorePass"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.txOnChannelInfo.keyStorePass,callback:function(t){e.$set(e.txOnChannelInfo,"keyStorePass",t)},expression:"txOnChannelInfo.keyStorePass"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.confirmTx()}}},[e._v(e._s(e.$t("index.transfer")))]),e._v(" "),a("el-button",{on:{click:function(t){e.ShowTxOnChannelBox=!1}}},[e._v(e._s(e.$t("index.cancel")))])],1)],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("a",{staticClass:"button-item"},[t("i",{staticClass:"el-icon-ETH-saoyisao"}),this._v(" "),t("p",[this._v("扫一扫")])])}]};var xe=a("VU/8")(ye,Se,!1,function(e){a("R1OE")},"data-v-3551e0b4",null).exports,Ce={name:"descoverForm",data:()=>({paymentCodeForm:{amount:"",assetType:"",assetContractAddress:"",selfUri:"",R:"",Hr:"",Code:""},paymentCodeRules:{amount:[{validator:(e,t,a)=>{if(!t)return a(new Error("金额不能为空"));t<0?a(new Error("请输入正确的数字值")):a()},trigger:"blur"}],assetType:[{validator:(e,t,a)=>{""===t?a(new Error("请选择资产类型")):a()},trigger:"change"}]},isPaymentCodeBoxShow:!1}),filters:{},components:{headBox:C.a},methods:{copyfun(){let e=this;clipboard&&clipboard.destroy(),clipboard=new ClipboardJS(".btncopy"),clipboard.on("success",function(t){e.$notify.info({title:"消息",dangerouslyUseHTMLString:!0,message:"复制成功",duration:3e3})}),clipboard.on("error",function(t){e.$notify.info({title:"警告",dangerouslyUseHTMLString:!0,message:"复制失败，请自行复制",duration:3e3,type:"warning"})})},createPaymentCode(){let e=this;e.$refs.paymentCodeForm.validate(t=>{if(!t)return console.log("error submit!!"),!1;if("ETH"==e.$store.state.vuexStore.baseChain){if("TNC"==e.paymentCodeForm.assetType)e.paymentCodeForm.assetContractAddress=e.$store.state.vuexStore.tncContractAddress;else{if("ETH"!=e.paymentCodeForm.assetType)return e.$notify.info({title:"警告",dangerouslyUseHTMLString:!0,message:"资产类型出错",duration:3e3,type:"warning"}),!1;e.paymentCodeForm.assetContractAddress=""}if(e.paymentCodeForm.R=randomBytes(32),console.log(e.paymentCodeForm.R),e.paymentCodeForm.Hr=web3.utils.keccak256(e.paymentCodeForm.R),console.log(e.paymentCodeForm.Hr),e.$store.state.vuexStore.channelList.forEach(function(t,a){3==t.State&&t.assetType==e.paymentCodeForm.assetType&&(e.paymentCodeForm.selfUri=t.SelfUri)}),""==e.paymentCodeForm.selfUri)return e.$notify.info({title:"警告",dangerouslyUseHTMLString:!0,message:"没有该资产类型的通道",duration:3e3,type:"warning"}),!1;let t=e.paymentCodeForm.selfUri+"&"+e.$store.state.vuexStore.NetMagic+"&"+e.paymentCodeForm.Hr+"&"+e.paymentCodeForm.assetType+"&"+e.paymentCodeForm.amount.mul(1e8)+"&PaymentCode";console.log(t),e.paymentCodeForm.Code="TN"+base58encode(t),console.log(e.paymentCodeForm.Code),e.isPaymentCodeBoxShow=!0;let a={Hr:e.paymentCodeForm.Hr,R:e.paymentCodeForm.R};e.$store.state.vuexStore.RList.push(a),e.$parent.$parent.StoreData("RList")}else"NEO"==e.$store.state.vuexStore.baseChain&&e.createPaymentCodeNEO()})},createPaymentCodeNEO(){console.log("NEO");let e=this;if(e.paymentCodeForm.R=randomBytes(32),console.log(e.paymentCodeForm.R),e.paymentCodeForm.Hr=createHr(e.paymentCodeForm.R.slice(2)),console.log(e.paymentCodeForm.Hr),e.$store.state.vuexStore.channelList.forEach(function(t,a){3==t.State&&t.assetType==e.paymentCodeForm.assetType&&(e.paymentCodeForm.selfUri=t.SelfUri)}),""==e.paymentCodeForm.selfUri)return e.$notify.info({title:"警告",dangerouslyUseHTMLString:!0,message:"没有该资产类型的通道",duration:3e3,type:"warning"}),!1;let t=e.$parent.$parent.AssetTypeToAssetId1(e.paymentCodeForm.assetType),a=e.paymentCodeForm.selfUri+"&"+e.paymentCodeForm.Hr+"&"+t+"&"+e.paymentCodeForm.amount+"&PaymentCode";console.log(a),e.paymentCodeForm.Code="TN"+base58encode(a),console.log(e.paymentCodeForm.Code),e.isPaymentCodeBoxShow=!0;let s={Hr:e.paymentCodeForm.Hr,R:e.paymentCodeForm.R.slice(2)};e.$store.state.vuexStore.RList.push(s),e.$parent.$parent.StoreData("RList")},resetForm(){this.isPaymentCodeBoxShow=!1,this.paymentCodeForm={amount:"",assetType:"",selfUri:"",R:"",Hr:"",Code:""}}}},be={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"descoverForm"},[a("headBox"),e._v(" "),a("div",{staticClass:"contentBox"},[e.isPaymentCodeBoxShow?a("el-button",{staticStyle:{"font-size":"12px",float:"right"},attrs:{size:"mini"},on:{click:function(t){e.resetForm("ruleForm")}}},[e._v(e._s(e.$t("receive.reset")))]):e._e(),e._v(" "),a("h2",{staticClass:"title_h2"},[e._v("创建收款码")]),e._v(" "),a("hr"),e._v(" "),e.isPaymentCodeBoxShow?a("div",[a("div",{staticClass:"QRCodeBox QRCodeBox-white"},[a("qriously",{staticStyle:{zoom:"0.76"},attrs:{value:e.paymentCodeForm.Code,level:"H",size:244}}),e._v(" "),a("p",{staticStyle:{"margin-top":"22px"}},[e._v(e._s(e.$t("receive.receiveCode")))])],1),e._v(" "),a("hr"),e._v(" "),a("p",[e._v("收款码")]),e._v(" "),a("h3",{attrs:{id:"receivePaymentCode"}},[e._v(e._s(e.paymentCodeForm.Code))]),e._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{staticClass:"btncopy",attrs:{"data-clipboard-target":"#receivePaymentCode",type:"primary"},on:{click:function(t){e.copyfun()}}},[e._v(e._s(e.$t("receive.copy")))])],1)]):a("div",[a("el-form",{ref:"paymentCodeForm",staticClass:"demo-ruleForm",attrs:{model:e.paymentCodeForm,"status-icon":"",rules:e.paymentCodeRules,"label-width":"80px","label-position":"top"}},[a("el-form-item",{attrs:{label:e.$t("receive.amount"),prop:"amount"}},[a("el-input",{attrs:{type:"number","auto-complete":"off"},model:{value:e.paymentCodeForm.amount,callback:function(t){e.$set(e.paymentCodeForm,"amount",e._n(t))},expression:"paymentCodeForm.amount"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("receive.assetType"),prop:"assetType"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("receive.chooseAssetType")},model:{value:e.paymentCodeForm.assetType,callback:function(t){e.$set(e.paymentCodeForm,"assetType",t)},expression:"paymentCodeForm.assetType"}},["ETH"==e.$store.state.vuexStore.baseChain?[a("el-option",{attrs:{label:"TNC",value:"TNC"}}),e._v(" "),a("el-option",{attrs:{label:"ETH",value:"ETH",disabled:""}})]:e._e(),e._v(" "),"NEO"==e.$store.state.vuexStore.baseChain?[a("el-option",{attrs:{label:"TNC",value:"TNC"}}),e._v(" "),a("el-option",{attrs:{label:"NEO",value:"NEO"}}),e._v(" "),a("el-option",{attrs:{label:"GAS",value:"GAS"}})]:e._e()],2)],1),e._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.createPaymentCode()}}},[e._v(e._s(e.$t("receive.create")))])],1)],1)],1)],1)],1)},staticRenderFns:[]};var $e=a("VU/8")(Ce,be,!1,function(e){a("tAxE")},"data-v-470089fe",null).exports,_e={name:"backupForm",data:()=>({}),components:{headBox:C.a},methods:{backup(){if("ETH"==this.$store.state.vuexStore.baseChain)if(this.$store.state.vuexStore.walletInfo.keyStore){var e=JSON.stringify(this.$store.state.vuexStore.walletInfo.keyStore),t=new Blob([e],{type:"text/plain;charset=utf-8"});saveAs(t,this.$store.state.vuexStore.walletInfo.keyStore.id+".json")}else this.$notify.error({title:"警告",dangerouslyUseHTMLString:!0,message:"备份失败，请确认正确导入钱包",duration:3e3});else if("NEO"==this.$store.state.vuexStore.baseChain)if(this.$store.state.vuexStore.NEOwalletInfo.keyStore){e=JSON.stringify(this.$store.state.vuexStore.NEOwalletInfo.keyStore),t=new Blob([e],{type:"text/plain;charset=utf-8"});saveAs(t,this.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].address+".json")}else this.$notify.error({title:"警告",dangerouslyUseHTMLString:!0,message:"备份失败，请确认正确导入钱包",duration:3e3})}}},Te={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"backupForm"},[a("headBox"),e._v(" "),a("div",{staticClass:"contentBox"},[a("h2",{staticClass:"title_h2"},[e._v(e._s(e.$t("backup.title")))]),e._v(" "),a("hr"),e._v(" "),a("el-button",{staticStyle:{margin:"10px 0"},attrs:{type:"primary",icon:"el-icon-edit",plain:""},on:{click:function(t){e.backup()}}},[e._v(e._s(e.$t("backup.backupBtn")))]),e._v(" "),a("div",{staticClass:"tipBox tipBox-red"},[a("h3",[e._v(e._s(e.$t("backup.tips")))]),e._v(" "),a("p",[e._v(e._s(e.$t("backup.tipsContent")))])])],1)],1)},staticRenderFns:[]};var ke=a("VU/8")(_e,Te,!1,function(e){a("a5Xv")},"data-v-b3afab28",null).exports,we={name:"contactBox",data(){return{contactList:[],multipleSelection:[],centerDialogVisible:!1,addContactForm:{name:"",address:""},addContactRules:{name:[{validator:(e,t,a)=>{if(""===t)return a(new Error(this.$t("contact.callback-1")));a()},trigger:"blur"}],address:[{validator:(e,t,a)=>{let s=!1;this.$store.state.vuexStore.contactList.forEach(function(e,a){e.address===t&&(s=!0)}),""===t?a(new Error(this.$t("contact.callback-2"))):42!==t.length?a(new Error(this.$t("contact.callback-3"))):s?a(new Error(this.$t("contact.callback-4"))):a()},trigger:"blur"}]}}},components:{headBox:C.a},mounted(){this.$nextTick(function(){this.$store.state.vuexStore.isLogin?this.contactList=this.$store.state.vuexStore.contactList:this.$router.push("/start")})},methods:{toggleSelection(e){e?e.forEach(e=>{this.$refs.multipleTable.toggleRowSelection(e)}):this.$refs.multipleTable.clearSelection()},handleSelectionChange(e){this.multipleSelection=e},addContact(){this.$refs.addContactForm.validate(e=>{if(!e)return console.log("error submit!!"),!1;{let e={name:this.addContactForm.name,address:this.addContactForm.address};this.$store.state.vuexStore.contactList.push(e),this.saveAsArray(this.$store.state.vuexStore.walletInfo.address+"@contactList",this.$store.state.vuexStore.contactList),this.centerDialogVisible=!1,this.$notify({title:this.$t("common.success"),dangerouslyUseHTMLString:!0,message:this.$t("contact.callback-5"),duration:3e3,type:"success"})}})},DeltableData(){let e=this;e.multipleSelection.forEach(function(t,a){e.$store.state.vuexStore.contactList.forEach(function(a,s){a.address===t.address&&e.$store.state.vuexStore.contactList.splice(s,1)}),e.saveAsArray(e.$store.state.vuexStore.walletInfo.address+"@contactList",e.$store.state.vuexStore.contactList)})},transfer(){let e=this.multipleSelection[0].address;this.$store.state.vuexStore.activeNavIndex="1-1",this.$router.push({name:"index",params:{address:e}})},saveAsArray:function(e,t){let a=e.toString();window.localStorage.setItem(a,JSON.stringify(t))}}},Ne={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"contactBox"},[a("headBox"),e._v(" "),a("div",{staticClass:"contentBox"},[a("h2",{staticClass:"title_h2"},[e._v(e._s(e.$t("contact.title")))]),e._v(" "),a("hr"),e._v(" "),a("el-button",{staticStyle:{margin:"10px 0"},attrs:{type:"primary",icon:"el-icon-plus",plain:""},on:{click:function(t){e.centerDialogVisible=!0}}},[e._v(e._s(e.$t("contact.addContact")))]),e._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.contactList,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"60"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:e.$t("contact.name"),width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"address",label:e.$t("contact.address")}})],1),e._v(" "),a("div",{staticStyle:{"margin-top":"20px"}},[a("el-button",{attrs:{disabled:1!=e.multipleSelection.length,type:"success",plain:""},on:{click:function(t){e.transfer()}}},[e._v(e._s(e.$t("contact.transfer")))]),e._v(" "),a("el-button",{attrs:{type:"danger",plain:""},on:{click:function(t){e.DeltableData()}}},[e._v(e._s(e.$t("contact.delete")))]),e._v(" "),a("el-button",{attrs:{plain:""},on:{click:function(t){e.toggleSelection()}}},[e._v(e._s(e.$t("contact.cancelSelection")))])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.$t("contact.addContact"),visible:e.centerDialogVisible,width:"40%",center:"","modal-append-to-body":!1},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[a("el-form",{ref:"addContactForm",staticClass:"demo-ruleForm",attrs:{model:e.addContactForm,"status-icon":"",rules:e.addContactRules,"label-width":"70px"}},[a("el-form-item",{attrs:{label:e.$t("contact.name"),prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addContactForm.name,callback:function(t){e.$set(e.addContactForm,"name",t)},expression:"addContactForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("contact.address"),prop:"address"}},[a("el-input",{model:{value:e.addContactForm.address,callback:function(t){e.$set(e.addContactForm,"address",t)},expression:"addContactForm.address"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addContact()}}},[e._v(e._s(e.$t("contact.add")))]),e._v(" "),a("el-button",{on:{click:function(t){e.centerDialogVisible=!1}}},[e._v(e._s(e.$t("contact.cancel")))])],1)],1)],1)},staticRenderFns:[]};var Ie=a("VU/8")(we,Ne,!1,function(e){a("Am27")},"data-v-d4c465e2",null).exports,Be={name:"changePasswordForm",data(){return{changePasswordForm:{oldPass:"",pass:"",checkPass:""},changePasswordRules:{oldPass:[{validator:(e,t,a)=>{if(!t)return a(new Error(this.$t("changePassword.callback-1")));{let e=this.$parent.decryptPrivateKey(this.$store.state.vuexStore.walletInfo.keyStore,t);setTimeout(()=>{if(!e)return a(new Error(this.$t("changePassword.callback-2")));a()},2e3)}},trigger:"blur"}],pass:[{validator:(e,t,a)=>{""===t?a(new Error(this.$t("changePassword.callback-3"))):(""!==this.changePasswordForm.checkPass&&this.$refs.changePasswordForm.validateField("checkPass"),a())},trigger:"blur"}],checkPass:[{validator:(e,t,a)=>{""===t?a(new Error(this.$t("changePassword.callback-4"))):t!==this.changePasswordForm.pass?a(new Error(this.$t("changePassword.callback-5"))):a()},trigger:"blur"}]}}},components:{headBox:C.a},mounted(){this.$nextTick(function(){})},methods:{toLoginForm(){this.$refs.changePasswordForm.validate(e=>{if(!e)return console.log("error submit!!"),!1;{let e=this.$parent.decryptPrivateKey(this.$store.state.vuexStore.walletInfo.keyStore,this.changePasswordForm.oldPass);console.log(e);let t=web3.eth.accounts.encrypt(e.privateKey,this.changePasswordForm.pass);console.log(t);let a=web3.utils.toChecksumAddress(t.address);console.log(a),a==this.$store.state.vuexStore.walletInfo.address?(this.$store.state.vuexStore.walletInfo.keyStore=t,this.$notify({title:this.$t("changePassword.callback-6"),dangerouslyUseHTMLString:!0,message:this.$t("changePassword.callback-7"),duration:3e3,type:"success"})):this.$notify.error({title:this.$t("changePassword.callback-8"),dangerouslyUseHTMLString:!0,message:this.$t("changePassword.callback-9"),duration:3e3})}this.changePasswordForm.oldPass="",this.changePasswordForm.pass="",this.changePasswordForm.checkPass=""})}}},Oe={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"changePasswordForm"},[a("headBox"),e._v(" "),a("div",{staticClass:"contentBox"},[a("h2",{staticClass:"title_h2"},[e._v(e._s(e.$t("changePassword.title")))]),e._v(" "),a("hr"),e._v(" "),a("el-form",{ref:"changePasswordForm",staticClass:"demo-ruleForm",attrs:{model:e.changePasswordForm,"status-icon":"",rules:e.changePasswordRules,"label-position":"top","label-width":"92px"}},[a("el-form-item",{attrs:{label:e.$t("changePassword.oldPass"),prop:"oldPass"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.changePasswordForm.oldPass,callback:function(t){e.$set(e.changePasswordForm,"oldPass",t)},expression:"changePasswordForm.oldPass"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("changePassword.password"),prop:"pass"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.changePasswordForm.pass,callback:function(t){e.$set(e.changePasswordForm,"pass",t)},expression:"changePasswordForm.pass"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("changePassword.checkPass"),prop:"checkPass"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.changePasswordForm.checkPass,callback:function(t){e.$set(e.changePasswordForm,"checkPass",t)},expression:"changePasswordForm.checkPass"}})],1),e._v(" "),a("div",{staticClass:"button-item",staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.toLoginForm()}}},[e._v(e._s(e.$t("changePassword.changePassword")))])],1)],1)],1)],1)},staticRenderFns:[]};var Le=a("VU/8")(Be,Oe,!1,function(e){a("LzvJ")},"data-v-1e9be3d0",null).exports,De={name:"languageForm",data:()=>({languageData:[{name:"中文",lang:"cn",isSelected:!1},{name:"English",lang:"en",isSelected:!1}]}),components:{headBox:C.a},watch:{},mounted(){this.$nextTick(function(){let e=this;e.$i18n.locale&&e.languageData.forEach(function(t,a){t.lang==e.$i18n.locale&&(t.isSelected=!0)})})},filters:{},methods:{ChangeLang(e,t){void 0!=e.lang?this.$i18n.locale=e.lang:this.$i18n.locale="cn",this.$parent.$parent.saveAsString("lang",this.$i18n.locale),console.log(t),this.languageData.forEach(function(e,t){e.isSelected=!1}),e.isSelected=!0,this.$set(this.languageData,t,e);let a=this;setTimeout(function(){a.$router.go(-1)},300)}}},Re={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"languageForm"},[a("headBox"),e._v(" "),a("div",{staticClass:"contentBox"},e._l(e.languageData,function(t,s){return a("a",{key:s,staticClass:"cell",on:{click:function(a){e.ChangeLang(t,s)}}},[a("div",{staticClass:"cell-wrapper"},[a("div",{staticClass:"cell-title"},[a("span",{staticClass:"cell-text"},[a("div",{class:[t.isSelected?"el-icon-check":"el-icon-null"]}),e._v("\n                      "+e._s(t.name)+"\n                  ")])]),e._v(" "),a("div",{staticClass:"cell-right"})])])}))],1)},staticRenderFns:[]};var Pe=a("VU/8")(De,Re,!1,function(e){a("t8LU")},"data-v-cf1460ac",null).exports,Ee={name:"aboutForm",data:()=>({clickNum:0}),components:{headBox:C.a},watch:{clickNum(e,t){e%5==0&&(console.log("切换主网/测试网"),this.switchNet())}},filters:{},methods:{switchNet(){this.$store.state.vuexStore.isTestNet?this.$store.state.vuexStore.isTestNet=!1:this.$store.state.vuexStore.isTestNet=!0}}},Fe={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"aboutForm"},[s("headBox"),e._v(" "),s("div",{staticClass:"contentBox"},[s("h2",{staticClass:"title_h2"},[e._v(e._s(e.$t("about.title")))]),e._v(" "),s("hr"),e._v(" "),s("div",{staticStyle:{"text-align":"center"}},[s("img",{attrs:{src:a("N+8p"),alt:"Trinity"},on:{click:function(t){e.clickNum+=1}}}),e._v(" "),s("h4",[e._v("Trinity Wallet for ETH")]),e._v(" "),e.$store.state.vuexStore.isTestNet?s("p",{staticStyle:{color:"red"}},[e._v("Test Network")]):e._e(),e._v(" "),s("p",[e._v("Version: V"+e._s(e.$store.state.vuexStore.version))])]),e._v(" "),s("div",[s("p",[e._v(e._s(e.$t("about.content")))]),e._v(" "),s("p",[s("b",[e._v(e._s(e.$t("about.tipsTitle"))+"  ")]),e._v(e._s(e.$t("about.tips")))])])])],1)},staticRenderFns:[]};var He=a("VU/8")(Ee,Fe,!1,function(e){a("uPXK")},"data-v-21b3ba14",null).exports;s.default.use(l.a);var Me=new l.a({routes:[{path:"/wallet",name:"index",component:h,meta:{index:0}},{path:"/message",name:"message",component:f,meta:{index:0}},{path:"/discover",name:"discover",component:p,meta:{index:0}},{path:"/setting",name:"setting",component:x,meta:{index:0}},{path:"/scan",name:"scan",component:_,meta:{index:3}},{path:"/EtherScan",name:"EtherScan",component:w,meta:{index:3}},{path:"/receive",name:"receiveForm",component:L,meta:{index:1}},{path:"/start",name:"startForm",component:M,meta:{index:0}},{path:"/create",name:"createForm",component:K,meta:{index:0}},{path:"/loginByPrivateKey",name:"loginByPrivateKeyForm",component:J,meta:{index:0}},{path:"/loginByKeyStore",name:"loginByKeyStoreForm",component:j,meta:{index:0}},{path:"/record",name:"recordForm",component:P},{path:"/chain/asset",name:"asset",component:z,meta:{index:1}},{path:"/chain/receive1",name:"receive1",component:te,meta:{index:2}},{path:"/chain/transfer",name:"transferOnChain",component:oe,meta:{index:2}},{path:"/channel/addChannel",name:"addChannelForm",component:ie,meta:{index:0}},{path:"/channel/channelList",name:"channelListForm",component:he,meta:{index:0}},{path:"/channel/payment",name:"payment",component:xe,meta:{index:0}},{path:"/channel/createPayment",name:"createPayment",component:$e,meta:{index:1}},{path:"/channel/channelAsset",name:"channelAsset",component:fe,meta:{index:2}},{path:"/channel/channelInfo",name:"channelInfo",component:pe,meta:{index:3},params:{Data:{Alice:"",ChannelName:"",date:"",SelfUri:"",SelfBalance:"",OtherUri:"",OtherBalance:"",State:"",isConnect:"",isTestNet:""}}},{path:"/setting/backup",name:"BackupForm",component:ke,meta:{index:1}},{path:"/setting/changePassword",name:"changePasswordForm",component:Le,meta:{index:1}},{path:"/setting/contact",name:"contactForm",component:Ie,meta:{index:1}},{path:"/setting/language",name:"language",component:Pe,meta:{index:1}},{path:"/setting/about",name:"aboutForm",component:He,meta:{index:1}}],mode:"hash"}),Ae=a("zL8q"),Ue=a.n(Ae),Ke=(a("tvR6"),a("NYxO")),We=a("urW8"),Xe=a.n(We),Je=a("TXmL");a("wUZ8");var Ge={tabbar:{wallet:"Wallet",message:"Message",channel:{addChannel:"Add Channel",channelList:"Channel List",payment:"Payment",scan:"Scan"},discover:"Discover",setting:"Me"},setting:{title:"Setting",backup:"Backup",changePass:"Change Password",contact:"Contact",switchLang:"Language",about:"About Us",signOut:"Sign Out"},start:{title:"Welcome",createWallet:"Create Wallet",loginByPrivateKey:"Import by Private Key",loginByKeystore:"Restore form the Backup File",createWalletTxt:"Create a new wallet and start a transaction of crypto asset",loginByPrivateKeyTxt:"You can import your wallet by your private key",loginByKeystoreTxt:"If you once backed up your files, you can import the wallet by the files"},create:{title:"Create Wallet",password:"Password",checkPass:"Repeat pass",create:"Create","callback-1":"Please input the password","callback-2":"Please repeat the password","callback-3":"Passwords don't match","callback-4":"Succeed","callback-5":"Create Succeed","callback-6":"Succeed","callback-7":"Warning","callback-8":"Create failed, please again"},loginByPrivateKey:{title:"Import the Private Key",privateKey:"PrivateKey",password:"Password",checkPass:"CheckPass",import:"Import",backToStart:"Back to start page","callback-1":"Private key can not be empty","callback-2":"Please input the correct private key","callback-3":"Please input the password","callback-4":"Please repeat the password","callback-5":"Passwords don't match","callback-6":"Succeed","callback-7":"Import succeed","callback-8":"Warning","callback-9":"Import failed, please confirm the private key"},loginByKeyStore:{title:"Restore form the Backup File",chooseKeyStore:"Choose the File",password:"Password",import:"Import","callback-1":"Warning","callback-2":"KeyStore file read error","callback-3":"Warning","callback-4":"KeyStore file can not be empty","callback-5":"Warning","callback-6":"Please input the password","callback-7":"Warning","callback-8":"Key derivation failed - possibly wrong password","callback-9":"Warning","callback-10":"Succeed","callback-11":"Restore succeed","callback-12":"Warning","callback-12":"Restore failed，please confirm the file and password"},index:{assetType:"Asset Type",balanceOnChain:"Chain Balance",balanceOnChannel:"Channel Balance",title:"Transfer",paymentCode:"Payment Code / Address",transferByContact:"Transfer from contact",transfer:"Transfer",transferOnChian:"Transfer On Chian",transferOnChannel:"Transfer On Channel",assetType:"AssetType",inputAssetType:"Choose Asset Type",password:"Password",cancel:"Cancel","transfer-1":"Send","transfer-2":" ","callback-1":"Address can not be empty","callback-2":"please confirm address","callback-3":"Amount can not be empty","callback-4":"Please enter a number","callback-5":"Amount must be greater than 0","callback-6":"AssetType can not be empty","callback-7":"Please input the password","callback-8":"Key derivation failed - possibly wrong password","callback-9":"Payment code / address can not be empty","callback-10":"Receiver's address can not be the same","callback-11":"Payment code parsing error","callback-12":"Not this network payment code, please confirm","callback-13":"Insufficient channel balance","callback-14":"No channels open yet, please add one before","callback-15":"Channel not open"},asset:{title:"Asset",receive:"Receive",send:"Send"},receive:{title:"Receive",receiveAddressQRCode:"Wallet Address QRCode",receiveAddress:"Wallet Address",copy:"Copy",amount:"Amount",assetType:"Asset Type",chooseAssetType:"Choose Asset Type",create:"Create",reset:"Reset",receiveCode:"Receive Code"},transferOnChian:{title1:"Transfer ",title2:" on chian",address:"Address",amount:"Amount",balance:"Balance",miningFee:"Mining Fee"},channelList:{title:"Channel List",addChannel:"Add Channel",noChannel:"No channels yet, go add now",channelName:"Channel name",date:"Open Date",selfUri:"Self uri",selfBalance:"Self balance",otherUri:"Other Uri",otherBalance:"Other balance",channelState:"Channel state",isConnect:"Connect state",isTestNet:"Network",closeChannel:"Close Channel",password:"Password",inputPassword:"Input password here",fastClose:"Fast Close",forcedClose:"Forced Close",cancel:"Cancel"},addChannel:{title:"Add Channel",assetBalance:"Asset Balance",otherUri:"TNAP",otherUriPlaceHolder:"Trinity Network Access Point",assetType:"Asset Type",chooseAssetType:"Choose Asset Type",selfDeposit:"Self deposit",otherDeposit:"Other deposit",alice:"Alice",password:"Password",addChannel:"Add Channel",cancel:"Cancel","callback-1":"TNAP can not be empty","callback-2":"The format of TNAP is incorrect","callback-3":"There is already a channel with this TNAP","callback-4":"Self deposit can not be empty","callback-5":"Self deposit must be greater than 0","callback-6":"deposit can not more than balance","callback-7":"The deposit limit is up to 8 decimal places","callback-8":"Other deposit can not be empty","callback-9":"Other deposit must be greater than 0","callback-10":"Alice can not be empty"},record:{title:"Record",noRecord:"No record yet",recordInfo:"Record Details",otherUri:"Other address",date:"Transaction data",amount:"Transaction amount",isOnChannel:"Transaction mode",state:"Transaction result",transactionHash:"Transaction hash",blockHash:"Block hash",close:"Close"},contact:{title:"My Contact",addContact:"Add Contact",name:"Name",address:"Address",transfer:"Transfer",delete:"Delete",cancelSelection:"Cancel Selection",add:"Add",cancel:"Cancel","callback-1":"Name can not be empty","callback-2":"Address can not be empty","callback-3":"Incorrect address format","callback-4":"Address already exists","callback-5":"Add Contact Succeed"},changePassword:{title:"Change Password",oldPass:"Old pass",password:"New pass",checkPass:"Repeat pass",changePassword:"Change Password","callback-1":"The wallet password can not be empty","callback-2":"Key derivation failed - possibly wrong password","callback-3":"Please input the new password","callback-4":"Please repeat the new password","callback-5":"Passwords don't match","callback-6":"Succeed","callback-7":"Change Password Succeed","callback-8":"Warning","callback-9":"Change Password Fail"},backup:{title:"Backup",backupBtn:"Backup Wallet",tips:"Tips",tipsContent:"After backed up the wallet, the system will generate a wallet backup file. When you clear the data, change the browser, or reinstall the system, you can use the wallet backup file to restore the wallet. Please save the file and the wallet password. Once lost wallet files or forgotten wallet passwords you may lost your assets."},about:{title:"About Us",content:"Trinity Wallet is a state channel based wallet App. Trinity provides users fast-speed transactions safely with “Trading off-chain, endorsement on-chain” state channels. Users can get the fastest payment experience by using this App.",tipsTitle:"Tips:",tips:" Carefully keep your private key, and confirm that the channel has been closed before uninstalling the App or deleting the data, otherwise you will lose the channel information."},common:{success:"Succeed",warning:"Warning",info:"Info",attention:"Attention",continue:"Continue",cancel:"Cancel",receive:"Receive","fee-1":"You will pay ","fee-2":" as the routing fee for this transaction.",whyFee:"What's the routing fee?",whyFeeTips:"The routing fee of the transaction is generated by passing multiple routing nodes","send-1":"send","send-2":"to you",password:"Password",inputPassword:"Input password here",twoPassword:"Because of cross-channel trading, you need to sign the data twice",closeChannel:"Close Channel","closeChannel-1":"want to close channel",selfBalance:"Self Balance",otherBalance:"Other Balance",forceCloseChannel:"Force Close Channel",signOut:"You will signout wallet","callback-1":"Please input the password","callback-2":"Key derivation failed - possibly wrong password","callback-3":"Connecting to Trinity Network","callback-4":"Transaction Confirmed","callback-5":"Transaction Failed","callback-6":"Trinity Network Connected","callback-7":"Can't found the channel, please try again later","callback-8":"Channel is opened","callback-9":"Channel is closed","callback-10":"It’s forced closing the channel, the data is correct","callback-11":"It’s forced closing the channel, the data is incorrect.tap to unlock the wallet for the sanctions","callback-12":"The balance is distributed, the channel is closed","callback-13":"Forced closing the channel has reached the block height, tap to confirm the password","callback-14":"The transaction has been sent to the Blockchain, please wait for confirm","callback-15":"Disconnected to the Trinity network, tap to reconnect","callback-16":"Failed to add channel, peer balance is insufficient","callback-17":"No channel is created with this Uri","callback-18":"The channel is not open or is not connected to the websocket","callback-19":"The channel has a payment message, you need to unlock the wallet.<br/>tap to unlock","callback-20":"Transaction Confirm","callback-21":"Receiving Confirm","callback-22":"The routing is empty, There is no channel available","callback-23":"Channel is closed","callback-24":"Disconnect","callback-25":"Transaction Failed",verifyFail:"The peer signature verification was failed, and the transaction was canceled.",switchLang:"切换语言",scan:"Scan"}};a("Vi3T");var Ye={en:Ge,cn:{tabbar:{wallet:"钱包",message:"消息",channel:{addChannel:"添加通道",channelList:"通道列表",payment:"支付码",scan:"扫一扫"},discover:"发现",setting:"我的"},message:{title:"消息"},setting:{title:"设置",backup:"备份钱包",changePass:"修改密码",contact:"联系人",switchLang:"多语言",about:"关于我们",signOut:"退出"},start:{title:"欢迎",createWallet:"创建新钱包",loginByPrivateKey:"从私钥导入",loginByKeystore:"从备份文件恢复",createWalletTxt:"创建新钱包开始加密货币交易之旅",loginByPrivateKeyTxt:"可以通过导入私钥的方式将钱包导入",loginByKeystoreTxt:"如果之前备份文件，也可以通过备份文件的方式导入钱包"},create:{title:"创建钱包",password:"密码",checkPass:"确认密码",create:"创建","callback-1":"请输入密码","callback-2":"请再次输入密码","callback-3":"两次输入密码不一致","callback-4":"成功","callback-5":"创建成功","callback-6":"成功","callback-7":"警告","callback-8":"创建失败,请再试一次"},loginByPrivateKey:{title:"导入私钥",privateKey:"私钥",password:"密码",checkPass:"确认密码",import:"导入",backToStart:"返回开始界面","callback-1":"私钥不能为空","callback-2":"请输入正确的私钥","callback-3":"请输入密码","callback-4":"请再次输入密码","callback-5":"两次输入密码不一致","callback-6":"成功","callback-7":"导入成功","callback-8":"警告","callback-9":"导入失败，请确认私钥正确"},loginByKeyStore:{title:"从备份文件恢复",chooseKeyStore:"选取文件",password:"密码",import:"导入","callback-1":"警告","callback-2":"KeyStore文件读取错误","callback-3":"警告","callback-4":"KeyStore文件不能为空","callback-5":"警告","callback-6":"密码不能为空","callback-7":"警告","callback-8":"钱包解锁失败 - 可能是密码错误","callback-9":"警告","callback-10":"成功","callback-11":"导入成功","callback-12":"警告","callback-12":"导入失败，请确认KeyStore和密码正确"},index:{assetType:"资产类型",balanceOnChain:"链上金额",balanceOnChannel:"通道金额",title:"转账",paymentCode:"支付码/地址",transferByContact:"从联系人里转账",transfer:"转 账",transferOnChian:"链上转账",transferOnChannel:"通道转账",assetType:"资产类型",inputAssetType:"请选择资产类型",password:"密码",cancel:"取 消","transfer-1":"向","transfer-2":"转账","callback-1":"地址不能为空","callback-2":"请输入正确的地址","callback-3":"金额不能为空","callback-4":"请输入数字值","callback-5":"金额必须大于0","callback-6":"资产类型不能为空","callback-7":"钱包密码不能为空，否则将无法交易","callback-8":"钱包解锁失败 - 可能是密码错误","callback-9":"付款码/地址不能为空","callback-10":"收付款地址不能相同","callback-11":"付款码解析错误","callback-12":"非本网络付款码,请确认","callback-13":"通道余额不足","callback-14":"没有开通的通道,请先建立通道","callback-15":"通道未打开"},asset:{title:"资产",receive:"收 款",send:"付 款"},receive:{title:"收款",receiveAddressQRCode:"钱包地址二维码",receiveAddress:"钱包地址",copy:"复制",amount:"金额",assetType:"资产类型",chooseAssetType:"请选择资产类型",create:"创建",reset:"重置",receiveCode:"收款码"},transferOnChian:{title1:"链上转账",title2:"",address:"地址",amount:"金额",balance:"余额",miningFee:"矿工费"},channelList:{title:"通道列表",addChannel:"添加通道",noChannel:"还没有通道，立即去添加",channelName:"通道名称",date:"开通时间",selfUri:"本端地址",selfBalance:"本端余额",otherUri:"对端地址",otherBalance:"对端余额",channelState:"通道状态",isConnect:"是否连接",isTestNet:"网络",closeChannel:"关闭通道",password:"密码",inputPassword:"在此输入密码",fastClose:"快速关闭",forcedClose:"强制关闭",cancel:"取消"},addChannel:{title:"添加通道",assetBalance:"资产余额",otherUri:"TNAP",otherUriPlaceHolder:"Trinity网络接入点",assetType:"资产类型",chooseAssetType:"请选择资产类型",selfDeposit:"本端余额",otherDeposit:"对端余额",alice:"通道名称",password:"密码",addChannel:"添加通道",cancel:"取消","callback-1":"对端TNAP不能为空","callback-2":"TNAP格式不正确","callback-3":"你已经和这个TNAP有一个通道了","callback-4":"本端押金数量不能为空","callback-5":"本端押金数量必须大于0","callback-6":"押金数量不能大于钱包余额","callback-7":"本端押金小数最多为8位小数","callback-8":"对端押金数量不能为空","callback-9":"对端押金数量必须大于0","callback-10":"通道名称不能为空"},record:{title:"交易记录",noRecord:"没有交易记录",recordInfo:"交易详情",otherUri:"对端地址",date:"交易时间",amount:"交易金额",isOnChannel:"交易方式",state:"交易结果",transactionHash:"交易哈希",blockHash:"块哈希",close:"关闭"},contact:{title:"我的联系人",addContact:"添加联系人",name:"名字",address:"地址",transfer:"转账",delete:"删除",cancelSelection:"取消选择",add:"添 加",cancel:"取 消","callback-1":"姓名不能为空","callback-2":"地址不能为空","callback-3":"地址检测错误","callback-4":"地址已经存在","callback-5":"添加联系人成功"},changePassword:{title:"修改密码",oldPass:"原密码",password:"新密码",checkPass:"重复新密码",changePassword:"修改密码","callback-1":"钱包密码不能为空，否则将无法修改密码","callback-2":"钱包解锁失败 - 可能是密码错误","callback-3":"请输入新密码","callback-4":"请再次输入新密码","callback-5":"两次输入密码不一致","callback-6":"成功","callback-7":"修改密码成功","callback-8":"警告","callback-9":"修改密码失败"},backup:{title:"备份",backupBtn:"备份钱包",tips:"温馨提醒",tipsContent:"备份当前钱包后，浏览器会生成一个钱包备份文件，当您清空数据库、或者更换 浏览器、重装系统后，可以使用钱包备份文件恢复当前钱包。同时保存好文件和 钱包密码，钱包文件丢失或忘记密码可能会导致您的资产丢失。"},about:{title:"关于我们",content:"Trinity Wallet App是基于状态通道功能的钱包App。Trinity的状态通道技术通过“链上信用背书，链下进行交易”的方式可以为所有区块链网络扩容。在钱包App中，Trinity为用户提供了基于状态通道的支付服务，让基于状态通道技术的交易具备极高的转账速度和安全性。打开状态通道，便可以获得最快的付款体验。",tipsTitle:"友情提示:",tips:"请妥善管理您的私钥。若要卸载或删除APP，请您提前请确认通道已经全部关闭，否则将会面临通道信息丢失的风险。"},common:{success:"成功",warning:"警告",info:"消息",attention:"注意",continue:"确 定",cancel:"取 消",receive:"收 款","fee-1":"你将额外支付","fee-2":"作为本次交易的路由费用",whyFee:"什么是路由费用?",whyFeeTips:"交易的路由费用由于通过多个路由节点而产生","send-1":"向你转账","send-2":"",password:"密码",inputPassword:"在此输入密码",twoPassword:"由于跨通道交易,你需要对数据进行两次签名",closeChannel:"关闭通道","closeChannel-1":"想要关闭通道",selfBalance:"本端余额",otherBalance:"对端余额",forceCloseChannel:"强制关闭通道",signOut:"你将退出钱包","callback-1":"密码不能为空，否则将无法交易","callback-2":"钱包解锁失败 - 可能是密码错误","callback-3":"正在连接至Trinity网络","callback-4":"交易已确认","callback-5":"交易确认失败","callback-6":"已连接到Trinity网络","callback-7":"未找到该通道,请重试一次","callback-8":"通道已开通","callback-9":"通道已关闭","callback-10":"正在强制关闭通道,数据正确","callback-11":"正在强制关闭通道,数据不正确,点击解锁钱包进行制裁","callback-12":"通道已分配余额,通道关闭","callback-13":"强制拆链已到达指定块高，点击输入密码确认","callback-14":"上链成功,请等待交易确认","callback-15":"与Trinity网络断开连接,点击进行重连","callback-16":"添加通道失败,对端余额不足","callback-17":"未与该Uri建立通道","callback-18":"该通道未Open或者未连接上websocket","callback-19":"通道有收款消息,需要你解锁钱包.<br/>点击进行解锁","callback-20":"转账确认","callback-21":"收款确认","callback-22":"路由为空,没有可用的通道","callback-23":"通道已关闭","callback-24":"断开连接","callback-25":"转账失败",verifyFail:"对端签名验证未通过,停止交易.",switchLang:"switch Language",scan:"扫一扫"}}};s.default.use(Je.a);const Ve=new Je.a({locale:localStorage.lang||"cn",messages:Ye});Xe.a.i18n((e,t)=>Ve.vm._t(e,t));var je=Ve,Qe=(a("7xIN"),{state:{version:"0.0.1",isLogin:!1,baseChain:"ETH",isTestNet:!0,activeNavIndex:"1-1",isNavShow:!0,isMessageBoxShow:!1,isChannelFormShow:!1,NetMagic:"195378745719990331",gasPrice:5e9,NodeUriWebSocketIp:"ws://47.104.81.20:9000",NodeUriWebSocket:"",NodeRpcUri:"http://47.254.64.251:21332",isNotifyShow:!1,walletInfo:{keyStore:"",publicKey:"",address:""},NEOwalletInfo:{keyStore:"",publicKey:"",address:""},balanceData:{Chain:{TNC:0,ETH:0,NEO:0,GAS:0},Channel:{TNC:0,ETH:0,NEO:0,GAS:0}},activeAssetInfo:{assetType:"",channelName:""},addChannelInfo:[],txOnChannelInfo:[],closeChannelInfo:[],channelList:[],contactList:{},txList:[],recordList:[],RList:[],eventList:[],tncContractAddress:"",tncContractAbi:[],trinityContractAddress:"",trinityDataContractAddress:"",trinityContractAbi:[],spvPort:""},getters:{channelList:e=>!e.channelList},mutations:{switch_dialog(e){e.show=!e.show}},actions:{switch_dialog(e){e.commit("switch_dialog")}}});s.default.use(Ke.a);var Ze=new Ke.a.Store({modules:{vuexStore:Qe}});s.default.use(Ue.a),s.default.use(Ke.a),s.default.config.productionTip=!1,new s.default({el:"#app",router:Me,store:Ze,i18n:je,components:{App:i},template:"<App/>"})},R1OE:function(e,t){},SKcX:function(e,t,a){"use strict";var s={name:"tabbar",data(){return{tabbarList:[{index:"0",icon:"el-icon-ETH-qianbao",name:this.$t("tabbar.wallet"),router:"/wallet"},{index:"1",icon:"el-icon-ETH-comment",name:this.$t("tabbar.message"),router:"/message"},{index:"2",icon:"./../../assets/img/Trinity.png"},{index:"3",icon:"el-icon-ETH-discover",name:this.$t("tabbar.discover"),router:"/discover"},{index:"4",icon:"el-icon-ETH-wode",name:this.$t("tabbar.setting"),router:"/setting"}],tabbarSelected:0,isTabbarShow:!0}},mounted(){this.$nextTick(function(){})},computed:{},watch:{"$route.path":"showTabbar","$i18n.locale":"changeLang"},methods:{selectItems(e,t){this.tabbarSelected=e,this.$router.push(t)},showChannelForm(){this.$store.state.vuexStore.isChannelFormShow=!0},showTabbar(){let e=this.$route.path;this.isTabbarShow="/start"!=e&&"/create"!=e&&"/loginByPrivateKey"!=e&&"/loginByKeyStore"!=e&&"/scan"!=e&&"/setting/language"!=e},changeLang(){this.tabbarList[0].name=this.$t("tabbar.wallet"),this.tabbarList[1].name=this.$t("tabbar.message"),this.tabbarList[3].name=this.$t("tabbar.discover"),this.tabbarList[4].name=this.$t("tabbar.setting")}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"show",rawName:"v-show",value:e.isTabbarShow,expression:"isTabbarShow"}],staticClass:"tabbar"},e._l(e.tabbarList,function(t,s){return a("div",{key:s,staticStyle:{flex:"1"}},[2!=s&&1!=s?a("a",{staticClass:"tab-item",class:{"is-selected":e.tabbarSelected==s},on:{click:function(a){a.stopPropagation(),e.selectItems(s,t.router)}}},[a("div",{staticClass:"tab-item-icon"},[a("i",{class:t.icon})]),e._v(" "),a("div",{staticClass:"tab-item-label"},[e._v("\n                "+e._s(t.name)+"\n            ")])]):e._e(),e._v(" "),1==s?a("a",{staticClass:"tab-item",class:{"is-selected":e.tabbarSelected==s},on:{click:function(a){a.stopPropagation(),e.selectItems(s,t.router)}}},[a("el-badge",{staticClass:"item",attrs:{value:3,max:99}},[a("div",{staticClass:"tab-item-icon"},[a("i",{class:t.icon})]),e._v(" "),a("div",{staticClass:"tab-item-label"},[e._v("\n                    "+e._s(t.name)+"\n                ")])])],1):e._e(),e._v(" "),2==s?a("a",{staticClass:"tab-item",on:{click:function(t){t.stopPropagation(),e.showChannelForm()}}},[e._m(0,!0)]):e._e()])}))},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"TrinityButton"},[t("img",{attrs:{src:a("N+8p"),alt:"Trinity"}})])}]};var n=a("VU/8")(s,o,!1,function(e){a("ZvD6")},"data-v-3167f343",null);t.a=n.exports},"T/b+":function(e,t){},VR0t:function(e,t,a){"use strict";var s={name:"dialogForm",data:()=>({}),filters:{},methods:{}},o={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"dialogForm"})},staticRenderFns:[]};var n=a("VU/8")(s,o,!1,function(e){a("5Znf")},"data-v-7a57ce5f",null);t.a=n.exports},Ve6V:function(e,t){},X7GO:function(e,t){},ZvD6:function(e,t){},a5Xv:function(e,t){},cdTS:function(e,t){},fxPf:function(e,t){},gE2U:function(e,t){},hWNH:function(e,t,a){e.exports=a.p+"static/img/Trinity.9d7f65f.png"},jqPu:function(e,t){},qBZY:function(e,t){},qKYu:function(e,t,a){"use strict";var s=a("7+uW");t.a=new s.default},rb7I:function(e,t){},rmXD:function(e,t){},"s/ph":function(e,t,a){"use strict";(function(e){var s=a("LumP");t.a={name:"loginByKeyStoreForm",data:()=>({fileList:[],keyStoreContent:"",keyStorePass:""}),mounted(){this.$nextTick(function(){})},components:{headBox:s.a},methods:{handleChange(e,t){var a=this;if(e.raw){let t=new FileReader;t.onload=function(e){"ETH"==a.$store.state.vuexStore.baseChain?(a.keyStoreContent=JSON.parse(e.target.result),40!==a.keyStoreContent.address.length&&(a.$notify.error({title:a.$t("loginByKeyStore.callback-1"),dangerouslyUseHTMLString:!0,message:a.$t("loginByKeyStore.callback-2"),duration:3e3}),a.keyStoreContent="")):"NEO"==a.$store.state.vuexStore.baseChain&&(a.keyStoreContent=JSON.parse(e.target.result),34!==a.keyStoreContent.accounts[0].address.length&&(a.$notify.error({title:a.$t("loginByKeyStore.callback-1"),dangerouslyUseHTMLString:!0,message:a.$t("loginByKeyStore.callback-2"),duration:3e3}),a.keyStoreContent=""))},t.readAsText(e.raw,"gb2312")}},login(){return""==this.keyStoreContent?(this.$notify.error({title:this.$t("loginByKeyStore.callback-3"),dangerouslyUseHTMLString:!0,message:this.$t("loginByKeyStore.callback-4"),duration:3e3}),!1):""==this.keyStorePass?(this.$notify.error({title:this.$t("loginByKeyStore.callback-5"),dangerouslyUseHTMLString:!0,message:this.$t("loginByKeyStore.callback-6"),duration:3e3}),!1):void this.loginByKeyStore()},loginByKeyStore(){if("ETH"==this.$store.state.vuexStore.baseChain){let t;try{t=web3.eth.accounts.decrypt(this.keyStoreContent,this.keyStorePass)}catch(e){return"Key derivation failed - possibly wrong password"==e.message?(this.$notify.error({title:this.$t("loginByKeyStore.callback-7"),dangerouslyUseHTMLString:!0,message:this.$t("loginByKeyStore.callback-8"),duration:3e3}),!1):(this.$notify.error({title:this.$t("loginByKeyStore.callback-9"),dangerouslyUseHTMLString:!0,message:e.message,duration:3e3}),!1)}let a=new e(t.privateKey.substring(2),"hex").toString("hex");console.log(a);let s=web3.eth.accounts.privateKeyToAccount("0x"+a).address;s=web3.utils.toChecksumAddress(s),web3.utils.checkAddressChecksum(s)?(this.$store.state.vuexStore.walletInfo.keyStore=this.keyStoreContent,this.$store.state.vuexStore.walletInfo.address=s,this.$store.state.vuexStore.isLogin=!0,this.$notify({title:this.$t("loginByKeyStore.callback-10"),dangerouslyUseHTMLString:!0,message:this.$t("loginByKeyStore.callback-11"),duration:3e3,type:"success"}),this.$router.push("/wallet")):this.$notify.error({title:this.$t("loginByKeyStore.callback-12"),dangerouslyUseHTMLString:!0,message:this.$t("loginByKeyStore.callback-13"),duration:3e3}),this.keyStoreContent="",this.keyStorePass=""}else if("NEO"==this.$store.state.vuexStore.baseChain){let e;console.log(this.keyStoreContent);try{e=scrypt_module_factory(DecryptWalletByPassword,{},{WalletScript:this.keyStoreContent.accounts[0].key,password:this.keyStorePass,address:this.keyStoreContent.accounts[0].address}),console.log(e)}catch(e){return this.$notify.error({title:this.$t("loginByKeyStore.callback-9"),dangerouslyUseHTMLString:!0,message:e.message,duration:3e3}),!1}this.$store.state.vuexStore.NEOwalletInfo.keyStore=this.keyStoreContent,this.$store.state.vuexStore.NEOwalletInfo.publicKey=getPublicKeyEncoded(ab2hexstring(getPublicKey(e,0))),console.log(this.$store.state.vuexStore.NEOwalletInfo.publicKey),this.$store.state.vuexStore.NEOwalletInfo.address=this.keyStoreContent.accounts[0].address,this.$store.state.vuexStore.isLogin=!0,this.$notify({title:this.$t("loginByKeyStore.callback-10"),dangerouslyUseHTMLString:!0,message:this.$t("loginByKeyStore.callback-11"),duration:3e3,type:"success"}),this.keyStoreContent="",this.keyStorePass="",this.$router.push("/wallet")}}}}}).call(t,a("EuP9").Buffer)},"sH/u":function(e,t){},t8LU:function(e,t){},tAxE:function(e,t){},tvR6:function(e,t){},uPXK:function(e,t){},uQaT:function(e,t){},vxah:function(e,t){},xJD8:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_Vue__=__webpack_require__("TXMN"),__WEBPACK_IMPORTED_MODULE_1__components_tabbar_channel__=__webpack_require__("JSzE"),__WEBPACK_IMPORTED_MODULE_2__components_common_footer__=__webpack_require__("SKcX"),__WEBPACK_IMPORTED_MODULE_3__components_common_config__=__webpack_require__("0NEh"),__WEBPACK_IMPORTED_MODULE_4__components_common_notify__=__webpack_require__("9HGa"),__WEBPACK_IMPORTED_MODULE_5__components_common_dialog__=__webpack_require__("VR0t");__webpack_exports__.a={name:"App",data(){return{startX:0,endX:0,isFeeInfoBoxShow:!1,isReceiptRsmcInfoBox:!1,isReceiptHtlcInfoBox:!1,isSettleInfoBox:!1,isSettleTransactionInfoBox:!1,isUpdateTransactionInfoBox:!1,isSendUnlockAmountInfoBox:!1,isUnlockAmountInfoBox:!1,isSignOutBoxShow:!1,activeInfo:{redata:{},txData:"",keyStorePass:""},SettleTransaction:{blockNumber:"",keyStorePass:""},paymentInfo:{redata:{},keyStorePass:"",fee:0},confirmReceiptRules:{keyStorePass:[{validator:(e,t,a)=>{if(!t)return a(new Error(this.$t("common.callback-1")));{let e;"ETH"==this.$store.state.vuexStore.baseChain?e=this.$parent.$parent.verifyPassword(this.$store.state.vuexStore.walletInfo.keyStore,t):"NEO"==this.$store.state.vuexStore.baseChain&&(e=scrypt_module_factory(DecryptWalletByPassword,{},{WalletScript:this.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].key,password:t,address:this.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].address})),setTimeout(()=>{if(!e)return a(new Error(this.$t("index.callback-8")));a()},1e3)}},trigger:"blur"}]},transitionName:""}},components:{footerBox:__WEBPACK_IMPORTED_MODULE_2__components_common_footer__.a,channel:__WEBPACK_IMPORTED_MODULE_1__components_tabbar_channel__.a,config:__WEBPACK_IMPORTED_MODULE_3__components_common_config__.a,notify:__WEBPACK_IMPORTED_MODULE_4__components_common_notify__.a,dialogBox:__WEBPACK_IMPORTED_MODULE_5__components_common_dialog__.a},mounted(){this.$nextTick(function(){})},created(){document.body.removeChild(document.getElementById("Loading"))},watch:{$route(e,t){e.meta.index>t.meta.index?this.transitionName="slide-left":e.meta.index<t.meta.index?this.transitionName="slide-right":this.transitionName=""}},methods:{connectWebSocketForNodeUri(){let e=this;if("ETH"==e.$store.state.vuexStore.baseChain){let t=e.$store.state.vuexStore.NodeUriWebSocketIp;if(e.$store.state.vuexStore.NodeUriWebSocket=new WebSocket(t),e.$store.state.vuexStore.NodeUriWebSocket.onmessage=e.nodeUriWebsocketOnMessage,e.$store.state.vuexStore.NodeUriWebSocket.onclose=e.nodeUriWebsocketClose,1==e.$store.state.vuexStore.isLogin){let t={messageType:"init",walletAddress:e.$store.state.vuexStore.walletInfo.address};setTimeout(function(){e.$store.state.vuexStore.NodeUriWebSocket.send(JSON.stringify(t))},1e3)}}else"NEO"==e.$store.state.vuexStore.baseChain&&axios({method:"post",url:e.$store.state.vuexStore.NodeRpcUri,headers:{"Content-Type":"application/json;charset=UTF-8"},data:JSON.stringify({jsonrpc:"2.0",method:"getBalance",params:["AW25dxZZRJYjgXApEacYAEQDNPGDuFGCWF"],id:1})}).then(function(t){e.loseWebSocketForNodeUriNotify&&e.loseWebSocketForNodeUriNotify.close(),console.log("连接全节点成功")})},backToStart(){this.$router.push("/start")},closeNav(){window.screen.width<1024&&this.$store.state.vuexStore.isNavShow&&(this.$store.state.vuexStore.isNavShow=!1)},touchStart(e){this.startX=e.touches[0].clientX,console.log("开始X:"+this.startX)},touchEnd(e){window.screen.width<1024&&(this.endX=e.changedTouches[0].clientX,console.log("结束X:"+this.endX),this.startX>300&&this.startX-this.endX>0&&this.$store.state.vuexStore.isNavShow&&(this.$store.state.vuexStore.isNavShow=!1),this.startX<50&&this.startX-this.endX<-50&&!this.$store.state.vuexStore.isNavShow&&(this.$store.state.vuexStore.isNavShow=!0),this.startX=0,this.endX=0)},fetchAsArray:function(e){let t=e.toString();return JSON.parse(window.localStorage.getItem(t)||"[]")},fetchAsString:function(e){let t=e.toString();return window.localStorage.getItem(t)||""},saveAsArray:function(e,t){let a=e.toString();window.localStorage.setItem(a,JSON.stringify(t))},saveAsString:function(e,t){let a=e.toString();window.localStorage.setItem(a,t)},keepDecimalPlaces(e,t){let a;return a=isNaN(e)?NaN:parseInt(e*Math.pow(10,t))/Math.pow(10,t)},getChannelBalance(){let e=this,t=0,a=0;e.$store.state.vuexStore.channelList.forEach(function(s,o){s.isTestNet==e.$store.state.vuexStore.isTestNet&&3==s.State&&"TNC"==s.assetType?t+=s.SelfBalance:s.isTestNet==e.$store.state.vuexStore.isTestNet&&3==s.State&&"ETH"==s.assetType&&(a+=s.SelfBalance)}),__WEBPACK_IMPORTED_MODULE_0_Vue__.a.set(e.$store.state.vuexStore.balanceData.Channel,"TNC",e.keepDecimalPlaces(t/1e8,3)),__WEBPACK_IMPORTED_MODULE_0_Vue__.a.set(e.$store.state.vuexStore.balanceData.Channel,"ETH",e.keepDecimalPlaces(a/1e8,3))},showLoading:function(){loading=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)",target:document.querySelector(".appBox")})},closeLoading(){loading.close()},showSignOutBox(){this.isSignOutBoxShow=!0},SignOut(){this.$store.state.vuexStore.walletInfo={keyStore:"",publicKey:"",address:""},location.reload()},decryptPrivateKey(e,t){let a,s=this;try{a=web3.eth.accounts.decrypt(e,t)}catch(e){return"Key derivation failed - possibly wrong password"==e.message?(s.$notify.error({title:s.$t("common.warning"),dangerouslyUseHTMLString:!0,message:s.$t("common.callback-2"),duration:3e3}),!1):(s.$notify.error({title:s.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.message,duration:3e3}),!1)}return a},verifyPassword(e,t){let a;try{a=web3.eth.accounts.decrypt(e,t)}catch(e){return!1}return a},async signDataForERC20Contract(e,t,a,s,o,n){let r,i=this,l=a.join(",");if(a.length==s.length){console.log(e),console.log(t),console.log(`${t}(${l})`),console.log(a),console.log(s),console.log(o),console.log(n),console.log("________________________");let c=i.decryptPrivateKey(i.$store.state.vuexStore.walletInfo.keyStore,o);await web3.eth.getTransactionCount(i.$store.state.vuexStore.walletInfo.address,web3.eth.defaultBlock.pending).then(async function(o){console.log(o);let d=web3.eth.abi.encodeFunctionSignature(`${t}(${l})`);console.log(d);let h=web3.eth.abi.encodeParameters(a,s);console.log(h),"number"!=typeof n&&(n=i.$store.state.vuexStore.gasPrice);try{await web3.eth.estimateGas({to:e,from:i.$store.state.vuexStore.walletInfo.address,data:d+h.substr(2)}).then(function(t){if("number"==typeof t){console.log(t);var a={nonce:web3.utils.toHex(o++),gasPrice:web3.utils.toHex(n),gasLimit:web3.utils.toHex(t+5e3),to:e,from:i.$store.state.vuexStore.walletInfo.address,value:"0x00",data:d+h.substr(2)};console.log(a),r=signData(a,c.privateKey),console.log(r)}else console.log("模拟上链失败"),console.log(t)})}catch(e){console.log(e)}})}return r},ecSignForTrinityContract(dataTypeList,dataList,password){let _this=this,result;if(dataTypeList.length==dataList.length){console.log(dataTypeList),console.log(dataList),console.log(password),console.log("________________________");let decryptPK=_this.decryptPrivateKey(_this.$store.state.vuexStore.walletInfo.keyStore,password),soliditySha3Data="web3.utils.soliditySha3(";for(let e=0;e<dataTypeList.length;e++){let t="{'t' : dataTypeList["+e+"],'v' : dataList["+e+"]},";soliditySha3Data+=t}soliditySha3Data+=")",console.log(soliditySha3Data);let txData=eval(soliditySha3Data);console.log(txData);let signedData=ecSign(txData,decryptPK.privateKey);console.log(signedData),result={txData:txData,signedData:signedData}}else console.log("参数长度不一致"),result=!1;return console.log(result),result},uri2Ip(e,t){let a=e.split("@")[1];return a=null==t?a.split(":")[0]:a.split(":")[0]+":"+t},assetContractAddress2AssetType(e){let t="";if(console.log(this.$store.state.vuexStore.isTestNet),this.$store.state.vuexStore.isTestNet)switch(console.log(1),console.log(e),e){case"65096f2B7A8dc1592479F1911cd2B98dae4d2218":t="TNC";break;case"ETH":t="ETH";break;default:t=Error}else switch(e){case"65096f2B7A8dc1592479F1911cd2B98dae4d2218":t="TNC";break;case"ETH":t="0x602c79718b16e442de58778e148d0b1084e3b2dffd5de6b7b16cee7969282de7";break;default:t=Error}return console.log(t),t},AssetType2AssetContractAddress(e){let t="";if(this.$store.state.vuexStore.isTestNet)switch(e){case"TNC":t=this.$store.state.vuexStore.tncContractAddress;break;case"ETH":t="0x602c79718b16e442de58778e148d0b1084e3b2dffd5de6b7b16cee7969282de7";break;default:t=Error}else switch(e){case"TNC":t="08e8c4400f1af2c20c28e0018f29535eb85d15b6";break;case"ETH":t="0x602c79718b16e442de58778e148d0b1084e3b2dffd5de6b7b16cee7969282de7";break;default:t=Error}return t},AssetTypeToAssetId(e){let t="";if(console.log(this.$store.state.vuexStore.isTestNet),this.$store.state.vuexStore.isTestNet)switch(e){case"TNC":t="0x849d095d07950b9e56d0c895ec48ec5100cfdff1";break;case"GAS":t="0x602c79718b16e442de58778e148d0b1084e3b2dffd5de6b7b16cee7969282de7";break;case"NEO":t="0xc56f33fc6ecfcd0c225c4ab356fee59390af8560be0e930faebe74a6daff7c9b";break;default:t=Error}else switch(e){case"TNC":t="0x08e8c4400f1af2c20c28e0018f29535eb85d15b6";break;case"GAS":t="0x602c79718b16e442de58778e148d0b1084e3b2dffd5de6b7b16cee7969282de7";break;case"NEO":t="0xc56f33fc6ecfcd0c225c4ab356fee59390af8560be0e930faebe74a6daff7c9b";break;default:t=Error}return t},AssetTypeToAssetId1(e){let t="";if(this.$store.state.vuexStore.isTestNet)switch(e){case"TNC":t="849d095d07950b9e56d0c895ec48ec5100cfdff1";break;case"GAS":t="0x602c79718b16e442de58778e148d0b1084e3b2dffd5de6b7b16cee7969282de7";break;case"NEO":t="0xc56f33fc6ecfcd0c225c4ab356fee59390af8560be0e930faebe74a6daff7c9b";break;default:t=Error}else switch(e){case"TNC":t="08e8c4400f1af2c20c28e0018f29535eb85d15b6";break;case"GAS":t="0x602c79718b16e442de58778e148d0b1084e3b2dffd5de6b7b16cee7969282de7";break;case"NEO":t="0xc56f33fc6ecfcd0c225c4ab356fee59390af8560be0e930faebe74a6daff7c9b";break;default:t=Error}return t},AssetIdToAssetType(e){let t="";if(this.$store.state.vuexStore.isTestNet)switch(e){case"849d095d07950b9e56d0c895ec48ec5100cfdff1":t="TNC";break;case"602c79718b16e442de58778e148d0b1084e3b2dffd5de6b7b16cee7969282de7":t="GAS";break;case"c56f33fc6ecfcd0c225c4ab356fee59390af8560be0e930faebe74a6daff7c9b":t="NEO";break;default:t=Error}else switch(e){case"08e8c4400f1af2c20c28e0018f29535eb85d15b6":t="TNC";break;case"602c79718b16e442de58778e148d0b1084e3b2dffd5de6b7b16cee7969282de7":t="GAS";break;case"c56f33fc6ecfcd0c225c4ab356fee59390af8560be0e930faebe74a6daff7c9b":t="NEO";break;default:t=Error}return t},getChannelSerial(e,t,a,s){let o=this,n=-1;return o.$store.state.vuexStore.channelList.forEach(function(r,i){if(r[e]==t&&r.isTestNet==o.$store.state.vuexStore.isTestNet){if(null==a)return void(n=i);if("open"==a){if(3==r.State&&1==r.isConnect)return void(n=i);n=-2,!1!==s&&o.$notify.error({title:o.$t("common.warning"),dangerouslyUseHTMLString:!0,message:o.$t("common.callback-18"),duration:3e3})}}else n=-1,!1!==s&&o.$notify.error({title:o.$t("common.warning"),dangerouslyUseHTMLString:!0,message:o.$t("common.callback-17"),duration:3e3})}),n},cycleGetTransactionReceipt(e){let t=this;setTimeout(function(){web3.eth.getTransactionReceipt(e).then(function(a){return null==a?t.cycleGetTransactionReceipt(e):(console.log(a),1==a.status?(t.$notify({title:t.$t("common.success"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-4"),duration:3e3,type:"success"}),t.$store.state.vuexStore.recordList.forEach(function(e,s){e.transactionHash==a.transactionHash&&(e.blockHash=a.blockHash,e.state=1,console.log("修改状态成功"),t.StoreData("recordList"))}),t.$store.state.vuexStore.channelList.forEach(function(e,s){e.closeHash==a.transactionHash&&(t.$store.state.vuexStore.channelList.splice(s,1),t.StoreData("channelList"),console.log("存储通道信息"))}),a):0==a.status?(t.$notify({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-5"),duration:3e3,type:"error"}),t.$store.state.vuexStore.recordList.forEach(function(e,s){e.transactionHash==a.transactionHash&&(e.blockHash=a.blockHash,e.state=-1,console.log("修改状态成功"),t.StoreData("recordList"))}),a):void 0)})},4e3)},monitorEventByNodeUri(e,t){let a=this;for(var s=0;s<t.length;s++){console.log(t),console.log(t[0]);let o={messageType:t[s],walletAddress:a.$store.state.vuexStore.walletInfo.address,chainType:a.$store.state.vuexStore.baseChain,playload:e,comments:""};a.$store.state.vuexStore.NodeUriWebSocket.send(JSON.stringify(o))}},nodeUriWebsocketOnMessage(e){let t=this;if("connected to server"===e.data)t.loseWebSocketForNodeUriNotify&&t.loseWebSocketForNodeUriNotify.close(),console.log("连接全节点成功");else{let a=JSON.parse(e.data),s=a.messageType;switch(console.log(a),s){case"monitorAddress":t.OnMesMonitorAddress(a);break;case"monitorDeposit":t.OnMesMonitorDeposit(a);break;case"monitorQuickCloseChannel":t.OnMesMonitorQuickCloseChannel(a);break;case"monitorCloseChannel":t.OnMesMonitorCloseChannel(a);break;case"monitorUpdateTransaction":t.OnMesMonitorUpdateTransaction(a);break;case"monitorWithdraw":t.OnMesMonitorWithdraw(a);break;case"monitorWithdrawUpdate":t.OnMesMonitorWithdrawUpdate(a);break;case"monitorWithdrawSettle":t.OnMesMonitorWithdrawSettle(a)}}},OnMesMonitorAddress(e){this.$notify({title:this.$t("common.success"),dangerouslyUseHTMLString:!0,message:this.$t("common.callback-14"),duration:3e3,type:"success"}),console.log("收款")},OnMesMonitorDeposit(e){console.log(e);let t=this,a=t.getChannelSerial("ChannelName",e.channelId);if(console.log(a),null!==a){if(console.log(e.amountA),console.log(e.amountB),console.log(t.$store.state.vuexStore.channelList[a].SelfBalance),console.log(t.$store.state.vuexStore.channelList[a].OtherBalance),e.amountA==t.$store.state.vuexStore.channelList[a].SelfBalance&&e.amountB==t.$store.state.vuexStore.channelList[a].OtherBalance){t.$notify({title:t.$t("common.success"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-8"),duration:3e3,type:"success"});let e=t.$store.state.vuexStore.channelList[a];e.State=3,__WEBPACK_IMPORTED_MODULE_0_Vue__.a.set(t.$store.state.vuexStore.channelList,a,e),console.log(t.$store.state.vuexStore.channelList[a]),t.StoreData("channelList"),t.getChannelBalance()}}else t.$notify.error({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-7"),duration:3e3})},OnMesMonitorQuickCloseChannel(e){let t=this,a=t.getChannelSerial("ChannelName",e.channelId);console.log(a),null!==a?(console.log(e.amountA),console.log(e.amountB),console.log(t.$store.state.vuexStore.channelList[a].SelfBalance),console.log(t.$store.state.vuexStore.channelList[a].OtherBalance),e.amountA==t.$store.state.vuexStore.channelList[a].SelfBalance&&e.amountB==t.$store.state.vuexStore.channelList[a].OtherBalance&&(t.$notify({title:t.$t("common.success"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-9"),duration:3e3,type:"success"}),t.$store.state.vuexStore.channelList.splice(a,1),t.StoreData("channelList"),t.getChannelBalance())):t.$notify.error({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-7"),duration:3e3})},OnMesMonitorCloseChannel(e){let t=this,a=t.getChannelSerial("ChannelName",e.playload);if(e.invoker==t.$store.state.vuexStore.walletInfo.address.toLowerCase()){let s={messageType:"monitorSelfCloseChannel",baseChain:"ETH",channelName:e.playload,blockNumber:e.blockNumber,selfBalance:t.$store.state.vuexStore.channelList[a].SelfBalance,otherBalance:t.$store.state.vuexStore.channelList[a].OtherBalance};t.$store.state.vuexStore.eventList.push(s),t.StoreData("eventList"),console.log(t.$store.state.vuexStore.eventList)}else if(console.log("对端nonce:"+e.nonce),console.log("本端nonce:"+t.$store.state.vuexStore.channelList[a].TxNonce),t.$store.state.vuexStore.channelList[a].TxNonce<=e.nonce)t.$notify.info({title:t.$t("common.info"),dangerouslyUseHTMLString:!0,message:e.channelId+t.$t("common.callback-10"),duration:3e3});else{t.settleTransactionNotify=t.$notify({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.channelId+t.$t("common.callback-11"),duration:0,type:"error",onClick:function(){t.activeInfo.redata=data,t.isUpdateTransactionInfoBox=!0}})}},OnMesMonitorUpdateTransaction(e){let t=this.getChannelSerial("ChannelName",e.playload);this.$store.state.vuexStore.channelList.splice(t,1),this.StoreData("channelList"),this.$notify({title:this.$t("common.success"),dangerouslyUseHTMLString:!0,message:this.$t("common.callback-12"),duration:3e3,type:"success"})},OnMesMonitorWithdraw(e){let t=this;if(e.invoker==t.$store.state.vuexStore.walletInfo.address.toLowerCase()){let a={messageType:"monitorUnlockAmount",baseChain:"ETH",channelName:e.playload,blockNumber:e.blockNumber,HashR:e.lockHash};t.$store.state.vuexStore.eventList.push(a),t.StoreData("eventList")}else e.R&&(console.log(R),t.$store.state.vuexStore.txList.forEach(function(a,s){a.channelName==e.playload&&a.forEach(function(a,s){if(a.R==e.R&&void 0==a.delayBlock){t.WithdrawNotify=t.$notify({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.channelId+t.$t("common.callback-11"),duration:0,type:"error",onClick:function(){this.activeInfo.redata=a,this.isUpdateTransactionInfoBox=!0}})}})}))},OnMesMonitorWithdrawUpdate(e){},OnMesMonitorWithdrawSettle(e){let t=this;e.hashLock&&(console.log(e.hashLock),t.$store.state.vuexStore.txList.forEach(function(t,a){t.channelName==e.playload&&t.forEach(function(t,a){t.HashR==e.hashLock&&void 0!=t.delayBlock&&console.log("对端HTLC上链成功,更新余额")})}))},sendUpdateTransaction(){this.$refs.activeInfo.validate(e=>{this.sendUpdateTransactionFun()})},async sendUpdateTransactionFun(){let e,t,a=this,s=a.getChannelSerial("ChannelName",a.activeInfo.redata.channelName);"0x0"==a.activeInfo.redata.HashR&&"0x0"==a.activeInfo.redata.HashR?a.$store.state.vuexStore.txList.forEach(function(s,o){s.channelName==a.activeInfo.ChannelName&&s.history[s.history.length-1].founderSignedData&&s.history[s.history.length-1].peerSignedData&&(console.log(s.history[s.history.length-1].founder),console.log(a.$store.state.vuexStore.walletInfo.address),s.history[s.history.length-1].founder==a.$store.state.vuexStore.walletInfo.address?(console.log("本端为founder"),e=s.history[s.history.length-1].founderSignedData,t=s.history[s.history.length-1].peerSignedData):(console.log("对端为founder"),t=s.history[s.history.length-1].founderSignedData,e=s.history[s.history.length-1].peerSignedData))}):a.$store.state.vuexStore.txList.forEach(function(s,o){s.channelName==a.activeInfo.ChannelName&&s.history.forEach(function(s,o){s.HashR==a.activeInfo.redata.HashR&&void 0==s.delayBlock&&(e=s.founderSignedData,t=s.peerSignedData)})});let o=[a.$store.state.vuexStore.channelList[s].ChannelName,a.$store.state.vuexStore.channelList[s].TxNonce,a.$store.state.vuexStore.channelList[s].OtherUri.split("@")[0],a.$store.state.vuexStore.channelList[s].OtherBalance,a.$store.state.vuexStore.walletInfo.address,a.$store.state.vuexStore.channelList[s].SelfBalance,void 0,void 0,t,e],n=await a.signDataForERC20Contract(a.$store.state.vuexStore.trinityContractAddress,"updateTransaction",["bytes32","uint256","address","uint256","address","uint256","bytes32","bytes32","bytes","bytes"],o,a.activeInfo.keyStorePass);console.log(n);(new Date).getTime();web3.eth.sendSignedTransaction("0x"+n).on("transactionHash",function(e){console.log(e),a.$notify({title:a.$t("common.success"),dangerouslyUseHTMLString:!0,message:a.$t("common.callback-14"),duration:3e3,type:"success"}),a.cycleGetTransactionReceipt(e),a.settleTransactionNotify.close(),a.isUpdateTransactionInfoBox=!1,a.activeInfo={channelName:"",keyStorePass:"",redata:"",txData:""},a.$refs.activeInfo.resetFields()}).on("receipt",console.log).on("error",function(e){console.log(e)})},nodeUriWebsocketClose(e){console.log("已断开websocket"),console.log(e)},getblockHeight(){let e=this;web3.eth.getBlockNumber().then(function(t){console.log("当前块高:"+t),e.$store.state.vuexStore.eventList.forEach(function(a,s){if(a.blockNumber<t&&t-a.blockNumber<5760)switch(console.log("监控到事件"+a.messageType),a.messageType){case"monitorSelfCloseChannel":e.OnMesMonitorSelfCloseChannel(a);break;case"monitorSendUnlockAmount":e.OnMesMonitorSendUnlockAmount(a);break;case"monitorUnlockAmount":e.OnMesMonitorUnlockAmount(a)}})})},blockHeightCycle(){setInterval(this.getblockHeight,6e4)},OnMesMonitorSelfCloseChannel(e){let t=this;if(void 0==t.selfCloseChannelNotify){t.selfCloseChannelNotify=t.$notify({title:t.$t("common.info"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-13"),duration:0,type:"info",onClick:function(){t.activeInfo.redata=e,t.isSettleTransactionInfoBox=!0}})}},sendSettleTransaction(){this.$refs.activeInfo.validate(e=>{this.sendSettleTransactionFun()})},async sendSettleTransactionFun(){let e=this;console.log(e.activeInfo.redata);let t=e.getChannelSerial("ChannelName",e.activeInfo.redata.channelName),a=[e.activeInfo.redata.channelName],s=await e.signDataForERC20Contract(e.$store.state.vuexStore.trinityContractAddress,"settleTransaction",["bytes32"],a,e.activeInfo.keyStorePass);console.log(s);let o=(new Date).getTime();web3.eth.sendSignedTransaction("0x"+s).on("transactionHash",function(a){console.log(a),e.$notify({title:e.$t("common.success"),dangerouslyUseHTMLString:!0,message:e.$t("common.callback-14"),duration:3e3,type:"success"});let s={date:o,name:e.$store.state.vuexStore.channelList[t].OtherUri.split("@")[0],Amount:e.$store.state.vuexStore.channelList[t].SelfBalance,assetType:"TNC",isOnChannel:!0,isPay:!0,state:0,isTestNet:e.$store.state.vuexStore.isTestNet,transactionHash:a,blockHash:""};e.$store.state.vuexStore.recordList.push(s),e.StoreData("recordList"),e.isSettleTransactionInfoBox=!1,e.SettleTransaction={blockNumber:"",keyStorePass:""},e.$store.state.vuexStore.channelList[t].closeHash=a,e.$store.state.vuexStore.eventList.forEach(function(a,s){a.channelName==e.$store.state.vuexStore.channelList[t].ChannelName&&(console.log("通道关闭,停止监听"),e.$store.state.vuexStore.eventList.splice(s,1),e.StoreData("eventList"))}),e.selfCloseChannelNotify.close(),e.cycleGetTransactionReceipt(a)}).on("receipt",console.log).on("error",function(e){console.log(e)})},OnMesMonitorSendUnlockAmount(e){let t=this;if(console.log(t.sendUnlockAmountNotify),void 0==t.sendUnlockAmountNotify){t.sendUnlockAmountNotify=t.$notify({title:"消息",dangerouslyUseHTMLString:!0,message:"HTLC已到达指定块高,可以申请解冻资产",duration:0,type:"info",onClick:function(){console.log(t.activeInfo.redata),t.activeInfo.redata=e,t.isSendUnlockAmountInfoBox=!0}})}},SendUnlockAmount(){this.$refs.activeInfo.validate(e=>{this.SendUnlockAmountFun()})},async SendUnlockAmountFun(){let e=this,t=e.activeInfo.redata;console.log(t);e.getChannelSerial("ChannelName",t.channelName);let a=[t.channelName,e.$store.state.vuexStore.walletInfo.address,t.data.peer,t.data.delayBlock,t.data.payment,t.data.HashR,t.data.founderDelayCommitment,t.data.peerDelayCommitment,t.data.R?t.data.R:"0x"+addPreZero(0,64)],s=await e.signDataForERC20Contract(e.$store.state.vuexStore.trinityContractAddress,"withdraw",["bytes32","address","address","uint256","uint256","bytes32","bytes","bytes","bytes32"],a,e.activeInfo.keyStorePass);console.log(s);(new Date).getTime();web3.eth.sendSignedTransaction("0x"+s).on("transactionHash",function(a){console.log(a),e.$notify({title:e.$t("common.success"),dangerouslyUseHTMLString:!0,message:e.$t("common.callback-14"),duration:3e3,type:"success"}),e.cycleGetTransactionReceipt(a),e.sendUnlockAmountNotify&&(e.sendUnlockAmountNotify.close(),e.sendUnlockAmountNotify=void 0),e.$store.state.vuexStore.eventList.forEach(function(a,s){a.channelName==t.channelName&&"monitorSendUnlockAmount"==a.messageType&&(console.log("withdraw成功,停止监听"),e.$store.state.vuexStore.eventList.splice(s,1),e.StoreData("eventList"))}),e.isSendUnlockAmountInfoBox=!1,e.activeInfo={channelName:"",keyStorePass:"",redata:"",txData:""},e.$refs.activeInfo.resetFields()}).on("receipt",console.log).on("error",function(e){console.log(e)})},OnMesMonitorUnlockAmount(e){let t=this;if(void 0==t.unlockAmountNotify){t.unlockAmountNotify=t.$notify({title:"消息",dangerouslyUseHTMLString:!0,message:"现在可以申请取回冻结的余额",duration:0,type:"info",onClick:function(){t.activeInfo.redata=e,console.log(t.activeInfo.redata),t.isUnlockAmountInfoBox=!0}})}},UnlockAmount(){this.$refs.activeInfo.validate(e=>{this.UnlockAmountFun()})},async UnlockAmountFun(){let e=this;console.log(e.activeInfo.redata);let t=[e.activeInfo.redata.channelName,e.activeInfo.redata.HashR],a=await e.signDataForERC20Contract(e.$store.state.vuexStore.trinityContractAddress,"withdrawSettle",["bytes32","bytes32"],t,e.activeInfo.keyStorePass);console.log(a);(new Date).getTime();web3.eth.sendSignedTransaction("0x"+a).on("transactionHash",function(t){console.log(t),e.$notify({title:e.$t("common.success"),dangerouslyUseHTMLString:!0,message:e.$t("common.callback-14"),duration:3e3,type:"success"}),e.unlockAmountNotify&&(e.unlockAmountNotify.close(),e.unlockAmountNotify=void 0),e.$store.state.vuexStore.eventList.forEach(function(t,a){t.channelName==e.activeInfo.redata.channelName&&"monitorUnlockAmount"==t.messageType&&(console.log("withdrawSettle,停止监听"),e.$store.state.vuexStore.eventList.splice(a,1),e.StoreData("eventList"))}),e.cycleGetTransactionReceipt(t)}).on("receipt",console.log).on("error",function(e){console.log(e)})},websocketOnmessage(e){let t=this,a=JSON.parse(e.data),s=a.MessageType;switch(console.log(a),s){case"FounderSign":t.OnMesFounderSign(a);break;case"Rsmc":t.OnMesRsmc(a);break;case"RsmcSign":t.OnMesRsmcSign(a);break;case"AckRouterInfo":t.OnMesAckRouterInfo(a);break;case"Htlc":t.OnMesHtlc(a);break;case"HtlcSign":t.OnMesHtlcSign(a);break;case"RResponse":t.OnMesRResponse(a);break;case"Settle":t.OnMesSettle(a);break;case"SettleSign":t.OnMesSettleSign(a);break;case"ChannelInfo":t.OnMesChannelInfo(a);break;case"AddChannel":t.OnMesAddChannel(a);break;case"DeleteChannel":t.OnMesDeleteChannel(a);break;case"Founder":t.OnMesFounder(a);break;case"UpdateChannel":t.OnMesUpdateChannel(a);break;case"RegisterChannelFail":t.OnMesRegisterChannelFail(a)}},async OnMesFounderSign(e){let t=this;if("ETH"==t.$store.state.vuexStore.baseChain)if("RESPONSE_OK"==e.Status)if(console.log(t.$store.state.vuexStore.addChannelInfo.txData),console.log(e.MessageBody.Commitment),console.log(e.Sender.split("@")[0].toLowerCase()),ecRecover(t.$store.state.vuexStore.addChannelInfo.txData,e.MessageBody.Commitment,e.Sender.split("@")[0].toLowerCase())){t.showLoading();let a=["address","uint256"],s=[t.$store.state.vuexStore.trinityDataContractAddress,t.$store.state.vuexStore.addChannelInfo.selfDeposit.mul(1e8)],o=await t.signDataForERC20Contract(t.$store.state.vuexStore.tncContractAddress,"approve",a,s,t.$store.state.vuexStore.addChannelInfo.keyStorePass);console.log(o),web3.eth.sendSignedTransaction("0x"+o).on("transactionHash",function(e){console.log(e)}).on("receipt",function(a){console.log(a),t.confirmOtherApprove(e)}).on("error",function(e){console.log(e),t.$notify.error({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e,duration:3e3}),t.closeLoading()})}else console.log("对端签名验证未通过,停止交易"),t.$notify({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:t.$t("common.verifyFail"),duration:3e3,type:"error"});else{console.log(e.Status),t.$notify.error({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.Status,duration:3e3});let a=t.getChannelSerial("ChannelName",e.ChannelName);t.$store.state.vuexStore.channelList.splice(a,1),t.StoreData("channelList")}else if("NEO"==t.$store.state.vuexStore.baseChain){if(t.getChannelSerial("ChannelName",e.ChannelName)>=0){let a=e.MessageBody,s=a.Founder.originalData.witness.replace("{signOther}",a.Founder.txDataSign).replace("{signSelf}",t.$store.state.vuexStore.addChannelInfo.selfSignedData),o=a.Founder.originalData.txData+s;axios({method:"post",url:t.$store.state.vuexStore.NodeRpcUri,headers:{"Content-Type":"application/json;charset=UTF-8"},data:JSON.stringify({jsonrpc:"2.0",method:"sendRawTx",params:[o],id:1})}).then(function(e){1==e.data.result?t.$notify({title:t.$t("common.success"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-14"),duration:3e3,type:"success"}):t.$notify.error({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:error,duration:3e3})})}}},confirmOtherApprove(e){let t=this;setTimeout(function(){web3.eth.getGasPrice().then(function(a){var s=new web3.eth.Contract(t.$store.state.vuexStore.tncContractAbi,t.$store.state.vuexStore.tncContractAddress,{from:t.$store.state.vuexStore.walletInfo.address,gasPrice:t.$store.state.vuexStore.gasPrice});s.methods.balanceOf(e.Sender.split("@")[0]).call({from:e.Sender.split("@")[0]},function(a,o){if(a)console.log(a);else{if(console.log(o),!(o>t.$store.state.vuexStore.addChannelInfo.otherDeposit.mul(1e8)))return t.$notify.error({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-16"),duration:0}),!1;s.methods.allowance(e.Sender.split("@")[0],t.$store.state.vuexStore.trinityDataContractAddress).call({from:t.$store.state.vuexStore.walletInfo.address},function(a,s){console.log(s),s>=t.$store.state.vuexStore.addChannelInfo.otherDeposit.mul(1e8)?(t.sendDeposit(e),t.closeLoading()):t.confirmOtherApprove(e)})}})})},3e3)},async sendDeposit(e){console.log(e);let t=this,a=[t.$store.state.vuexStore.addChannelInfo.channelName,1,t.$store.state.vuexStore.walletInfo.address,t.$store.state.vuexStore.addChannelInfo.selfDeposit.mul(1e8),t.$store.state.vuexStore.addChannelInfo.uri.split("@")[0],t.$store.state.vuexStore.addChannelInfo.otherDeposit.mul(1e8),t.$store.state.vuexStore.addChannelInfo.selfSignedData,e.MessageBody.Commitment],s=await t.signDataForERC20Contract(t.$store.state.vuexStore.trinityContractAddress,"deposit",["bytes32","uint256","address","uint256","address","uint256","bytes","bytes"],a,t.$store.state.vuexStore.addChannelInfo.keyStorePass);console.log(s),console.log(e.MessageBody.Commitment);let o={channelName:t.$store.state.vuexStore.addChannelInfo.channelName,history:[{},{nonce:1,founder:t.$store.state.vuexStore.walletInfo.address,founderBalance:t.$store.state.vuexStore.addChannelInfo.selfDeposit.mul(1e8),peer:t.$store.state.vuexStore.addChannelInfo.uri.split("@")[0],peerBalance:t.$store.state.vuexStore.addChannelInfo.otherDeposit.mul(1e8),founderSignedData:t.$store.state.vuexStore.addChannelInfo.selfSignedData,peerSignedData:e.MessageBody.Commitment,HashR:0,R:0}]};t.$store.state.vuexStore.txList.push(o),t.StoreData("txList");let n=(new Date).getTime();web3.eth.sendSignedTransaction("0x"+s).on("transactionHash",function(e){console.log(e),t.$notify({title:t.$t("common.success"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-14"),duration:3e3,type:"success"});let a=t.getChannelSerial("ChannelName",t.$store.state.vuexStore.addChannelInfo.channelName);t.$store.state.vuexStore.channelList[a].transactionHash=e,t.StoreData("channelList");let s={date:n,name:t.$store.state.vuexStore.addChannelInfo.uri.split("@")[0],Amount:t.$store.state.vuexStore.addChannelInfo.selfDeposit.mul(1e8),assetType:"TNC",isOnChannel:!1,isPay:!0,state:0,isTestNet:t.$store.state.vuexStore.isTestNet,transactionHash:e,blockHash:""};t.$store.state.vuexStore.recordList.push(s);let o={date:n,name:t.$store.state.vuexStore.addChannelInfo.uri.split("@")[0],Amount:t.$store.state.vuexStore.addChannelInfo.selfDeposit.mul(1e8),assetType:"TNC",isOnChannel:!0,isPay:!1,state:0,isTestNet:t.$store.state.vuexStore.isTestNet,transactionHash:e,blockHash:""};t.$store.state.vuexStore.recordList.push(o),t.StoreData("recordList"),t.cycleGetTransactionReceipt(e)}).on("receipt",console.log).on("error",function(e){console.log(e);let a=t.getChannelSerial("ChannelName",t.$store.state.vuexStore.addChannelInfo.channelName);t.$store.state.vuexStore.channelList.splice(a,1),t.StoreData("channelList")});t.monitorEventByNodeUri(e.ChannelName,["monitorDeposit","monitorQuickCloseChannel","monitorCloseChannel","monitorUpdateTransaction","monitorWithdraw","monitorWithdrawUpdate","monitorWithdrawSettle"]),t.$store.state.vuexStore.txOnChannelInfo=[]},OnMesAddChannel(e){if("ETH"==this.$store.state.vuexStore.baseChain&&null==this.$store.state.vuexStore.baseChain.NodeUriWebSocket){let t=this.getChannelSerial("ChannelName",e.MessageBody.ChannelName);console.log(t);let a=this.$store.state.vuexStore.channelList[t];console.log(a),a.State=3,__WEBPACK_IMPORTED_MODULE_0_Vue__.a.set(this.$store.state.vuexStore.channelList,t,a),console.log(this.$store.state.vuexStore.channelList[t]),this.StoreData("channelList"),this.getChannelBalance()}else if("NEO"==this.$store.state.vuexStore.baseChain){let t=this.getChannelSerial("ChannelName",e.MessageBody.ChannelName);if(t>=0){let a=this.$store.state.vuexStore.channelList[t];console.log(a),a.State=3,__WEBPACK_IMPORTED_MODULE_0_Vue__.a.set(this.$store.state.vuexStore.channelList,t,a),console.log(this.$store.state.vuexStore.channelList[t]),this.StoreData("channelList"),this.getChannelBalance(),this.$notify({title:this.$t("common.success"),dangerouslyUseHTMLString:!0,message:this.$t("common.callback-8"),duration:3e3,type:"success"});let s={channelName:this.$store.state.vuexStore.addChannelInfo.channelName,history:[{},{nonce:1,founder:this.$store.state.vuexStore.walletInfo.address,founderBalance:this.$store.state.vuexStore.addChannelInfo.selfDeposit.mul(1e8),peer:this.$store.state.vuexStore.addChannelInfo.uri.split("@")[0],peerBalance:this.$store.state.vuexStore.addChannelInfo.otherDeposit.mul(1e8),founderSignedData:this.$store.state.vuexStore.addChannelInfo.selfSignedData,peerSignedData:e.MessageBody.Commitment,HashR:0,R:0,addressFunding:this.$store.state.vuexStore.addChannelInfo.addressFunding,scriptFunding:this.$store.state.vuexStore.addChannelInfo.scriptFunding,txId:this.$store.state.vuexStore.addChannelInfo.txId}]};this.$store.state.vuexStore.txList.push(s),this.StoreData("txList")}}},OnMesRsmc(e){var t=this;console.log(t.$store.state.vuexStore.baseChain);let a=t.getChannelSerial("ChannelName",e.ChannelName,"open");if(console.log(t.$store.state.vuexStore.baseChain),"ETH"==t.$store.state.vuexStore.baseChain){if(a>=0){function s(){t.activeInfo.redata=e,console.log(t.activeInfo.redata),t.isReceiptRsmcInfoBox=!0}t.activeInfo.redata=e,t.activeInfo.redata.PaymentCount=e.MessageBody.PaymentCount,t.receiptRsmcNotify=t.$notify.info({title:t.$t("common.info"),duration:0,dangerouslyUseHTMLString:!0,message:t.$store.state.vuexStore.channelList[a].Alice+t.$t("common.callback-19"),onClick:s})}}else if("NEO"==t.$store.state.vuexStore.baseChain){console.log("NEO  RSMC");let o,n,r,i=e.MessageBody;if(0==i.RoleIndex){if(a>=0){function s(){t.activeInfo.redata=e,console.log(t.activeInfo.redata),t.isReceiptRsmcInfoBox=!0}t.activeInfo.redata=e,t.activeInfo.redata.PaymentCount=Number(e.MessageBody.Value).mul(1e8),t.receiptRsmcNotify=t.$notify.info({title:t.$t("common.info"),duration:0,dangerouslyUseHTMLString:!0,message:t.$store.state.vuexStore.channelList[a].Alice+t.$t("common.callback-19"),onClick:s})}return!1}3!=i.RoleIndex&&2!=i.RoleIndex||i.BreachRemedy&&t.$store.state.vuexStore.txList.forEach(function(t,a){if(t.channelName==e.ChannelName)return t.BreachRemedy=i.BreachRemedy,!1}),console.log(t.$store.state.vuexStore.txOnChannelInfo);try{r=scrypt_module_factory(DecryptWalletByPassword,{},{WalletScript:t.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].key,password:t.$store.state.vuexStore.txOnChannelInfo.keyStorePass,address:t.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].address})}catch(e){return t.$notify.error({title:t.$t("loginByKeyStore.callback-9"),dangerouslyUseHTMLString:!0,message:t.$t("loginByKeyStore.callback-8"),duration:3e3}),!1}console.log(r),i.Commitment&&(o=signatureData(i.Commitment.txData,r)),i.RevocableDelivery&&(n=signatureData(i.RevocableDelivery.txData,r));let l={MessageType:"RsmcSign",Sender:e.Receiver,Receiver:e.Sender,ChannelName:e.ChannelName,TxNonce:e.TxNonce,MessageBody:{Commitment:{txDataSign:o,originalData:i.Commitment},RevocableDelivery:{txDataSign:n,originalData:i.RevocableDelivery},AssetType:e.MessageBody.AssetType,Value:e.MessageBody.Value,RoleIndex:e.MessageBody.RoleIndex,Comments:e.MessageBody.Comments}};if((o||n)&&(t.$store.state.vuexStore.channelList[a].websock.send(JSON.stringify(l)),console.log(l)),1==i.RoleIndex||2==i.RoleIndex){let s;i.RevocableDelivery&&(s=signatureData(t.$store.state.vuexStore.txOnChannelInfo.BreachRemedy.txData,r));let o={MessageType:"Rsmc",Sender:e.Receiver,Receiver:e.Sender,ChannelName:e.ChannelName,TxNonce:e.TxNonce,MessageBody:{BreachRemedy:{txDataSign:s,originalData:t.$store.state.vuexStore.txOnChannelInfo.BreachRemedy},AssetType:e.MessageBody.AssetType,Value:e.MessageBody.Value,RoleIndex:e.MessageBody.RoleIndex+1,Comments:e.MessageBody.Comments}};t.$store.state.vuexStore.channelList[a].websock.send(JSON.stringify(o)),console.log(o)}}},RsmcSign(){let e=this;e.$refs.activeInfo.validate(t=>{if(!t)return console.log("error submit!!"),!1;if("ETH"==e.$store.state.vuexStore.baseChain){let t,a,s=e.getChannelSerial("ChannelName",e.activeInfo.redata.ChannelName,"open");console.log(e.activeInfo.redata.MessageBody),void 0==e.activeInfo.redata.MessageBody.HashR?t=Number(e.$store.state.vuexStore.channelList[s].OtherBalance)-Number(e.activeInfo.redata.MessageBody.PaymentCount):(t=Number(e.$store.state.vuexStore.channelList[s].OtherBalance),e.$store.state.vuexStore.RList.forEach(function(t,s){t.Hr===e.activeInfo.redata.MessageBody.HashR&&(console.log(t.Hr),a=t.R)}),console.log("R:"+a));let o=["bytes32","uint256","address","uint256","address","uint256","bytes32","bytes32"],n=[e.$store.state.vuexStore.channelList[s].ChannelName,e.$store.state.vuexStore.channelList[s].TxNonce+1,e.$store.state.vuexStore.channelList[s].OtherUri.split("@")[0],t,e.$store.state.vuexStore.walletInfo.address,Number(e.$store.state.vuexStore.channelList[s].SelfBalance)+Number(e.activeInfo.redata.MessageBody.PaymentCount),e.activeInfo.redata.MessageBody.HashR?e.activeInfo.redata.MessageBody.HashR:"0x"+addPreZero(0,64),a||"0x"+addPreZero(0,64)],r=e.ecSignForTrinityContract(o,n,e.activeInfo.keyStorePass);r||console.log("签名失败"),e.activeInfo.txData=r.txData,console.log(e.activeInfo);let i={MessageType:"RsmcSign",Sender:e.activeInfo.redata.Receiver,Receiver:e.activeInfo.redata.Sender,TxNonce:e.$store.state.vuexStore.channelList[s].TxNonce+1,ChannelName:e.activeInfo.redata.ChannelName,NetMagic:e.$store.state.vuexStore.NetMagic,AssetType:e.$store.state.vuexStore.channelList[s].assetType,MessageBody:{PaymentCount:e.activeInfo.redata.PaymentCount,SenderBalance:t,ReceiverBalance:Number(e.$store.state.vuexStore.channelList[s].SelfBalance)+Number(e.activeInfo.redata.MessageBody.PaymentCount),HashR:e.activeInfo.redata.MessageBody.HashR,Commitment:r.signedData,RoleIndex:0},Comments:{},Status:"RESPONSE_OK"};e.$store.state.vuexStore.channelList[s].websock.send(JSON.stringify(i)),e.activeInfo.redata.selfSignedData=r.signedData,e.isReceiptRsmcInfoBox=!1,e.receiptRsmcNotify.close()}else if("NEO"==e.$store.state.vuexStore.baseChain){let t,a,s,o=e.getChannelSerial("ChannelName",e.activeInfo.redata.ChannelName,"open");console.log(e.activeInfo);try{s=scrypt_module_factory(DecryptWalletByPassword,{},{WalletScript:e.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].key,password:e.activeInfo.keyStorePass,address:e.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].address})}catch(t){return e.$notify.error({title:e.$t("loginByKeyStore.callback-9"),dangerouslyUseHTMLString:!0,message:e.$t("loginByKeyStore.callback-8"),duration:3e3}),!1}console.log(s);let n=e.activeInfo.redata;n.MessageBody.Commitment&&(t=signatureData(n.MessageBody.Commitment.txData,s)),n.MessageBody.RevocableDelivery&&(a=signatureData(n.MessageBody.RevocableDelivery.txData,s));let r,i,l,c={MessageType:"RsmcSign",Sender:n.Receiver,Receiver:n.Sender,ChannelName:n.ChannelName,TxNonce:n.TxNonce,MessageBody:{Commitment:{txDataSign:t,originalData:n.MessageBody.Commitment},RevocableDelivery:{txDataSign:a,originalData:n.MessageBody.RevocableDelivery},AssetType:n.MessageBody.AssetType,Value:n.MessageBody.Value,RoleIndex:n.MessageBody.RoleIndex,Comments:n.MessageBody.Comments}};(t||a)&&(e.$store.state.vuexStore.channelList[o].websock.send(JSON.stringify(c)),console.log(c)),console.log(e.$store.state.vuexStore.channelList[o]);let d=Number(e.$store.state.vuexStore.channelList[o].SelfBalance).div(1e8),h=Number(e.$store.state.vuexStore.channelList[o].OtherBalance).div(1e8);console.log(e.$store.state.vuexStore.txList),e.$store.state.vuexStore.txList.forEach(function(e,t){e.channelName==n.ChannelName&&e.history.length&&(console.log(e.history[e.history.length-1]),r=e.history[e.history.length-1].txId,console.log(r),i=e.history[e.history.length-1].addressFunding,console.log(i),l=e.history[e.history.length-1].scriptFunding,console.log(l))}),axios({method:"post",url:e.$store.state.vuexStore.NodeRpcUri,headers:{"Content-Type":"application/json;charset=UTF-8"},data:JSON.stringify({jsonrpc:"2.0",method:"FunderTransaction",params:[n.Sender.split("@")[0],n.Receiver.split("@")[0],i,l,h,d,r,n.MessageBody.AssetType],id:1})}).then(function(t){console.log(t);let a={MessageType:"Rsmc",Sender:n.Receiver,Receiver:n.Sender,TxNonce:n.TxNonce,ChannelName:n.ChannelName,MessageBody:{Commitment:t.data.result.C_TX,RevocableDelivery:t.data.result.R_TX,AssetType:n.MessageBody.AssetType,Value:n.MessageBody.Value,RoleIndex:n.MessageBody.RoleIndex+1,Comments:n.MessageBody.Comments}};e.$store.state.vuexStore.channelList[o].websock.send(JSON.stringify(a)),console.log(JSON.stringify(a)),e.isReceiptRsmcInfoBox=!1,e.receiptRsmcNotify.close()})}})},OnMesRsmcSign:function(e){let t=this;if("ETH"==t.$store.state.vuexStore.baseChain)if("RESPONSE_OK"==e.Status){let a=t.getChannelSerial("ChannelName",e.ChannelName);if(console.log(a),-1==a)return void t.$notify.error({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-17"),duration:3e3});if(0==e.MessageBody.RoleIndex){let s,o;console.log(e),void 0==e.MessageBody.HashR?s=Number(t.$store.state.vuexStore.channelList[a].SelfBalance)-(Number(t.$store.state.vuexStore.txOnChannelInfo.value)+Number(t.$store.state.vuexStore.txOnChannelInfo.fee)):(s=Number(t.$store.state.vuexStore.channelList[a].SelfBalance),t.$store.state.vuexStore.RList.forEach(function(t,a){t.Hr===e.MessageBody.HashR&&(console.log(t.Hr),o=t.R)}),console.log("R:"+o));let n=["bytes32","uint256","address","uint256","address","uint256","bytes32","bytes32"],r=[t.$store.state.vuexStore.channelList[a].ChannelName,t.$store.state.vuexStore.channelList[a].TxNonce+1,t.$store.state.vuexStore.walletInfo.address,s,t.$store.state.vuexStore.channelList[a].OtherUri.split("@")[0],Number(t.$store.state.vuexStore.channelList[a].OtherBalance)+Number(t.$store.state.vuexStore.txOnChannelInfo.value)+Number(t.$store.state.vuexStore.txOnChannelInfo.fee),e.MessageBody.HashR?e.MessageBody.HashR:"0x"+addPreZero(0,64),e.MessageBody.R?e.MessageBody.R:"0x"+addPreZero(0,64)],i=t.ecSignForTrinityContract(n,r,t.$store.state.vuexStore.txOnChannelInfo.keyStorePass);if(!i)return console.log("签名失败"),!1;if(console.log(i.txData),console.log(e.MessageBody.Commitment),console.log(e.Sender.split("@")[0].toLowerCase()),ecRecover(i.txData,e.MessageBody.Commitment,e.Sender.split("@")[0].toLowerCase())){let o={MessageType:"RsmcSign",Sender:e.Receiver,Receiver:e.Sender,TxNonce:t.$store.state.vuexStore.channelList[a].TxNonce+1,ChannelName:e.ChannelName,NetMagic:t.$store.state.vuexStore.NetMagic,AssetType:t.$store.state.vuexStore.txOnChannelInfo.assetType,MessageBody:{PaymentCount:Number(t.$store.state.vuexStore.txOnChannelInfo.value)+Number(t.$store.state.vuexStore.txOnChannelInfo.fee),SenderBalance:s,ReceiverBalance:Number(t.$store.state.vuexStore.channelList[a].OtherBalance)+Number(t.$store.state.vuexStore.txOnChannelInfo.value)+Number(t.$store.state.vuexStore.txOnChannelInfo.fee),HashR:e.MessageBody.HashR,R:e.MessageBody.R,Commitment:i.signedData,RoleIndex:1},Comments:{},Status:"RESPONSE_OK"};t.$store.state.vuexStore.channelList[a].websock.send(JSON.stringify(o));let n=t.$store.state.vuexStore.channelList[a];n.SelfBalance=e.MessageBody.SenderBalance,n.OtherBalance=e.MessageBody.ReceiverBalance,n.TxNonce+=1,__WEBPACK_IMPORTED_MODULE_0_Vue__.a.set(t.$store.state.vuexStore.channelList,a,n),console.log(t.$store.state.vuexStore.channelList[a]),t.StoreData("channelList");let r={nonce:t.$store.state.vuexStore.channelList[a].TxNonce,founder:t.$store.state.vuexStore.walletInfo.address,founderBalance:Number(t.$store.state.vuexStore.channelList[a].SelfBalance),peer:t.$store.state.vuexStore.channelList[a].OtherUri.split("@")[0],peerBalance:Number(t.$store.state.vuexStore.channelList[a].OtherBalance),founderSignedData:i.signedData,peerSignedData:e.MessageBody.Commitment,HashR:e.MessageBody.HashR?e.MessageBody.HashR:addPreZero(0,64),R:e.MessageBody.R?e.MessageBody.R:addPreZero(0,64)};t.newTxList(e.ChannelName,r),t.getChannelBalance(),console.log(e.MessageBody.HashR),e.MessageBody.HashR!=addPreZero(0,64)&&t.$store.state.vuexStore.eventList.forEach(function(a,s){a.HashR==e.MessageBody.HashR&&(console.log("H交易已完成,停止监听"),t.$store.state.vuexStore.eventList.splice(s,1),t.StoreData("eventList"))});let l={date:(new Date).getTime(),name:e.Sender.split("@")[0],Amount:Number(t.$store.state.vuexStore.txOnChannelInfo.value)+Number(t.$store.state.vuexStore.txOnChannelInfo.fee),assetType:t.$store.state.vuexStore.txOnChannelInfo.assetType,isOnChannel:!0,isPay:!0,state:1,isTestNet:t.$store.state.vuexStore.isTestNet,transactionHash:"none",blockHash:"none"};t.$store.state.vuexStore.recordList.push(l),t.StoreData("recordList"),t.isReceiptRsmcInfoBox=!1,t.$store.state.vuexStore.txOnChannelInfo=[],t.$notify({title:t.$t("common.success"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-20"),duration:3e3,type:"success"})}else console.log("对端签名验证未通过,停止交易"),t.$notify({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:t.$t("common.verifyFail"),duration:3e3,type:"error"})}else if(1==e.MessageBody.RoleIndex)if(ecRecover(t.activeInfo.txData,e.MessageBody.Commitment,e.Sender.split("@")[0].toLowerCase())){let s=t.$store.state.vuexStore.channelList[a];s.SelfBalance=e.MessageBody.ReceiverBalance,s.OtherBalance=e.MessageBody.SenderBalance,s.TxNonce+=1,__WEBPACK_IMPORTED_MODULE_0_Vue__.a.set(t.$store.state.vuexStore.channelList,a,s),console.log(t.$store.state.vuexStore.channelList[a]);let o={nonce:e.TxNonce,founder:e.Sender.split("@")[0],founderBalance:s.OtherBalance,peer:t.$store.state.vuexStore.walletInfo.address,peerBalance:s.SelfBalance,founderSignedData:e.MessageBody.Commitment,peerSignedData:t.activeInfo.redata.selfSignedData,HashR:e.MessageBody.HashR?e.MessageBody.HashR:0,R:e.MessageBody.R?e.MessageBody.R:0};t.newTxList(e.ChannelName,o),t.StoreData("channelList"),t.getChannelBalance();let n=(new Date).getTime();console.log(Number(e.MessageBody.PaymentCount));let r={date:n,name:e.Sender.split("@")[0],Amount:Number(e.MessageBody.PaymentCount),assetType:e.MessageBody.AssetType,isOnChannel:!0,isPay:!1,state:1,isTestNet:t.$store.state.vuexStore.isTestNet,transactionHash:"none",blockHash:"none"};t.$store.state.vuexStore.recordList.push(r),t.StoreData("recordList"),t.receiptRsmcNotify.close(),t.$notify({title:t.$t("common.success"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-21"),duration:3e3,type:"success"}),t.activeInfo={redata:[],txData:"",keyStorePass:""}}else console.log("对端签名验证未通过,停止交易"),t.$notify({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:t.$t("common.verifyFail"),duration:3e3,type:"error"})}else console.log(e.Status);else"NEO"==t.$store.state.vuexStore.baseChain&&console.log("NEO")},OnMesAckRouterInfo:function(e){let t=this;if("ETH"==t.$store.state.vuexStore.baseChain){if(null===e.RouterInfo)return t.$notify.error({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-22"),duration:3e3}),t.$store.state.vuexStore.txOnChannelInfo=[],!1;{let t=this,s=e.RouterInfo.FullPath;console.log(t.$store.state.vuexStore.txOnChannelInfo),t.$store.state.vuexStore.txOnChannelInfo.receiverUri.split(":")[1]==t.$store.state.vuexStore.spvPort?(s.unshift([t.$store.state.vuexStore.txOnChannelInfo.sendUri,0]),s.push([t.$store.state.vuexStore.txOnChannelInfo.receiverUri,0])):s.unshift([t.$store.state.vuexStore.txOnChannelInfo.sendUri,0]);let o=0;for(var a=0;a<s.length-1;a++)o+=e.RouterInfo.FullPath[a][1];o=1e8*parseFloat(o).toFixed(8),t.$store.state.vuexStore.txOnChannelInfo.Router=s,t.$store.state.vuexStore.txOnChannelInfo.Next=e.RouterInfo.Next,t.$store.state.vuexStore.txOnChannelInfo.fee=o,console.log(t.$store.state.vuexStore.txOnChannelInfo),console.log(1),t.isFeeInfoBoxShow=!0}}else if("NEO"==t.$store.state.vuexStore.baseChain){if(null===e.RouterInfo)return t.$notify.error({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-22"),duration:3e3}),t.$store.state.vuexStore.txOnChannelInfo=[],!1;{let t=this,s=e.RouterInfo.FullPath;console.log(t.$store.state.vuexStore.txOnChannelInfo),t.$store.state.vuexStore.txOnChannelInfo.receiverUri.split(":")[1]==t.$store.state.vuexStore.spvPort?(s.unshift([t.$store.state.vuexStore.txOnChannelInfo.sendUri,0]),s.push([t.$store.state.vuexStore.txOnChannelInfo.receiverUri,0])):s.unshift([t.$store.state.vuexStore.txOnChannelInfo.sendUri,0]);let o=0;for(a=0;a<s.length-1;a++)o+=e.RouterInfo.FullPath[a][1];o=1e8*parseFloat(o).toFixed(8),t.$store.state.vuexStore.txOnChannelInfo.Router=s,t.$store.state.vuexStore.txOnChannelInfo.Next=e.RouterInfo.Next,t.$store.state.vuexStore.txOnChannelInfo.fee=o,console.log(t.$store.state.vuexStore.txOnChannelInfo),t.isFeeInfoBoxShow=!0}}},sendHtlcMes(){let e=this;if("ETH"==e.$store.state.vuexStore.baseChain){let t=e.getChannelSerial("OtherUri",e.$store.state.vuexStore.txOnChannelInfo.Next,"open");console.log(t),t>=0&&web3.eth.getBlockNumber().then(function(a){console.log(a);let s=a+15*(e.$store.state.vuexStore.txOnChannelInfo.Router.length-1);console.log(s);let o=e.uri2Ip(e.$store.state.vuexStore.txOnChannelInfo.Next,e.$store.state.vuexStore.spvPort),n=e.$store.state.vuexStore.walletInfo.address+"@"+o,r=Number(e.$store.state.vuexStore.txOnChannelInfo.value)+Number(e.$store.state.vuexStore.txOnChannelInfo.fee);console.log(r);let i=web3.utils.soliditySha3({t:"bytes32",v:e.$store.state.vuexStore.channelList[t].ChannelName},{t:"address",v:e.$store.state.vuexStore.walletInfo.address},{t:"address",v:e.$store.state.vuexStore.channelList[t].OtherUri.split("@")[0]},{t:"uint256",v:s},{t:"uint256",v:r},{t:"bytes32",v:e.$store.state.vuexStore.txOnChannelInfo.hr});console.log(i),console.log(e.$store.state.vuexStore.txOnChannelInfo.keyStorePass);let l=e.decryptPrivateKey(e.$store.state.vuexStore.walletInfo.keyStore,e.$store.state.vuexStore.txOnChannelInfo.keyStorePass),c=ecSign(i,l.privateKey);console.log(c);let d=web3.utils.soliditySha3({t:"bytes32",v:e.$store.state.vuexStore.channelList[t].ChannelName},{t:"uint256",v:e.$store.state.vuexStore.channelList[t].TxNonce+1},{t:"address",v:e.$store.state.vuexStore.walletInfo.address},{t:"uint256",v:Number(e.$store.state.vuexStore.channelList[t].SelfBalance)-Number(r)},{t:"address",v:e.$store.state.vuexStore.channelList[t].OtherUri.split("@")[0]},{t:"uint256",v:Number(e.$store.state.vuexStore.channelList[t].OtherBalance)},{t:"bytes32",v:addPreZero(0,64)},{t:"bytes32",v:addPreZero(0,64)});console.log(d),e.$store.state.vuexStore.txOnChannelInfo.txData=d;let h=ecSign(d,l.privateKey);console.log(h);let u={MessageType:"Htlc",Sender:n,Receiver:e.$store.state.vuexStore.txOnChannelInfo.Next,TxNonce:e.$store.state.vuexStore.channelList[t].TxNonce+1,ChannelName:e.$store.state.vuexStore.channelList[t].ChannelName,AssetType:e.$store.state.vuexStore.channelList[t].assetType,NetMagic:e.$store.state.vuexStore.NetMagic,Router:e.$store.state.vuexStore.txOnChannelInfo.Router,Next:e.$store.state.vuexStore.txOnChannelInfo.Next,MessageBody:{SenderBalance:Number(e.$store.state.vuexStore.channelList[t].SelfBalance)-Number(r),ReceiverBalance:Number(e.$store.state.vuexStore.channelList[t].OtherBalance),Commitment:h,Payment:Number(r),DelayBlock:s,DelayCommitment:c,HashR:e.$store.state.vuexStore.txOnChannelInfo.hr}};e.$store.state.vuexStore.channelList[t].websock.send(JSON.stringify(u)),e.$store.state.vuexStore.txOnChannelInfo.selfSignedData=h,e.$store.state.vuexStore.txOnChannelInfo.selfDelaySignedData=c,e.isFeeInfoBoxShow=!1})}else if("NEO"==e.$store.state.vuexStore.baseChain){let t=e.getChannelSerial("OtherUri",e.$store.state.vuexStore.txOnChannelInfo.Next,"open");if(console.log(t),t>=0){let a,s,o;console.log(e.$store.state.vuexStore.channelList[t]);let n=Number(e.$store.state.vuexStore.channelList[t].SelfBalance).div(1e8),r=Number(e.$store.state.vuexStore.channelList[t].OtherBalance).div(1e8);console.log(e.$store.state.vuexStore.txList),e.$store.state.vuexStore.txList.forEach(function(n,r){console.log(n.channelName),console.log(e.$store.state.vuexStore.channelList[t].ChannelName),console.log(n.history.length),n.channelName==e.$store.state.vuexStore.channelList[t].ChannelName&&n.history.length&&(console.log(n.history[n.history.length-1]),a=n.history[n.history.length-1].txId,console.log(a),s=n.history[n.history.length-1].addressFunding,console.log(s),o=n.history[n.history.length-1].scriptFunding,console.log(o))}),console.log(e.$store.state.vuexStore.txOnChannelInfo),axios({method:"post",url:e.$store.state.vuexStore.NodeRpcUri,headers:{"Content-Type":"application/json;charset=UTF-8"},data:JSON.stringify({jsonrpc:"2.0",method:"HTLCTransaction",params:[e.$store.state.vuexStore.NEOwalletInfo.publicKey,e.$store.state.vuexStore.txOnChannelInfo.Next.split("@")[0],Number(e.$store.state.vuexStore.txOnChannelInfo.value+e.$store.state.vuexStore.txOnChannelInfo.fee).div(1e8),n,r,e.$store.state.vuexStore.txOnChannelInfo.hr,s,o,e.$store.state.vuexStore.txOnChannelInfo.assetType],id:1})}).then(function(a){if(console.log(a),a){let s={MessageType:"Htlc",Sender:e.$store.state.vuexStore.channelList[t].SelfUri,Receiver:e.$store.state.vuexStore.txOnChannelInfo.Next,TxNonce:e.$store.state.vuexStore.channelList[t].TxNonce+1,ChannelName:e.$store.state.vuexStore.channelList[t].ChannelName,Router:e.$store.state.vuexStore.txOnChannelInfo.Router,Next:e.$store.state.vuexStore.txOnChannelInfo.Next,MessageBody:{HCTX:a.data.result.HCTX,RDTX:a.data.result.RDTX,HEDTX:a.data.result.HEDTX,HTTX:a.data.result.HTTX,HTDTX:a.data.result.HTDTX,HTRDTX:a.data.result.HTRDTX,RoleIndex:0,Comments:"",Count:Number(e.$store.state.vuexStore.txOnChannelInfo.value+e.$store.state.vuexStore.txOnChannelInfo.fee).div(1e8),AssetType:e.$store.state.vuexStore.txOnChannelInfo.assetType,HashR:e.$store.state.vuexStore.txOnChannelInfo.hr}};e.$store.state.vuexStore.channelList[t].websock.send(JSON.stringify(s)),console.log(JSON.stringify(s)),e.isFeeInfoBoxShow=!1}})}}},OnMesHtlc:function(e){var t=this;if("ETH"==t.$store.state.vuexStore.baseChain){let s=t.getChannelSerial("ChannelName",e.ChannelName,"open");if(-1==s)return!1;{function a(){t.activeInfo.redata=e,console.log(t.activeInfo.redata),t.isReceiptHtlcInfoBox=!0}t.activeInfo.redata=e,t.activeInfo.redata.PaymentCount=e.MessageBody.Payment,t.receiptHtlcNotify=t.$notify.info({title:t.$t("common.info"),duration:0,dangerouslyUseHTMLString:!0,message:t.$store.state.vuexStore.channelList[s].Alice+t.$t("common.callback-19"),onClick:a})}}else if("NEO"==t.$store.state.vuexStore.baseChain){let s=e.MessageBody,o=s.RoleIndex,n=t.getChannelSerial("ChannelName",e.ChannelName,"open");if(0==o&&n>=0){function a(){t.activeInfo.redata=e,console.log(t.activeInfo.redata),t.isReceiptHtlcInfoBox=!0}t.activeInfo.redata=e,t.activeInfo.redata.PaymentCount=e.MessageBody.Payment,t.receiptHtlcNotify=t.$notify.info({title:t.$t("common.info"),duration:0,dangerouslyUseHTMLString:!0,message:t.$store.state.vuexStore.channelList[n].Alice+t.$t("common.callback-19"),onClick:a})}else if(1==o&&n>=0){let a,o,r,i,l,c;console.log("收到roleindex为1的HTLC,回签"),console.log(t.$store.state.vuexStore.txOnChannelInfo.keyStorePass);try{a=scrypt_module_factory(DecryptWalletByPassword,{},{WalletScript:t.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].key,password:t.$store.state.vuexStore.txOnChannelInfo.keyStorePass,address:t.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].address})}catch(e){return t.$notify.error({title:t.$t("loginByKeyStore.callback-9"),dangerouslyUseHTMLString:!0,message:t.$t("loginByKeyStore.callback-8"),duration:3e3}),!1}console.log(a),s.HCTX&&(o=signatureData(s.HCTX.txData,a),console.log("HCTX_sig:"+o)),s.HTTX&&(r=signatureData(s.HTTX.txData,a),console.log("HTTX_sig:"+r)),s.HTDTX&&(i=signatureData(s.HTDTX.txData,a),console.log("HTDTX_sig:"+i)),s.HTRDTX&&(l=signatureData(s.HTRDTX.txData,a),console.log("HTRDTX_sig:"+l)),s.RDTX&&(c=signatureData(s.RDTX.txData,a),console.log("RDTX_sig:"+c));let d={MessageType:"HtlcSign",Sender:e.Receiver,Receiver:e.Sender,TxNonce:e.TxNonce,ChannelName:e.ChannelName,Router:e.Router,Next:e.Next,MessageBody:{HCTX:{txDataSign:o,originalData:s.HCTX},RDTX:{txDataSign:c,originalData:s.RDTX},HTDTX:{txDataSign:i,originalData:s.HTDTX},HETX:s.HETX,HERDTX:s.HERDTX,RoleIndex:s.RoleIndex,Comments:"",Count:s.Count,AssetType:s.AssetType,HashR:s.HashR}};t.$store.state.vuexStore.channelList[n].websock.send(JSON.stringify(d)),console.log(d)}}},HtlcSign(){let e=this;e.$refs.activeInfo.validate(t=>{if(!t)return console.log("error submit!!"),!1;if("ETH"==e.$store.state.vuexStore.baseChain){let t=e.getChannelSerial("ChannelName",e.activeInfo.redata.ChannelName,"open"),a=web3.utils.soliditySha3({t:"bytes32",v:e.$store.state.vuexStore.channelList[t].ChannelName},{t:"uint256",v:e.$store.state.vuexStore.channelList[t].TxNonce+1},{t:"address",v:e.$store.state.vuexStore.channelList[t].OtherUri.split("@")[0]},{t:"uint256",v:Number(e.$store.state.vuexStore.channelList[t].OtherBalance)-Number(e.activeInfo.redata.PaymentCount)},{t:"address",v:e.$store.state.vuexStore.walletInfo.address},{t:"uint256",v:Number(e.$store.state.vuexStore.channelList[t].SelfBalance)+Number(e.activeInfo.redata.PaymentCount)});console.log(a);let s=e.decryptPrivateKey(e.$store.state.vuexStore.walletInfo.keyStore,e.activeInfo.keyStorePass),o=ecSign(a,s.privateKey);console.log(o),console.log(e.activeInfo.redata.MessageBody.SenderBalance),console.log(Number(e.$store.state.vuexStore.channelList[t].OtherBalance)-Number(e.activeInfo.redata.PaymentCount)),console.log(e.activeInfo.redata.MessageBody.ReceiverBalance),console.log(Number(e.$store.state.vuexStore.channelList[t].SelfBalance)),e.activeInfo.redata.MessageBody.SenderBalance==e.$store.state.vuexStore.channelList[t].OtherBalance-Number(e.activeInfo.redata.PaymentCount)&&e.activeInfo.redata.MessageBody.ReceiverBalance==e.$store.state.vuexStore.channelList[t].SelfBalance&&web3.eth.getBlockNumber().then(function(a){console.log(a);let n=a+4*(e.activeInfo.redata.Router.length-1)*60*24;console.log(n);let r=web3.utils.soliditySha3({t:"bytes32",v:e.$store.state.vuexStore.channelList[t].ChannelName},{t:"uint256",v:e.$store.state.vuexStore.channelList[t].TxNonce+1},{t:"address",v:e.$store.state.vuexStore.channelList[t].OtherUri.split("@")[0]},{t:"address",v:e.$store.state.vuexStore.walletInfo.address},{t:"uint256",v:n},{t:"uint256",v:Number(e.activeInfo.redata.PaymentCount)},{t:"bytes32",v:e.activeInfo.redata.MessageBody.HashR});console.log(r),console.log(e.$store.state.vuexStore.txOnChannelInfo.keyStorePass);let i=ecSign(r,s.privateKey);console.log(i);let l={MessageType:"HtlcSign",Sender:e.activeInfo.redata.Receiver,Receiver:e.activeInfo.redata.Sender,TxNonce:e.$store.state.vuexStore.channelList[t].TxNonce+1,ChannelName:e.activeInfo.redata.ChannelName,AssetType:e.activeInfo.redata.AssetType,NetMagic:e.$store.state.vuexStore.NetMagic,Router:e.activeInfo.redata.Router,Next:e.activeInfo.redata.Sender,MessageBody:{SenderBalance:Number(e.$store.state.vuexStore.channelList[t].OtherBalance)-Number(e.activeInfo.redata.PaymentCount),ReceiverBalance:Number(e.$store.state.vuexStore.channelList[t].SelfBalance),Commitment:o,Payment:Number(e.activeInfo.redata.PaymentCount),DelayBlock:n,DelayCommitment:i,HashR:e.activeInfo.redata.MessageBody.HashR},Comments:{},Status:"RESPONSE_OK"};e.$store.state.vuexStore.channelList[t].websock.send(JSON.stringify(l));let c="";console.log("HashR:"+e.activeInfo.redata.MessageBody.HashR),e.$store.state.vuexStore.RList.forEach(function(t,a){t.Hr===e.activeInfo.redata.MessageBody.HashR&&(console.log(t.Hr),c=t.R)}),console.log("R:"+c);let d={nonce:e.$store.state.vuexStore.channelList[t].TxNonce+1,founder:e.$store.state.vuexStore.channelList[t].OtherUri.split("@")[0],founderBalance:Number(e.$store.state.vuexStore.channelList[t].OtherBalance)-Number(e.activeInfo.redata.PaymentCount),peer:e.$store.state.vuexStore.walletInfo.address,peerBalance:Number(e.$store.state.vuexStore.channelList[t].SelfBalance),founderSignedData:e.activeInfo.redata.MessageBody.Commitment,peerSignedData:o,delayBlock:n,payment:Number(e.activeInfo.redata.PaymentCount),HashR:e.activeInfo.redata.MessageBody.HashR,R:c,founderDelayCommitment:e.activeInfo.redata.MessageBody.DelayCommitment,peerDelayCommitment:i};e.newTxList(e.activeInfo.redata.ChannelName,d),console.log("此处回复RResponse");let h={MessageType:"RResponse",Sender:e.activeInfo.redata.Receiver,Receiver:e.activeInfo.redata.Sender,TxNonce:e.activeInfo.redata.TxNonce,ChannelName:e.activeInfo.redata.ChannelName,AssetType:e.activeInfo.redata.AssetType,NetMagic:e.$store.state.vuexStore.NetMagic,Router:e.activeInfo.redata.Router,Next:e.activeInfo.redata.Next,MessageBody:{RoleIndex:0,Comments:"",PaymentCount:e.activeInfo.redata.PaymentCount,AssetType:e.$store.state.vuexStore.AssetType,R:c,HashR:e.activeInfo.redata.MessageBody.HashR}};e.$store.state.vuexStore.channelList[t].websock.send(JSON.stringify(h));let u=e.$store.state.vuexStore.channelList[t];u.OtherBalance=Number(e.$store.state.vuexStore.channelList[t].OtherBalance)-Number(e.activeInfo.redata.PaymentCount),u.TxNonce+=1,__WEBPACK_IMPORTED_MODULE_0_Vue__.a.set(e.$store.state.vuexStore.channelList,t,u),console.log(e.$store.state.vuexStore.channelList[t]),e.StoreData("channelList"),e.activeInfo.keyStorePass="",e.isReceiptHtlcInfoBox=!1,e.receiptHtlcNotify.close()})}else if("NEO"==e.$store.state.vuexStore.baseChain){let t,a,s,o,n,r,i=e.activeInfo.redata,l=i.MessageBody,c=(l.RoleIndex,e.getChannelSerial("ChannelName",e.activeInfo.redata.ChannelName,"open"));try{t=scrypt_module_factory(DecryptWalletByPassword,{},{WalletScript:e.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].key,password:e.activeInfo.keyStorePass,address:e.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].address})}catch(t){return e.$notify.error({title:e.$t("loginByKeyStore.callback-9"),dangerouslyUseHTMLString:!0,message:e.$t("loginByKeyStore.callback-8"),duration:3e3}),!1}console.log(t),l.HCTX&&(a=signatureData(l.HCTX.txData,t),console.log("HCTX_sig:"+a)),l.HTTX&&(s=signatureData(l.HTTX.txData,t),console.log("HTTX_sig:"+s)),l.HTDTX&&(o=signatureData(l.HTDTX.txData,t),console.log("HTDTX_sig:"+o)),l.HTRDTX&&(n=signatureData(l.HTRDTX.txData,t),console.log("HTRDTX_sig:"+n)),l.RDTX&&(r=signatureData(l.RDTX.txData,t),console.log("RDTX_sig:"+r));let d,h,u,m={MessageType:"HtlcSign",Sender:i.Receiver,Receiver:i.Sender,TxNonce:i.TxNonce,ChannelName:i.ChannelName,Router:i.Router,Next:i.Next,MessageBody:{HCTX:{txDataSign:a,originalData:l.HCTX},RDTX:{txDataSign:r,originalData:l.RDTX},HTTX:{txDataSign:s,originalData:l.HTTX},HTRDTX:{txDataSign:n,originalData:l.HTRDTX},HEDTX:l.HEDTX,RoleIndex:l.RoleIndex,Comments:"",Count:l.Count,AssetType:l.AssetType,HashR:l.HashR}};e.$store.state.vuexStore.channelList[c].websock.send(JSON.stringify(m)),console.log(m),console.log(e.$store.state.vuexStore.channelList[c]);let f=Number(e.$store.state.vuexStore.channelList[c].SelfBalance).div(1e8),v=Number(e.$store.state.vuexStore.channelList[c].OtherBalance).div(1e8);console.log(e.$store.state.vuexStore.txList),e.$store.state.vuexStore.txList.forEach(function(e,t){e.channelName==i.ChannelName&&e.history.length&&(console.log(e.history[e.history.length-1]),d=e.history[e.history.length-1].txId,console.log(d),h=e.history[e.history.length-1].addressFunding,console.log(h),u=e.history[e.history.length-1].scriptFunding,console.log(u))}),axios({method:"post",url:e.$store.state.vuexStore.NodeRpcUri,headers:{"Content-Type":"application/json;charset=UTF-8"},data:JSON.stringify({jsonrpc:"2.0",method:"HTLCTransaction",params:[e.$store.state.vuexStore.NEOwalletInfo.publicKey,i.Sender.split("@")[0],l.Count,f,v,l.HashR,h,u,l.AssetType],id:1})}).then(function(a){console.log(a);let s=signatureData(a.data.result.HETX.txData,t),o=signatureData(a.data.result.HERDTX.txData,t),n={MessageType:"Htlc",Sender:i.Receiver,Receiver:i.Sender,TxNonce:i.TxNonce,ChannelName:i.ChannelName,Router:i.Router,Next:i.Next,MessageBody:{HCTX:a.data.result.HCTX,RDTX:a.data.result.RDTX,HTDTX:a.data.result.HTDTX,HETX:{txDataSign:s,originalData:a.data.result.HETX},HERDTX:{txDataSign:o,originalData:a.data.result.HERDTX},RoleIndex:l.RoleIndex+1,Comments:"",Count:l.Count,AssetType:l.AssetType,HashR:l.HashR}};e.$store.state.vuexStore.channelList[c].websock.send(JSON.stringify(n)),console.log(n)})}})},OnMesHtlcSign:function(e){let t=this;if("ETH"==t.$store.state.vuexStore.baseChain)if("RESPONSE_OK"==e.Status)if(console.log(t.$store.state.vuexStore.txOnChannelInfo.txData),ecRecover(t.$store.state.vuexStore.txOnChannelInfo.txData,e.MessageBody.Commitment,e.Sender.split("@")[0].toLowerCase())){let a=t.getChannelSerial("ChannelName",t.$store.state.vuexStore.txOnChannelInfo.ChannelName),s=t.$store.state.vuexStore.channelList[a];s.SelfBalance-=e.MessageBody.Payment,s.TxNonce+=1,__WEBPACK_IMPORTED_MODULE_0_Vue__.a.set(t.$store.state.vuexStore.channelList,a,s),console.log(t.$store.state.vuexStore.channelList[a]),t.StoreData("channelList"),t.getChannelBalance();let o={nonce:t.$store.state.vuexStore.channelList[a].TxNonce,founder:t.$store.state.vuexStore.walletInfo.address,founderBalance:Number(t.$store.state.vuexStore.channelList[a].SelfBalance),peer:t.$store.state.vuexStore.channelList[a].OtherUri.split("@")[0],peerBalance:Number(t.$store.state.vuexStore.channelList[a].OtherBalance),founderSignedData:t.$store.state.vuexStore.txOnChannelInfo.selfSignedData,peerSignedData:e.MessageBody.Commitment,delayBlock:e.MessageBody.DelayBlock,payment:Number(e.MessageBody.Payment),HashR:e.MessageBody.HashR,R:"",founderDelayCommitment:t.$store.state.vuexStore.txOnChannelInfo.selfDelaySignedData,peerDelayCommitment:e.MessageBody.DelayCommitment};t.newTxList(e.ChannelName,o);let n={messageType:"monitorSendUnlockAmount",baseChain:"ETH",channelName:e.ChannelName,blockNumber:e.MessageBody.DelayBlock,HashR:e.MessageBody.HashR,data:o};t.$store.state.vuexStore.eventList.push(n),t.StoreData("eventList")}else console.log(e.Status),t.$notify.error({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.Status,duration:3e3});else console.log(e.Status);else if("NEO"==t.$store.state.vuexStore.baseChain){let a=t.getChannelSerial("ChannelName",e.ChannelName,"open",!1),s=e.MessageBody,o=t.$store.state.vuexStore.channelList[a];if(o.TxNonce+=1,__WEBPACK_IMPORTED_MODULE_0_Vue__.a.set(t.$store.state.vuexStore.channelList,a,o),1==s.RoleIndex){let s="";if(console.log("HashR:"+t.activeInfo.redata.MessageBody.HashR),t.$store.state.vuexStore.RList.forEach(function(e,a){e.Hr==t.activeInfo.redata.MessageBody.HashR&&(console.log(e.Hr),s=e.R)}),console.log("R:"+s),console.log("此处回复RResponse"),!s)return;let o={MessageType:"RResponse",Sender:e.Receiver,Receiver:e.Sender,TxNonce:e.TxNonce,ChannelName:e.ChannelName,Router:e.RouterInfo,Next:e.Next,MessageBody:{RoleIndex:0,Comments:"",Count:e.MessageBody.Count,AssetType:e.MessageBody.AssetType,R:s,HR:e.MessageBody.HashR}};t.$store.state.vuexStore.channelList[a].websock.send(JSON.stringify(o))}}},OnMesRResponse:function(e){var t=this;if("ETH"==t.$store.state.vuexStore.baseChain){let a=web3.utils.keccak256(e.MessageBody.R);if(console.log(a),console.log(e.MessageBody.HashR),console.log(t.$store.state.vuexStore.txOnChannelInfo.hr),a==t.$store.state.vuexStore.txOnChannelInfo.hr){console.log("进入R交易");e.MessageBody;let a={R:e.MessageBody.R};t.updateTxList(e.ChannelName,a,e.MessageBody.HashR);let s=t.getChannelSerial("ChannelName",e.ChannelName);if(s>=0){console.log(s),console.log(t.$store.state.vuexStore.txOnChannelInfo);let a={MessageType:"RResponseAck",Sender:t.$store.state.vuexStore.txOnChannelInfo.sendUri,Receiver:e.Sender,TxNonce:t.$store.state.vuexStore.channelList[s].TxNonce+1,ChannelName:t.$store.state.vuexStore.channelList[s].ChannelName,NetMagic:t.$store.state.vuexStore.NetMagic,AssetType:t.$store.state.vuexStore.txOnChannelInfo.assetType,MessageBody:{HashR:e.MessageBody.HashR,R:e.MessageBody.R,PaymentCount:Number(t.$store.state.vuexStore.txOnChannelInfo.value)+Number(t.$store.state.vuexStore.txOnChannelInfo.fee)},Comments:{}};t.$store.state.vuexStore.channelList[s].websock.send(JSON.stringify(a));let o={MessageType:"Rsmc",Sender:t.$store.state.vuexStore.txOnChannelInfo.sendUri,Receiver:e.Sender,TxNonce:t.$store.state.vuexStore.channelList[s].TxNonce+1,ChannelName:t.$store.state.vuexStore.channelList[s].ChannelName,NetMagic:t.$store.state.vuexStore.NetMagic,AssetType:t.$store.state.vuexStore.txOnChannelInfo.assetType,MessageBody:{PaymentCount:Number(t.$store.state.vuexStore.txOnChannelInfo.value)+Number(t.$store.state.vuexStore.txOnChannelInfo.fee),SenderBalance:Number(t.$store.state.vuexStore.channelList[s].SelfBalance),ReceiverBalance:Number(t.$store.state.vuexStore.channelList[s].OtherBalance)+Number(t.$store.state.vuexStore.txOnChannelInfo.value)+Number(t.$store.state.vuexStore.txOnChannelInfo.fee),HashR:e.MessageBody.HashR,Commitment:""},Comments:{}};t.$store.state.vuexStore.channelList[s].websock.send(JSON.stringify(o)),t.StoreData("channelList")}}}else if("NEO"==t.$store.state.vuexStore.baseChain){let a=createHr(e.MessageBody.R);if(console.log(a),console.log(e.MessageBody.HR),a==e.MessageBody.HR){console.log("进入R交易");let a,s,o,n=t.getChannelSerial("ChannelName",e.ChannelName);console.log(t.$store.state.vuexStore.channelList[n]);let r=Number(t.$store.state.vuexStore.channelList[n].SelfBalance).div(1e8),i=Number(t.$store.state.vuexStore.channelList[n].OtherBalance).div(1e8);console.log(t.$store.state.vuexStore.txList),t.$store.state.vuexStore.txList.forEach(function(t,n){t.channelName==e.ChannelName&&t.history.length&&(console.log(t.history[t.history.length-1]),a=t.history[t.history.length-1].txId,console.log(a),s=t.history[t.history.length-1].addressFunding,console.log(s),o=t.history[t.history.length-1].scriptFunding,console.log(o))}),axios({method:"post",url:t.$store.state.vuexStore.NodeRpcUri,headers:{"Content-Type":"application/json;charset=UTF-8"},data:JSON.stringify({jsonrpc:"2.0",method:"FunderTransaction",params:[e.Sender.split("@")[0],t.$store.state.vuexStore.NEOwalletInfo.publicKey,s,o,i,r,a,e.MessageBody.AssetType],id:1})}).then(function(a){console.log(a);let s={MessageType:"Rsmc",Sender:e.Receiver,Receiver:e.Sender,TxNonce:e.TxNonce+1,ChannelName:e.ChannelName,MessageBody:{Commitment:a.data.result.C_TX,RevocableDelivery:a.data.result.R_TX,AssetType:e.MessageBody.AssetType,Value:e.MessageBody.Count,RoleIndex:0,Comments:e.MessageBody.HR}};t.$store.state.vuexStore.channelList[n].websock.send(JSON.stringify(s)),console.log(s),t.$store.state.vuexStore.txOnChannelInfo.BreachRemedy=a.data.result.BR_TX})}}},OnMesSettle:function(e){var t=this;let a=t.getChannelSerial("ChannelName",e.ChannelName,"open");if(-1==a)return t.$notify.error({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-17"),duration:3e3}),!1;if(-2==a)return t.$notify.error({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-18"),duration:3e3}),!1;t.activeInfo.redata=e,t.activeInfo.redata.ReceiverBalance=e.MessageBody.ReceiverBalance,t.activeInfo.redata.SenderBalance=e.MessageBody.SenderBalance,t.$notify.info({title:t.$t("common.info"),duration:0,dangerouslyUseHTMLString:!0,message:t.$store.state.vuexStore.channelList[a].Alice+t.$t("common.callback-19"),onClick:function(){t.activeInfo.redata=data,console.log(t.activeInfo.redata),t.isSettleInfoBox=!0}})},SettleSign(){let e=this;console.log(e.activeInfo.redata),e.$refs.activeInfo.validate(t=>{if(t){let t=e.getChannelSerial("ChannelName",e.activeInfo.redata.ChannelName,"open"),a=web3.utils.soliditySha3({t:"bytes32",v:e.$store.state.vuexStore.channelList[t].ChannelName},{t:"uint256",v:0},{t:"address",v:e.$store.state.vuexStore.channelList[t].OtherUri.split("@")[0]},{t:"uint256",v:Number(e.$store.state.vuexStore.channelList[t].OtherBalance)},{t:"address",v:e.$store.state.vuexStore.walletInfo.address},{t:"uint256",v:Number(e.$store.state.vuexStore.channelList[t].SelfBalance)});console.log(a);let s=e.decryptPrivateKey(e.$store.state.vuexStore.walletInfo.keyStore,e.activeInfo.keyStorePass),o=ecSign(a,s.privateKey);if(console.log(o),e.activeInfo.redata.SenderBalance!=e.$store.state.vuexStore.channelList[t].OtherBalance||e.activeInfo.redata.ReceiverBalance!=e.$store.state.vuexStore.channelList[t].SelfBalance)return console.log("error submit!!"),!1;{let a={MessageType:"SettleSign",NetMagic:e.activeInfo.redata.NetMagic,Receiver:e.activeInfo.redata.Sender,Sender:e.activeInfo.redata.Receiver,ChannelName:e.activeInfo.redata.ChannelName,AssetType:e.activeInfo.redata.MessageBody.AssetType,MessageBody:{Commitment:o},Status:"RESPONSE_OK",TxNonce:0};e.$store.state.vuexStore.channelList[t].websock.send(JSON.stringify(a)),e.isSettleInfoBox=!1,e.activeInfo={redata:[],txData:"",keyStorePass:""}}}})},async OnMesSettleSign(e){var t=this;if("ETH"==t.$store.state.vuexStore.baseChain)if("RESPONSE_OK"==e.Status)if(console.log(t.$store.state.vuexStore.closeChannelInfo.txData),ecRecover(t.$store.state.vuexStore.closeChannelInfo.txData,e.MessageBody.Commitment,e.Sender.split("@")[0].toLowerCase())){let a=["bytes32","uint256","address","uint256","address","uint256","bytes","bytes"],s=[t.$store.state.vuexStore.closeChannelInfo.ChannelName,0,t.$store.state.vuexStore.walletInfo.address,Number(t.$store.state.vuexStore.closeChannelInfo.SelfBalance),t.$store.state.vuexStore.closeChannelInfo.OtherUri.split("@")[0],Number(t.$store.state.vuexStore.closeChannelInfo.OtherBalance),t.$store.state.vuexStore.closeChannelInfo.selfSignedData,e.MessageBody.Commitment],o=await t.signDataForERC20Contract(t.$store.state.vuexStore.trinityContractAddress,"quickCloseChannel",a,s,t.$store.state.vuexStore.closeChannelInfo.keyStorePass);console.log(o);let n=(new Date).getTime();web3.eth.sendSignedTransaction("0x"+o,function(e,a){if(e)console.log(e);else{console.log(a),t.$notify({title:t.$t("common.success"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-14"),duration:3e3,type:"success"});let e={date:n,name:t.$store.state.vuexStore.closeChannelInfo.OtherUri.split("@")[0],Amount:t.$store.state.vuexStore.closeChannelInfo.SelfBalance,assetType:"TNC",isOnChannel:!0,isPay:!0,state:0,isTestNet:t.$store.state.vuexStore.isTestNet,transactionHash:a,blockHash:""};t.$store.state.vuexStore.recordList.push(e);let s={date:n,name:t.$store.state.vuexStore.trinityContractAddress,Amount:t.$store.state.vuexStore.closeChannelInfo.SelfBalance,assetType:"TNC",isOnChannel:!1,isPay:!1,state:0,isTestNet:t.$store.state.vuexStore.isTestNet,transactionHash:a,blockHash:""};t.$store.state.vuexStore.recordList.push(s),t.StoreData("recordList"),t.cycleGetTransactionReceipt(a)}})}else console.log("对端签名验证未通过,停止交易"),t.$notify({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:t.$t("common.verifyFail"),duration:3e3,type:"error"});else console.log(e.Status);else if("NEO"==t.$store.state.vuexStore.baseChain){console.log(t.$store.state.vuexStore.closeChannelInfo.witness);let a=t.$store.state.vuexStore.closeChannelInfo.witness.replace("{signSelf}",t.$store.state.vuexStore.closeChannelInfo.selfSignedData).replace("{signOther}",e.MessageBody.Settlement.txDataSign),s=t.$store.state.vuexStore.closeChannelInfo.txData+a;axios({method:"post",url:t.$store.state.vuexStore.NodeRpcUri,headers:{"Content-Type":"application/json;charset=UTF-8"},data:JSON.stringify({jsonrpc:"2.0",method:"sendRawTx",params:[s],id:1})}).then(function(e){console.log(e),"true"==e.data.result?t.$notify({title:t.$t("common.success"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-14"),duration:3e3,type:"success"}):console.log(e.data)})}},OnMesDeleteChannel(e){let t=this;if("ETH"==t.$store.state.vuexStore.baseChain);else if("NEO"==t.$store.state.vuexStore.baseChain){console.log("NEO删除通道");let a=t.getChannelSerial("ChannelName",e.MessageBody.ChannelName);t.$notify({title:t.$t("common.success"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-23"),duration:3e3,type:"success"}),t.$store.state.vuexStore.channelList.splice(a,1),t.StoreData("channelList"),t.getChannelBalance()}},OnMesChannelInfo(e){},OnMesFounder(e){var t=this;let a=t.getChannelSerial("ChannelName",e.ChannelName);if(console.log(t.$store.state.vuexStore.addChannelInfo),a>=0){let s=scrypt_module_factory(DecryptWalletByPassword,{},{WalletScript:t.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].key,password:t.$store.state.vuexStore.addChannelInfo.keyStorePass,address:t.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].address}),o=e.MessageBody;t.$store.state.vuexStore.addChannelInfo.selfSignedData=signatureData(o.Founder.txData,s);let n=signatureData(o.Commitment.txData,s),r=signatureData(o.RevocableDelivery.txData,s),i={MessageType:"FounderSign",Sender:e.Receiver,Receiver:e.Sender,ChannelName:e.ChannelName,TxNonce:e.TxNonce,MessageBody:{Founder:{txDataSign:t.$store.state.vuexStore.addChannelInfo.selfSignedData,originalData:o.Founder},Commitment:{txDataSign:n,originalData:o.Commitment},RevocableDelivery:{txDataSign:r,originalData:o.RevocableDelivery},AssetType:e.MessageBody.AssetType,Deposit:e.MessageBody.Deposit,RoleIndex:e.MessageBody.RoleIndex}};t.$store.state.vuexStore.channelList[a].websock.send(JSON.stringify(i)),axios({method:"post",url:t.$store.state.vuexStore.NodeRpcUri,headers:{"Content-Type":"application/json;charset=UTF-8"},data:JSON.stringify({jsonrpc:"2.0",method:"FunderTransaction",params:[e.Sender.split("@")[0],e.Receiver.split("@")[0],o.Founder.addressFunding,o.Founder.scriptFunding,e.MessageBody.Deposit,e.MessageBody.Deposit,o.Founder.txId,e.MessageBody.AssetType],id:1})}).then(function(s){let n={MessageType:"Founder",Sender:e.Receiver,Receiver:e.Sender,TxNonce:e.TxNonce,ChannelName:e.ChannelName,MessageBody:{Founder:o.Founder,Commitment:s.data.result.C_TX,RevocableDelivery:s.data.result.R_TX,AssetType:e.MessageBody.AssetType,Deposit:e.MessageBody.Deposit,RoleIndex:e.MessageBody.RoleIndex+1}};t.$store.state.vuexStore.channelList[a].websock.send(JSON.stringify(n)),t.$store.state.vuexStore.addChannelInfo.txId=o.Founder.txId,t.$store.state.vuexStore.addChannelInfo.addressFunding=o.Founder.addressFunding,t.$store.state.vuexStore.addChannelInfo.scriptFunding=o.Founder.scriptFunding}),t.$store.state.vuexStore.channelList[a].transactionHash=o.Founder.txId}},OnMesUpdateChannel(e){let t=this.getChannelSerial("ChannelName",e.MessageBody.ChannelName,"open",!1),a=this.$store.state.vuexStore.channelList[t],s=a.SelfUri,o=a.OtherUri;a.SelfBalance=Number(e.MessageBody.Balance[s].TNC).mul(1e8),a.OtherBalance=Number(e.MessageBody.Balance[o].TNC).mul(1e8),a.TxNonce+=1,__WEBPACK_IMPORTED_MODULE_0_Vue__.a.set(this.$store.state.vuexStore.channelList,t,a),console.log(this.$store.state.vuexStore.channelList[t]),this.$notify({title:this.$t("common.success"),dangerouslyUseHTMLString:!0,message:"余额更新",duration:3e3,type:"success"})},OnMesRegisterChannelFail(e){let t=this,a=t.getChannelSerial("ChannelName",e.ChannelName);a>=0&&(t.$store.state.vuexStore.channelList.splice(a,1),t.StoreData("channelList"),t.getChannelBalance(),t.$notify.error({title:t.$t("common.warning"),message:e.Error,duration:3e3}))},websocketClose(e){console.log("已断开websocket");let t=this,a=e.currentTarget.url.split("/")[2].split(":")[0];console.log(a);let s=t.getChannelSerial("Ip",a);if(console.log(s),null!==s){t.$notify.error({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:a+t.$t("common.callback-24"),duration:3e3});let e=t.$store.state.vuexStore.channelList[s];e.isConnect=!1,__WEBPACK_IMPORTED_MODULE_0_Vue__.a.set(t.$store.state.vuexStore.channelList,s,e)}},reconnectWebsocket(e,t){let a=this;const s="ws://"+e+"/";var o=a.getChannelSerial("ChannelName",t);if(console.log(o),o>=0){a.$store.state.vuexStore.channelList[o].websock=new WebSocket(s),a.$store.state.vuexStore.channelList[o].websock.onmessage=a.websocketOnmessage,a.$store.state.vuexStore.channelList[o].websock.onclose=a.websocketClose,a.$store.state.vuexStore.channelList[o].isConnect=!0,console.log(a.$store.state.vuexStore.channelList);let e={MessageType:"GetChannelInfo",Sender:a.$store.state.vuexStore.channelList[o].SelfUri,Magic:a.activeInfo.redata.NetMagic,MessageBody:{AssetType:"TNC"}};setTimeout(function(){a.$store.state.vuexStore.channelList[o].websock.send(JSON.stringify(e))},2e3)}},StoreData(e){console.log(this.$store.state.vuexStore[e]),"ETH"==this.$store.state.vuexStore.baseChain?this.saveAsArray(this.$store.state.vuexStore.walletInfo.address+"@"+e,this.$store.state.vuexStore[e]):"NEO"==this.$store.state.vuexStore.baseChain&&this.saveAsArray(this.$store.state.vuexStore.NEOwalletInfo.address+"@"+e,this.$store.state.vuexStore[e])},newTxList(e,t){let a=this;a.$store.state.vuexStore.txList.forEach(function(s,o){s.channelName==e&&(console.log("增加交易数据"),s.history.push(t)),a.StoreData("txList")})},updateTxList(e,t,a){this.$store.state.vuexStore.txList.forEach(function(s,o){s.channelName==e&&(console.log("更新H交易数据"),s.history.forEach(function(e,s){if(e.HashR==a)for(var o in t)e[o]=t[o]}))}),this.StoreData("txList")}}}},yfsC:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIsAAAAwCAYAAAAhFIlJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTFBOEQ1MkNCQTI3MTFFODgyMjBBQjhBN0Y2RjZEODQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MkMzQjM2QzhCQTI3MTFFODgyMjBBQjhBN0Y2RjZEODQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDoxMUE4RDUyQUJBMjcxMUU4ODIyMEFCOEE3RjZGNkQ4NCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDoxMUE4RDUyQkJBMjcxMUU4ODIyMEFCOEE3RjZGNkQ4NCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PryQJ+oAABFvSURBVHja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"}},["NHnr"]);