webpackJsonp([1],{"+4aq":function(e,t){},"+vE3":function(e,t){},"0NEh":function(e,t,a){"use strict";a("TXMN");var s=a("qKYu"),n={name:"config",data:()=>({}),computed:{isTestNet(){return this.$store.state.vuexStore.isTestNet},address(){return"ETH"==this.$store.state.vuexStore.baseChain?this.$store.state.vuexStore.walletInfo.address:"NEO"==this.$store.state.vuexStore.baseChain?this.$store.state.vuexStore.NEOwalletInfo.address:void 0},baseChain(){return this.$store.state.vuexStore.baseChain},isLogin(){return this.$store.state.vuexStore.isLogin}},watch:{"$store.state.vuexStore.baseChain":"UpdateConfig","$store.state.vuexStore.isTestNet":"UpdateConfig"},mounted(){this.$nextTick(function(){let e=this,t=e.$parent.fetchAsString("isLogin");console.log(t),e.$store.state.vuexStore.isLogin="true"===t,console.log(e.$store.state.vuexStore.isLogin);let a=e.$parent.fetchAsString("isTestNet");console.log(a),e.$store.state.vuexStore.isTestNet="true"===a,console.log(e.$store.state.vuexStore.isTestNet),e.$store.state.vuexStore.baseChain=e.$parent.fetchAsString("baseChain")||"ETH",console.log(e.baseChain);let s={keyStore:"",publicKey:"",address:"",keyStorePass:""};"ETH"==e.baseChain?(e.$store.state.vuexStore.walletInfo=e.$parent.fetchAsArray("walletInfo"),e.$store.state.vuexStore.walletInfo.length&&(e.$store.state.vuexStore.walletInfo=s),console.log(e.$store.state.vuexStore.walletInfo)):"NEO"==e.baseChain&&(e.$store.state.vuexStore.NEOwalletInfo=e.$parent.fetchAsArray("walletInfo")||s,console.log(e.$store.state.vuexStore.NEOwalletInfo)),e.$store.state.vuexStore.isLogin?e.$router.push("/back"):e.$router.push("/start"),e.getConfig()}),s.a.$on("getAddressInfo",e=>{this.getAddressInfo()})},methods:{getConfig(){let e=this;if(configData){let t;t=e.$store.state.vuexStore.isTestNet?"testNet":"mainNet",console.log(t),"ETH"==e.baseChain?(console.log("切换到ETH"),web3=new Web3(new Web3.providers.HttpProvider(configData.ETH[t].web3)),e.$store.state.vuexStore.NodeUriWebSocketIp=configData.ETH[t].NodeUriWebSocketIp,e.$store.state.vuexStore.NetMagic=configData.ETH[t].NetMagic,e.$store.state.vuexStore.spvPort=configData.ETH[t].spvPort,e.$store.state.vuexStore.delayBlock=configData.ETH[t].delayBlock,e.$store.state.vuexStore.nodeWebSocketIp=configData.ETH[t].nodeWebSocketIp,e.$store.state.vuexStore.tncContractAddress=configData.ETH[t].tncContractAddress,e.$store.state.vuexStore.trinityDataContractAddress=configData.ETH[t].trinityDataContractAddress,e.$store.state.vuexStore.trinityContractAddress=configData.ETH[t].trinityContractAddress,e.$store.state.vuexStore.tncContractAbi=configData.ETH.tncContractAbi,e.$store.state.vuexStore.trinityContractAbi=configData.ETH.trinityContractAbi):"NEO"==e.baseChain&&(console.log("切换到NEO"),e.$store.state.vuexStore.NetMagic=configData.NEO[t].NetMagic,e.$store.state.vuexStore.NodeRpcUri=configData.NEO[t].NodeRpcUri,e.$store.state.vuexStore.spvPort=configData.NEO[t].spvPort),setTimeout(function(){e.$parent.connectWebSocketForNodeUri(),e.getAddressInfo()},1500),e.$parent.saveAsString("baseChain",e.$store.state.vuexStore.baseChain),e.$parent.saveAsString("isTestNet",e.$store.state.vuexStore.isTestNet)}else console.log("获取配置文件失败")},UpdateConfig(){console.log(this.address),console.log(this.$store.state.vuexStore.isLogin),console.log(this.$store.state.vuexStore.baseChain),this.getConfig()},getAddressInfo(){let e=this;console.log(e.baseChain);let t=e.$parent.fetchAsArray(e.address+"@channelList");console.log(t);let a=[];t&&t.forEach(function(e,t){void 0!=e.transactionHash&&a.push(e)}),e.$store.state.vuexStore.channelList=a,e.$store.state.vuexStore.txList=e.$parent.fetchAsArray(e.address+"@txList"),console.log(e.$store.state.vuexStore.txList),e.$store.state.vuexStore.contactList=e.$parent.fetchAsArray(e.address+"@contactList"),e.$store.state.vuexStore.recordList=e.$parent.fetchAsArray(e.address+"@recordList"),e.$store.state.vuexStore.eventList=e.$parent.fetchAsArray(e.address+"@eventList"),console.log(e.$store.state.vuexStore.eventList),e.$store.state.vuexStore.RList=e.$parent.fetchAsArray(e.address+"@RList");let s=e.$parent.fetchAsString(e.address+"@isOneStepPayment");if(console.log(s),e.$store.state.vuexStore.isOneStepPayment="true"==s,console.log(e.$store.state.vuexStore.isOneStepPayment),e.getBalance(),"ETH"==e.baseChain&&e.address){let t={messageType:"init",walletAddress:e.address},a={messageType:"monitorAddress",walletAddress:e.address,playload:e.address,chainType:"ETH",comments:{}};setTimeout(function(){e.$store.state.vuexStore.NodeUriWebSocket.send(JSON.stringify(t)),e.$store.state.vuexStore.NodeUriWebSocket.send(JSON.stringify(a))},1500),e.$parent.blockHeightCycle()}e.BalanceCycle(),e.cycleReconnectWebsocket()},BalanceCycle:function(){setInterval(this.getBalance,2e4)},getBalance(){"ETH"==this.baseChain?web3.utils.isAddress(this.address)&&(this.getEthBalance(),this.getTncBalance(),this.$parent.getChannelBalance()):"NEO"==this.baseChain&&34==this.address.length&&this.NEOgetTncBalance()},getEthBalance(){let e=this;e.address&&web3.utils.checkAddressChecksum(e.address)&&web3.eth.getBalance(e.address).then(function(t){let a=web3.utils.fromWei(web3.utils.hexToNumberString(t));e.$store.state.vuexStore.balanceData.Chain.ETH=e.$parent.keepDecimalPlaces(a,3)})},getTncBalance(){let e=this;web3.eth.getGasPrice().then(function(t){new web3.eth.Contract(e.$store.state.vuexStore.tncContractAbi,e.$store.state.vuexStore.tncContractAddress,{from:e.address,gasPrice:t}).methods.balanceOf(e.address).call({from:e.$store.state.vuexStore.tncContractAddress},function(t,a){if(t)console.log(t);else{let t=a/1e8;e.$store.state.vuexStore.balanceData.Chain.TNC=e.$parent.keepDecimalPlaces(t,3)}})})},NEOgetTncBalance(){let e=this;axios({method:"post",url:e.$store.state.vuexStore.NodeRpcUri,headers:{"Content-Type":"application/json;charset=UTF-8"},data:JSON.stringify({jsonrpc:"2.0",method:"getBalance",params:[e.address],id:1})}).then(function(t){e.$store.state.vuexStore.balanceData.Chain.TNC=e.$parent.keepDecimalPlaces(t.data.result.tncBalance,3),e.$store.state.vuexStore.balanceData.Chain.NEO=e.$parent.keepDecimalPlaces(t.data.result.neoBalance,3),e.$store.state.vuexStore.balanceData.Chain.GAS=e.$parent.keepDecimalPlaces(t.data.result.gasBalance,3)})},cycleReconnectWebsocket(){var e=this;e.$store.state.vuexStore.channelList.forEach(function(t,a){t.isTestNet==e.$store.state.vuexStore.isTestNet&&("ETH"==e.baseChain?e.$parent.reconnectWebsocket(t.Ip,t.ChannelName):"NEO"==e.baseChain&&e.$parent.reconnectWebsocket(t.Ip,t.ChannelName))})}}},o={render:function(){var e=this.$createElement;return(this._self._c||e)("div")},staticRenderFns:[]};var r=a("VU/8")(n,o,!1,function(e){a("jQdT")},"data-v-19abdc4f",null);t.a=r.exports},"2CWT":function(e,t){},"5/uQ":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAUEAAABQCAYAAACH88e7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAADLRJREFUeNrsnd9x27oSh2GP3sP7cGfu26HnFmC6AtMVWK7AdAVSKjhMBXIqoFKB5QokVyClgDNi3s7MfbBOBblEsohhBBJBEH/J3RmOpLEJAh/B3y5AcEkIGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhraSOwsgDrkzZY12x/wmcCnzHbNdmi2utm+wu/NyM9hCrzodsnxSyT/e+AYMn474In8kB/ycwht3mxPzfbd0LaGMtORMJw226LZ9ob40XIqKBf5Ib9R8XMZCRbNdnuioRvwCN84jyGKJ90+cJ4nORItfm62FZQzJOcxA46ydtfQ9q8cT1nUTcBjp0cibspsCQxr5If8kJ8Z8ZN5jCeI3rKeJ6Y4ElW+Nlt55ITFZDl4SZn3XIBT0W1j0uLV11zHRX7ID/kZEL/tCU/S1xIoey0Rw3mknreStKXq6ThOWQYd8lXisFLkh/yQnzq8tWdFzyQncBuRVymFjuA6qk3AcYhOrER+yA/5nba5AM+38MgEOWSQKTALZUifSC6IrcVIAPkhv2j5JULkFdoQdCoBGdpcoVjHdUBDgJS8n3d9hakH5If8kB+IyVYQmBDH74kEZCgeZU7imMMshAtlgfyQ39j5ZUKlqkiG7CEJIR9B7wMeKvHnfBvQOUd+yC8YASxIPMaH/j6FsAp8iK4a/VfID/mNjV8SsQDKRNyHEMbaAY+1oUJ+yG8s/EQVjlEAjwlh6nBuI/YOyIyfZ50jP+Q3An7vDhqzADLLHXeIfEAdUOYUp8gP+Q2Y37ubChUZjvGecWH5hPGRZzIQfrQdewcRNfJDfj75/Rg68h5kaFY58CZ8FJ0PjB/fP9bID/kNkN+vJy9czp358iZ7C15ySuJ7fKqrlRanSpAf8vPJ791wcU6Ga7mljsIL7JYM27YWhlvID/n55PduHmFNhm/8sNhUxFsOeBhyalhSIj/kNwB+owIoin4VYHljcyTID/lZ5aeSWZqFlTRT810PdXaVE2zZbB9Jv6zSVPj/hO8XpF+GW5NlxWIpDL+oferpkU3xm0I5pxbF0z5z1XKMlLQvLdlBu1dD4fff//yb5etUGWLSY6z++vt/B6GMvEMgRfffueDXJoIF5z1uiN5LjfhOU1sWAQZ4A/XtO4dCPx9BVHWNOREqzg8eotoCLkbX4lvBsQ9w8R088qPLnlTnsh/gWKf6mOq0UJ++Ewy/RrwyaHOXOTYqYDdMCJsyWHu62EOz/9I2vzYRZLm7+ogK80R9Ikkd8boiv7+nRBfivzTL4J1I3/r4aoOJaLBNWGzyYw/cswjlS0sk+KhYr1Ojmnvu77r1DoUfFTCmA3T/Z4VdZkx4GxF7gAhwzTmGf1r2/4MTzIumjNoTvx+FmLjdXBK384lrQ8fjJ1h11w2ydVm+7sjxCWV9Hn/tkV9JzN/o6nLtlJHzoyL4HbZE8f+n8P9r+F3C70WHY25hn9w2v/OWORTmHVdkfMa/D/VWMyplDL+QcdoXbgiZeua3cTglUBMz78MOiR8R5/haImqZ/dPhcAdX/M5bQnrWeQ4jvYhXgkPoYrmknLHyIxqROfJDfk74TU54EXYX7dlC5TJi9tG0R0tCTT3JnOPRZU7lVhJRjs0O4ERpB7wm3eZlkB/yc8JvckKk+GGEaWMvcTZlG0v13AHIBEB2EcHMIr+Y7AXYdY1kkB/yc8Jv0hJK15a8CF27881QWbXlE73jPMmjRid8GXknpOeGrg5IwZkckB/yC4nfMRG85ATGhtFyy8g8Sdphn1wQ0THbTrgwN8gP+YXE79iNkQS9yDvBFqcI2iyV7D9WO3DeN0N+yC80fm3DYVt3hW3eGPkEJ96UB9TpRCl6YemUQuKB38HTuWBtPkTOb/D9b9IhlDRpdPmNyZRcGy7M3RCzc4QHwTlsNPdF+/kkAHHM75F0m8s1ZR9Jv8ctQ+E3+P438VQZGq2ZXHqzsVjXnYPOOpYphRT5RcmPHj+F539VFl4vBBFm9Z81ZdQKo6vM8Gj0JD9fInggw751n1oqs+hRj1JD/E0tsv0WAL+YzTc/GtE+Qf8rOlzjNNihT5osG/Gbgbh1See17JFJRpnfZEAdZQ6KP9TV8euenftPjX18JH1w6ahMvW1NJQVXtNYI0aoRMZpAZUbUU2l9EhIf3MA1eq142OdmfyfTGL5EMNe8KAkMox8lHXphOHoJcUjkMkI6EHNzSh8C5JkQs+nrbb65zTu/RpA2fUZv8Nxx6an6H0IUwXuin+UlFUSQzxXHXqZ+YzCC0encL8R81pwbjTIX5G1ZQNdUaLXByCbjhNUXP9lw/8pgJGgzYvbODzLAFIq8DhAJPnL7s6Gw6jIfKrgPmmm0OvGbWBAA1TkG3cwWtdA4JoAr+J0C7CvDHZAEMNzZaFycuvvasK+BRYOxDfW98AMB7LKag+rGgt4EgaE0vSa7JmXNYZ8L2/wmJzpHBpuN4aWpGyMJJ06fod5PxN7SgLpD+wgZxztZVKN3HfFGfmHwK+BTKdMzJ5oz0I8pXKvvsk2f2J+JJr0jncNQ3Bq/8xaIoS9VqKGuDBqd6KZzhibT2OcaUeDOQTQd40W888CPpYYvHLd5CsfNIuf3q4wOqe6fjwQrzyo5CWEIXLvqf5OWOYXMYgeZae5L61ZywkTnuhbk7fle+v3e4HBY5zlqccgewlDUl+UakbRJflOuDkuH7Z7Bcac9h92++Q2+/01aINoSwVvS78ZIKYgpFcY7+F0ZrrdONg4WobIUXGPuhNmRCAX5Ib8g+B0TwY3gSU3PC5q6McKUnm42lhGkRP85zA2wuxz5UPha0qeQH/ILht+pSLAGAbi2IIKmboysyNtNHP7ulalFlvkRx6A6bJ8Ss4kiYh6OvCA/5Bciv/MWT0IigHhF3l7lSYX7hph7cP2WY9H1jvNKiKbHaOyuINFwpMgP+Tnhd0oEn7khYRZ4Y1fk7UXXpuY/+Ld16SR7qLkh9P1IO+GthAXyQ35B8TtvEZYavs8iaPBHw8P2gvu+1Czji8QjjcV4J7JCfsgvVH7nihCLiCDSucFX0v852xkHUHfx9Uqo15iM7zOfA+CXOm5/OjB+g+1/bSK4jBDiLTQ+7Qkw7dkBWRi+5ETVtSPxmVRzJhlR+OBXc6JUORBD8Th15Px+GTz/q2LH/u9a8TgJMRvEnOR3plBYBaJAL6gLjQurJD8zxtDK3DnogCw9Up80UHsoa0O6Jx6QdYgtfP9E3GbSoMemi8dlmXdse2GWN+6G9JunNcFvS9Tntdv6DV+fNmNJGqLmB8lUC/jZVhf+neU0iUIJj8HtOWGuFerM3gx3ofKUSR9+Z4rCwhrAbj7oCpPtbBs5d6J0xWtO3jLj9u2AzJ5gfkLXkcQ2F7OHTxNOxAS/BMrIFf73jpyeQ6JlrBXK2UBZh9j5QWSmyo/ZYyNeH7kyCriuVKNRKpR3GklVO/M7UyyY9wQ6EVbXNDp9bAlCfQjkAhYdCa3fAxmu8RlHTDkRU/xShWGWSn1zhQu4Hho/iOhUhqm7Y9EbTYigMo3TI6O0DX6/xIHebPjeYSgQoz1BG79bEOwFV3Y+UH4518YK+SG/AfH7YVPuAOUAARaW28eizO/gUIa2ZMF2+5Af8guifXykNKRV6JmjSJf3VOuBdUIXfQP5IT/v2iSqbTYAeK7bVNoO2T0Y36YF8kN+A+b3W9QUe1idQOTHABYevFYReQcsPEQXyA/5+eT324FNvbbQtwDOPR67GEAHdNkPkB/yC0KH+ArsIxsai52gCqAO84g7oI8RAfJDfj75Ha1IHgG8LAABDEmMdawKxAEiP+QXRADGC2HoHmVK3uYzQ6mr2BHp9zTgCHod2FQI8kN+wURXvLisAwPJHvvho9YisPpVQv1CW4IkOpCngDog8kN+Qao0rXAZyNzBq+A9Qp2/nAtRdQjOJBXOa8iL5ZEf8gsG5KswZvcRdeVCmM/WEIV+JzuT1LsifvLhVUI9QnYgyA/5BWUy9d6DQNoUoQQEdy/xaLEt7BadCeuMuYOLQOx8oUT1yA/5RWe5RAzZeL4wJIgsjXYlOWm+olCTol4eadfCoLCzvIN7ybmqSLwL4pEf8mu1M0cwqRjOiHyydQfbV/isyfE0RCm3XUK5shOxIT8zQq/IMCwBz3wvGZaw15cyfm2vM83JW+LLS+63WCbl90iGkfsQ+SG/oIbJc8mcg4ltC2WnZNh2LOrtu71CuVPkh/zGxO/MI8wEvMA1eIWucw0biBhfuO9jsww6zSV87+IAai4C3xCDySeRH/KLid9ZYFAThXmGHRl2enoTHfPUHIrtVxwgP+SH/NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NCCtf8LMACTwZk9T1TuvwAAAABJRU5ErkJggg=="},"5Znf":function(e,t){},"62ln":function(e,t){},"7m3c":function(e,t){},"7sHk":function(e,t){},"7xIN":function(e,t){},"8sVr":function(e,t){},"9HGa":function(e,t,a){"use strict";var s={name:"notifyBox",data:()=>({startY:0,endY:0}),filters:{},methods:{touchStart(e){this.startY=e.touches[0].clientY,console.log("开始X:"+this.startY)},touchEnd(e){this.endY=e.changedTouches[0].clientY,console.log("结束X:"+this.endY),this.startY<100&&this.startY-this.endY>10&&this.$store.state.vuexStore.isNotifyShow&&(this.$store.state.vuexStore.isNotifyShow=!1),this.startY=0,this.endY=0}}},n={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("transition",{attrs:{name:"top-show"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.$store.state.vuexStore.isNotifyShow,expression:"$store.state.vuexStore.isNotifyShow"}],staticClass:"notifyBox",on:{"!touchstart":function(t){return e.touchStart(t)},"!touchend":function(t){return e.touchEnd(t)}}},[s("div",{staticClass:"notify-title"},[s("img",{attrs:{src:a("hWNH"),alt:""}}),e._v(" "),s("p",{staticStyle:{display:"inline-block",margin:"0"}},[e._v("标题")])]),e._v(" "),s("div",{staticClass:"notify-label"},[e._v("\n          内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容\n          "),s("div",{staticStyle:{"text-align":"center"}},[s("i",{staticClass:"closeBtn el-icon-ETH-shouqi1",on:{click:function(t){e.$store.state.vuexStore.isNotifyShow=!1}}})])])])])},staticRenderFns:[]};var o=a("VU/8")(s,n,!1,function(e){a("L4uq")},"data-v-7794d028",null);t.a=o.exports},C90t:function(e,t){},"DaZ/":function(e,t){},EYaR:function(e,t){},F1k1:function(e,t){},FD4X:function(e,t){},GEkJ:function(e,t){},JSzE:function(e,t,a){"use strict";var s={name:"channelForm",data(){return{buttonItem:[{name:this.$t("tabbar.channel.addChannel"),iconStyle:"-60px",link:"/channel/addChannel",actionName:"slide-fade1"},{name:this.$t("tabbar.channel.channelList"),iconStyle:"-180px",link:"/channel/channelList",actionName:"slide-fade2"},{name:this.$t("tabbar.channel.payment"),iconStyle:"0px",link:"/channel/payment",actionName:"slide-fade3"},{name:this.$t("tabbar.channel.scan"),iconStyle:"-120px",link:"/scan",actionName:"slide-fade4"}]}},mounted(){this.$nextTick(function(){})},watch:{"$i18n.locale":"changeLang"},methods:{toOtherForm(e){1==this.$store.state.vuexStore.isChannelFormShow&&this.$router.push(e)},changeLang(){this.buttonItem[0].name=this.$t("tabbar.channel.addChannel"),this.buttonItem[1].name=this.$t("tabbar.channel.channelList"),this.buttonItem[2].name=this.$t("tabbar.channel.payment"),this.buttonItem[3].name=this.$t("tabbar.channel.scan")}}},n={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("transition",{attrs:{name:"fade"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.$store.state.vuexStore.isChannelFormShow,expression:"$store.state.vuexStore.isChannelFormShow"}],staticClass:"channelForm",on:{click:function(t){e.$store.state.vuexStore.isChannelFormShow=!1}}},[s("div",{staticStyle:{position:"absolute",bottom:"0",left:"0",right:"0",padding:"40px 40px 20px 40px"}},[s("div",{staticClass:"buttonBox",staticStyle:{"text-align":"center"}},e._l(e.buttonItem,function(t,n){return s("transition",{key:n,attrs:{name:t.actionName}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.$store.state.vuexStore.isChannelFormShow,expression:"$store.state.vuexStore.isChannelFormShow"}],staticClass:"button-item",on:{click:function(a){e.toOtherForm(t.link)}}},[s("div",{staticClass:"button-item-img"},[s("img",{style:{marginLeft:t.iconStyle},attrs:{src:a("5/uQ"),alt:""}})]),e._v(" "),s("p",{staticClass:"button-item-label"},[e._v(e._s(t.name))])])])})),e._v(" "),s("div",{staticClass:"closeBox"},[s("span",{on:{click:function(t){e.$store.state.vuexStore.isChannelFormShow=!1}}},[s("i",{staticClass:"el-icon-ETH-guanbi"})])])])])])},staticRenderFns:[]};var o=a("VU/8")(s,n,!1,function(e){a("fhdw")},"data-v-102cf712",null);t.a=o.exports},L4uq:function(e,t){},LumP:function(e,t,a){"use strict";var s={name:"headBoxForChild",data:()=>({}),mounted(){this.$nextTick(function(){})},methods:{}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"headBox"},[a("div",{staticClass:"header-button is-left"},[a("i",{staticClass:"el-icon-ETH-fanhui",on:{click:function(t){e.$router.go(-1)}}})]),e._v(" "),a("h1",[e._v(e._s(e.$router.name))]),e._v(" "),a("div",{staticClass:"header-button is-right",staticStyle:{"text-align":"right"}})])},staticRenderFns:[]};var o=a("VU/8")(s,n,!1,function(e){a("sH/u")},"data-v-55ee080f",null);t.a=o.exports},"N+8p":function(e,t,a){e.exports=a.p+"static/img/Trinity.9d7f65f.png"},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("7+uW"),n=a("xJD8"),o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"appBox",attrs:{id:"app"}},[a("div",{staticStyle:{position:"relative",margin:"0 auto",width:"100%","max-width":"1400px",height:"100%"}},[a("transition-group",{attrs:{name:e.transitionName,mode:"in-out"}},[a("router-view",{key:"router-box"})],1),e._v(" "),a("footer-box")],1),e._v(" "),a("channel"),e._v(" "),a("config"),e._v(" "),a("notify"),e._v(" "),a("dialogBox"),e._v(" "),a("el-dialog",{attrs:{title:e.$t("common.attention"),visible:e.isFeeInfoBoxShow,width:"calc(100% - 20px)",center:""},on:{"update:visible":function(t){e.isFeeInfoBoxShow=t}}},[a("span",[e._v(e._s(e.$t("common.fee-1"))),a("b",{staticStyle:{color:"#F56C6C"}},[e._v(e._s(e.$store.state.vuexStore.txOnChannelInfo.fee/1e8)+e._s(e.$store.state.vuexStore.txOnChannelInfo.assetType))]),e._v(e._s(e.$t("common.fee-2")))]),a("br"),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$t("common.whyFeeTips"),placement:"top"}},[a("span",{staticStyle:{"margin-top":"20px",display:"inline-block","text-decoration":"underline"}},[e._v(e._s(e.$t("common.whyFee")))])]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",disabled:e.isDisable},on:{click:function(t){e.sendHtlcMes()}}},[e._v(e._s(e.$t("common.continue")))]),e._v(" "),a("el-button",{on:{click:function(t){e.isFeeInfoBoxShow=!1}}},[e._v(e._s(e.$t("common.cancel")))])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"退出",visible:e.isSignOutBoxShow,width:"calc(100% - 20px)",center:""},on:{"update:visible":function(t){e.isSignOutBoxShow=t}}},[a("span",[e._v(e._s(e.$t("common.signOut"))+" ")]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"danger"},on:{click:function(t){e.SignOut()}}},[e._v(e._s(e.$t("common.continue")))]),e._v(" "),a("el-button",{on:{click:function(t){e.isSignOutBoxShow=!1}}},[e._v(e._s(e.$t("common.cancel")))])],1)])],1)},staticRenderFns:[]};var r=function(e){a("y3Ia")},i=a("VU/8")(n.a,o,!1,r,null,null).exports,l=a("/ocq"),c={name:"indexForm",data:()=>({assetList:[{name:"TNC",iconStyle:"-53px",baseChain:"all"},{name:"ETH",iconStyle:"-25px",baseChain:"ETH"},{name:"NEO",iconStyle:"3px",baseChain:"NEO"},{name:"GAS",iconStyle:"3px",baseChain:"NEO"}],isChangeWalletBoxShow:!1}),computed:{walletInfo(){return"ETH"==this.$store.state.vuexStore.baseChain?this.$store.state.vuexStore.walletInfo:"NEO"==this.$store.state.vuexStore.baseChain?this.$store.state.vuexStore.NEOwalletInfo:void 0},balanceData(){return this.$store.state.vuexStore.balanceData},baseChain(){return this.$store.state.vuexStore.baseChain}},filters:{formatAddress:function(e){return e.replace(/(.{10}).*(.{10})/,"$1......$2")}},mounted(){this.$nextTick(function(){})},watch:{},methods:{toAssetForm(e){this.$router.push("/chain/asset"),this.$store.state.vuexStore.activeAssetInfo.assetType=e},changeWallet(){console.log(1),"ETH"==this.$store.state.vuexStore.baseChain?this.$store.state.vuexStore.baseChain="NEO":this.$store.state.vuexStore.baseChain="ETH",console.log(this.$store.state.vuexStore.baseChain),this.$store.state.vuexStore.isLogin&&""!=this.address||this.$router.push("/start")}}},d={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"indexBox"},[s("div",{staticClass:"headBox"},[s("div",{staticClass:"header-button is-left"},[s("p",{on:{click:function(t){e.isChangeWalletBoxShow=!0}}},[e._v("ETH/NEO")])]),e._v(" "),s("h1"),e._v(" "),s("div",{staticClass:"header-button is-right",staticStyle:{"text-align":"right"}},[s("router-link",{attrs:{to:"/scan"}},[s("i",{staticClass:"notificationIcon el-icon-ETH-saoyisao",attrs:{click:"$router.push('/scan')"}})])],1)]),e._v(" "),s("div",{staticClass:"assetBox"},[s("div",{staticClass:"amountBox"},[s("h3",[e._v("TNC")]),e._v(" "),s("h1",[e._v(e._s(e.balanceData.Chain.TNC))])]),e._v(" "),s("div",{staticClass:"addressBox"},[s("el-row",{attrs:{gutter:20}},[s("el-col",{staticStyle:{"border-right":"1px solid #8A9199"},attrs:{span:8}},[e._v("\n          "+e._s(e.baseChain)+"\n        ")]),e._v(" "),s("el-col",{attrs:{span:16}},[s("router-link",{attrs:{to:"/chain/receive"}},[s("i",{staticClass:"el-icon-ETH-erweima"}),e._v("\n            "+e._s(e._f("formatAddress")(e.walletInfo.address))+"\n          ")])],1)],1)],1)]),e._v(" "),s("div",{staticClass:"content1Box"},[s("ul",{staticClass:"listUl"},e._l(e.assetList,function(t,n){return t.baseChain==e.baseChain||"all"==t.baseChain?s("li",{key:n,on:{click:function(a){e.toAssetForm(t.name)}}},[s("div",{staticClass:"assetIcon"},[s("img",{style:{marginLeft:t.iconStyle},attrs:{src:a("yfsC"),alt:""}})]),e._v(" "),s("span",[e._v(e._s(t.name))]),e._v(" "),s("span",[e._v(e._s(e.balanceData.Chain[t.name]))])]):e._e()}))]),e._v(" "),s("el-dialog",{attrs:{title:"切换钱包",visible:e.isChangeWalletBoxShow,width:"calc(100% - 20px)",center:""},on:{"update:visible":function(t){e.isChangeWalletBoxShow=t}}},[s("span",[e._v(" 是否切换钱包 ")]),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:function(t){e.changeWallet()()}}},[e._v(e._s(e.$t("common.continue")))]),e._v(" "),s("el-button",{on:{click:function(t){e.isChangeWalletBoxShow=!1}}},[e._v(e._s(e.$t("common.cancel")))])],1)])],1)},staticRenderFns:[]};var h=a("VU/8")(c,d,!1,function(e){a("OHZR")},"data-v-66cc5ac1",null).exports,u=a("TXMN"),m={name:"messageForm",data:()=>({messageList:[{title:"欢迎来到消息中心",messageType:"signFun",isRead:!1,date:1539314320400,imgLink:"./../../../static/Trinity.png",content:"测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试",sender:{type:"channel",name:"1"}},{title:"目前该功能还在开发中",messageType:"showPrivateKey",isRead:!1,date:1539314320400,imgLink:"./../../../static/Trinity.png",content:"测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试",sender:{type:"address",name:"0xADCe15cDEc589f93D25BE13DFa9370F659e78D45"}},{title:"敬请期待",messageType:"testFun",isRead:!0,date:1539314320400,imgLink:"./../../../static/Trinity.png",content:"测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试",sender:{type:"trinity",name:"Trinity"}}],messageList1:[]}),filters:{formatAddress:function(e){return e.replace(/(.{8}).*(.{8})/,"$1...$2")},formatDateTime:function(e){var t=new Date(e),a=t.getMonth()+1;a=a<10?"0"+a:a;var s=t.getDate();return a+"-"+(s=s<10?"0"+s:s)+" "+t.getHours()+":"+t.getMinutes()}},methods:{readMessage(e){switch(console.log(e),e.messageType){case"signFun":this.signFun();break;case"showPrivateKey":this.showPrivateKey();break;case"testFun":this.testFun6();break;default:alert("未知消息类型")}},clearAll(){return console.log("清除全部"),this.$store.state.vuexStore.channelList=[],this.$parent.$parent.StoreData("channelList"),this.$store.state.vuexStore.recordList=[],this.$parent.$parent.StoreData("recordList"),this.$store.state.vuexStore.txList=[],this.$parent.$parent.StoreData("txList"),this.$store.state.vuexStore.eventList=[],this.$parent.$parent.StoreData("eventList"),!1},signFun(){let e=web3.utils.soliditySha3({t:"bytes32",v:"0x295722f9ae1a0fe6315a9d7c7b930f5740c8ca8f8163da076e35c1f347f5410e"},{t:"uint256",v:2},{t:"address",v:"0xDc1FF8Ee46f97F6089aa17553F1531f81C33fe7F"},{t:"uint256",v:9e8},{t:"address",v:"0xA5a0640c9542c7621cDA89Cce562580b66333549"},{t:"uint256",v:11e8},{t:"bytes32",v:"0x0000000000000000000000000000000000000000000000000000000000000000"},{t:"bytes32",v:"0x0000000000000000000000000000000000000000000000000000000000000000"});console.log(e);let t=ecSign(e,"0xab669573efbdcaf5f2d88704b41162a77c6090cf908d937979d5c38b44e66741");console.log(t)},showPrivateKey(){this.$notify.error({title:this.$t("common.warning"),dangerouslyUseHTMLString:!0,message:"e",duration:0})},testFun1(){let e=this.$store.state.vuexStore.channelList[0].ChannelName;this.$parent.$parent.updateTxListLength(e,2),this.$parent.$parent.StoreData("txList");let t=this.$parent.$parent.getChannelSerial("ChannelName",e),a=this.$store.state.vuexStore.channelList[t];a.SelfBalance=1e9,a.OtherBalance=1e9,a.TxNonce=1,u.a.set(this.$store.state.vuexStore.channelList,t,a),console.log(this.$store.state.vuexStore.channelList[t]),this.$parent.$parent.StoreData("channelList"),this.$store.state.vuexStore.eventList=[],this.$parent.$parent.StoreData("eventList")},testFun2(){let e=this.$store.state.vuexStore.channelList[0].ChannelName;this.$parent.$parent.updateTxList1(e,2,{state:"INIT",founderSignedData:"",peerSignedData:""}),this.$parent.$parent.updateTxListLength(e,3),this.$parent.$parent.StoreData("txList");let t=this.$parent.$parent.getChannelSerial("ChannelName",e),a=this.$store.state.vuexStore.channelList[t];a.SelfBalance=1e9,a.OtherBalance=1e9,a.TxNonce=2,u.a.set(this.$store.state.vuexStore.channelList,t,a),console.log(this.$store.state.vuexStore.channelList[t]),this.$parent.$parent.StoreData("channelList"),this.$store.state.vuexStore.eventList=[],this.$parent.$parent.StoreData("eventList")},testFun3(){let e=this.$store.state.vuexStore.channelList[0].ChannelName;this.$parent.$parent.updateTxList1(e,2,{state:"confirming",founderSignedData:""}),this.$parent.$parent.updateTxListLength(e,3),this.$parent.$parent.StoreData("txList");let t=this.$parent.$parent.getChannelSerial("ChannelName",e),a=this.$store.state.vuexStore.channelList[t];a.SelfBalance=1e9,a.OtherBalance=1e9,a.TxNonce=2,u.a.set(this.$store.state.vuexStore.channelList,t,a),console.log(this.$store.state.vuexStore.channelList[t]),this.$parent.$parent.StoreData("channelList"),this.$store.state.vuexStore.eventList=[],this.$parent.$parent.StoreData("eventList")},testFun4(){this.$store.state.vuexStore.eventList=[],this.$parent.$parent.StoreData("eventList")},testFun5(){let e=this.$store.state.vuexStore.channelList[0].ChannelName;this.$parent.$parent.updateTxList1(e,3,{state:"init",founderSignedData:"",peerSignedData:""}),this.$parent.$parent.updateTxListLength(e,4),this.$parent.$parent.StoreData("txList");let t=this.$parent.$parent.getChannelSerial("ChannelName",e),a=this.$store.state.vuexStore.channelList[t];a.SelfBalance=899e6,a.OtherBalance=1e9,a.TxNonce=3,u.a.set(this.$store.state.vuexStore.channelList,t,a),console.log(this.$store.state.vuexStore.channelList[t]),this.$parent.$parent.StoreData("channelList"),this.$store.state.vuexStore.eventList=[],this.$parent.$parent.StoreData("eventList")},testFun6(){this.$store.state.vuexStore.eventList=[],this.$parent.$parent.StoreData("eventList")}}},g={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"messageForm"},[a("div",{staticClass:"headBox"},[a("div",{staticClass:"header-button is-left"}),e._v(" "),a("h1",[e._v("消息中心")]),e._v(" "),a("div",{staticClass:"header-button is-right",staticStyle:{"text-align":"right"}},[e.messageList.length?a("p",{on:{click:function(t){e.clearAll()}}},[e._v("清空全部")]):e._e()])]),e._v(" "),a("div",{staticClass:"contentBox"},[e.messageList.length?a("ul",{staticClass:"listUl"},e._l(e.messageList,function(t,s){return a("li",{key:s,on:{click:function(a){e.readMessage(t)}}},[a("h2",{staticClass:"title"},[e._v(e._s(t.title)),a("span",{staticClass:"readFlag",class:{isRead:t.isRead}}),a("span",{staticClass:"date"},[e._v(e._s(e._f("formatDateTime")(t.date)))])]),e._v(" "),a("div",{staticClass:"bottomBox"},[a("img",{attrs:{src:t.imgLink,alt:"image"}}),e._v(" "),a("p",[e._v(e._s(t.content))]),e._v(" "),"channel"==t.sender.type?a("p",[e._v("发起人: "+e._s(t.sender.name)+" - 通道")]):e._e(),e._v(" "),"address"==t.sender.type?a("p",[e._v("发起人: "+e._s(e._f("formatAddress")(t.sender.name)))]):e._e(),e._v(" "),"trinity"==t.sender.type?a("p",[e._v("发起人: "+e._s(t.sender.name))]):e._e()])])})):a("p",{staticStyle:{"text-align":"center","margin-top":"20vh","font-size":"14px",color:"#5e6d82","line-height":"1.5em","font-weight":"400"}},[e._v("\n          消息中心功能正在加入中...\n      ")])])])},staticRenderFns:[]};var p=a("VU/8")(m,g,!1,function(e){a("TsFg")},"data-v-2215fc26",null).exports,v={name:"descoverForm",data:()=>({descoverList:[{title:"排行榜",link:"/discover/ranking",imgLink:a("ey8z"),style:{background:"#CCCCCC"}}]}),filters:{},methods:{descoverLink(e){this.$router.push(e)}}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"descoverForm"},[e._m(0),e._v(" "),a("div",{staticClass:"contentBox"},[e.descoverList.length?a("ul",{staticClass:"listUl"},e._l(e.descoverList,function(t,s){return a("li",{key:s,style:t.style,on:{click:function(a){e.descoverLink(t.link)}}},[a("h2",{staticClass:"title"},[e._v(e._s(t.title))]),e._v(" "),a("div",{staticClass:"bottomBox"},[a("img",{attrs:{src:t.imgLink,alt:"image"}})])])})):a("p",{staticStyle:{"text-align":"center","margin-top":"20vh","font-size":"14px",color:"#5e6d82","line-height":"1.5em","font-weight":"400"}},[e._v("\n        一键资产转换等功能正在加入中...\n    ")])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"headBox"},[t("div",{staticClass:"header-button is-left"}),this._v(" "),t("h1",[this._v("发现")]),this._v(" "),t("div",{staticClass:"header-button is-right",staticStyle:{"text-align":"right"}})])}]};var y=a("VU/8")(v,f,!1,function(e){a("xu0g")},"data-v-1612b390",null).exports,S={name:"settingForm",data:()=>({}),filters:{},methods:{showSignOutBox(){this.$parent.$parent.showSignOutBox()}}},x={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"settingForm"},[a("div",{staticClass:"headBox"},[a("div",{staticClass:"header-button is-left"}),e._v(" "),a("h1",[e._v(e._s(e.$t("setting.title")))]),e._v(" "),a("div",{staticClass:"header-button is-right"})]),e._v(" "),a("div",{staticClass:"contentBox"},[a("router-link",{staticClass:"cell cell-hover",attrs:{to:"/setting/backup"}},[a("div",{staticClass:"cell-wrapper"},[a("div",{staticClass:"cell-title"},[a("span",{staticClass:"cell-text"},[e._v(e._s(e.$t("setting.backup")))])]),e._v(" "),a("div",{staticClass:"cell-right"},[a("i",{staticClass:"el-icon-ETH-qianjin"})])])]),e._v(" "),a("router-link",{staticClass:"cell cell-hover",attrs:{to:"/setting/changePassword"}},[a("div",{staticClass:"cell-wrapper"},[a("div",{staticClass:"cell-title"},[a("span",{staticClass:"cell-text"},[e._v(e._s(e.$t("setting.changePass")))])]),e._v(" "),a("div",{staticClass:"cell-right"},[a("i",{staticClass:"el-icon-ETH-qianjin"})])])]),e._v(" "),a("router-link",{staticClass:"cell cell-hover",staticStyle:{display:"none"},attrs:{to:"/setting/contact"}},[a("div",{staticClass:"cell-wrapper"},[a("div",{staticClass:"cell-title"},[a("span",{staticClass:"cell-text"},[e._v(e._s(e.$t("setting.contact"))+"( Test )")])]),e._v(" "),a("div",{staticClass:"cell-right"},[a("i",{staticClass:"el-icon-ETH-qianjin"})])])]),e._v(" "),a("router-link",{staticClass:"cell cell-hover",attrs:{to:"/setting/language"}},[a("div",{staticClass:"cell-wrapper"},[a("div",{staticClass:"cell-title"},[a("span",{staticClass:"cell-text"},[e._v(e._s(e.$t("setting.switchLang")))])]),e._v(" "),a("div",{staticClass:"cell-right"},[a("i",{staticClass:"el-icon-ETH-qianjin"})])])]),e._v(" "),a("router-link",{staticClass:"cell cell-hover",attrs:{to:"/setting/more"}},[a("div",{staticClass:"cell-wrapper"},[a("div",{staticClass:"cell-title"},[a("span",{staticClass:"cell-text"},[e._v(e._s(e.$t("setting.more.title")))])]),e._v(" "),a("div",{staticClass:"cell-right"},[a("i",{staticClass:"el-icon-ETH-qianjin"})])])]),e._v(" "),a("router-link",{staticClass:"cell cell-hover",staticStyle:{"margin-top":"30px"},attrs:{to:"/setting/about"}},[a("div",{staticClass:"cell-wrapper"},[a("div",{staticClass:"cell-title"},[a("span",{staticClass:"cell-text"},[e._v(e._s(e.$t("setting.about")))])]),e._v(" "),a("div",{staticClass:"cell-right"},[a("i",{staticClass:"el-icon-ETH-qianjin"})])])]),e._v(" "),a("div",{staticStyle:{"text-align":"center","margin-top":"42px"}},[a("el-button",{staticStyle:{width:"80%"},attrs:{type:"primary"},on:{click:function(t){e.showSignOutBox()}}},[e._v(e._s(e.$t("setting.signOut")))])],1)],1)])},staticRenderFns:[]};var C=a("VU/8")(S,x,!1,function(e){a("+vE3")},"data-v-4e49ac69",null).exports,b={name:"scanForm",data:()=>({}),computed:{baseChain(){return this.$store.state.vuexStore.baseChain}},filters:{},mounted(){this.$nextTick(function(){let e=this;setTimeout(function(){e.startRecognize()},350)})},watch:{},methods:{back(){this.$router.go(-1),scan.close()},startRecognize(){scan=new plus.barcode.Barcode("bcid"),scan.onmarked=this.onmarked,this.startScan()},onmarked(e,t){let a=this;var s="未知";switch(e){case plus.barcode.QR:s="QR";break;case plus.barcode.EAN13:s="EAN13";break;case plus.barcode.EAN8:s="EAN8"}console.log(s+": "+t),a.closeScan(),t.startsWith("TN")?a.$router.push({name:"payment",params:{paymentCode:t}}):t.includes("@")&&t.includes(":")?a.$router.push({name:"addChannelForm",params:{Uri:t}}):"ETH"==a.baseChain&&web3.utils.checkAddressChecksum(t)?a.$router.push({name:"transferOnChain",params:{address:t}}):"NEO"==a.baseChain&&34==t.length?a.$router.push({name:"transferOnChain",params:{address:t}}):(alert("无效二维码"),a.$router.go(-1))},startScan(){scan.start()},closeScan(){scan.close()}}},$={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"scanForm"},[a("div",{staticClass:"headBox"},[a("div",{staticClass:"header-button is-left"},[a("i",{staticClass:"el-icon-ETH-fanhui",on:{click:function(t){e.back()}}})]),e._v(" "),a("h1",[e._v(e._s(e.$router.name))]),e._v(" "),a("div",{staticClass:"header-button is-right",staticStyle:{"text-align":"right"}})]),e._v(" "),a("div",{attrs:{id:"bcid"}})])},staticRenderFns:[]};var k=a("VU/8")(b,$,!1,function(e){a("mI+2")},"data-v-54502b3a",null).exports,T=a("LumP"),_={name:"EtherScanForm",data:()=>({clickNum:0}),components:{headBox:T.a},watch:{},filters:{},mounted(){this.$nextTick(function(){})},methods:{}},w={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"EtherScanForm"},[t("headBox"),this._v(" "),this._m(0)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"contentBox",attrs:{id:"EtherScanBox"}},[t("object",{staticStyle:{border:"0px"},attrs:{type:"text/x-scriptlet",data:"https://ropsten.etherscan.io",width:"100%",height:"30"}})])}]};var B=a("VU/8")(_,w,!1,function(e){a("+4aq")},"data-v-33c6d3a6",null).exports,N=a("qKYu"),D={name:"startForm",data:()=>({}),methods:{toOtherForm(e){this.$router.push(e)},switchLang(){"cn"===this.$i18n.locale?this.$i18n.locale="en":this.$i18n.locale="cn",this.$parent.$parent.saveAsString("lang",this.$i18n.locale)},switchNet(e){let t=this;"object"==typeof t.$store.state.vuexStore.NodeUriWebSocket&&(t.$store.state.vuexStore.NodeUriWebSocket.close(),t.$store.state.vuexStore.NodeUriWebSocket=""),t.$store.state.vuexStore.baseChain=e,t.$parent.$parent.saveAsString("baseChain",t.$store.state.vuexStore.baseChain),N.a.$emit("UpdateConfig",!0)},test1(){let e=createMnemonic();validateMnemonic(e)&&mnemonic2privateKey(e)}}},L={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"startForm"},[e._m(0),e._v(" "),a("div",{staticClass:"contentBox"},[a("div",[a("div",{staticClass:"chainIconBox"},[a("p",[e._v(e._s(e.$t("start.Chain"))+": ")]),e._v(" "),a("i",{staticClass:"el-icon-ETH-ETH",class:{active:"ETH"==e.$store.state.vuexStore.baseChain},on:{click:function(t){e.switchNet("ETH")}}}),e._v(" "),a("i",{staticClass:"el-icon-ETH-NEO",class:{active:"NEO"==e.$store.state.vuexStore.baseChain},on:{click:function(t){e.switchNet("NEO")}}})]),e._v(" "),a("h2",{staticClass:"title_h2",on:{click:function(t){e.test1()}}},[e._v(e._s(e.$t("start.title")))])]),e._v(" "),a("hr"),e._v(" "),a("div",{staticClass:"clooseLoginBox clooseLoginBox-blue",on:{click:function(t){e.toOtherForm("./create")}}},[a("h3",[e._v(e._s(e.$t("start.createWallet")))]),e._v(" "),a("p",[e._v(e._s(e.$t("start.createWalletTxt")))])]),e._v(" "),a("div",{staticClass:"clooseLoginBox clooseLoginBox-green",on:{click:function(t){e.toOtherForm("./loginByPrivateKey")}}},[a("h3",[e._v(e._s(e.$t("start.loginByPrivateKey")))]),e._v(" "),a("p",[e._v(e._s(e.$t("start.loginByPrivateKeyTxt")))])]),e._v(" "),e.$store.state.vuexStore.isMobile?a("div",{staticClass:"clooseLoginBox clooseLoginBox-yellow",on:{click:function(t){e.toOtherForm("./loginByMnemonic")}}},[a("h3",[e._v(e._s(e.$t("start.loginByMnemonic")))]),e._v(" "),a("p",[e._v(e._s(e.$t("start.loginByMnemonicTxt")))])]):a("div",{staticClass:"clooseLoginBox clooseLoginBox-gray",on:{click:function(t){e.toOtherForm("./loginByKeyStore")}}},[a("h3",[e._v(e._s(e.$t("start.loginByKeystore")))]),e._v(" "),a("p",[e._v(e._s(e.$t("start.loginByKeystoreTxt")))])]),e._v(" "),a("a",{staticClass:"backToStartBtn",on:{click:function(t){e.switchLang()}}},[e._v(e._s(e.$t("common.switchLang")))])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"headBox"},[t("div",{staticClass:"header-button is-left"}),this._v(" "),t("h1"),this._v(" "),t("div",{staticClass:"header-button is-right",staticStyle:{"text-align":"right"}})])}]};var I=a("VU/8")(D,L,!1,function(e){a("mB2j")},"data-v-2b149023",null).exports,O={name:"createForm",data(){return{createForm:{pass:"",checkPass:""},createRules:{pass:[{validator:(e,t,a)=>{""===t?a(new Error(this.$t("create.callback-1"))):(""!==this.createForm.checkPass&&this.$refs.createForm.validateField("checkPass"),a())},trigger:"blur"}],checkPass:[{validator:(e,t,a)=>{""===t?a(new Error(this.$t("create.callback-2"))):t!==this.createForm.pass?a(new Error(this.$t("create.callback-3"))):a()},trigger:"blur"}]}}},components:{headBox:T.a},mounted(){this.$nextTick(function(){})},methods:{toLoginForm(){this.$refs.createForm.validate(e=>{if(!e)return console.log("error submit!!"),!1;if("ETH"==this.$store.state.vuexStore.baseChain){let e=createMnemonic(),t=mnemonic2privateKey(e);console.log(t);let a=web3.eth.accounts.encrypt("0x"+t,this.createForm.pass);console.log(a);let s=web3.utils.toChecksumAddress(a.address);console.log(s),web3.utils.checkAddressChecksum(s)&&(this.$store.state.vuexStore.walletInfo.keyStore=a,this.$store.state.vuexStore.walletInfo.address=s,this.$store.state.vuexStore.isLogin=!0,console.log(JSON.stringify(this.$store.state.vuexStore.walletInfo)),N.a.$emit("getAddressInfo",!0),this.$parent.$parent.saveAsString("isLogin",this.$store.state.vuexStore.isLogin),this.$parent.$parent.saveAsArray("walletInfo",this.$store.state.vuexStore.walletInfo)),this.$router.push({name:"firstBackupForm",params:{mnemonic:e}})}else if("NEO"==this.$store.state.vuexStore.baseChain){let e=ab2hexstring(generatePrivateKey());console.log(e);let t=scrypt_module_factory(generateWalletFileBlob,{},{privateKey:e,password:this.createForm.pass});console.log(t);let a=t.accounts[0].address;console.log(a),34==a.length&&(this.$store.state.vuexStore.NEOwalletInfo.keyStore=t,this.$store.state.vuexStore.NEOwalletInfo.publicKey=getPublicKeyEncoded(ab2hexstring(getPublicKey(e,0))),this.$store.state.vuexStore.NEOwalletInfo.address=a,this.$store.state.vuexStore.isLogin=!0),N.a.$emit("getAddressInfo",!0),this.$parent.$parent.saveAsString("isLogin",this.$store.state.vuexStore.isLogin),this.$parent.$parent.saveAsArray("walletInfo",this.$store.state.vuexStore.NEOwalletInfo),this.$router.push("/setting/backup")}this.createForm.pass="",this.createForm.checkPass=""})}}},R={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"createForm"},[a("headBox"),e._v(" "),a("div",{staticClass:"contentBox"},[a("h2",{staticClass:"title_h2"},[e._v(e._s(e.$t("create.title")))]),e._v(" "),a("hr"),e._v(" "),a("el-form",{ref:"createForm",staticClass:"demo-ruleForm",attrs:{model:e.createForm,"status-icon":"",rules:e.createRules,"label-position":"top"}},[a("el-form-item",{attrs:{label:e.$t("create.password"),prop:"pass"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.createForm.pass,callback:function(t){e.$set(e.createForm,"pass",t)},expression:"createForm.pass"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("create.checkPass"),prop:"checkPass"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.createForm.checkPass,callback:function(t){e.$set(e.createForm,"checkPass",t)},expression:"createForm.checkPass"}})],1),e._v(" "),a("div",{staticStyle:{"text-align":"center","margin-bottom":"22px"}},[a("el-button",{staticStyle:{width:"80%"},attrs:{type:"primary"},on:{click:function(t){e.toLoginForm()}}},[e._v(e._s(e.$t("create.create")))])],1)],1),e._v(" "),a("a",{staticClass:"backToStartBtn",on:{click:function(t){e.$parent.$parent.backToStart()}}},[e._v(e._s(e.$t("loginByPrivateKey.backToStart")))])],1)],1)},staticRenderFns:[]};var E=a("VU/8")(O,R,!1,function(e){a("C90t")},"data-v-94bb58d6",null).exports,P={name:"loginByPrivateKeyForm",data(){return{loginByPrivateKeyForm:{privateKey:"",pass:"",checkPass:""},loginByPrivateKeyRules:{privateKey:[{validator:(e,t,a)=>{if(!t)return a(new Error(this.$t("loginByPrivateKey.callback-1")));64!==t.length?66==t.length&&"0x"==t.substr(0,2)?a():a(new Error(this.$t("loginByPrivateKey.callback-2"))):a()},trigger:"blur"}],pass:[{validator:(e,t,a)=>{""===t?a(new Error(this.$t("loginByPrivateKey.callback-3"))):(""!==this.loginByPrivateKeyForm.checkPass&&this.$refs.loginByPrivateKeyForm.validateField("checkPass"),a())},trigger:"blur"}],checkPass:[{validator:(e,t,a)=>{""===t?a(new Error(this.$t("loginByPrivateKey.callback-4"))):t!==this.loginByPrivateKeyForm.pass?a(new Error(this.$t("loginByPrivateKey.callback-5"))):a()},trigger:"blur"}]}}},components:{headBox:T.a},computed:{completePrivateKey(){return this.loginByPrivateKeyForm.privateKey.startsWith("0x")?this.loginByPrivateKeyForm.privateKey:"0x"+this.loginByPrivateKeyForm.privateKey}},mounted(){this.$nextTick(function(){})},methods:{Login(){this.$refs.loginByPrivateKeyForm.validate(e=>{if(!e)return console.log("error submit!!"),!1;if("ETH"==this.$store.state.vuexStore.baseChain){let e=web3.eth.accounts.encrypt(this.completePrivateKey,this.loginByPrivateKeyForm.pass);console.log(e);let t=web3.utils.toChecksumAddress(e.address);console.log(t),web3.utils.checkAddressChecksum(t)?(this.$store.state.vuexStore.walletInfo.keyStore=e,this.$store.state.vuexStore.walletInfo.address=t,this.$store.state.vuexStore.isLogin=!0,this.$notify({title:this.$t("loginByPrivateKey.callback-6"),dangerouslyUseHTMLString:!0,message:this.$t("loginByPrivateKey.callback-7"),duration:3e3,type:"success"}),N.a.$emit("getAddressInfo",!0),this.$parent.$parent.saveAsString("isLogin",this.$store.state.vuexStore.isLogin),this.$parent.$parent.saveAsArray("walletInfo",this.$store.state.vuexStore.walletInfo),this.$router.push("/setting/backup")):this.$notify.error({title:this.$t("loginByPrivateKey.callback-8"),dangerouslyUseHTMLString:!0,message:this.$t("loginByPrivateKey.callback-9"),duration:3e3})}else if("NEO"==this.$store.state.vuexStore.baseChain){let e=scrypt_module_factory(generateWalletFileBlob,{},{privateKey:this.loginByPrivateKeyForm.privateKey,password:this.loginByPrivateKeyForm.pass});console.log(e),34==e.accounts[0].address.length?(this.$store.state.vuexStore.NEOwalletInfo.keyStore=e,this.$store.state.vuexStore.NEOwalletInfo.publicKey=getPublicKeyEncoded(ab2hexstring(getPublicKey(this.loginByPrivateKeyForm.privateKey,0))),console.log(this.$store.state.vuexStore.NEOwalletInfo.keyStore),this.$store.state.vuexStore.NEOwalletInfo.address=e.accounts[0].address,this.$store.state.vuexStore.isLogin=!0,this.$notify({title:this.$t("loginByPrivateKey.callback-6"),dangerouslyUseHTMLString:!0,message:this.$t("loginByPrivateKey.callback-7"),duration:3e3,type:"success"}),N.a.$emit("getAddressInfo",!0),this.$parent.$parent.saveAsString("isLogin",this.$store.state.vuexStore.isLogin),this.$parent.$parent.saveAsArray("walletInfo",this.$store.state.vuexStore.NEOwalletInfo),this.$router.push("/setting/backup")):this.$notify.error({title:this.$t("loginByPrivateKey.callback-8"),dangerouslyUseHTMLString:!0,message:this.$t("loginByPrivateKey.callback-9"),duration:3e3})}this.loginByPrivateKeyForm.privateKey="",this.loginByPrivateKeyForm.pass="",this.loginByPrivateKeyForm.checkPass=""})}}},F={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"loginByPrivateKeyForm"},[a("headBox"),e._v(" "),a("div",{staticClass:"contentBox"},[a("h2",{staticClass:"title_h2"},[e._v(e._s(e.$t("loginByPrivateKey.title")))]),e._v(" "),a("hr"),e._v(" "),a("el-form",{ref:"loginByPrivateKeyForm",staticClass:"demo-ruleForm",attrs:{model:e.loginByPrivateKeyForm,"status-icon":"",rules:e.loginByPrivateKeyRules,"label-position":"top","label-width":"80px"}},[a("el-form-item",{attrs:{label:e.$t("loginByPrivateKey.privateKey"),prop:"privateKey"}},[a("el-input",{model:{value:e.loginByPrivateKeyForm.privateKey,callback:function(t){e.$set(e.loginByPrivateKeyForm,"privateKey",t)},expression:"loginByPrivateKeyForm.privateKey"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("loginByPrivateKey.password"),prop:"pass"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.loginByPrivateKeyForm.pass,callback:function(t){e.$set(e.loginByPrivateKeyForm,"pass",t)},expression:"loginByPrivateKeyForm.pass"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("loginByPrivateKey.checkPass"),prop:"checkPass"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.loginByPrivateKeyForm.checkPass,callback:function(t){e.$set(e.loginByPrivateKeyForm,"checkPass",t)},expression:"loginByPrivateKeyForm.checkPass"}})],1),e._v(" "),a("div",{staticStyle:{"text-align":"center","margin-bottom":"22px"}},[a("el-button",{staticStyle:{width:"80%"},attrs:{type:"primary"},on:{click:function(t){e.Login()}}},[e._v(e._s(e.$t("loginByPrivateKey.import")))])],1)],1),e._v(" "),a("a",{staticClass:"backToStartBtn",on:{click:function(t){e.$parent.$parent.backToStart()}}},[e._v(e._s(e.$t("loginByPrivateKey.backToStart")))])],1)],1)},staticRenderFns:[]};var M=a("VU/8")(P,F,!1,function(e){a("2CWT")},"data-v-7112e1f2",null).exports,H={name:"loginByMnemonicForm",data(){return{loginByMnemonicForm:{mnemonic:"",pass:"",checkPass:""},loginByMnemonicRules:{mnemonic:[{validator:(e,t,a)=>{if(!t)return a(new Error(this.$t("loginByMnemonic.callback-4")));console.log(validateMnemonic(t)),validateMnemonic(t)?a():a(new Error(this.$t("loginByMnemonic.callback-2")))},trigger:"blur"}],pass:[{validator:(e,t,a)=>{""===t?a(new Error(this.$t("loginByMnemonic.callback-3"))):(""!==this.loginByMnemonicForm.checkPass&&this.$refs.loginByMnemonicForm.validateField("checkPass"),a())},trigger:"blur"}],checkPass:[{validator:(e,t,a)=>{""===t?a(new Error(this.$t("loginByMnemonic.callback-4"))):t!==this.loginByMnemonicForm.pass?a(new Error(this.$t("loginByMnemonic.callback-5"))):a()},trigger:"blur"}]}}},components:{headBox:T.a},mounted(){this.$nextTick(function(){})},methods:{Login(){this.$refs.loginByMnemonicForm.validate(e=>{if(!e)return console.log("error submit!!"),!1;if("ETH"==this.$store.state.vuexStore.baseChain){let e=this.loginByMnemonicForm.mnemonic;console.log(e);let t=mnemonic2privateKey(e);console.log(t);let a=web3.eth.accounts.encrypt("0x"+t,this.loginByMnemonicForm.pass);console.log(a);let s=web3.utils.toChecksumAddress(a.address);console.log(s),web3.utils.checkAddressChecksum(s)?(this.$store.state.vuexStore.walletInfo.keyStore=a,this.$store.state.vuexStore.walletInfo.address=s,this.$store.state.vuexStore.isLogin=!0,this.$notify({title:this.$t("loginByPrivateKey.callback-6"),dangerouslyUseHTMLString:!0,message:this.$t("loginByPrivateKey.callback-7"),duration:3e3,type:"success"}),this.$router.push("/wallet")):this.$notify.error({title:this.$t("loginByPrivateKey.callback-8"),dangerouslyUseHTMLString:!0,message:this.$t("loginByPrivateKey.callback-9"),duration:3e3}),this.loginByMnemonicForm.mnemonic="",this.loginByMnemonicForm.pass="",this.loginByMnemonicForm.checkPass=""}else this.$store.state.vuexStore.baseChain})}}},A={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"loginByMnemonicForm"},[a("headBox"),e._v(" "),a("div",{staticClass:"contentBox"},[a("h2",{staticClass:"title_h2"},[e._v(e._s(e.$t("loginByMnemonic.title")))]),e._v(" "),a("hr"),e._v(" "),a("el-form",{ref:"loginByMnemonicForm",staticClass:"demo-ruleForm",attrs:{model:e.loginByMnemonicForm,"status-icon":"",rules:e.loginByMnemonicRules,"label-position":"top","label-width":"80px"}},[a("el-form-item",{attrs:{label:e.$t("loginByMnemonic.mnemonic"),prop:"mnemonic"}},[a("el-input",{attrs:{type:"textarea",rows:"2",placeholder:e.$t("loginByMnemonic.mnemonic-txt")},model:{value:e.loginByMnemonicForm.mnemonic,callback:function(t){e.$set(e.loginByMnemonicForm,"mnemonic",t)},expression:"loginByMnemonicForm.mnemonic"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("loginByPrivateKey.password"),prop:"pass"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.loginByMnemonicForm.pass,callback:function(t){e.$set(e.loginByMnemonicForm,"pass",t)},expression:"loginByMnemonicForm.pass"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("loginByPrivateKey.checkPass"),prop:"checkPass"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.loginByMnemonicForm.checkPass,callback:function(t){e.$set(e.loginByMnemonicForm,"checkPass",t)},expression:"loginByMnemonicForm.checkPass"}})],1),e._v(" "),a("el-form-item",{staticStyle:{"text-align":"center"}},[a("el-button",{staticStyle:{width:"80%"},attrs:{type:"primary"},on:{click:function(t){e.Login()}}},[e._v(e._s(e.$t("loginByPrivateKey.import")))])],1)],1),e._v(" "),a("a",{staticClass:"backToStartBtn",on:{click:function(t){e.$parent.$parent.backToStart()}}},[e._v(e._s(e.$t("loginByPrivateKey.backToStart")))])],1)],1)},staticRenderFns:[]};var U=a("VU/8")(H,A,!1,function(e){a("FD4X")},"data-v-27a7dd8c",null).exports,K=a("s/ph"),W={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"loginByKeyStoreForm"},[a("headBox"),e._v(" "),a("div",{staticClass:"contentBox loginByKeyStoreContentBox"},[a("h2",{staticClass:"title_h2"},[e._v(e._s(e.$t("loginByKeyStore.title")))]),e._v(" "),a("hr"),e._v(" "),a("el-form",{ref:"loginByKeyStoreForm",staticClass:"demo-ruleForm",attrs:{"status-icon":"","label-position":"top","label-width":"80px"}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{"on-change":e.handleChange,"file-list":e.fileList,accept:".json","auto-upload":!1,limit:1,action:"/"}},[a("el-button",{attrs:{slot:"trigger"},slot:"trigger"},[e._v(e._s(e.$t("loginByKeyStore.chooseKeyStore")))])],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("loginByKeyStore.password"),prop:"keyStorePass"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.keyStorePass,callback:function(t){e.keyStorePass=t},expression:"keyStorePass"}})],1),e._v(" "),a("div",{staticStyle:{"text-align":"center","margin-bottom":"22px"}},[a("el-button",{staticStyle:{width:"80%"},attrs:{type:"primary"},on:{click:function(t){e.login()}}},[e._v(e._s(e.$t("loginByKeyStore.import")))])],1)],1),e._v(" "),a("a",{staticClass:"backToStartBtn",on:{click:function(t){e.$parent.$parent.backToStart()}}},[e._v(e._s(e.$t("loginByPrivateKey.backToStart")))])],1)],1)},staticRenderFns:[]};var X=function(e){a("DaZ/")},J=a("VU/8")(K.a,W,!1,X,"data-v-1ce428fd",null).exports,G=a("lGmd"),V={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"createForm"},[e._m(0),e._v(" "),a("div",{staticClass:"contentBox"},[a("h2",{staticClass:"title_h2",on:{click:function(t){e.test()}}},[e._v("恢复钱包")]),e._v(" "),a("hr"),e._v(" "),a("el-form",{ref:"backForm",staticClass:"demo-ruleForm",attrs:{model:e.backForm,"status-icon":"","label-position":"top"}},[a("el-form-item",{attrs:{label:e.$t("create.password"),prop:"pass"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.backForm.pass,callback:function(t){e.$set(e.backForm,"pass",t)},expression:"backForm.pass"}})],1),e._v(" "),a("div",{staticStyle:{"text-align":"center",margin:"10% 0 22px"}},[a("el-button",{staticStyle:{width:"80%"},attrs:{type:"primary",disabled:e.isDisable},on:{click:function(t){e.toLoginForm()}}},[e._v("恢复")])],1)],1),e._v(" "),a("a",{staticClass:"backToStartBtn",on:{click:function(t){e.$parent.$parent.backToStart()}}},[e._v(e._s(e.$t("loginByPrivateKey.backToStart")))])],1)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"headBox"},[t("div",{staticClass:"header-button is-left"}),this._v(" "),t("h1"),this._v(" "),t("div",{staticClass:"header-button is-right",staticStyle:{"text-align":"right"}})])}]};var Z=function(e){a("ox10")},j=a("VU/8")(G.a,V,!1,Z,"data-v-fc34252c",null).exports,Y={name:"assetForm",data(){return{buttonBoxData:[{name:this.$t("asset.receive"),icon:"el-icon-ETH-shoukuan",link:"receive"},{name:this.$t("asset.send"),icon:"el-icon-ETH-fukuan",link:"transfer"}],isRecordInfoShow:!1,activeData:{Amount:"",assetType:"",blockHash:"",date:"",isOnChannel:"",isPay:"",isTestNet:"",name:"",state:"",transactionHash:""}}},computed:{assetType(){return this.$store.state.vuexStore.activeAssetInfo.assetType},balanceData(){return this.$store.state.vuexStore.balanceData},recordData(){return this.$store.state.vuexStore.recordList}},filters:{formatAddress:function(e){var t="";return e&&(t=e.replace(/(.{5}).*(.{5})/,"$1......$2")),t},formatIsOnChannel:function(e){return e?"Channel":"Chain"},formatState:function(e){let t;switch(e){case-1:t="Fail";break;case 0:t="Pending";break;case 1:t="Success"}return t},formatIsPay:function(e){return e?"-":"+"},formatDateTime:function(e){var t=new Date(e),a=t.getFullYear(),s=t.getMonth()+1;s=s<10?"0"+s:s;var n=t.getDate();return a+"-"+s+"-"+(n=n<10?"0"+n:n)+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()}},mounted(){this.$nextTick(function(){})},methods:{toOtherForm(e){this.$router.push("/chain/"+e)},formatRecordList(e){let t=this,a=[];var s;console.log(e.length),e.length>0&&e.forEach(function(e,s){0==e.isOnChannel&&e.assetType==t.assetType&&a.push(e)});for(var n=0;n<a.length;n++)for(var o=n;o<a.length;o++)a[n].date<a[o].date&&(s=a[o],a[o]=a[n],a[n]=s);return console.log(a),a},showRecordInfo(e){console.log(e),this.activeData=e,this.isRecordInfoShow=!0},back(){this.isRecordInfoShow?this.isRecordInfoShow=!1:this.$router.go(-1)}}},Q={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"assetForm"},[a("div",{staticClass:"headBox"},[a("div",{staticClass:"header-button is-left"},[a("i",{staticClass:"el-icon-ETH-fanhui",on:{click:function(t){e.back()}}})]),e._v(" "),a("h1",[e._v(e._s(e.assetType))]),e._v(" "),a("div",{staticClass:"header-button is-right"})]),e._v(" "),a("div",{staticStyle:{position:"relative",height:"calc(100% - 44px)"}},[a("div",{staticClass:"assetBox"},[a("div",{staticClass:"amountBox"},[a("h3",[e._v(e._s(e.balanceData.Chain[e.assetType]))])]),e._v(" "),a("div",{staticClass:"buttonBox clearfloat"},[a("el-row",{attrs:{gutter:20}},e._l(e.buttonBoxData,function(t,s){return a("el-col",{key:s,attrs:{span:12}},[a("a",{staticClass:"button-item",on:{click:function(a){e.toOtherForm(t.link)}}},[a("i",{class:t.icon}),e._v(" "),a("p",[e._v(e._s(t.name))])])])}))],1)]),e._v(" "),a("div",{staticClass:"contentBox"},[a("h2",{staticClass:"title_h2",staticStyle:{margin:"0 30px"}},[e._v(e._s(e.$t("record.title")))]),e._v(" "),a("hr",{staticStyle:{"margin-bottom":"0"}}),e._v(" "),e.formatRecordList(e.recordData).length?a("div",{staticStyle:{"overflow-x":"hidden",height:"calc(100% - 50px)"}},[a("ul",{staticClass:"listUl"},e._l(e.formatRecordList(e.recordData),function(t,s){return a("li",{key:s,on:{click:function(a){e.showRecordInfo(t,s)}}},[a("h4",[e._v(e._s(e._f("formatIsOnChannel")(t.isOnChannel))+" - "+e._s(e._f("formatAddress")(t.name))+"\n                          "),a("span",{staticStyle:{float:"right"}},[e._v(e._s(e._f("formatIsPay")(t.isPay))+e._s(t.Amount/1e8)+e._s(t.assetType))])]),e._v(" "),a("p",[e._v(e._s(e._f("formatDateTime")(t.date))),a("span",{staticStyle:{float:"right"}},[e._v("State："+e._s(e._f("formatState")(t.state)))])])])}))]):a("p",{staticStyle:{margin:"30% 0 0","text-align":"center"}},[e._v(e._s(e.$t("record.noRecord")))])]),e._v(" "),e.isRecordInfoShow?a("div",{staticClass:"assetInfo"},[a("h2",{staticClass:"title_h2"},[e._v(e._s(e.$t("record.recordInfo")))]),e._v(" "),a("hr",{staticStyle:{margin:"8px 0 0 0"}}),e._v(" "),a("h1",[e._v(e._s(e._f("formatIsPay")(e.activeData.isPay))+e._s(e.activeData.Amount/1e8)+e._s(e.activeData.assetType))]),e._v(" "),a("p",[e._v(e._s(e.$t("record.state"))+": "+e._s(e._f("formatState")(e.activeData.state)))]),e._v(" "),a("p",[e._v(e._s(e.$t("record.otherUri"))+": "+e._s(e.activeData.name))]),e._v(" "),a("p",[e._v(e._s(e.$t("record.date"))+": "+e._s(e._f("formatDateTime")(e.activeData.date)))]),e._v(" "),a("p",[e._v(e._s(e.$t("record.amount"))+": "+e._s(e.activeData.Amount/1e8)+e._s(e.activeData.assetType))]),e._v(" "),a("p",[e._v(e._s(e.$t("record.isOnChannel"))+": "+e._s(e._f("formatIsOnChannel")(e.activeData.isOnChannel)))]),e._v(" "),a("p",[e._v(e._s(e.$t("record.transactionHash"))+": "+e._s(e.activeData.transactionHash))]),e._v(" "),a("p",[e._v(e._s(e.$t("record.blockHash"))+": "+e._s(e.activeData.blockHash))]),e._v(" "),a("div",{staticStyle:{"text-align":"center",margin:"15% 0"}},[a("el-button",{staticStyle:{width:"80%"},on:{click:function(t){e.isRecordInfoShow=!1}}},[e._v(" "+e._s(e.$t("record.close"))+" ")])],1)]):e._e()])])},staticRenderFns:[]};var z=a("VU/8")(Y,Q,!1,function(e){a("EYaR")},"data-v-1e9aa0c3",null).exports,q=a("f3u+"),ee=a.n(q);s.default.use(ee.a);var te={name:"receiveForm",data:()=>({paymentCodeForm:{amount:"",assetType:"",assetContractAddress:"",selfUri:"",R:"",Hr:"",Code:""},paymentCodeRules:{amount:[{validator:(e,t,a)=>{if(!t)return a(new Error("金额不能为空"));t<0?a(new Error("请输入正确的数字值")):a()},trigger:"blur"}],assetType:[{validator:(e,t,a)=>{""===t?a(new Error("请选择资产类型")):a()},trigger:"change"}]},isPaymentCodeBoxShow:!1}),components:{headBox:T.a},watch:{},mounted(){this.$nextTick(function(){})},computed:{walletInfo(){return"ETH"==this.$store.state.vuexStore.baseChain?this.$store.state.vuexStore.walletInfo:"NEO"==this.$store.state.vuexStore.baseChain?this.$store.state.vuexStore.NEOwalletInfo:void 0}},methods:{copyfun(){let e=this;clipboard&&clipboard.destroy(),clipboard=new ClipboardJS(".btncopy"),clipboard.on("success",function(t){e.$notify.info({title:"消息",dangerouslyUseHTMLString:!0,message:"复制成功",duration:3e3})}),clipboard.on("error",function(t){e.$notify.info({title:"警告",dangerouslyUseHTMLString:!0,message:"复制失败，请自行复制",duration:3e3,type:"warning"})})}}},ae={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"receiveForm"},[a("headBox"),e._v(" "),a("div",{staticClass:"contentBox"},[a("h2",{staticClass:"title_h2"},[e._v(e._s(e.$t("receive.title")))]),e._v(" "),a("hr"),e._v(" "),a("div",{staticClass:"QRCodeBox QRCodeBox-white"},[a("qriously",{attrs:{value:e.walletInfo.address,level:"H",size:210}}),e._v(" "),a("p",[e._v(e._s(e.$t("receive.receiveAddressQRCode")))])],1),e._v(" "),a("hr"),e._v(" "),a("p",[e._v(e._s(e.$t("receive.receiveAddress")))]),e._v(" "),a("h3",{attrs:{id:"receiveAddress"}},[e._v(e._s(e.walletInfo.address))]),e._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{staticClass:"btncopy",attrs:{"data-clipboard-target":"#receiveAddress",type:"primary"},on:{click:function(t){e.copyfun()}}},[e._v(e._s(e.$t("receive.copy")))])],1)])],1)},staticRenderFns:[]};var se=a("VU/8")(te,ae,!1,function(e){a("pG/9")},"data-v-fd6ca1ac",null).exports,ne={name:"transferOnChainForm",data(){return{isDisable:!1,txOnChainInfo:{address:"",assetType:"",amount:"",gasPrice:1,keyStorePass:""},contact:"",txOnChainRules:{address:[{validator:(e,t,a)=>{if(!t)return a(new Error(this.$t("index.callback-1")));"ETH"==this.$store.state.vuexStore.baseChain?web3.utils.checkAddressChecksum(t)?a():a(new Error(this.$t("index.callback-2"))):"NEO"==this.$store.state.vuexStore.baseChain&&(34!==t.length?a(new Error(this.$t("index.callback-2"))):a())},trigger:"blur"}],amount:[{validator:(e,t,a)=>{if(!t)return a(new Error(this.$t("index.callback-3")));isNaN(t)?a(new Error(this.$t("index.callback-4"))):t<0?a(new Error(this.$t("index.callback-5"))):t>this.balanceData.Chain[this.assetType]?a(new Error("转账金额不能大于余额")):a()},trigger:"blur"}],gasPrice:[{validator:(e,t,a)=>{if("ETH"==this.assetType){if(this.Gwei2ETH(t)+this.txOnChainInfo.amount>=this.balanceData.Chain.ETH)return a(new Error("转账金额加矿工费不能大于余额"));a()}else if("TNC"==this.assetType){if(this.Gwei2ETH(t)>=this.balanceData.Chain.ETH)return a(new Error("转账金额加矿工费不能大于余额"));a()}},trigger:"change"}],keyStorePass:[{validator:(e,t,a)=>{if(!t)return a(new Error(this.$t("index.callback-7")));{let e;"ETH"==this.$store.state.vuexStore.baseChain?e=this.$parent.$parent.verifyPassword(this.$store.state.vuexStore.walletInfo.keyStore,t):"NEO"==this.$store.state.vuexStore.baseChain&&(e=scrypt_module_factory(DecryptWalletByPassword,{},{WalletScript:this.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].key,password:t,address:this.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].address})),setTimeout(()=>{if(!e)return a(new Error(this.$t("index.callback-8")));a()},1e3)}},trigger:"blur"}]}}},components:{headBox:T.a},computed:{assetType(){return this.$store.state.vuexStore.activeAssetInfo.assetType},balanceData(){return this.$store.state.vuexStore.balanceData}},filters:{},watch:{},mounted(){this.$nextTick(function(){let e=this;web3.eth.getGasPrice().then(function(t){e.txOnChainInfo.gasPrice=Number(t).div(1e9)}),e.$route.params.address&&(e.txOnChainInfo.address=e.$route.params.address)})},methods:{contactChange(){this.txOnChainInfo.address=this.contact},formatTooltip:e=>e+" Gwei",Gwei2ETH(e){let t,a=this;return e?(t=e.mul(22e3).div(1e9),t=a.$parent.$parent.keepDecimalPlaces(t,7)):t="error",t},txOnChain(){let e=this;e.isDisable=!0,setTimeout(()=>{e.isDisable=!1},2e3),e.$refs.txOnChainInfo.validate(t=>{if(!t)return console.log("error submit!!"),!1;"ETH"==e.$store.state.vuexStore.baseChain?"ETH"==e.assetType?e.txEthOnChain():e.txTncOnChain():"NEO"==e.$store.state.vuexStore.baseChain&&e.NEOtxOnChain()})},txEthOnChain(){let e=this;web3.eth.getTransactionCount(e.$store.state.vuexStore.walletInfo.address,web3.eth.defaultBlock.pending).then(function(t){let a=e.$store.state.vuexStore.gasPrice,s=e.$parent.$parent.decryptPrivateKey(e.$store.state.vuexStore.walletInfo.keyStore,e.txOnChainInfo.keyStorePass),n=e.$store.state.vuexStore.walletInfo.address,o=e.txOnChainInfo.address,r=e.txOnChainInfo.amount.mul(1e18);var i={nonce:web3.utils.toHex(t++),gasLimit:web3.utils.toHex(22e3),gasPrice:web3.utils.toHex(a),to:o,from:n,value:web3.utils.toHex(r),data:""};console.log(i);let l=signData(i,s.privateKey);console.log(l),e.sendSignedTransaction(l)})},async txTncOnChain(){let e=[this.txOnChainInfo.address,this.txOnChainInfo.amount.mul(1e8)],t=await this.$parent.$parent.signDataForERC20Contract(this.$store.state.vuexStore.tncContractAddress,"transfer",["address","uint256"],e,this.txOnChainInfo.keyStorePass,this.txOnChainInfo.gasPrice.mul(1e9));console.log(t),this.sendSignedTransaction(t)},sendSignedTransaction(e){let t=this,a=(new Date).getTime();web3.eth.sendSignedTransaction("0x"+e,function(e,s){if(e)t.$notify({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-25")+e,duration:3e3,type:"error"}),t.$router.push("/chain/asset");else{console.log(s),t.$notify({title:t.$t("common.success"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-14"),duration:3e3,type:"success"});let e={date:a,name:t.txOnChainInfo.address,Amount:t.txOnChainInfo.amount.mul(1e8),assetType:t.assetType,isOnChannel:!1,isPay:!0,state:0,isTestNet:t.$store.state.vuexStore.isTestNet,transactionHash:s,blockHash:""};console.log(t.txOnChainInfo.address),console.log(e),t.$store.state.vuexStore.recordList.push(e),t.$parent.$parent.StoreData("recordList"),t.$parent.$parent.cycleGetTransactionReceipt(s),t.$router.push("/chain/asset")}})},NEOtxOnChain(){let e=this;console.log(e.assetType);let t=e.$parent.$parent.AssetTypeToAssetId(e.assetType);console.log(t),axios({method:"post",url:e.$store.state.vuexStore.NodeRpcUri,headers:{"Content-Type":"application/json;charset=UTF-8"},data:JSON.stringify({jsonrpc:"2.0",method:"constructTx",params:[e.$store.state.vuexStore.NEOwalletInfo.address,e.txOnChainInfo.address,e.txOnChainInfo.amount,t],id:1})}).then(function(t){if(console.log(t.data),t.data.error)e.$notify({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("common.callback-25"),duration:3e3,type:"warning"}),e.$router.go(-1),e.clearTxData();else{let a,s=t.data.result.txData;try{a=scrypt_module_factory(DecryptWalletByPassword,{},{WalletScript:e.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].key,password:e.txOnChainInfo.keyStorePass,address:e.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].address})}catch(t){return e.$notify.error({title:e.$t("loginByKeyStore.callback-9"),dangerouslyUseHTMLString:!0,message:e.$t("loginByKeyStore.callback-8"),duration:3e3}),!1}console.log(a);let n=signatureData(s,a);console.log(n),console.log(e.$store.state.vuexStore.NEOwalletInfo.publicKey);let o=s+t.data.result.witness.replace("{signature}",n).replace("{pubkey}",e.$store.state.vuexStore.NEOwalletInfo.publicKey);axios({method:"post",url:e.$store.state.vuexStore.NodeRpcUri,headers:{"Content-Type":"application/json;charset=UTF-8"},data:JSON.stringify({jsonrpc:"2.0",method:"sendRawTx",params:[o],id:1})}).then(function(a){if(console.log(a),1==a.data.result){e.$notify({title:e.$t("common.success"),dangerouslyUseHTMLString:!0,message:e.$t("common.callback-14"),duration:3e3,type:"success"});let a={date:(new Date).getTime(),name:e.txOnChainInfo.address,Amount:e.txOnChainInfo.amount.mul(1e8),assetType:"TNC",isOnChannel:!1,isPay:!0,state:1,isTestNet:e.$store.state.vuexStore.isTestNet,transactionHash:t.data.result.txid,blockHash:""};console.log(e.txOnChainInfo.address),console.log(a),e.$store.state.vuexStore.recordList.push(a),e.$parent.$parent.StoreData("recordList"),e.$router.go(-1),e.clearTxData()}else e.$notify({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("common.callback-25"),duration:3e3,type:"warning"}),e.$router.go(-1),e.clearTxData()})}})},clearTxData(){this.txOnChainInfo={address:"",assetType:"",amount:"",keyStorePass:""},this.contact=""}}},oe={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"transferOnChainForm"},[a("headBox"),e._v(" "),a("div",{staticClass:"contentBox"},[a("h2",{staticClass:"title_h2"},[e._v(e._s(e.$t("transferOnChian.title1"))+e._s(e.assetType)+e._s(e.$t("transferOnChian.title2")))]),e._v(" "),a("hr"),e._v(" "),a("div",{staticClass:"buttonBox clearfloat"},[a("a",{staticClass:"button-item"},[a("i",{staticClass:"el-icon-ETH-lianxiren"}),e._v(" "),a("p",[e._v(e._s(e.$t("setting.contact")))])]),e._v(" "),a("router-link",{staticClass:"button-item",attrs:{to:"/scan"}},[a("i",{staticClass:"el-icon-ETH-saoyisao"}),e._v(" "),a("p",[e._v(e._s(e.$t("common.scan")))])])],1),e._v(" "),a("el-form",{ref:"txOnChainInfo",staticClass:"demo-ruleForm",attrs:{model:e.txOnChainInfo,"status-icon":"",rules:e.txOnChainRules}},[a("el-form-item",{attrs:{prop:"address"}},[a("el-input",{attrs:{placeholder:e.$t("transferOnChian.address"),"auto-complete":"off"},model:{value:e.txOnChainInfo.address,callback:function(t){e.$set(e.txOnChainInfo,"address",t)},expression:"txOnChainInfo.address"}})],1),e._v(" "),a("label",{staticStyle:{"font-size":"14px","line-height":"28px"},attrs:{for:""}},[e._v(e._s(e.$t("transferOnChian.amount"))+": ")]),e._v(" "),a("span",{staticStyle:{"font-size":"14px","line-height":"28px",float:"right"}},[e._v(e._s(e.$t("transferOnChian.balance"))+": "+e._s(e.balanceData.Chain[e.assetType])+e._s(e.assetType))]),e._v(" "),a("el-form-item",{attrs:{prop:"amount"}},[a("el-input",{attrs:{placeholder:e.$t("transferOnChian.amount"),"auto-complete":"off"},model:{value:e.txOnChainInfo.amount,callback:function(t){e.$set(e.txOnChainInfo,"amount",e._n("string"==typeof t?t.trim():t))},expression:"txOnChainInfo.amount"}})],1),e._v(" "),"ETH"==e.$store.state.vuexStore.baseChain?[a("span",[e._v(e._s(e.$t("transferOnChian.miningFee"))+": ")]),e._v(" "),a("span",{staticStyle:{float:"right"}},[e._v(" ≈ "+e._s(e.Gwei2ETH(e.txOnChainInfo.gasPrice))+" ETH")]),e._v(" "),a("el-form-item",{attrs:{prop:"gasPrice"}},[a("el-slider",{attrs:{min:1,max:100,step:.1,"format-tooltip":e.formatTooltip},model:{value:e.txOnChainInfo.gasPrice,callback:function(t){e.$set(e.txOnChainInfo,"gasPrice",t)},expression:"txOnChainInfo.gasPrice"}})],1)]:e._e(),e._v(" "),"NEO"==e.$store.state.vuexStore.baseChain?a("span",[e._v("密码: ")]):e._e(),e._v(" "),a("el-form-item",{attrs:{prop:"keyStorePass"}},[a("el-input",{attrs:{type:"password",placeholder:e.$t("index.password"),"auto-complete":"off"},model:{value:e.txOnChainInfo.keyStorePass,callback:function(t){e.$set(e.txOnChainInfo,"keyStorePass",t)},expression:"txOnChainInfo.keyStorePass"}})],1)],2),e._v(" "),a("div",{staticStyle:{"text-align":"center","margin-top":"10%"}},[a("el-button",{staticClass:"transferBtn",attrs:{type:"primary",disabled:e.isDisable},on:{click:function(t){e.txOnChain()}}},[e._v(e._s(e.$t("index.transfer")))])],1)],1)],1)},staticRenderFns:[]};var re=a("VU/8")(ne,oe,!1,function(e){a("7sHk")},"data-v-d589c6f8",null).exports,ie={name:"addChannelForm",data(){return{addChannelForm:{uri:"",assetType:"",selfDeposit:0,otherDeposit:0,alice:"",channelName:"",selfSignedData:"",txData:"",keyStorePass:""},addChannelRules:{uri:[{validator:(e,t,a)=>{let s=this;if(!t)return a(new Error(s.$t("addChannel.callback-1")));t.indexOf("@")<=-1||t.indexOf(":")<=-1?a(new Error(s.$t("addChannel.callback-2"))):("ETH"==s.baseChain?42!==t.split("@")[0].length&&a(new Error(s.$t("addChannel.callback-2"))):"NEO"==s.baseChain&&66!==t.split("@")[0].length&&a(new Error(s.$t("addChannel.callback-2"))),s.$store.state.vuexStore.channelList.forEach(function(e,t){e.OtherUri===s.addChannelForm.uri&&a(new Error(s.$t("addChannel.callback-3")))}),a())},trigger:"blur"}],assetType:[{validator:(e,t,a)=>{""===t?a(new Error(this.$t("index.inputAssetType"))):a()},trigger:"change"}],selfDeposit:[{validator:(e,t,a)=>{if(""===t)a(new Error(this.$t("addChannel.callback-4")));else if(t<=0)a(new Error(this.$t("addChannel.callback-5")));else if(t>this.$store.state.vuexStore.balanceData.Chain[this.addChannelForm.assetType])a(new Error(this.$t("addChannel.callback-6")));else if(String(t).indexOf(".")>-1){let e=String(t).indexOf(".")+1;String(t).length-e>8?a(new Error(this.$t("addChannel.callback-7"))):a()}else a()},trigger:"blur"}],otherDeposit:[{validator:(e,t,a)=>{""===t?a(new Error(this.$t("addChannel.callback-8"))):t<=0?a(new Error(this.$t("addChannel.callback-9"))):a()},trigger:"change"}],alice:[{validator:(e,t,a)=>{""===t?a(new Error(this.$t("addChannel.callback-10"))):a()},trigger:"blur"}],keyStorePass:[{validator:(e,t,a)=>{if(!t)return a(new Error(this.$t("common.callback-1")));{let e;"ETH"==this.baseChain?(console.log(this.$store.state.vuexStore.walletInfo),console.log(t),e=this.$parent.$parent.verifyPassword(this.$store.state.vuexStore.walletInfo.keyStore,t)):"NEO"==this.baseChain&&(e=scrypt_module_factory(DecryptWalletByPassword,{},{WalletScript:this.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].key,password:t,address:this.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].address})),setTimeout(()=>{if(!e)return a(new Error(this.$t("common.callback-2")));a()},300)}},trigger:"blur"}]}}},components:{headBox:T.a},computed:{baseChain(){return this.$store.state.vuexStore.baseChain},keyStore(){return this.$store.state.vuexStore.walletInfo.keyStore},spvPort(){return this.$store.state.vuexStore.spvPort},NetMagic(){return this.$store.state.vuexStore.NetMagic},isTestNet(){return this.$store.state.vuexStore.isTestNet}},mounted(){this.$nextTick(function(){this.$route.params.Uri&&(this.addChannelForm.uri=this.$route.params.Uri)})},methods:{addChannel(){let e=this;e.$refs.addChannelForm.validate(t=>{if(!t)return console.log("error submit!!"),!1;if("ETH"==e.baseChain){var a=e.$store.state.vuexStore.channelList.length;console.log(a);let t=(new Date).getTime(),o=e.addChannelForm.selfDeposit.mul(1e8),r=e.addChannelForm.uri,i=e.addChannelForm.otherDeposit.mul(1e8),l=1,c=e.addChannelForm.assetType,d=e.$parent.$parent.uri2Ip(r,e.spvPort),h=e.$store.state.vuexStore.walletInfo.address+"@"+d,u="0x"+md5encode(r,t)+md5encode(h,t),m=e.addChannelForm.keyStorePass;console.log(u);const g="ws://"+d+"/";(n={Ip:e.$parent.$parent.uri2Ip(r,null),websock:new WebSocket(g)}).websock.onmessage=e.$parent.$parent.websocketOnmessage,n.websock.onclose=e.$parent.$parent.websocketClose,console.log(n),e.$store.state.vuexStore.webSocketList.push(n);let p=web3.utils.soliditySha3({t:"bytes32",v:u},{t:"uint256",v:l},{t:"address",v:h.split("@")[0]},{t:"uint256",v:o},{t:"address",v:r.split("@")[0]},{t:"uint256",v:i});console.log(p);let v=e.$parent.$parent.decryptPrivateKey(e.keyStore,m),f=ecSign(p,v.privateKey);console.log(f);var s={MessageType:"Founder",Sender:h,Receiver:r,TxNonce:l,ChannelName:u,NetMagic:e.NetMagic,AssetType:c,MessageBody:{FounderDeposit:o,PartnerDeposit:i,Commitment:f}};setTimeout(function(){e.$parent.$parent.sendWebsocket(r,s)},2e3),e.addChannelForm.channelName=u,e.addChannelForm.txData=p,e.addChannelForm.selfSignedData=f,e.$store.state.vuexStore.addChannelInfo=e.addChannelForm,console.log(e.$store.state.vuexStore.addChannelInfo),e.$store.state.vuexStore.walletInfo.keyStorePass=m;let y={ChannelName:u,Alice:e.addChannelForm.alice,State:2,isConnect:!0,SelfBalance:o,OtherBalance:i,assetType:c,isTestNet:e.isTestNet,SelfUri:h,OtherUri:r,TxNonce:l,date:t,Ip:e.$parent.$parent.uri2Ip(r,null)};e.$store.state.vuexStore.channelList[a]=y,e.$parent.$parent.StoreData("channelList"),e.$router.push("/channel/channelList")}else if("NEO"==e.baseChain){let t=e.$parent.$parent.uri2Ip(e.addChannelForm.uri,e.$store.state.vuexStore.spvPort);const o="ws://"+t+"/";a=e.$store.state.vuexStore.channelList.length;console.log(a);let r=e.$store.state.vuexStore.NEOwalletInfo.publicKey+"@"+t,i=(e.addChannelForm.uri.split("@")[0],(new Date).getTime());var n;e.addChannelForm.channelName=md5encode(e.addChannelForm.uri,i),console.log(e.addChannelForm.channelName),(n={Ip:e.$parent.$parent.uri2Ip(e.addChannelForm.uri,null),websock:new WebSocket(o)}).websock.onmessage=e.$parent.$parent.websocketOnmessage,n.websock.onclose=e.$parent.$parent.websocketClose,console.log(n),e.$store.state.vuexStore.webSocketList.push(n);s={MessageType:"RegisterChannel",Sender:r,Receiver:e.addChannelForm.uri,ChannelName:e.addChannelForm.channelName,NetMagic:e.$store.state.vuexStore.NetMagic,MessageBody:{AssetType:e.addChannelForm.assetType,Deposit:parseFloat(e.addChannelForm.selfDeposit)}};setTimeout(function(){e.$parent.$parent.sendWebsocket(e.addChannelForm.uri,s)},2e3),e.$store.state.vuexStore.addChannelInfo=e.addChannelForm,console.log(e.$store.state.vuexStore.addChannelInfo);let l={ChannelName:e.addChannelForm.channelName,Alice:e.addChannelForm.alice,State:2,isConnect:!0,SelfBalance:e.addChannelForm.selfDeposit.mul(1e8),OtherBalance:e.addChannelForm.otherDeposit.mul(1e8),assetType:e.addChannelForm.assetType,isTestNet:e.$store.state.vuexStore.isTestNet,SelfUri:r,OtherUri:e.addChannelForm.uri,TxNonce:1,date:i,Ip:e.$parent.$parent.uri2Ip(e.addChannelForm.uri,null)};e.$store.state.vuexStore.channelList[a]=l,e.$parent.$parent.StoreData("channelList"),e.$router.push("/channel/channelList")}})},removeAddChannelData(){this.$refs.addChannelForm.resetFields(),this.$router.push("/channel/channelList")}}},le={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"addChannelBox"},[a("headBox"),e._v(" "),a("div",{staticClass:"contentBox"},[a("div",[e.addChannelForm.assetType?a("p",{staticStyle:{float:"right",margin:"5px 30px 5px 0","font-size":"16px"}},[e._v(e._s(e.$t("addChannel.assetBalance"))+"："+e._s(e.$store.state.vuexStore.balanceData.Chain[e.addChannelForm.assetType])+e._s(e.addChannelForm.assetType))]):e._e(),e._v(" "),a("h2",{staticClass:"title_h2",staticStyle:{margin:"0 30px"}},[e._v(e._s(e.$t("addChannel.title")))])]),e._v(" "),a("hr",{staticStyle:{height:"2px",border:"none","border-top":"2px dotted #EBEEF5",margin:"6px 30px"}}),e._v(" "),a("div",{staticClass:"formBox"},[a("el-form",{ref:"addChannelForm",staticClass:"addChannelForm",attrs:{model:e.addChannelForm,"status-icon":"",rules:e.addChannelRules,"label-position":"top"}},[a("el-form-item",{attrs:{label:e.$t("addChannel.otherUri"),prop:"uri"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:e.$t("addChannel.otherUriPlaceHolder")},model:{value:e.addChannelForm.uri,callback:function(t){e.$set(e.addChannelForm,"uri",t)},expression:"addChannelForm.uri"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("addChannel.assetType"),prop:"assetType"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("addChannel.chooseAssetType")},model:{value:e.addChannelForm.assetType,callback:function(t){e.$set(e.addChannelForm,"assetType",t)},expression:"addChannelForm.assetType"}},["ETH"==e.$store.state.vuexStore.baseChain?[a("el-option",{attrs:{label:"TNC",value:"TNC"}}),e._v(" "),a("el-option",{attrs:{label:"ETH",value:"ETH",disabled:""}})]:e._e(),e._v(" "),"NEO"==e.$store.state.vuexStore.baseChain?[a("el-option",{attrs:{label:"TNC",value:"TNC"}}),e._v(" "),a("el-option",{attrs:{label:"NEO",value:"NEO"}}),e._v(" "),a("el-option",{attrs:{label:"GAS",value:"GAS"}})]:e._e()],2)],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("addChannel.selfDeposit"),prop:"selfDeposit"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addChannelForm.selfDeposit,callback:function(t){e.$set(e.addChannelForm,"selfDeposit",e._n(t))},expression:"addChannelForm.selfDeposit"}})],1),e._v(" "),"ETH"==e.$store.state.vuexStore.baseChain?a("el-form-item",{attrs:{label:e.$t("addChannel.otherDeposit"),prop:"otherDeposit"}},[a("el-slider",{attrs:{"show-input-controls":!1,max:e.addChannelForm.selfDeposit,step:1e-5,"show-input":""},model:{value:e.addChannelForm.otherDeposit,callback:function(t){e.$set(e.addChannelForm,"otherDeposit",t)},expression:"addChannelForm.otherDeposit"}})],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:e.$t("addChannel.alice"),prop:"alice"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addChannelForm.alice,callback:function(t){e.$set(e.addChannelForm,"alice",t)},expression:"addChannelForm.alice"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("addChannel.password"),prop:"keyStorePass"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.addChannelForm.keyStorePass,callback:function(t){e.$set(e.addChannelForm,"keyStorePass",t)},expression:"addChannelForm.keyStorePass"}})],1),e._v(" "),a("div",{staticStyle:{"text-align":"center","margin-bottom":"10%"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addChannel()}}},[e._v(e._s(e.$t("addChannel.addChannel")))]),e._v(" "),a("el-button",{on:{click:function(t){e.removeAddChannelData()}}},[e._v(e._s(e.$t("addChannel.cancel")))])],1)],1)],1)])],1)},staticRenderFns:[]};var ce=a("VU/8")(ie,le,!1,function(e){a("cToj")},"data-v-90c7b0ca",null).exports,de={name:"channelListForm",data:()=>({buttonBoxData:[{name:"收 款",icon:"el-icon-ETH-shoukuan",link:"/channel/createPayment"},{name:"付 款",icon:"el-icon-ETH-fukuan",link:"/channel/payment"},{name:"添 加",icon:"el-icon-plus",link:"/channel/addChannel"}]}),components:{headBox:T.a},computed:{channelList(){return this.$store.state.vuexStore.channelList}},filters:{formatStatus:function(e){let t;switch(e){case 1:t="Closing";break;case 2:t="Opening";break;case 3:t="Open";break;default:t="Error"}return t},formatBalance:function(e){let t;return t=e<0||isNaN(e)?"error":Number(e).div(1e8)},formatDateTime:function(e){let t=new Date;t.setTime(e);let a=t.getFullYear(),s=t.getMonth()+1;s=s<10?"0"+s:s;let n=t.getDate();return a+"-"+s+"-"+(n=n<10?"0"+n:n)},formatConnect:function(e){let t;return t=e?"True":"False"},formatNet:function(e){let t;return t=e?"TestNet":"MainNet"}},mounted(){this.$nextTick(function(){})},watch:{"$store.state.vuexStore.walletInfo.channelList":"getAddressInfo"},methods:{toChannelAssetForm(e,t){console.log(e),e.ChannelName&&(this.$router.push("/channel/channelAsset"),this.$store.state.vuexStore.activeAssetInfo.channelName=e.ChannelName)},formatChannelList(e){let t=this,a=[];return e.forEach(function(e,s){e.isTestNet==t.$store.state.vuexStore.isTestNet&&a.push(e)}),a}}},he={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"channelListForm",class:{fullPage:!e.$store.state.vuexStore.isNavShow}},[a("headBox"),e._v(" "),a("div",{staticClass:"contentBox"},[a("div",[a("h2",{staticClass:"title_h2"},[e._v(e._s(e.$t("channelList.title")))])]),e._v(" "),a("hr",{staticStyle:{margin:"8px 0 0 0"}}),e._v(" "),a("div",{staticClass:"buttonBox"},[a("el-row",{attrs:{gutter:20}},e._l(e.buttonBoxData,function(t,s){return a("el-col",{key:s,attrs:{span:8}},[a("router-link",{staticClass:"button-item",attrs:{to:t.link}},[a("i",{class:t.icon}),e._v(" "),a("p",[e._v(e._s(t.name))])])],1)}))],1),e._v(" "),e.formatChannelList(e.channelList).length?a("div",{staticStyle:{"overflow-x":"hidden",height:"calc(100% - 220px)"}},[a("ul",{staticClass:"listUl"},e._l(e.formatChannelList(e.channelList),function(t,s){return a("li",{key:s,on:{click:function(a){e.toChannelAssetForm(t,s)}}},[a("h3",[e._v(e._s(t.Alice))]),a("br"),e._v(" "),a("p",[e._v(e._s(e._f("formatDateTime")(t.date)))]),e._v(" "),t.isConnect?a("p",{staticStyle:{"min-width":"180px"}},[e._v("State："+e._s(e._f("formatStatus")(t.State)))]):e._e(),e._v(" "),t.isConnect?e._e():a("p",{staticStyle:{"min-width":"180px"}},[e._v("State：NotConnect")]),e._v(" "),a("span",[e._v(e._s(e._f("formatBalance")(t.SelfBalance))),a("sup",[e._v(e._s(t.assetType))])])])}))]):e._e(),e._v(" "),e.formatChannelList(e.channelList).length?e._e():a("p",{staticStyle:{"text-align":"center","margin-top":"20vh","font-size":"14px",color:"#5e6d82","line-height":"1.5em","font-weight":"400"}},[e._v("\n          "+e._s(e.$t("channelList.noChannel"))+"\n      ")])])],1)},staticRenderFns:[]};var ue=a("VU/8")(de,he,!1,function(e){a("rXUA")},"data-v-71196bfd",null).exports,me={name:"assetForm",data:()=>({isRecordInfoShow:!1,activeData:{Amount:"",assetType:"",blockHash:"",date:"",isOnChannel:"",isPay:"",isTestNet:"",name:"",state:"",transactionHash:""}}),computed:{channelName(){return this.$store.state.vuexStore.activeAssetInfo.channelName},Data(){let e=this,t={};return e.$store.state.vuexStore.activeAssetInfo.channelName&&e.$store.state.vuexStore.channelList.forEach(function(a,s){a.ChannelName==e.$store.state.vuexStore.activeAssetInfo.channelName&&(t=a)}),t},recordData(){return this.$store.state.vuexStore.recordList}},filters:{formatAddress:function(e){var t="";return e&&(t=e.replace(/(.{5}).*(.{5})/,"$1......$2")),t},formatBalance:function(e){let t;return t=e<0||isNaN(e)?"error":Number(e).div(1e8)},formatState:function(e){let t;switch(e){case-1:t="Fail";break;case 0:t="Pending";break;case 1:t="Success"}return t},formatIsPay:function(e){return e?"-":"+"},formatDateTime:function(e){var t=new Date(e),a=t.getFullYear(),s=t.getMonth()+1;s=s<10?"0"+s:s;var n=t.getDate();return a+"-"+s+"-"+(n=n<10?"0"+n:n)+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()}},mounted(){this.$nextTick(function(){})},methods:{toOtherForm(e){this.$router.push("/channel/"+e)},formatRecordList(e){let t=this,a=[];if(e.length){var s;e.forEach(function(e,s){e.channelName==t.channelName&&a.push(e)});for(var n=0;n<a.length;n++)for(var o=n;o<a.length;o++)a[n].date<a[o].date&&(s=a[o],a[o]=a[n],a[n]=s)}return console.log(a),a},showChannelInfo(){console.log(this.Data),this.$router.push({name:"channelInfo",params:{Data:this.Data}})},showRecordInfo(e){console.log(e),this.activeData=e,this.isRecordInfoShow=!0},back(){this.isRecordInfoShow?this.isRecordInfoShow=!1:this.$router.go(-1)}}},ge={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"assetForm"},[a("div",{staticClass:"headBox"},[a("div",{staticClass:"header-button is-left"},[a("i",{staticClass:"el-icon-ETH-fanhui",on:{click:function(t){e.back()}}})]),e._v(" "),a("h1",[e._v("通道 - "+e._s(e.Data.Alice))]),e._v(" "),a("div",{staticClass:"header-button is-right"})]),e._v(" "),a("div",{staticStyle:{position:"relative",height:"calc(100% - 44px)"}},[a("div",{staticClass:"assetBox"},[a("div",{staticClass:"amountBox"},[a("h3",[e._v(e._s(e._f("formatBalance")(e.Data.SelfBalance))+e._s(e.Data.assetType))])]),e._v(" "),a("div",{staticClass:"buttonBox"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("router-link",{staticClass:"button-item",attrs:{to:"/channel/createPayment"}},[a("i",{staticClass:"el-icon-ETH-shoukuan"}),e._v(" "),a("p",[e._v("收款")])])],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("router-link",{staticClass:"button-item",attrs:{to:"/channel/payment"}},[a("i",{staticClass:"el-icon-ETH-fukuan"}),e._v(" "),a("p",[e._v("付款")])])],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("a",{staticClass:"button-item",on:{click:function(t){e.showChannelInfo()}}},[a("i",{staticClass:"el-icon-ETH-xiangqing"}),e._v(" "),a("p",[e._v("详情")])])])],1)],1)]),e._v(" "),a("div",{staticClass:"contentBox"},[a("h2",{staticClass:"title_h2",staticStyle:{margin:"0 30px"}},[e._v("交易记录")]),e._v(" "),a("hr",{staticStyle:{"margin-bottom":"0"}}),e._v(" "),e.formatRecordList(e.recordData).length?a("div",{staticStyle:{"overflow-x":"hidden",height:"100%"}},[a("ul",{staticClass:"listUl"},e._l(e.formatRecordList(e.recordData),function(t,s){return a("li",{key:s,on:{click:function(a){e.showRecordInfo(t,s)}}},[a("h4",[e._v(e._s(t.isOnChannel)+" - "+e._s(e._f("formatAddress")(t.name))+"\n                          "),a("span",{staticStyle:{float:"right"}},[e._v(e._s(e._f("formatIsPay")(t.isPay))+e._s(t.Amount/1e8)+e._s(t.assetType))])]),e._v(" "),a("p",[e._v(e._s(e._f("formatDateTime")(t.date))),a("span",{staticStyle:{float:"right"}},[e._v("State："+e._s(e._f("formatState")(t.state)))])])])}))]):a("p",{staticStyle:{margin:"30% 0 0","text-align":"center"}},[e._v("没有交易记录")])]),e._v(" "),e.isRecordInfoShow?a("div",{staticClass:"channelAssetInfo"},[a("h2",{staticClass:"title_h2"},[e._v("交易详情")]),e._v(" "),a("hr",{staticStyle:{margin:"8px 0 0 0"}}),e._v(" "),a("h1",[e._v(e._s(e._f("formatIsPay")(e.activeData.isPay))+e._s(e.activeData.Amount/1e8)+e._s(e.activeData.assetType))]),e._v(" "),a("p",[e._v(e._s(e.$t("record.state"))+": "+e._s(e._f("formatState")(e.activeData.state)))]),e._v(" "),a("p",[e._v(e._s(e.$t("record.otherUri"))+": "+e._s(e.activeData.name))]),e._v(" "),a("p",[e._v(e._s(e.$t("record.date"))+": "+e._s(e._f("formatDateTime")(e.activeData.date)))]),e._v(" "),a("p",[e._v(e._s(e.$t("record.amount"))+": "+e._s(e.activeData.Amount/1e8)+e._s(e.activeData.assetType))]),e._v(" "),a("p",[e._v(e._s(e.$t("record.isOnChannel"))+": "+e._s(e._f("formatIsOnChannel")(e.activeData.isOnChannel)))]),e._v(" "),a("p",[e._v(e._s(e.$t("record.transactionHash"))+": "+e._s(e.activeData.transactionHash))]),e._v(" "),a("p",[e._v(e._s(e.$t("record.blockHash"))+": "+e._s(e.activeData.blockHash))]),e._v(" "),a("div",{staticStyle:{"text-align":"center",margin:"15%"}},[a("el-button",{staticStyle:{width:"80%"},on:{click:function(t){e.isRecordInfoShow=!1}}},[e._v(" "+e._s(e.$t("record.close"))+" ")])],1)]):e._e()])])},staticRenderFns:[]};var pe=a("VU/8")(me,ge,!1,function(e){a("soYl")},"data-v-06fb6d10",null).exports,ve={name:"channelInfoForm",data(){return{isConfirmCloseChannel:!1,channelInfo:{keyStorePass:""},confirmCloseRules:{keyStorePass:[{validator:(e,t,a)=>{if(!t)return a(new Error("钱包密码不能为空，否则将无法交易"));{let e;"ETH"==this.$store.state.vuexStore.baseChain?e=this.$parent.$parent.verifyPassword(this.$store.state.vuexStore.walletInfo.keyStore,t):"NEO"==this.$store.state.vuexStore.baseChain&&(e=scrypt_module_factory(DecryptWalletByPassword,{},{WalletScript:this.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].key,password:t,address:this.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].address})),setTimeout(()=>{if(!e)return a(new Error(this.$t("index.callback-8")));a()},1e3)}},trigger:"blur"}]}}},computed:{Data(){if(this.$route.params.Data)return this.$route.params.Data;return{Alice:"",ChannelName:"",date:"",SelfUri:"",SelfBalance:"",OtherUri:"",OtherBalance:"",State:"",isConnect:"",isTestNet:""}},spvPort(){return this.$store.state.vuexStore.spvPort}},mounted(){this.$nextTick(function(){console.log(this.$route.params.Data),this.$route.params.Data||this.$router.push("/start")})},watch:{},filters:{formatStatus:function(e){let t;switch(e){case 1:t="Closing";break;case 2:t="Opening";break;case 3:t="Open";break;default:t="Error"}return t},formatDateTime:function(e){let t=new Date;t.setTime(e);let a=t.getFullYear(),s=t.getMonth()+1;s=s<10?"0"+s:s;let n=t.getDate();return a+"-"+s+"-"+(n=n<10?"0"+n:n)},formatBalance:function(e){let t;return t=e<0||isNaN(e)?"error":e/1e8},formatConnect:function(e){let t;return t=e?"True":"False"},formatNet:function(e){let t;return t=e?"TestNet":"MainNet"}},methods:{reconnectWebsocket(){this.$parent.$parent.reconnectWebsocket(this.Data.Ip,this.Data.ChannelName)},closeChannel(){let e=this;e.$refs.channelInfo.validate(t=>{if(!t)return console.log("error submit!!"),!1;{let t=e.$parent.$parent.getChannelSerial("ChannelName",e.Data.ChannelName);if(console.log(t),t>=0)if(console.log(e.$store.state.vuexStore.channelList[t].isConnect),void 0==e.$store.state.vuexStore.channelList[t].transactionHash)e.$store.state.vuexStore.channelList.splice(t,1),e.channelInfo.keyStorePass="",e.$router.push("/channel/channelList");else if("ETH"==e.$store.state.vuexStore.baseChain){let a=web3.utils.soliditySha3({t:"bytes32",v:e.Data.ChannelName},{t:"uint256",v:0},{t:"address",v:e.$store.state.vuexStore.walletInfo.address},{t:"uint256",v:e.Data.SelfBalance},{t:"address",v:e.Data.OtherUri.split("@")[0]},{t:"uint256",v:e.Data.OtherBalance});console.log(a);let s=e.$parent.$parent.decryptPrivateKey(e.$store.state.vuexStore.walletInfo.keyStore,e.channelInfo.keyStorePass),n=ecSign(a,s.privateKey);console.log(n);let o={MessageType:"Settle",Sender:e.Data.SelfUri,Receiver:e.Data.OtherUri,TxNonce:0,ChannelName:e.Data.ChannelName,AssetType:e.Data.assetType,NetMagic:e.$store.state.vuexStore.NetMagic,MessageBody:{Commitment:n,SenderBalance:e.Data.SelfBalance,ReceiverBalance:e.Data.OtherBalance},Comments:{}};e.$parent.$parent.sendWebsocket(e.Data.OtherUri,o),e.$store.state.vuexStore.closeChannelInfo=e.Data,e.$store.state.vuexStore.closeChannelInfo.txData=a,e.$store.state.vuexStore.closeChannelInfo.keyStorePass=e.channelInfo.keyStorePass,console.log(e.$store.state.vuexStore.closeChannelInfo.txData),e.$store.state.vuexStore.closeChannelInfo.selfSignedData=n,e.$store.state.vuexStore.channelList[t].State=1,setTimeout(()=>{e.$router.push("/channel/channelList")},1e3)}else if("NEO"==e.$store.state.vuexStore.baseChain){let t,a,s,n;try{t=scrypt_module_factory(DecryptWalletByPassword,{},{WalletScript:e.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].key,password:e.channelInfo.keyStorePass,address:e.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].address})}catch(t){return e.$notify.error({title:e.$t("loginByKeyStore.callback-9"),dangerouslyUseHTMLString:!0,message:e.$t("loginByKeyStore.callback-8"),duration:3e3}),!1}console.log(t),e.$store.state.vuexStore.txList.forEach(function(t,o){t.channelName==e.Data.ChannelName&&(a=t.history[1].addressFunding,s=t.history[1].scriptFunding,n=t.history[1].txId)}),console.log(a),console.log(s),console.log(n),axios({method:"post",url:e.$store.state.vuexStore.NodeRpcUri,headers:{"Content-Type":"application/json;charset=UTF-8"},data:JSON.stringify({jsonrpc:"2.0",method:"RefoundTrans",params:[a,Number(e.Data.SelfBalance).div(1e8),Number(e.Data.OtherBalance).div(1e8),e.Data.SelfUri.split("@")[0],e.Data.OtherUri.split("@")[0],s,e.Data.assetType],id:1})}).then(function(a){console.log(a);let s={};s[e.Data.SelfUri.split("@")[0]]={},s[e.Data.OtherUri.split("@")[0]]={},s[e.Data.SelfUri.split("@")[0]].TNC=Number(e.Data.SelfBalance).div(1e8),s[e.Data.OtherUri.split("@")[0]].TNC=Number(e.Data.OtherBalance).div(1e8);let n=a.data.result.Settlement;console.log(n);let o=signatureData(n.txData,t);e.$store.state.vuexStore.closeChannelInfo.txData=n.txData,e.$store.state.vuexStore.closeChannelInfo.selfSignedData=o,e.$store.state.vuexStore.closeChannelInfo.witness=n.witness,e.$store.state.vuexStore.closeChannelInfo.keyStorePass=e.channelInfo.keyStorePass,console.log(e.$store.state.vuexStore.closeChannelInfo);let r={MessageType:"Settle",Sender:e.Data.SelfUri,Receiver:e.Data.OtherUri,TxNonce:e.Data.TxNonce,ChannelName:e.Data.ChannelName,MessageBody:{Settlement:n,Balance:s}};e.$parent.$parent.sendWebsocket(e.Data.OtherUri,r),setTimeout(()=>{e.$router.push("/channel/channelList")},1e3)})}}})},forcedCloseChannel(){this.$refs.channelInfo.validate(e=>{if(e){let e=this.$parent.$parent.getChannelSerial("ChannelName",this.Data.ChannelName);console.log(e),e>=0&&(console.log("\b进入强制拆通道"),this.forcedCloseChannelFun())}})},async forcedCloseChannelFun(){let e,t,a,s,n,o,r,i,l=this,c=l.Data.ChannelName,d=l.Data.TxNonce;l.$store.state.vuexStore.txList.forEach(function(l,d){if(l.channelName==c){let c=l.history;for(var h=c.length-1;h>0;h--)if(console.log(c),console.log(c[h]),"confirmed"==c[h].state&&!c[h].delayTxData){e=c[h].founder,t=c[h].founderBalance,a=c[h].peer,s=c[h].peerBalance,n=c[h].founderSignedData,o=c[h].peerSignedData,r=c[h].HashR,i=c[h].R;break}}});let h=[c,d,e,t,a,s,r||"0x"+addPreZero(0,64),i||"0x"+addPreZero(0,64),n,o],m=await l.$parent.$parent.signDataForERC20Contract(l.$store.state.vuexStore.trinityContractAddress,"closeChannel",["bytes32","uint256","address","uint256","address","uint256","bytes32","bytes32","bytes","bytes"],h,l.channelInfo.keyStorePass);console.log(m);(new Date).getTime();web3.eth.sendSignedTransaction("0x"+m).on("transactionHash",function(e){console.log(e),l.$notify({title:"成功",dangerouslyUseHTMLString:!0,message:"上链成功，请交易确认",duration:3e3,type:"success"});let t=l.$parent.$parent.getChannelSerial("ChannelName",l.Data.ChannelName),a=l.$store.state.vuexStore.channelList[t];a.State=1,u.a.set(l.$store.state.vuexStore.channelList,t,a),console.log(l.$store.state.vuexStore.channelList[t]),l.$parent.$parent.StoreData("channelList"),l.$router.push("/channel/channelList"),l.$parent.$parent.cycleGetTransactionReceipt(e)}).on("receipt",console.log).on("error",function(e){console.log(e)})}}},fe={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"channelInfoForm"},[a("div",{staticClass:"headBox"},[a("div",{staticClass:"header-button is-left"},[a("i",{staticClass:"el-icon-ETH-fanhui",on:{click:function(t){e.$router.go(-1)}}})]),e._v(" "),a("h1"),e._v(" "),a("div",{staticClass:"header-button is-right",staticStyle:{"text-align":"right"}},[e.isConfirmCloseChannel?a("p",{on:{click:function(t){e.forcedCloseChannel()}}},[e._v("强制关闭")]):e._e()])]),e._v(" "),a("div",{staticClass:"contentBox"},[a("h2",{staticClass:"title_h2"},[e._v(e._s(e.Data.Alice)+" - 通道信息")]),e._v(" "),a("hr"),e._v(" "),a("p",[e._v(e._s(e.$t("channelList.channelName"))+"："+e._s(e.Data.ChannelName))]),e._v(" "),a("p",[e._v(e._s(e.$t("channelList.date"))+"："+e._s(e._f("formatDateTime")(e.Data.date)))]),e._v(" "),a("p",[e._v(e._s(e.$t("channelList.selfUri"))+"："+e._s(e.Data.SelfUri))]),e._v(" "),a("p",[e._v(e._s(e.$t("channelList.selfBalance"))+"："+e._s(e._f("formatBalance")(e.Data.SelfBalance))+e._s(e.Data.assetType))]),e._v(" "),a("p",[e._v(e._s(e.$t("channelList.otherUri"))+"："+e._s(e.Data.OtherUri))]),e._v(" "),a("p",[e._v(e._s(e.$t("channelList.otherBalance"))+"："+e._s(e._f("formatBalance")(e.Data.OtherBalance))+e._s(e.Data.assetType))]),e._v(" "),a("p",[e._v(e._s(e.$t("channelList.channelState"))+"："+e._s(e._f("formatStatus")(e.Data.State)))]),e._v(" "),a("p",[e._v(e._s(e.$t("channelList.isConnect"))+"："+e._s(e._f("formatConnect")(e.Data.isConnect))),e.Data.isConnect?e._e():a("a",{staticStyle:{color:"#F56C6C","margin-left":"10px",cursor:"pointer"},on:{click:function(t){e.reconnectWebsocket()}}},[e._v("Reconnect")])]),e._v(" "),a("hr",{staticStyle:{height:"2px",border:"none","border-top":"2px dotted #EBEEF5"}}),e._v(" "),e.isConfirmCloseChannel?a("div",{staticClass:"closeBox"},[a("el-form",{ref:"channelInfo",staticClass:"demo-ruleForm",attrs:{model:e.channelInfo,"status-icon":"",rules:e.confirmCloseRules}},[a("p",{staticStyle:{"text-align":"left",color:"#F56C6C"}},[e._v("是否确认关闭通道?")]),e._v(" "),a("el-form-item",{attrs:{prop:"keyStorePass"}},[a("el-input",{attrs:{placeholder:e.$t("channelList.inputPassword"),type:"password","auto-complete":"off"},model:{value:e.channelInfo.keyStorePass,callback:function(t){e.$set(e.channelInfo,"keyStorePass",t)},expression:"channelInfo.keyStorePass"}})],1),e._v(" "),a("el-form-item",{staticStyle:{"text-align":"center","margin-left":"-80px"}}),e._v(" "),a("el-form-item",{staticClass:"buttonBox"},[a("div",{staticClass:"button-item",on:{click:function(t){e.closeChannel()}}},[a("i",{staticClass:"el-icon-ETH-zhengque1"}),e._v(" "),a("p",[e._v("确认")])]),e._v(" "),a("div",{staticClass:"button-item",on:{click:function(t){e.isConfirmCloseChannel=!1}}},[a("i",{staticClass:"el-icon-ETH-fanhui1"}),e._v(" "),a("p",[e._v("返回")])])])],1)],1):a("div",{staticClass:"closeBox"},[a("div",{staticClass:"buttonBox"},[a("div",{staticStyle:{height:"88px",width:"100%"}}),e._v(" "),a("div",{staticClass:"button-item",on:{click:function(t){e.isConfirmCloseChannel=!0}}},[a("i",{staticClass:"el-icon-ETH-icon_wrong"}),e._v(" "),a("p",[e._v("关闭通道")])]),e._v(" "),a("div",{staticClass:"button-item",on:{click:function(t){e.$router.go(-1)}}},[a("i",{staticClass:"el-icon-ETH-fanhui1"}),e._v(" "),a("p",[e._v("返回")])])])])])])},staticRenderFns:[]};var ye=a("VU/8")(ve,fe,!1,function(e){a("GEkJ")},"data-v-231b1b27",null).exports,Se={name:"paymentBox",data(){return{isDisable:!1,paymentCode:"",txOnChannelInfo:{sendUri:"",receiverUri:"",netMagic:"",hr:"",assetType:"",value:0,fee:0,description:"",ChannelName:"",keyStorePass:""},txOnChannelRules:{keyStorePass:[{validator:(e,t,a)=>{if(!t)return a(new Error(this.$t("index.callback-7")));{let e;"ETH"==this.baseChain?e=this.$parent.$parent.verifyPassword(this.$store.state.vuexStore.walletInfo.keyStore,t):"NEO"==this.baseChain&&(e=scrypt_module_factory(DecryptWalletByPassword,{},{WalletScript:this.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].key,password:t,address:this.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].address})),setTimeout(()=>{if(!e)return a(new Error(this.$t("index.callback-8")));a()},1e3)}},trigger:"blur"}]},ShowTxOnChannelBox:!1}},components:{headBox:T.a},computed:{baseChain(){return this.$store.state.vuexStore.baseChain},txList(){return this.$store.state.vuexStore.txList},walletInfo(){return"ETH"==this.baseChain?this.$store.state.vuexStore.walletInfo:"NEO"==this.baseChain?this.$store.state.vuexStore.NEOwalletInfo:void 0}},filters:{formatAddress:function(e){return e.replace(/(.{10}).*(.{10})/,"$1......$2")}},mounted(){this.$nextTick(function(){this.$route.params.paymentCode&&(this.paymentCode=this.$route.params.paymentCode)})},watch:{},methods:{decryptPaymentCode(){let e=this;if(""!=e.paymentCode.length){if(!e.paymentCode.startsWith("TN"))return 42==e.paymentCode.length&&"ETH"==e.baseChain||34==e.paymentCode.length&&"NEO"==e.baseChain?e.paymentCode==e.$store.state.vuexStore.walletInfo.address?void e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-10"),duration:3e3}):(console.log("进入链上转账"),void e.$router.push({name:"transferOnChain",params:{address:e.paymentCode}})):void e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-11"),duration:3e3});{let t;console.log("进入通道交易");try{t=base58decode(e.paymentCode.substring(2)).toString()}catch(t){return e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-11")+"1",duration:3e3}),!1}if(console.log(t),!(t.indexOf("&")>-1))return e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-11"),duration:3e3}),!1;{let a=t.split("&");if("ETH"==e.baseChain){if(e.txOnChannelInfo.receiverUri=a[0],e.txOnChannelInfo.netMagic=a[1],e.txOnChannelInfo.hr=a[2],e.txOnChannelInfo.assetType=a[3],e.txOnChannelInfo.value=a[4],e.txOnChannelInfo.description=a[5],console.log(e.txOnChannelInfo),e.txOnChannelInfo.netMagic!=e.$store.state.vuexStore.NetMagic)return void e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-12"),duration:3e3});if(!web3.utils.isAddress(e.txOnChannelInfo.receiverUri.split("@")[0]))return void e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-11")+"2",duration:3e3});if(""==e.txOnChannelInfo.hr)return void e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-11")+"3",duration:3e3});if(""==e.txOnChannelInfo.assetType)return void e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-11")+"4",duration:3e3});if(0==e.txOnChannelInfo.value)return void e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-11")+"5",duration:3e3});if(e.$store.state.vuexStore.walletInfo.address===e.txOnChannelInfo.receiverUri.split("@")[0])return void e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-10"),duration:3e3});e.ShowTxOnChannelBox=!0}else if("NEO"==e.baseChain){if(e.txOnChannelInfo.receiverUri=a[0],e.txOnChannelInfo.hr=a[1],e.txOnChannelInfo.assetType=e.$parent.$parent.AssetIdToAssetType(a[2]),e.txOnChannelInfo.value=Number(a[3]).mul(1e8),e.txOnChannelInfo.description=a[4],console.log(e.txOnChannelInfo),66!==e.txOnChannelInfo.receiverUri.split("@")[0].length)return void e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-11")+"2",duration:3e3});if(""==e.txOnChannelInfo.hr)return void e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-11")+"3",duration:3e3});if(""==e.txOnChannelInfo.assetType)return void e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-11")+"4",duration:3e3});if(0==e.txOnChannelInfo.value)return void e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-11")+"5",duration:3e3});if(e.$store.state.vuexStore.NEOwalletInfo.publicKey==e.txOnChannelInfo.receiverUri.split("@")[0])return void e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-10"),duration:3e3});e.ShowTxOnChannelBox=!0}}}}else e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-9"),duration:3e3})},confirmTx(){let e=this;e.isDisable=!0,setTimeout(()=>{e.isDisable=!1},2e3),e.$refs.txOnChannelInfo.validate(t=>{if(!t)return console.log("error submit!!"),!1;"ETH"==e.baseChain?"ETH"==e.txOnChannelInfo.assetType?e.txEthOnChannel():"TNC"==e.txOnChannelInfo.assetType&&e.txTncOnChannel():"NEO"==e.baseChain&&e.txTncOnChannel()})},txEthOnChannel(){console.log("进入通道交易ETH")},txTncOnChannel(){let e=this;if(console.log("进入通道交易"),"ETH"==e.baseChain){let t=e.txOnChannelInfo.receiverUri;console.log(t);let a=e.$parent.$parent.getChannelSerial("OtherUri",t,"open",!1);if(console.log(a),a>=0){let s,n=e.$store.state.vuexStore.channelList[a].ChannelName,o=e.$store.state.vuexStore.channelList[a].SelfUri,r=Number(e.$store.state.vuexStore.channelList[a].SelfBalance),i=Number(e.$store.state.vuexStore.channelList[a].OtherBalance),l=Number(e.txOnChannelInfo.value),c=e.txOnChannelInfo.hr,d=e.txOnChannelInfo.assetType,h=e.$store.state.vuexStore.channelList[a].TxNonce+1,m=e.$store.state.vuexStore.NetMagic,g=e.$parent.$parent.checkHistory(n,h);if("Resign"==g.type){console.log("上次交易未确认,请求回签"),s=g.ResignBody,console.log(g);let t=["paymentCount","delayBlock"],a=e.$parent.$parent.getTxListInfo(n,s.Nonce,t);a.delayBlock?(r=r,i-=a.paymentCount):(r+=a.paymentCount,i-=a.paymentCount)}else"Same"==g.type&&console.log("检查正常");if(r>=l){let g={MessageType:"Rsmc",Sender:o,Receiver:t,TxNonce:h,ChannelName:n,NetMagic:m,AssetType:d,MessageBody:{PaymentCount:l,SenderBalance:r-l,ReceiverBalance:i+l,Commitment:"",RoleIndex:0,ResignBody:s},Comments:c};e.txOnChannelInfo.sendUri=t,e.txOnChannelInfo.ChannelName=n,e.$store.state.vuexStore.txOnChannelInfo=e.txOnChannelInfo,console.log(e.$store.state.vuexStore.txOnChannelInfo),e.$parent.$parent.sendWebsocket(t,g);let p={state:"INIT",nonce:h,founder:o.split("@")[0],founderBalance:r-l,peer:t.split("@")[0],peerBalance:i+l,paymentCount:l,isFounder:!0,founderSignedData:"",peerSignedData:"",HashR:"0x"+addPreZero(0,64),R:"0x"+addPreZero(0,64)};e.$parent.$parent.newTxList(n,p),console.log(e.$store.state.vuexStore.txList);let v=e.$store.state.vuexStore.channelList[a];v.TxNonce=h,u.a.set(e.$store.state.vuexStore.channelList,a,v),console.log(e.$store.state.vuexStore.channelList[a].TxNonce),e.$parent.$parent.StoreData("channelList"),e.ShowTxOnChannelBox=!1,e.clearTxData()}else e.$notify.error({title:e.$t("common.info"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-14"),duration:3e3}),e.ShowTxOnChannelBox=!1,e.clearTxData()}else{if(-1!=a)return-2==a?(e.ShowTxOnChannelBox=!1,void e.clearTxData()):void 0;{let t=-1;e.$store.state.vuexStore.channelList.forEach(function(e,a){3!=e.State||1!=e.isConnect||(t=a)});let a=[];if(e.$store.state.vuexStore.channelList.forEach(function(e,t){3==e.State&&1==e.isConnect&&a.push(e.OtherUri)}),console.log(a),t<0)return e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:"没有开通的通道",duration:3e3}),e.ShowTxOnChannelBox=!1,e.clearTxData(),!1;{console.log(t),e.txOnChannelInfo.sendUri=e.$store.state.vuexStore.channelList[t].SelfUri,e.txOnChannelInfo.ChannelName=e.$store.state.vuexStore.channelList[t].ChannelName;let s={MessageType:"GetRouterInfo",Sender:e.txOnChannelInfo.sendUri,Receiver:e.txOnChannelInfo.receiverUri,NetMagic:e.$store.state.vuexStore.NetMagic,AssetType:e.txOnChannelInfo.assetType,MessageBody:{NodeList:a}};e.$store.state.vuexStore.txOnChannelInfo=e.txOnChannelInfo,console.log(e.$store.state.vuexStore.txOnChannelInfo),e.$parent.$parent.sendWebsocket(e.txOnChannelInfo.sendUri,s),e.ShowTxOnChannelBox=!1,e.clearTxData()}}}}else if("NEO"==e.baseChain){console.log("NEO通道交易");let t=e.$parent.$parent.getChannelSerial("OtherUri",e.txOnChannelInfo.receiverUri,"open",!1);if(t>=0)if(console.log(e.txOnChannelInfo.value),e.$store.state.vuexStore.channelList[t].SelfBalance>=e.txOnChannelInfo.value){let a,s,n;e.txOnChannelInfo.sendUri=e.$store.state.vuexStore.channelList[t].SelfUri,e.txOnChannelInfo.ChannelName=e.$store.state.vuexStore.channelList[t].ChannelName,console.log(t),e.txList.forEach(function(t,o){t.channelName==e.txOnChannelInfo.ChannelName&&(a=t.history[1].addressFunding,s=t.history[1].scriptFunding,n=t.history[1].txId)}),console.log(a),console.log(s),console.log(n);let o=(Number(e.$store.state.vuexStore.channelList[t].OtherBalance)-Number(e.txOnChannelInfo.value)).div(1e8),r=(Number(e.$store.state.vuexStore.channelList[t].OtherBalance)+Number(e.txOnChannelInfo.value)).div(1e8);axios({method:"post",url:e.$store.state.vuexStore.NodeRpcUri,headers:{"Content-Type":"application/json;charset=UTF-8"},data:JSON.stringify({jsonrpc:"2.0",method:"FunderTransaction",params:[e.txOnChannelInfo.receiverUri.split("@")[0],e.walletInfo.publicKey,a,s,o,r,n,e.txOnChannelInfo.assetType],id:1})}).then(function(a){console.log(a),a.data.error&&(e.$notify.error({title:"构造交易出错",dangerouslyUseHTMLString:!0,message:e.$t("index.callback-14"),duration:3e3}),e.ShowTxOnChannelBox=!1,e.clearTxData());let s={MessageType:"Rsmc",Sender:e.txOnChannelInfo.sendUri,Receiver:e.txOnChannelInfo.receiverUri,TxNonce:e.$store.state.vuexStore.channelList[t].TxNonce+1,ChannelName:e.$store.state.vuexStore.channelList[t].ChannelName,MessageBody:{Commitment:a.data.result.C_TX,RevocableDelivery:a.data.result.R_TX,AssetType:e.txOnChannelInfo.assetType,Value:Number(e.txOnChannelInfo.value).div(1e8),RoleIndex:0,Comments:e.txOnChannelInfo.hr}};console.log(JSON.stringify(s)),e.txOnChannelInfo.BreachRemedy=a.data.result.BR_TX,e.$store.state.vuexStore.txOnChannelInfo=e.txOnChannelInfo,console.log(e.$store.state.vuexStore.txOnChannelInfo),e.$parent.$parent.sendWebsocket(e.txOnChannelInfo.receiverUri,s),e.ShowTxOnChannelBox=!1,e.clearTxData()})}else e.$notify.error({title:e.$t("common.info"),dangerouslyUseHTMLString:!0,message:e.$t("index.callback-14"),duration:3e3}),e.ShowTxOnChannelBox=!1,e.clearTxData();else if(-1==t){console.log("H交易");let t=-1;e.$store.state.vuexStore.channelList.forEach(function(e,a){3!=e.State||1!=e.isConnect||(t=a)});let a=[];if(e.$store.state.vuexStore.channelList.forEach(function(e,t){3==e.State&&1==e.isConnect&&a.push(e.OtherUri)}),console.log(a),t<0)return e.$notify.error({title:e.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.$t("common.callback-14"),duration:3e3}),e.ShowTxOnChannelBox=!1,e.clearTxData(),!1;{console.log(t),e.txOnChannelInfo.sendUri=e.$store.state.vuexStore.channelList[t].SelfUri,e.txOnChannelInfo.ChannelName=e.$store.state.vuexStore.channelList[t].ChannelName;let s={MessageType:"GetRouterInfo",Sender:e.txOnChannelInfo.sendUri,Receiver:e.txOnChannelInfo.receiverUri,Magic:e.$store.state.vuexStore.NetMagic,MessageBody:{NodeList:a,AssetType:e.txOnChannelInfo.assetType}};e.$store.state.vuexStore.txOnChannelInfo=e.txOnChannelInfo,console.log(e.$store.state.vuexStore.txOnChannelInfo),e.$store.state.vuexStore.channelList[t].websock.send(JSON.stringify(s)),e.ShowTxOnChannelBox=!1,e.clearTxData()}}else console.log("l错误")}},clearTxData(){this.txOnChannelInfo={sendUri:"",receiverUri:"",hr:"",assetType:"",value:0,fee:0,description:"",ChannelName:"",keyStorePass:""},this.paymentCode=""}}},xe={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"paymentBox"},[a("headBox"),e._v(" "),a("div",{staticClass:"contentBox"},[a("h2",{staticClass:"title_h2"},[e._v(e._s(e.$t("index.title")))]),e._v(" "),a("hr"),e._v(" "),a("div",{staticClass:"buttonBox clearfloat"},[a("router-link",{staticClass:"button-item",attrs:{to:"/channel/createPayment"}},[a("i",{staticClass:"el-icon-ETH-shoukuan"}),e._v(" "),a("p",[e._v("收款")])]),e._v(" "),a("router-link",{staticClass:"button-item",attrs:{to:"/scan"}},[a("i",{staticClass:"el-icon-ETH-saoyisao"}),e._v(" "),a("p",[e._v("扫一扫")])])],1),e._v(" "),a("el-form",{ref:"form",staticClass:"indexForm"},[a("label",{staticStyle:{"line-height":"28px","font-size":"16px"}},[e._v(e._s(e.$t("index.paymentCode"))+":")]),e._v(" "),a("el-form-item",{staticStyle:{"margin-top":"10px"}},[a("el-input",{attrs:{type:"textarea",rows:"3"},model:{value:e.paymentCode,callback:function(t){e.paymentCode="string"==typeof t?t.trim():t},expression:"paymentCode"}})],1),e._v(" "),a("el-form-item",{staticStyle:{"text-align":"center"}},[a("el-button",{staticClass:"transferBtn",attrs:{type:"primary"},on:{click:function(t){e.decryptPaymentCode()}}},[e._v(e._s(e.$t("index.transfer")))])],1)],1)],1),e._v(" "),a("el-dialog",{staticClass:"txOnChannelBox",attrs:{title:e.$t("index.transferOnChannel"),visible:e.ShowTxOnChannelBox,width:"calc(100% - 20px)",center:"","modal-append-to-body":!1},on:{"update:visible":function(t){e.ShowTxOnChannelBox=t}}},[a("span",[e._v(e._s(e.$t("index.transfer-1"))+e._s(e.txOnChannelInfo.receiverUri.split("@")[0]))]),e._v(" "),a("span",{staticStyle:{color:"#F56C6C","font-size":"16px"}},[e._v(e._s(e.$t("index.transfer-2"))+" "+e._s(e.txOnChannelInfo.value/1e8)+" "+e._s(e.txOnChannelInfo.assetType))]),e._v(" "),a("el-form",{ref:"txOnChannelInfo",staticClass:"demo-ruleForm",attrs:{model:e.txOnChannelInfo,"status-icon":"",rules:e.txOnChannelRules,"label-width":"90px"}},[a("el-form-item",{attrs:{label:e.$t("index.password"),prop:"keyStorePass"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.txOnChannelInfo.keyStorePass,callback:function(t){e.$set(e.txOnChannelInfo,"keyStorePass",t)},expression:"txOnChannelInfo.keyStorePass"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",disabled:e.isDisable},on:{click:function(t){e.confirmTx()}}},[e._v(e._s(e.$t("index.transfer")))]),e._v(" "),a("el-button",{on:{click:function(t){e.ShowTxOnChannelBox=!1}}},[e._v(e._s(e.$t("index.cancel")))])],1)],1)],1)},staticRenderFns:[]};var Ce=a("VU/8")(Se,xe,!1,function(e){a("7m3c")},"data-v-0a197694",null).exports,be={name:"descoverForm",data:()=>({paymentCodeForm:{amount:"",assetType:"",assetContractAddress:"",selfUri:"",R:"",Hr:"",Code:""},paymentCodeRules:{amount:[{validator:(e,t,a)=>{if(!t)return a(new Error("金额不能为空"));t<0?a(new Error("请输入正确的数字值")):a()},trigger:"blur"}],assetType:[{validator:(e,t,a)=>{""===t?a(new Error("请选择资产类型")):a()},trigger:"change"}]},isPaymentCodeBoxShow:!1}),filters:{},components:{headBox:T.a},methods:{copyfun(){let e=this;clipboard&&clipboard.destroy(),clipboard=new ClipboardJS(".btncopy"),clipboard.on("success",function(t){e.$notify.info({title:"消息",dangerouslyUseHTMLString:!0,message:"复制成功",duration:3e3})}),clipboard.on("error",function(t){e.$notify.info({title:"警告",dangerouslyUseHTMLString:!0,message:"复制失败，请自行复制",duration:3e3,type:"warning"})})},createPaymentCode(){let e=this;e.$refs.paymentCodeForm.validate(t=>{if(!t)return console.log("error submit!!"),!1;if("ETH"==e.$store.state.vuexStore.baseChain){if("TNC"==e.paymentCodeForm.assetType)e.paymentCodeForm.assetContractAddress=e.$store.state.vuexStore.tncContractAddress;else{if("ETH"!=e.paymentCodeForm.assetType)return e.$notify.info({title:"警告",dangerouslyUseHTMLString:!0,message:"资产类型出错",duration:3e3,type:"warning"}),!1;e.paymentCodeForm.assetContractAddress=""}if(e.paymentCodeForm.R=randomBytes(32),console.log(e.paymentCodeForm.R),e.paymentCodeForm.Hr=web3.utils.keccak256(e.paymentCodeForm.R),console.log(e.paymentCodeForm.Hr),e.$store.state.vuexStore.channelList.forEach(function(t,a){3==t.State&&t.assetType==e.paymentCodeForm.assetType&&(e.paymentCodeForm.selfUri=t.SelfUri)}),""==e.paymentCodeForm.selfUri)return e.$notify.info({title:"警告",dangerouslyUseHTMLString:!0,message:"没有该资产类型的通道",duration:3e3,type:"warning"}),!1;let t=e.paymentCodeForm.selfUri+"&"+e.$store.state.vuexStore.NetMagic+"&"+e.paymentCodeForm.Hr+"&"+e.paymentCodeForm.assetType+"&"+e.paymentCodeForm.amount.mul(1e8)+"&PaymentCode";console.log(t),e.paymentCodeForm.Code="TN"+base58encode(t),console.log(e.paymentCodeForm.Code),e.isPaymentCodeBoxShow=!0;let a={Hr:e.paymentCodeForm.Hr,R:e.paymentCodeForm.R};e.$store.state.vuexStore.RList.push(a),e.$parent.$parent.StoreData("RList")}else"NEO"==e.$store.state.vuexStore.baseChain&&e.createPaymentCodeNEO()})},createPaymentCodeNEO(){console.log("NEO");let e=this;if(e.paymentCodeForm.R=randomBytes(32),console.log(e.paymentCodeForm.R),e.paymentCodeForm.Hr=createHr(e.paymentCodeForm.R.slice(2)),console.log(e.paymentCodeForm.Hr),e.$store.state.vuexStore.channelList.forEach(function(t,a){3==t.State&&t.assetType==e.paymentCodeForm.assetType&&(e.paymentCodeForm.selfUri=t.SelfUri)}),""==e.paymentCodeForm.selfUri)return e.$notify.info({title:"警告",dangerouslyUseHTMLString:!0,message:"没有该资产类型的通道",duration:3e3,type:"warning"}),!1;let t=e.$parent.$parent.AssetTypeToAssetId1(e.paymentCodeForm.assetType),a=e.paymentCodeForm.selfUri+"&"+e.paymentCodeForm.Hr+"&"+t+"&"+e.paymentCodeForm.amount+"&PaymentCode";console.log(a),e.paymentCodeForm.Code="TN"+base58encode(a),console.log(e.paymentCodeForm.Code),e.isPaymentCodeBoxShow=!0;let s={Hr:e.paymentCodeForm.Hr,R:e.paymentCodeForm.R.slice(2)};e.$store.state.vuexStore.RList.push(s),e.$parent.$parent.StoreData("RList")},resetForm(){this.isPaymentCodeBoxShow=!1,this.paymentCodeForm={amount:"",assetType:"",selfUri:"",R:"",Hr:"",Code:""}}}},$e={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"descoverForm"},[a("headBox"),e._v(" "),a("div",{staticClass:"contentBox"},[e.isPaymentCodeBoxShow?a("el-button",{staticStyle:{"font-size":"12px",float:"right"},attrs:{size:"mini"},on:{click:function(t){e.resetForm("ruleForm")}}},[e._v(e._s(e.$t("receive.reset")))]):e._e(),e._v(" "),a("h2",{staticClass:"title_h2"},[e._v("创建收款码")]),e._v(" "),a("hr"),e._v(" "),e.isPaymentCodeBoxShow?a("div",[a("div",{staticClass:"QRCodeBox QRCodeBox-white"},[a("qriously",{staticStyle:{zoom:"0.76"},attrs:{value:e.paymentCodeForm.Code,level:"H",size:244}}),e._v(" "),a("p",{staticStyle:{"margin-top":"22px"}},[e._v(e._s(e.$t("receive.receiveCode")))])],1),e._v(" "),a("hr"),e._v(" "),a("p",[e._v("收款码")]),e._v(" "),a("h3",{attrs:{id:"receivePaymentCode"}},[e._v(e._s(e.paymentCodeForm.Code))]),e._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{staticClass:"btncopy",staticStyle:{width:"80%"},attrs:{"data-clipboard-target":"#receivePaymentCode",type:"primary"},on:{click:function(t){e.copyfun()}}},[e._v(e._s(e.$t("receive.copy")))])],1)]):a("div",[a("el-form",{ref:"paymentCodeForm",staticClass:"demo-ruleForm",attrs:{model:e.paymentCodeForm,"status-icon":"",rules:e.paymentCodeRules,"label-width":"80px","label-position":"top"}},[a("el-form-item",{attrs:{label:e.$t("receive.amount"),prop:"amount"}},[a("el-input",{attrs:{type:"number","auto-complete":"off"},model:{value:e.paymentCodeForm.amount,callback:function(t){e.$set(e.paymentCodeForm,"amount",e._n(t))},expression:"paymentCodeForm.amount"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("receive.assetType"),prop:"assetType"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("receive.chooseAssetType")},model:{value:e.paymentCodeForm.assetType,callback:function(t){e.$set(e.paymentCodeForm,"assetType",t)},expression:"paymentCodeForm.assetType"}},["ETH"==e.$store.state.vuexStore.baseChain?[a("el-option",{attrs:{label:"TNC",value:"TNC"}}),e._v(" "),a("el-option",{attrs:{label:"ETH",value:"ETH",disabled:""}})]:e._e(),e._v(" "),"NEO"==e.$store.state.vuexStore.baseChain?[a("el-option",{attrs:{label:"TNC",value:"TNC"}}),e._v(" "),a("el-option",{attrs:{label:"NEO",value:"NEO"}}),e._v(" "),a("el-option",{attrs:{label:"GAS",value:"GAS"}})]:e._e()],2)],1),e._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{staticStyle:{width:"80%"},attrs:{type:"primary"},on:{click:function(t){e.createPaymentCode()}}},[e._v(e._s(e.$t("receive.create")))])],1)],1)],1)],1)],1)},staticRenderFns:[]};var ke=a("VU/8")(be,$e,!1,function(e){a("qvUZ")},"data-v-d6f909f4",null).exports,Te={name:"rankingForm",data:()=>({tabsItems:[{name:"按支付量",func:"payment"},{name:"按收款量",func:"income"},{name:"按交易次数",func:"nonce"}],tabPaneSelected:0,dataOrderBy:"payment",DataList:[]}),components:{},mounted(){this.$nextTick(function(){this.getnodeList()})},watch:{},filters:{formatAddress:function(e){var t="";return e&&(t=e.replace(/(.{8}).*(.{8})/,"$1......$2")),t},formatBalance:e=>e>0?Number(e).div(1e8):0},computed:{rankingDataOrderBy(){return this.DataList.sort((e,t)=>t[this.dataOrderBy]-e[this.dataOrderBy])},nodeWebSocketIp(){return this.$store.state.vuexStore.nodeWebSocketIp},spvPort(){return this.$store.state.vuexStore.spvPort}},methods:{selectPane(e,t){this.tabPaneSelected=t,this.dataOrderBy=e},getnodeList(){let e=this;e.testWebSocket=new WebSocket("ws://47.98.228.81:8866"),e.testWebSocket.onmessage=e.websocketOnMessage,e.testWebSocket.onclose=e.websocketClose;let t={AssetType:"TNC",MessageBody:{},MessageType:"GetNodeList",NetMagic:"527465737419990331",Sender:"0x4E801062608188F5d6815ddC3e98B766088784CE@47.98.228.81:8866"};setTimeout(function(){e.testWebSocket.send(JSON.stringify(t))},1e3)},websocketOnMessage(e){let t=[];JSON.parse(e.data).Nodes.nodes.forEach(function(e,a){t.push(e.Publickey+"@"+e.Ip.split(":")[0]+":21556")}),this.$store.state.vuexStore.nodeList=t,console.log(this.$store.state.vuexStore.nodeList),this.getRankingData(),this.cycleGetData=setInterval(this.getRankingData,1e4)},websocketClose(){console.log("关闭")},getRankingData(){let e=this,t=this.$store.state.vuexStore.nodeList;for(var a=0;a<t.length;a++)axios({method:"post",url:"http://"+t[a].split("@")[1],headers:{"Content-Type":"application/json;charset=UTF-8"},data:JSON.stringify({jsonrpc:"2.0",method:"GetWalletStatistics",params:[t[a].split("@")[0]],id:1})}).then(function(t){if("GetWalletStatisticsAck"==t.data.result.MessageType){console.log(t.data.result.MessageBody);let a=t.data.result.MessageBody,s=a.rsmc_successed||0,n=a.htlc_successed||0,o=a.total_rsmc_transaction||0,r=a.total_htlc_transaction||0,i={address:a.address,assetType:"TNC",income:a.income||0,rsmc_successed:s,total_rsmc_transaction:o,htlc_successed:n,total_htlc_transaction:r,total_free:a.total_free||0,payment:a.payment||0,nonce_successed:s+n,nonce:o+r};console.log(i);let l=!0;e.DataList.forEach(function(t,s){if(t.address==a.address)return console.log("更新数据"),u.a.set(e.DataList,s,i),void(l=!1)}),l&&e.DataList.push(i)}})},back(){clearInterval(this.cycleGetData),this.$router.go(-1)}}},_e={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"rankingForm"},[a("div",{staticClass:"headBox"},[a("div",{staticClass:"header-button is-left"},[a("i",{staticClass:"el-icon-ETH-fanhui",on:{click:function(t){e.back()}}})]),e._v(" "),a("h1",[e._v(e._s(e.$router.name))]),e._v(" "),a("div",{staticClass:"header-button is-right",staticStyle:{"text-align":"right"}})]),e._v(" "),e._m(0),e._v(" "),a("div",{staticClass:"tabs"},e._l(e.tabsItems,function(t,s){return a("div",{key:s,staticClass:"tab-pane",class:{"is-selected":e.tabPaneSelected==s},on:{click:function(a){e.selectPane(t.func,s)}}},[e._v("\n          "+e._s(t.name)+"\n          "),e._m(1,!0)])})),e._v(" "),a("div",{staticClass:"contentBox"},e._l(e.rankingDataOrderBy,function(t,s){return a("div",{key:s,staticClass:"cell"},[a("div",{staticClass:"cell-wrapper"},[a("div",{staticClass:"cell-title"},[0==s?a("div",{staticClass:"indexBox"},[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-jiangpai-1"}})])]):e._e(),e._v(" "),1==s?a("div",{staticClass:"indexBox"},[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-jiangpai-2"}})])]):e._e(),e._v(" "),2==s?a("div",{staticClass:"indexBox"},[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-jiangpai-3"}})])]):e._e(),e._v(" "),s>2?a("div",{staticClass:"indexBox"},[a("h2",[e._v(e._s(s+1))])]):e._e(),e._v(" "),a("span",{staticClass:"cell-text"},[e._v(e._s(e._f("formatAddress")(t.address)))])]),e._v(" "),"payment"==e.dataOrderBy||"income"==e.dataOrderBy?a("div",{staticClass:"cell-right"},[e._v("\n                  "+e._s(e._f("formatBalance")(t[e.dataOrderBy]))+e._s(t.assetType)+"\n              ")]):e._e(),e._v(" "),"nonce"==e.dataOrderBy?a("div",{staticClass:"cell-right"},[e._v("\n                  "+e._s(t.nonce)+"\n              ")]):e._e()])])}))])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"banner"},[t("div",{staticClass:"txtBox"},[t("h1",[this._v("排行榜")]),this._v(" "),t("p",[this._v("Trinity状态通道排行榜")])]),this._v(" "),t("img",{attrs:{src:a("ey8z"),alt:""}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticStyle:{position:"absolute",bottom:"0px","text-align":"center",left:"0",width:"100%"}},[t("div",{staticClass:"sanjiao"})])}]};var we=a("VU/8")(Te,_e,!1,function(e){a("a4pD")},"data-v-4b0e0fc6",null).exports,Be={name:"firstBackupForm",data:()=>({buttonBoxData:[{name:"备份助记词",icon:"el-icon-ETH-daima",func:"backupKeyStore"},{name:"备份私钥",icon:"el-icon-ETH-mima",func:"backupPrivateKey"}],mnemonic:"",privateKey:""}),components:{},computed:{baseChain(){return this.$store.state.vuexStore.baseChain}},mounted(){this.$nextTick(function(){this.$route.params.mnemonic?this.mnemonic=this.$route.params.mnemonic:this.$router.push("/setting/backup")})},methods:{backup(e){"backupKeyStore"==e?(this.privateKey="",this.mnemonic=this.$route.params.mnemonic):"backupPrivateKey"==e&&(this.privateKey=mnemonic2privateKey(this.mnemonic),this.mnemonic="")}}},Ne={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"firstBackupForm"},[e._m(0),e._v(" "),a("div",{staticClass:"contentBox"},[a("h2",{staticClass:"title_h2"},[e._v(e._s(e.$t("backup.title")))]),e._v(" "),a("hr"),e._v(" "),a("div",{staticClass:"buttonBox clearfloat"},[a("el-row",{attrs:{gutter:20}},e._l(e.buttonBoxData,function(t,s){return a("el-col",{key:s,attrs:{span:12}},[a("a",{staticClass:"button-item",on:{click:function(a){e.backup(t.func)}}},[a("i",{class:t.icon}),e._v(" "),a("p",[e._v(e._s(t.name))])])])}))],1),e._v(" "),e.mnemonic?a("el-input",{attrs:{id:"backupKeyStore",type:"textarea",rows:"4",readonly:"readonly"},model:{value:e.mnemonic,callback:function(t){e.mnemonic=t},expression:"mnemonic"}}):e._e(),e._v(" "),e.privateKey?a("el-input",{attrs:{id:"backupPrivateKey",type:"textarea",rows:"3",readonly:"readonly"},model:{value:e.privateKey,callback:function(t){e.privateKey=t},expression:"privateKey"}}):e._e(),e._v(" "),e.mnemonic||e.privateKey?e._e():a("div",{staticClass:"tipBox tipBox-red"},[a("h3",[e._v(e._s(e.$t("backup.tips")))]),e._v(" "),a("p",[e._v(e._s(e.$t("backup.tipsContent")))])]),e._v(" "),a("a",{staticClass:"toWalletBtn",on:{click:function(t){e.$router.push("/wallet")}}},[e._v("> 我已安全备份")])],1)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"headBox"},[t("div",{staticClass:"header-button is-left"}),this._v(" "),t("h1"),this._v(" "),t("div",{staticClass:"header-button is-right",staticStyle:{"text-align":"right"}})])}]};var De=a("VU/8")(Be,Ne,!1,function(e){a("F1k1")},"data-v-2c73a2e4",null).exports,Le={name:"backupForm",data(){return{isDisable:!1,buttonBoxData:[{name:"备份keyStore",icon:"el-icon-ETH-daima",func:"backupKeyStore"},{name:"备份私钥",icon:"el-icon-ETH-mima",func:"backupPrivateKey"}],backupType:"",keyStore:"",privateKey:"",isUnlockWalletBox:!1,unlockWalletForm:{keyStorePass:""},unlockWalletRules:{keyStorePass:[{validator:(e,t,a)=>{if(!t)return a(new Error(this.$t("common.callback-1")));{let e;"ETH"==this.baseChain?(console.log(this.$store.state.vuexStore.walletInfo),console.log(t),e=this.$parent.$parent.verifyPassword(this.$store.state.vuexStore.walletInfo.keyStore,t)):"NEO"==this.baseChain&&(console.log(1),e=scrypt_module_factory(DecryptWalletByPassword,{},{WalletScript:this.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].key,password:t,address:this.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].address})),setTimeout(()=>{if(!e)return a(new Error(this.$t("common.callback-2")));a()},300)}},trigger:"blur"}]}}},components:{},computed:{isMobile(){return this.$store.state.vuexStore.isMobile},baseChain(){return this.$store.state.vuexStore.baseChain}},methods:{confirmBackup(e){this.isUnlockWalletBox=!0,this.backupType=e},cancel(){},backup(){let e=this;e.isDisable=!0,setTimeout(()=>{e.isDisable=!1},2e3),this.$refs.unlockWalletForm.validate(e=>{if(e){let e=this.unlockWalletForm.keyStorePass;if("backupKeyStore"==this.backupType){if(this.isMobile)this.privateKey="",this.$store.state.vuexStore.walletInfo.keyStore&&(this.keyStore=JSON.stringify(this.$store.state.vuexStore.walletInfo.keyStore));else if("ETH"==this.$store.state.vuexStore.baseChain)if(this.$store.state.vuexStore.walletInfo.keyStore){var t=JSON.stringify(this.$store.state.vuexStore.walletInfo.keyStore),a=new Blob([t],{type:"text/plain;charset=utf-8"});saveAs(a,this.$store.state.vuexStore.walletInfo.keyStore.id+".json")}else this.$notify.error({title:"警告",dangerouslyUseHTMLString:!0,message:"备份失败，请确认正确导入钱包",duration:3e3});else if("NEO"==this.$store.state.vuexStore.baseChain)if(this.$store.state.vuexStore.NEOwalletInfo.keyStore){t=JSON.stringify(this.$store.state.vuexStore.NEOwalletInfo.keyStore),a=new Blob([t],{type:"text/plain;charset=utf-8"});saveAs(a,this.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].address+".json")}else this.$notify.error({title:"警告",dangerouslyUseHTMLString:!0,message:"备份失败，请确认正确导入钱包",duration:3e3})}else if("backupPrivateKey"==this.backupType){this.keyStore="";let t=this.$parent.$parent.decryptPrivateKey(this.$store.state.vuexStore.walletInfo.keyStore,e);this.privateKey=t.privateKey}this.isUnlockWalletBox=!1,this.unlockWalletForm.keyStorePass=""}})},copyfun(){let e=this;clipboard&&clipboard.destroy(),clipboard=new ClipboardJS(".btncopy"),clipboard.on("success",function(t){e.$notify.info({title:"消息",dangerouslyUseHTMLString:!0,message:"复制成功",duration:3e3})}),clipboard.on("error",function(t){e.$notify.info({title:"警告",dangerouslyUseHTMLString:!0,message:"复制失败，请自行复制",duration:3e3,type:"warning"})})}}},Ie={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"backupForm"},[a("div",{staticClass:"headBox"},[a("div",{staticClass:"header-button is-left"},[a("i",{staticClass:"el-icon-ETH-fanhui",on:{click:function(t){e.$router.push("/wallet")}}})]),e._v(" "),a("h1"),e._v(" "),a("div",{staticClass:"header-button is-right",staticStyle:{"text-align":"right"}})]),e._v(" "),a("div",{staticClass:"contentBox"},[a("h2",{staticClass:"title_h2"},[e._v(e._s(e.$t("backup.title")))]),e._v(" "),a("hr"),e._v(" "),a("div",{staticClass:"buttonBox clearfloat"},[a("el-row",{attrs:{gutter:20}},e._l(e.buttonBoxData,function(t,s){return a("el-col",{key:s,attrs:{span:12}},[a("a",{staticClass:"button-item",on:{click:function(a){e.confirmBackup(t.func)}}},[a("i",{class:t.icon}),e._v(" "),a("p",[e._v(e._s(t.name))])])])}))],1),e._v(" "),e.keyStore?a("el-input",{attrs:{id:"backupKeyStore",type:"textarea",rows:"6",readonly:"readonly"},model:{value:e.keyStore,callback:function(t){e.keyStore=t},expression:"keyStore"}}):e._e(),e._v(" "),e.privateKey?a("el-input",{attrs:{id:"backupPrivateKey",type:"textarea",rows:"3",readonly:"readonly"},model:{value:e.privateKey,callback:function(t){e.privateKey=t},expression:"privateKey"}}):e._e(),e._v(" "),e.keyStore||e.privateKey?e._e():a("div",{staticClass:"tipBox tipBox-red"},[a("h3",[e._v(e._s(e.$t("backup.tips")))]),e._v(" "),a("p",[e._v(e._s(e.$t("backup.tipsContent")))])]),e._v(" "),e.keyStore?a("div",{staticClass:"align-center",staticStyle:{"margin-top":"18%"}},[a("el-button",{staticClass:"btncopy",attrs:{"data-clipboard-target":"#backupKeyStore",type:"primary"},on:{click:function(t){e.copyfun()}}},[e._v("复制")])],1):e._e(),e._v(" "),e.privateKey?a("div",{staticClass:"align-center",staticStyle:{"margin-top":"18%"}},[a("el-button",{staticClass:"btncopy",attrs:{"data-clipboard-target":"#backupPrivateKey",type:"primary"},on:{click:function(t){e.copyfun()}}},[e._v("复制")])],1):e._e(),e._v(" "),a("el-dialog",{staticClass:"unlockWalletBox",attrs:{title:"请输入密码",visible:e.isUnlockWalletBox,width:"calc(100% - 20px)",center:"","modal-append-to-body":!1},on:{"update:visible":function(t){e.isUnlockWalletBox=t}}},[a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-form",{ref:"unlockWalletForm",staticClass:"demo-ruleForm",attrs:{model:e.unlockWalletForm,"status-icon":"",rules:e.unlockWalletRules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:e.$t("common.password"),prop:"keyStorePass"}},[a("el-input",{attrs:{placeholder:e.$t("common.inputPassword"),type:"password","auto-complete":"off"},model:{value:e.unlockWalletForm.keyStorePass,callback:function(t){e.$set(e.unlockWalletForm,"keyStorePass",t)},expression:"unlockWalletForm.keyStorePass"}})],1),e._v(" "),a("el-form-item",{staticStyle:{"text-align":"center","margin-left":"-80px"}},[a("el-button",{attrs:{type:"primary",disabled:e.isDisable},on:{click:function(t){e.backup()}}},[e._v(e._s(e.$t("common.continue")))]),e._v(" "),a("el-button",{on:{click:function(t){e.isUnlockWalletBox=!1}}},[e._v(e._s(e.$t("common.cancel")))])],1)],1)],1)])],1)])},staticRenderFns:[]};var Oe=a("VU/8")(Le,Ie,!1,function(e){a("mx98")},"data-v-db89a6c2",null).exports,Re={name:"contactBox",data(){return{contactList:[],multipleSelection:[],centerDialogVisible:!1,addContactForm:{name:"",address:""},addContactRules:{name:[{validator:(e,t,a)=>{if(""===t)return a(new Error(this.$t("contact.callback-1")));a()},trigger:"blur"}],address:[{validator:(e,t,a)=>{let s=!1;this.$store.state.vuexStore.contactList.forEach(function(e,a){e.address===t&&(s=!0)}),""===t?a(new Error(this.$t("contact.callback-2"))):42!==t.length?a(new Error(this.$t("contact.callback-3"))):s?a(new Error(this.$t("contact.callback-4"))):a()},trigger:"blur"}]}}},components:{headBox:T.a},mounted(){this.$nextTick(function(){this.$store.state.vuexStore.isLogin?this.contactList=this.$store.state.vuexStore.contactList:this.$router.push("/start")})},methods:{toggleSelection(e){e?e.forEach(e=>{this.$refs.multipleTable.toggleRowSelection(e)}):this.$refs.multipleTable.clearSelection()},handleSelectionChange(e){this.multipleSelection=e},addContact(){this.$refs.addContactForm.validate(e=>{if(!e)return console.log("error submit!!"),!1;{let e={name:this.addContactForm.name,address:this.addContactForm.address};this.$store.state.vuexStore.contactList.push(e),this.saveAsArray(this.$store.state.vuexStore.walletInfo.address+"@contactList",this.$store.state.vuexStore.contactList),this.centerDialogVisible=!1,this.$notify({title:this.$t("common.success"),dangerouslyUseHTMLString:!0,message:this.$t("contact.callback-5"),duration:3e3,type:"success"})}})},DeltableData(){let e=this;e.multipleSelection.forEach(function(t,a){e.$store.state.vuexStore.contactList.forEach(function(a,s){a.address===t.address&&e.$store.state.vuexStore.contactList.splice(s,1)}),e.saveAsArray(e.$store.state.vuexStore.walletInfo.address+"@contactList",e.$store.state.vuexStore.contactList)})},transfer(){let e=this.multipleSelection[0].address;this.$store.state.vuexStore.activeNavIndex="1-1",this.$router.push({name:"index",params:{address:e}})},saveAsArray:function(e,t){let a=e.toString();window.localStorage.setItem(a,JSON.stringify(t))}}},Ee={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"contactBox"},[a("headBox"),e._v(" "),a("div",{staticClass:"contentBox"},[a("h2",{staticClass:"title_h2"},[e._v(e._s(e.$t("contact.title")))]),e._v(" "),a("hr"),e._v(" "),a("el-button",{staticStyle:{margin:"10px 0"},attrs:{type:"primary",icon:"el-icon-plus",plain:""},on:{click:function(t){e.centerDialogVisible=!0}}},[e._v(e._s(e.$t("contact.addContact")))]),e._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.contactList,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"60"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:e.$t("contact.name"),width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"address",label:e.$t("contact.address")}})],1),e._v(" "),a("div",{staticStyle:{"margin-top":"20px"}},[a("el-button",{attrs:{disabled:1!=e.multipleSelection.length,type:"success",plain:""},on:{click:function(t){e.transfer()}}},[e._v(e._s(e.$t("contact.transfer")))]),e._v(" "),a("el-button",{attrs:{type:"danger",plain:""},on:{click:function(t){e.DeltableData()}}},[e._v(e._s(e.$t("contact.delete")))]),e._v(" "),a("el-button",{attrs:{plain:""},on:{click:function(t){e.toggleSelection()}}},[e._v(e._s(e.$t("contact.cancelSelection")))])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.$t("contact.addContact"),visible:e.centerDialogVisible,width:"40%",center:"","modal-append-to-body":!1},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[a("el-form",{ref:"addContactForm",staticClass:"demo-ruleForm",attrs:{model:e.addContactForm,"status-icon":"",rules:e.addContactRules,"label-width":"70px"}},[a("el-form-item",{attrs:{label:e.$t("contact.name"),prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addContactForm.name,callback:function(t){e.$set(e.addContactForm,"name",t)},expression:"addContactForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("contact.address"),prop:"address"}},[a("el-input",{model:{value:e.addContactForm.address,callback:function(t){e.$set(e.addContactForm,"address",t)},expression:"addContactForm.address"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addContact()}}},[e._v(e._s(e.$t("contact.add")))]),e._v(" "),a("el-button",{on:{click:function(t){e.centerDialogVisible=!1}}},[e._v(e._s(e.$t("contact.cancel")))])],1)],1)],1)},staticRenderFns:[]};var Pe=a("VU/8")(Re,Ee,!1,function(e){a("62ln")},"data-v-2f1cc424",null).exports,Fe={name:"changePasswordForm",data(){return{changePasswordForm:{oldPass:"",pass:"",checkPass:""},changePasswordRules:{oldPass:[{validator:(e,t,a)=>{if(!t)return a(new Error(this.$t("changePassword.callback-1")));{let e=this.$parent.$parent.decryptPrivateKey(this.$store.state.vuexStore.walletInfo.keyStore,t);setTimeout(()=>{if(!e)return a(new Error(this.$t("changePassword.callback-2")));a()},2e3)}},trigger:"blur"}],pass:[{validator:(e,t,a)=>{""===t?a(new Error(this.$t("changePassword.callback-3"))):(""!==this.changePasswordForm.checkPass&&this.$refs.changePasswordForm.validateField("checkPass"),a())},trigger:"blur"}],checkPass:[{validator:(e,t,a)=>{""===t?a(new Error(this.$t("changePassword.callback-4"))):t!==this.changePasswordForm.pass?a(new Error(this.$t("changePassword.callback-5"))):a()},trigger:"blur"}]}}},components:{headBox:T.a},mounted(){this.$nextTick(function(){})},methods:{toLoginForm(){this.$refs.changePasswordForm.validate(e=>{if(!e)return console.log("error submit!!"),!1;{let e=this.$parent.$parent.decryptPrivateKey(this.$store.state.vuexStore.walletInfo.keyStore,this.changePasswordForm.oldPass);console.log(e);let t=web3.eth.accounts.encrypt(e.privateKey,this.changePasswordForm.pass);console.log(t);let a=web3.utils.toChecksumAddress(t.address);console.log(a),a==this.$store.state.vuexStore.walletInfo.address?(this.$store.state.vuexStore.walletInfo.keyStore=t,this.$notify({title:this.$t("changePassword.callback-6"),dangerouslyUseHTMLString:!0,message:this.$t("changePassword.callback-7"),duration:3e3,type:"success"}),this.$router.push("/setting/backup")):this.$notify.error({title:this.$t("changePassword.callback-8"),dangerouslyUseHTMLString:!0,message:this.$t("changePassword.callback-9"),duration:3e3})}this.changePasswordForm.oldPass="",this.changePasswordForm.pass="",this.changePasswordForm.checkPass=""})}}},Me={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"changePasswordForm"},[a("headBox"),e._v(" "),a("div",{staticClass:"contentBox"},[a("h2",{staticClass:"title_h2"},[e._v(e._s(e.$t("changePassword.title")))]),e._v(" "),a("hr"),e._v(" "),a("el-form",{ref:"changePasswordForm",staticClass:"demo-ruleForm",attrs:{model:e.changePasswordForm,"status-icon":"",rules:e.changePasswordRules,"label-position":"top","label-width":"92px"}},[a("el-form-item",{attrs:{label:e.$t("changePassword.oldPass"),prop:"oldPass"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.changePasswordForm.oldPass,callback:function(t){e.$set(e.changePasswordForm,"oldPass",t)},expression:"changePasswordForm.oldPass"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("changePassword.password"),prop:"pass"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.changePasswordForm.pass,callback:function(t){e.$set(e.changePasswordForm,"pass",t)},expression:"changePasswordForm.pass"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("changePassword.checkPass"),prop:"checkPass"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.changePasswordForm.checkPass,callback:function(t){e.$set(e.changePasswordForm,"checkPass",t)},expression:"changePasswordForm.checkPass"}})],1),e._v(" "),a("div",{staticClass:"button-item",staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.toLoginForm()}}},[e._v(e._s(e.$t("changePassword.changePassword")))])],1)],1)],1)],1)},staticRenderFns:[]};var He=a("VU/8")(Fe,Me,!1,function(e){a("SHvM")},"data-v-31ce1a80",null).exports,Ae={name:"languageForm",data:()=>({languageData:[{name:"中文",lang:"cn",isSelected:!1},{name:"English",lang:"en",isSelected:!1},{name:"Español (coming soon)",lang:void 0,isSelected:!1}]}),components:{headBox:T.a},watch:{},mounted(){this.$nextTick(function(){let e=this;e.$i18n.locale&&e.languageData.forEach(function(t,a){t.lang==e.$i18n.locale&&(t.isSelected=!0)})})},filters:{},methods:{ChangeLang(e,t){void 0!=e.lang?this.$i18n.locale=e.lang:this.$i18n.locale="cn",this.$parent.$parent.saveAsString("lang",this.$i18n.locale),this.languageData.forEach(function(e,t){e.isSelected=!1}),e.isSelected=!0,this.$set(this.languageData,t,e);let a=this;setTimeout(function(){a.$router.go(-1)},300)}}},Ue={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"languageForm"},[a("headBox"),e._v(" "),a("div",{staticClass:"contentBox"},e._l(e.languageData,function(t,s){return a("a",{key:s,staticClass:"cell",on:{click:function(a){e.ChangeLang(t,s)}}},[a("div",{staticClass:"cell-wrapper"},[a("div",{staticClass:"cell-title"},[a("span",{staticClass:"cell-text"},[a("div",{class:[t.isSelected?"el-icon-check":"el-icon-null"]}),e._v("\n                      "+e._s(t.name)+"\n                  ")])]),e._v(" "),a("div",{staticClass:"cell-right"})])])}))],1)},staticRenderFns:[]};var Ke=a("VU/8")(Ae,Ue,!1,function(e){a("8sVr")},"data-v-7f795f6e",null).exports,We={name:"aboutForm",data:()=>({clickNum:0,testNum:0,transNum:0,testWebSocket:"",txOnChannelInfo:{sendUri:"",receiverUri:"",netMagic:"",hr:"",assetType:"",value:0,fee:0,description:"",ChannelName:"",keyStorePass:""}}),components:{headBox:T.a},watch:{clickNum(e,t){e%5==0&&(console.log("切换主网/测试网"),this.switchNet())},testNum(e,t){if(e%5==0)if(e/5%2==0){console.log("关闭TestFun"),clearInterval(this.transCycle);let e=this.transNum,t=this.$store.state.vuexStore.RSMCNum,a=this.$store.state.vuexStore.HTLCNum,s=this.$store.state.vuexStore.HTLCRNum;console.log(`期间一共转账${e}笔交易,其中RSMC${t}笔,HTLC${a}笔,HTLC - R${s}笔`)}else console.log("开启TestFun"),this.test()}},filters:{},methods:{switchNet(){this.$store.state.vuexStore.isTestNet?this.$store.state.vuexStore.isTestNet=!1:this.$store.state.vuexStore.isTestNet=!0},test(){let e=this;if(e.$store.state.vuexStore.isOneStepPayment&&e.$store.state.vuexStore.walletInfo.keyStorePass){let t=e.$store.state.vuexStore.nodeWebSocketIp+":"+e.$store.state.vuexStore.spvPort;e.testWebSocket=new WebSocket(t),e.testWebSocket.onmessage=e.websocketOnMessage,e.testWebSocket.onclose=e.websocketClose;let a={AssetType:"TNC",MessageBody:{},MessageType:"GetNodeList",NetMagic:"527465737419990331",Sender:"0x4E801062608188F5d6815ddC3e98B766088784CE@47.98.228.81:8866"};setTimeout(function(){e.testWebSocket.send(JSON.stringify(a))},1e3)}else console.log("未打开免密支付")},websocketOnMessage(e){let t=[];JSON.parse(e.data).Nodes.nodes.forEach(function(e,a){t.push(e.Ip.split(":")[0]+":21556")}),this.$store.state.vuexStore.nodeList=t,console.log(this.$store.state.vuexStore.nodeList),this.htlcCycle()},websocketClose(){console.log("关闭")},randomNum:(e,t)=>Math.floor(Math.random()*(t-e+1)+e),htlcCycle:function(){this.transCycle=setInterval(this.autoHtlc,25e3)},autoHtlc(){let e=this,t=e.randomNum(1,10);console.log(t),this.transNum+=1,e.$store.state.vuexStore.txOnChannelInfo=[],e.txOnChannelInfo={sendUri:"",receiverUri:"",netMagic:"",hr:"",assetType:"",value:0,fee:0,description:"",ChannelName:"",keyStorePass:""};let a=e.randomNum(0,e.$store.state.vuexStore.nodeList.length-1);console.log(a);let s=e.randomNum(1,10);axios({method:"post",url:"http://"+e.$store.state.vuexStore.nodeList[a],headers:{"Content-Type":"application/json;charset=UTF-8"},data:JSON.stringify({jsonrpc:"2.0",method:"GetPayment",params:["TNC",Number(s).mul(1e7)],id:1})}).then(function(t){console.log(t.data);let a=t.data.result.MessageBody.pycode,s=base58decode(a.substring(2)).toString().split("&");console.log(s),e.txOnChannelInfo.receiverUri=s[0],e.txOnChannelInfo.netMagic=s[1],e.txOnChannelInfo.hr=s[2],e.txOnChannelInfo.assetType=s[3],e.txOnChannelInfo.value=s[4],e.txOnChannelInfo.description=s[5];let n=e.$parent.$parent.getChannelSerial("OtherUri",e.txOnChannelInfo.receiverUri,"open",!1);if(n>=0)if(Number(e.$store.state.vuexStore.channelList[n].SelfBalance)>=Number(e.txOnChannelInfo.value)){console.log("RSMC");let t,a=e.$store.state.vuexStore.channelList[n].ChannelName,o=e.$store.state.vuexStore.channelList[n].TxNonce+1,r=e.$store.state.vuexStore.channelList[n].SelfUri,i=e.$store.state.vuexStore.channelList[n].OtherUri,l=Number(s[4]),c=Number(e.$store.state.vuexStore.channelList[n].SelfBalance),d=Number(e.$store.state.vuexStore.channelList[n].OtherBalance),h=e.$parent.$parent.checkHistory(a,o);if("Resign"==h.type){console.log("上次交易未确认,请求回签"),t=h.ResignBody,console.log(h);let s=["paymentCount","delayBlock"],n=e.$parent.$parent.getTxListInfo(a,t.Nonce,s);n.delayBlock?(c=c,d-=n.paymentCount):(c+=n.paymentCount,d-=n.paymentCount)}else"Same"==h.type&&console.log("检查正常");console.log(n);let m={MessageType:"Rsmc",Sender:r,Receiver:i,TxNonce:o,ChannelName:a,NetMagic:e.$store.state.vuexStore.NetMagic,AssetType:e.txOnChannelInfo.assetType,MessageBody:{PaymentCount:l,SenderBalance:c-l,ReceiverBalance:d+l,RoleIndex:0,Commitment:"",ResignBody:t},Comments:s[2]};e.$store.state.vuexStore.txOnChannelInfo=e.txOnChannelInfo,console.log(e.$store.state.vuexStore.txOnChannelInfo),e.$parent.$parent.sendWebsocket(e.txOnChannelInfo.receiverUri,m);let g={state:"INIT",nonce:o,founder:r.split("@")[0],founderBalance:c-l,peer:i.split("@")[0],peerBalance:d+l,paymentCount:l,isFounder:!0,founderSignedData:"",peerSignedData:"",HashR:"0x"+addPreZero(0,64),R:"0x"+addPreZero(0,64)};e.$parent.$parent.newTxList(a,g),console.log(e.$store.state.vuexStore.txList);let p=e.$store.state.vuexStore.channelList[n];p.TxNonce=o,u.a.set(e.$store.state.vuexStore.channelList,n,p),console.log(e.$store.state.vuexStore.channelList[n].TxNonce),e.$parent.$parent.StoreData("channelList")}else console.log("余额不足,停止交易"),clearInterval(e.transCycle);else{let t;console.log("HTLC"),e.$store.state.vuexStore.channelList.forEach(function(e,a){3!=e.State||1!=e.isConnect||(t=a)});let a=[];e.$store.state.vuexStore.channelList.forEach(function(e,t){3==e.State&&1==e.isConnect&&a.push(e.OtherUri)}),console.log(a),console.log(t),e.txOnChannelInfo.sendUri=e.$store.state.vuexStore.channelList[t].SelfUri,e.txOnChannelInfo.ChannelName=e.$store.state.vuexStore.channelList[t].ChannelName;let s={MessageType:"GetRouterInfo",Sender:e.txOnChannelInfo.sendUri,Receiver:e.txOnChannelInfo.receiverUri,NetMagic:e.$store.state.vuexStore.NetMagic,AssetType:e.txOnChannelInfo.assetType,MessageBody:{NodeList:a}};e.$store.state.vuexStore.txOnChannelInfo=e.txOnChannelInfo,console.log(e.$store.state.vuexStore.txOnChannelInfo),e.$store.state.vuexStore.HTLCNum+=1,Number(e.$store.state.vuexStore.channelList[t].SelfBalance)>=Number(e.txOnChannelInfo.value)?e.$parent.$parent.sendWebsocket(e.$store.state.vuexStore.channelList[t].SelfUri,s):(console.log("余额不足,停止交易"),clearInterval(e.transCycle))}})}}},Xe={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"aboutForm"},[s("headBox"),e._v(" "),s("div",{staticClass:"contentBox"},[s("h2",{staticClass:"title_h2",on:{click:function(t){e.testNum+=1}}},[e._v(e._s(e.$t("about.title")))]),e._v(" "),s("hr"),e._v(" "),s("div",{staticStyle:{"text-align":"center"}},[s("img",{attrs:{src:a("N+8p"),alt:"Trinity"},on:{click:function(t){e.clickNum+=1}}}),e._v(" "),s("h4",[e._v("Trinity Wallet for ETH")]),e._v(" "),e.$store.state.vuexStore.isTestNet?s("p",{staticStyle:{color:"red"}},[e._v("Test Network")]):e._e(),e._v(" "),s("p",[e._v("Version: V"+e._s(e.$store.state.vuexStore.version))]),e._v(" "),e.$store.state.vuexStore.isOneStepPayment&&e.$store.state.vuexStore.isTestNet?[s("p",[e._v("当前交易笔数: "+e._s(e.transNum)+"笔,其中RSMC笔数: "+e._s(e.$store.state.vuexStore.RSMCNum)+"笔")]),e._v(" "),s("p",[e._v("HTLC笔数: "+e._s(e.$store.state.vuexStore.HTLCNum)+"笔, HTLC - R: "+e._s(e.$store.state.vuexStore.HTLCRNum)+"笔")])]:e._e()],2),e._v(" "),s("div",[s("p",[e._v(e._s(e.$t("about.content")))]),e._v(" "),s("p",[s("b",[e._v(e._s(e.$t("about.tipsTitle"))+"  ")]),e._v(e._s(e.$t("about.tips")))])])])],1)},staticRenderFns:[]};var Je=a("VU/8")(We,Xe,!1,function(e){a("fz4B")},"data-v-0b1bb246",null).exports,Ge={name:"moreForm",data(){return{isComfirmOneStepPaymentShow:!1,activeInfo:{keyStorePass:""},oneStepPaymentRules:{keyStorePass:[{validator:(e,t,a)=>{if(!t)return a(new Error(this.$t("common.callback-1")));{let e;"ETH"==this.$store.state.vuexStore.baseChain?e=this.$parent.$parent.verifyPassword(this.$store.state.vuexStore.walletInfo.keyStore,t):"NEO"==this.$store.state.vuexStore.baseChain&&(e=scrypt_module_factory(DecryptWalletByPassword,{},{WalletScript:this.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].key,password:t,address:this.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].address})),setTimeout(()=>{if(!e)return a(new Error(this.$t("index.callback-8")));a()},100)}},trigger:"blur"}]}}},components:{headBox:T.a},filters:{},watch:{"$store.state.vuexStore.isOneStepPayment":"oneStepChange"},methods:{oneStepChange(){console.log(this.$store.state.vuexStore.isOneStepPayment),this.$store.state.vuexStore.isOneStepPayment?this.isComfirmOneStepPaymentShow=!0:this.$parent.$parent.saveAsString(this.$store.state.vuexStore.walletInfo.address+"@isOneStepPayment",this.$store.state.vuexStore.isOneStepPayment)},confirm(){this.$refs.activeInfo.validate(e=>{this.$store.state.vuexStore.walletInfo.keyStorePass=this.activeInfo.keyStorePass,console.log(this.$store.state.vuexStore.walletInfo.keyStorePass),this.$parent.$parent.saveAsString(this.$store.state.vuexStore.walletInfo.address+"@isOneStepPayment",this.$store.state.vuexStore.isOneStepPayment),this.isComfirmOneStepPaymentShow=!1})}}},Ve={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"moreForm"},[a("headBox"),e._v(" "),a("div",{staticClass:"contentBox"},[a("router-link",{staticClass:"cell",attrs:{to:"/setting/more"}},[a("div",{staticClass:"cell-wrapper"},[a("div",{staticClass:"cell-title"},[a("span",{staticClass:"cell-text"},[e._v(e._s(e.$t("setting.more.oneStepPayment"))+" ( Test ) ")])]),e._v(" "),a("div",{staticClass:"cell-right"},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#CCCCCC"},model:{value:e.$store.state.vuexStore.isOneStepPayment,callback:function(t){e.$set(e.$store.state.vuexStore,"isOneStepPayment",t)},expression:"$store.state.vuexStore.isOneStepPayment"}})],1)])])],1),e._v(" "),a("el-dialog",{attrs:{title:"免密支付",visible:e.isComfirmOneStepPaymentShow,width:"calc(100% - 20px)",center:""},on:{"update:visible":function(t){e.isComfirmOneStepPaymentShow=t}}},[a("span",[e._v("注意:开启免密支付后收付款不用再输入密码")]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-form",{ref:"activeInfo",staticClass:"demo-ruleForm",attrs:{model:e.activeInfo,"status-icon":"",rules:e.oneStepPaymentRules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:e.$t("common.password"),prop:"keyStorePass"}},[a("el-input",{attrs:{placeholder:e.$t("common.inputPassword"),type:"password","auto-complete":"off"},model:{value:e.activeInfo.keyStorePass,callback:function(t){e.$set(e.activeInfo,"keyStorePass",t)},expression:"activeInfo.keyStorePass"}})],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.confirm()}}},[e._v(e._s(e.$t("common.continue")))]),e._v(" "),a("el-button",{on:{click:function(t){e.isComfirmOneStepPaymentShow=!1}}},[e._v(e._s(e.$t("common.cancel")))])],1)])],1)},staticRenderFns:[]};var Ze=a("VU/8")(Ge,Ve,!1,function(e){a("SFN9")},"data-v-43686641",null).exports;s.default.use(l.a);var je=new l.a({routes:[{path:"/wallet",name:"index",component:h,meta:{index:0}},{path:"/message",name:"message",component:p,meta:{index:0}},{path:"/discover",name:"discover",component:y,meta:{index:0}},{path:"/setting",name:"setting",component:C,meta:{index:0}},{path:"/scan",name:"scan",component:k,meta:{index:3}},{path:"/EtherScan",name:"EtherScan",component:B,meta:{index:3}},{path:"/start",name:"startForm",component:I,meta:{index:0}},{path:"/create",name:"createForm",component:E,meta:{index:0}},{path:"/loginByPrivateKey",name:"loginByPrivateKeyForm",component:M,meta:{index:0}},{path:"/loginByMnemonic",name:"loginByMnemonicForm",component:U,meta:{index:0}},{path:"/loginByKeyStore",name:"loginByKeyStoreForm",component:J,meta:{index:0}},{path:"/back",name:"backForm",component:j,meta:{index:0}},{path:"/chain/asset",name:"asset",component:z,meta:{index:1}},{path:"/chain/receive",name:"receive",component:se,meta:{index:2}},{path:"/chain/transfer",name:"transferOnChain",component:re,meta:{index:2},params:{address:""}},{path:"/channel/addChannel",name:"addChannelForm",component:ce,meta:{index:0},params:{Uri:""}},{path:"/channel/channelList",name:"channelListForm",component:ue,meta:{index:0}},{path:"/channel/payment",name:"payment",component:Ce,meta:{index:0},params:{paymentCode:""}},{path:"/channel/createPayment",name:"createPayment",component:ke,meta:{index:1}},{path:"/channel/channelAsset",name:"channelAsset",component:pe,meta:{index:2}},{path:"/channel/channelInfo",name:"channelInfo",component:ye,meta:{index:3},params:{Data:{Alice:"",ChannelName:"",date:"",SelfUri:"",SelfBalance:"",OtherUri:"",OtherBalance:"",State:"",isConnect:"",isTestNet:""}}},{path:"/setting/firstBackup",name:"firstBackupForm",component:De,meta:{index:1},params:{mnemonic:""}},{path:"/setting/backup",name:"BackupForm",component:Oe,meta:{index:1}},{path:"/setting/changePassword",name:"changePasswordForm",component:He,meta:{index:1}},{path:"/setting/contact",name:"contactForm",component:Pe,meta:{index:1}},{path:"/setting/language",name:"language",component:Ke,meta:{index:1}},{path:"/setting/about",name:"aboutForm",component:Je,meta:{index:1}},{path:"/setting/more",name:"moreForm",component:Ze,meta:{index:2}},{path:"/discover/ranking",name:"ranking",component:we,meta:{index:1}}],mode:"hash"}),Ye=a("zL8q"),Qe=a.n(Ye),ze=(a("tvR6"),a("NYxO")),qe=a("urW8"),et=a.n(qe),tt=a("TXmL");a("wUZ8");var at={tabbar:{wallet:"Wallet",message:"Message",channel:{addChannel:"Add Channel",channelList:"Channel List",payment:"Payment",scan:"Scan"},discover:"Discover",setting:"Me"},setting:{title:"Setting",backup:"Backup",changePass:"Change Password",contact:"Contact",switchLang:"Language",more:{title:"More",oneStepPayment:"One-step Payment"},about:"About Us",signOut:"Sign Out"},start:{title:"Welcome",Chain:"Chain",createWallet:"Create Wallet",loginByPrivateKey:"Import by Private Key",loginByKeystore:"Restore form the Backup File",loginByMnemonic:"Restore form the Mnemonic",createWalletTxt:"Create a new wallet and start a transaction of crypto asset",loginByPrivateKeyTxt:"You can import your wallet by your private key",loginByKeystoreTxt:"If you once backed up your files, you can import the wallet by the files",loginByMnemonicTxt:"If you once backed up your mnemonic, you can import the wallet by the mnemonic"},create:{title:"Create Wallet",password:"Password",checkPass:"Repeat pass",create:"Create","callback-1":"Please input the password","callback-2":"Please repeat the password","callback-3":"Passwords don't match","callback-4":"Succeed","callback-5":"Create Succeed","callback-6":"Succeed","callback-7":"Warning","callback-8":"Create failed, please again"},loginByPrivateKey:{title:"Import the Private Key",privateKey:"PrivateKey",password:"Password",checkPass:"CheckPass",import:"Import",backToStart:"Back to start page","callback-1":"Private key can not be empty","callback-2":"Please input the correct private key","callback-3":"Please input the password","callback-4":"Please repeat the password","callback-5":"Passwords don't match","callback-6":"Succeed","callback-7":"Import succeed","callback-8":"Warning","callback-9":"Import failed, please confirm the private key"},loginByKeyStore:{title:"Restore form the Backup File",chooseKeyStore:"Choose the File",password:"Password",import:"Import","callback-1":"Warning","callback-2":"KeyStore file read error","callback-3":"Warning","callback-4":"KeyStore file can not be empty","callback-5":"Warning","callback-6":"Please input the password","callback-7":"Warning","callback-8":"Key derivation failed - possibly wrong password","callback-9":"Warning","callback-10":"Succeed","callback-11":"Restore succeed","callback-12":"Warning","callback-12":"Restore failed，please confirm the file and password"},loginByMnemonic:{title:"Restore form the Mnemonic",mnemonic:"Mnemonic","mnemonic-txt":"please separate each mnemonic word with a space",import:"Import","callback-1":"Warning","callback-2":"Mnemonic error","callback-3":"Warning","callback-4":"Mnemonic can not be empty","callback-5":"Warning","callback-6":"Please input the password","callback-7":"Warning","callback-8":"Key derivation failed - possibly wrong password","callback-9":"Warning","callback-10":"Succeed","callback-11":"Restore succeed","callback-12":"Warning","callback-12":"Restore failed，please confirm the file and password"},index:{assetType:"Asset Type",balanceOnChain:"Chain Balance",balanceOnChannel:"Channel Balance",title:"Transfer",paymentCode:"Payment Code / Address",transferByContact:"Transfer from contact",transfer:"Transfer",transferOnChian:"Transfer On Chian",transferOnChannel:"Transfer On Channel",assetType:"AssetType",inputAssetType:"Choose Asset Type",password:"Password",cancel:"Cancel","transfer-1":"Send","transfer-2":" ","callback-1":"Address can not be empty","callback-2":"please confirm address","callback-3":"Amount can not be empty","callback-4":"Please enter a number","callback-5":"Amount must be greater than 0","callback-6":"AssetType can not be empty","callback-7":"Please input the password","callback-8":"Key derivation failed - possibly wrong password","callback-9":"Payment code / address can not be empty","callback-10":"Receiver's address can not be the same","callback-11":"Payment code parsing error","callback-12":"Not this network payment code, please confirm","callback-13":"Insufficient channel balance","callback-14":"No channels open yet, please add one before","callback-15":"Channel not open"},asset:{title:"Asset",receive:"Receive",send:"Send"},receive:{title:"Receive",receiveAddressQRCode:"Wallet Address QRCode",receiveAddress:"Wallet Address",copy:"Copy",amount:"Amount",assetType:"Asset Type",chooseAssetType:"Choose Asset Type",create:"Create",reset:"Reset",receiveCode:"Receive Code"},transferOnChian:{title1:"Transfer ",title2:" on chian",address:"Address",amount:"Amount",balance:"Balance",miningFee:"Mining Fee"},channelList:{title:"Channel List",addChannel:"Add Channel",noChannel:"No channels yet, go add now",channelName:"Channel name",date:"Open Date",selfUri:"Self uri",selfBalance:"Self balance",otherUri:"Other Uri",otherBalance:"Other balance",channelState:"Channel state",isConnect:"Connect state",isTestNet:"Network",closeChannel:"Close Channel",password:"Password",inputPassword:"Input password here",fastClose:"Fast Close",forcedClose:"Forced Close",cancel:"Cancel"},addChannel:{title:"Add Channel",assetBalance:"Asset Balance",otherUri:"TNAP",otherUriPlaceHolder:"Trinity Network Access Point",assetType:"Asset Type",chooseAssetType:"Choose Asset Type",selfDeposit:"Self deposit",otherDeposit:"Other deposit",alice:"Alice",password:"Password",addChannel:"Add Channel",cancel:"Cancel","callback-1":"TNAP can not be empty","callback-2":"The format of TNAP is incorrect","callback-3":"There is already a channel with this TNAP","callback-4":"Self deposit can not be empty","callback-5":"Self deposit must be greater than 0","callback-6":"deposit can not more than balance","callback-7":"The deposit limit is up to 8 decimal places","callback-8":"Other deposit can not be empty","callback-9":"Other deposit must be greater than 0","callback-10":"Alice can not be empty"},record:{title:"Record",noRecord:"No record yet",recordInfo:"Record Details",otherUri:"Other address",date:"Transaction data",amount:"Transaction amount",isOnChannel:"Transaction mode",state:"Transaction result",transactionHash:"Transaction hash",blockHash:"Block hash",close:"Close"},contact:{title:"My Contact",addContact:"Add Contact",name:"Name",address:"Address",transfer:"Transfer",delete:"Delete",cancelSelection:"Cancel Selection",add:"Add",cancel:"Cancel","callback-1":"Name can not be empty","callback-2":"Address can not be empty","callback-3":"Incorrect address format","callback-4":"Address already exists","callback-5":"Add Contact Succeed"},changePassword:{title:"Change Password",oldPass:"Old pass",password:"New pass",checkPass:"Repeat pass",changePassword:"Change Password","callback-1":"The wallet password can not be empty","callback-2":"Key derivation failed - possibly wrong password","callback-3":"Please input the new password","callback-4":"Please repeat the new password","callback-5":"Passwords don't match","callback-6":"Succeed","callback-7":"Change Password Succeed","callback-8":"Warning","callback-9":"Change Password Fail"},backup:{title:"Backup",backupBtn:"Backup Wallet",tips:"Tips",tipsContent:"After backed up the wallet, the system will generate a wallet backup file. When you clear the data, change the browser, or reinstall the system, you can use the wallet backup file to restore the wallet. Please save the file and the wallet password. Once lost wallet files or forgotten wallet passwords you may lost your assets."},about:{title:"About Us",content:"Trinity Wallet is a state channel based wallet App. Trinity provides users fast-speed transactions safely with “Trading off-chain, endorsement on-chain” state channels. Users can get the fastest payment experience by using this App.",tipsTitle:"Tips:",tips:" Carefully keep your private key, and confirm that the channel has been closed before uninstalling the App or deleting the data, otherwise you will lose the channel information."},common:{success:"Succeed",warning:"Warning",info:"Info",attention:"Attention",continue:"Continue",cancel:"Cancel",receive:"Receive","fee-1":"You will pay ","fee-2":" as the routing fee for this transaction.",whyFee:"What's the routing fee?",whyFeeTips:"The routing fee of the transaction is generated by passing multiple routing nodes","send-1":"send","send-2":"to you",password:"Password",inputPassword:"Input password here",twoPassword:"Because of cross-channel trading, you need to sign the data twice",closeChannel:"Close Channel","closeChannel-1":"want to close channel",selfBalance:"Self Balance",otherBalance:"Other Balance",forceCloseChannel:"Force Close Channel",signOut:"You will signout wallet","callback-1":"Please input the password","callback-2":"Key derivation failed - possibly wrong password","callback-3":"Connecting to Trinity Network","callback-4":"Transaction Confirmed","callback-5":"Transaction Failed","callback-6":"Trinity Network Connected","callback-7":"Can't found the channel, please try again later","callback-8":"Channel is opened","callback-9":"Channel is closed","callback-10":"It’s forced closing the channel, the data is correct","callback-11":"It’s forced closing the channel, the data is incorrect.tap to unlock the wallet for the sanctions","callback-12":"The balance is distributed, the channel is closed","callback-13":"Forced closing the channel has reached the block height, tap to confirm the password","callback-14":"The transaction has been sent to the Blockchain, please wait for confirm","callback-15":"Disconnected to the Trinity network, tap to reconnect","callback-16":"Failed to add channel, peer balance is insufficient","callback-17":"No channel is created with this Uri","callback-18":"The channel is not open or is not connected to the websocket","callback-19":"The channel has a payment message, you need to unlock the wallet.<br/>tap to unlock","callback-20":"Transaction Confirm","callback-21":"Receiving Confirm","callback-22":"The routing is empty, There is no channel available","callback-23":"Channel is closed","callback-24":"Disconnect","callback-25":"Transaction Failed",verifyFail:"The peer signature verification was failed, and the transaction was canceled.",switchLang:"切换语言",scan:"Scan"}};a("Vi3T");var st={en:at,cn:{tabbar:{wallet:"钱包",message:"消息",channel:{addChannel:"添加通道",channelList:"通道列表",payment:"支付码",scan:"扫一扫"},discover:"发现",setting:"我的"},message:{title:"消息"},setting:{title:"设置",backup:"备份钱包",changePass:"修改密码",contact:"联系人",switchLang:"多语言",more:{title:"更多",oneStepPayment:"免密支付"},about:"关于我们",signOut:"退出"},start:{title:"欢迎",Chain:"链",createWallet:"创建新钱包",loginByPrivateKey:"从私钥导入",loginByKeystore:"从备份文件恢复",loginByMnemonic:"从助记词恢复",createWalletTxt:"创建新钱包开始加密货币交易之旅",loginByPrivateKeyTxt:"可以通过导入私钥的方式将钱包导入",loginByKeystoreTxt:"如果之前备份文件，也可以通过备份文件的方式导入钱包",loginByMnemonicTxt:"如果之前备份文件，也可以通过助记词的方式导入钱包"},create:{title:"创建钱包",password:"密码",checkPass:"确认密码",create:"创建","callback-1":"请输入密码","callback-2":"请再次输入密码","callback-3":"两次输入密码不一致","callback-4":"成功","callback-5":"创建成功","callback-6":"成功","callback-7":"警告","callback-8":"创建失败,请再试一次"},loginByPrivateKey:{title:"导入私钥",privateKey:"私钥",password:"密码",checkPass:"确认密码",import:"导入",backToStart:"返回开始界面","callback-1":"私钥不能为空","callback-2":"请输入正确的私钥","callback-3":"请输入密码","callback-4":"请再次输入密码","callback-5":"两次输入密码不一致","callback-6":"成功","callback-7":"导入成功","callback-8":"警告","callback-9":"导入失败，请确认私钥正确"},loginByKeyStore:{title:"从备份文件恢复",chooseKeyStore:"选取文件",password:"密码",import:"导入","callback-1":"警告","callback-2":"KeyStore文件读取错误","callback-3":"警告","callback-4":"KeyStore文件不能为空","callback-5":"警告","callback-6":"密码不能为空","callback-7":"警告","callback-8":"钱包解锁失败 - 可能是密码错误","callback-9":"警告","callback-10":"成功","callback-11":"导入成功","callback-12":"警告","callback-12":"导入失败，请确认KeyStore和密码正确"},loginByMnemonic:{title:"从助记词恢复",mnemonic:"助记词","mnemonic-txt":"请输入12个单词,以空格隔开",import:"导入","callback-1":"警告","callback-2":"助记词读取错误","callback-3":"警告","callback-4":"助记词不能为空","callback-5":"警告","callback-6":"密码不能为空","callback-7":"警告","callback-8":"钱包解锁失败 - 可能是密码错误","callback-9":"警告","callback-10":"成功","callback-11":"导入成功","callback-12":"警告","callback-12":"导入失败，请确认KeyStore和密码正确"},index:{assetType:"资产类型",balanceOnChain:"链上金额",balanceOnChannel:"通道金额",title:"转账",paymentCode:"支付码/地址",transferByContact:"从联系人里转账",transfer:"转 账",transferOnChian:"链上转账",transferOnChannel:"通道转账",assetType:"资产类型",inputAssetType:"请选择资产类型",password:"密码",cancel:"取 消","transfer-1":"向","transfer-2":"转账","callback-1":"地址不能为空","callback-2":"请输入正确的地址","callback-3":"金额不能为空","callback-4":"请输入数字值","callback-5":"金额必须大于0","callback-6":"资产类型不能为空","callback-7":"钱包密码不能为空，否则将无法交易","callback-8":"钱包解锁失败 - 可能是密码错误","callback-9":"付款码/地址不能为空","callback-10":"收付款地址不能相同","callback-11":"付款码解析错误","callback-12":"非本网络付款码,请确认","callback-13":"通道余额不足","callback-14":"没有开通的通道,请先建立通道","callback-15":"通道未打开"},asset:{title:"资产",receive:"收 款",send:"付 款"},receive:{title:"收款",receiveAddressQRCode:"钱包地址二维码",receiveAddress:"钱包地址",copy:"复制",amount:"金额",assetType:"资产类型",chooseAssetType:"请选择资产类型",create:"创建",reset:"重置",receiveCode:"收款码"},transferOnChian:{title1:"链上转账",title2:"",address:"地址",amount:"金额",balance:"余额",miningFee:"矿工费"},channelList:{title:"通道列表",addChannel:"添加通道",noChannel:"还没有通道，立即去添加",channelName:"通道名称",date:"开通时间",selfUri:"本端地址",selfBalance:"本端余额",otherUri:"对端地址",otherBalance:"对端余额",channelState:"通道状态",isConnect:"是否连接",isTestNet:"网络",closeChannel:"关闭通道",password:"密码",inputPassword:"在此输入密码",fastClose:"快速关闭",forcedClose:"强制关闭",cancel:"取消"},addChannel:{title:"添加通道",assetBalance:"资产余额",otherUri:"TNAP",otherUriPlaceHolder:"Trinity网络接入点",assetType:"资产类型",chooseAssetType:"请选择资产类型",selfDeposit:"本端余额",otherDeposit:"对端余额",alice:"通道名称",password:"密码",addChannel:"添加通道",cancel:"取消","callback-1":"对端TNAP不能为空","callback-2":"TNAP格式不正确","callback-3":"你已经和这个TNAP有一个通道了","callback-4":"本端押金数量不能为空","callback-5":"本端押金数量必须大于0","callback-6":"押金数量不能大于钱包余额","callback-7":"本端押金小数最多为8位小数","callback-8":"对端押金数量不能为空","callback-9":"对端押金数量必须大于0","callback-10":"通道名称不能为空"},record:{title:"交易记录",noRecord:"没有交易记录",recordInfo:"交易详情",otherUri:"对端地址",date:"交易时间",amount:"交易金额",isOnChannel:"交易方式",state:"交易结果",transactionHash:"交易哈希",blockHash:"块哈希",close:"关闭"},contact:{title:"我的联系人",addContact:"添加联系人",name:"名字",address:"地址",transfer:"转账",delete:"删除",cancelSelection:"取消选择",add:"添 加",cancel:"取 消","callback-1":"姓名不能为空","callback-2":"地址不能为空","callback-3":"地址检测错误","callback-4":"地址已经存在","callback-5":"添加联系人成功"},changePassword:{title:"修改密码",oldPass:"原密码",password:"新密码",checkPass:"重复新密码",changePassword:"修改密码","callback-1":"钱包密码不能为空，否则将无法修改密码","callback-2":"钱包解锁失败 - 可能是密码错误","callback-3":"请输入新密码","callback-4":"请再次输入新密码","callback-5":"两次输入密码不一致","callback-6":"成功","callback-7":"修改密码成功","callback-8":"警告","callback-9":"修改密码失败"},backup:{title:"备份",backupBtn:"备份钱包",tips:"温馨提醒",tipsContent:"备份当前钱包后，浏览器会生成一个钱包备份文件，当您清空数据库、或者更换 浏览器、重装系统后，可以使用钱包备份文件恢复当前钱包。同时保存好文件和 钱包密码，钱包文件丢失或忘记密码可能会导致您的资产丢失。"},about:{title:"关于我们",content:"Trinity Wallet App是基于状态通道功能的钱包App。Trinity的状态通道技术通过“链上信用背书，链下进行交易”的方式可以为所有区块链网络扩容。在钱包App中，Trinity为用户提供了基于状态通道的支付服务，让基于状态通道技术的交易具备极高的转账速度和安全性。打开状态通道，便可以获得最快的付款体验。",tipsTitle:"友情提示:",tips:"请妥善管理您的私钥。若要卸载或删除APP，请您提前请确认通道已经全部关闭，否则将会面临通道信息丢失的风险。"},common:{success:"成功",warning:"警告",info:"消息",attention:"注意",continue:"确 定",cancel:"取 消",receive:"收 款","fee-1":"你将额外支付","fee-2":"作为本次交易的路由费用",whyFee:"什么是路由费用?",whyFeeTips:"交易的路由费用由于通过多个路由节点而产生","send-1":"向你转账","send-2":"",password:"密码",inputPassword:"在此输入密码",twoPassword:"由于跨通道交易,你需要对数据进行两次签名",closeChannel:"关闭通道","closeChannel-1":"想要关闭通道",selfBalance:"本端余额",otherBalance:"对端余额",forceCloseChannel:"强制关闭通道",signOut:"你将退出钱包","callback-1":"密码不能为空，否则将无法交易","callback-2":"钱包解锁失败 - 可能是密码错误","callback-3":"正在连接至Trinity网络","callback-4":"交易已确认","callback-5":"交易确认失败","callback-6":"已连接到Trinity网络","callback-7":"未找到该通道,请重试一次","callback-8":"通道已开通","callback-9":"通道已关闭","callback-10":"正在强制关闭通道,数据正确","callback-11":"正在强制关闭通道,数据不正确,点击解锁钱包进行制裁","callback-12":"通道已分配余额,通道关闭","callback-13":"强制拆链已到达指定块高，点击输入密码确认","callback-14":"上链成功,请等待交易确认","callback-15":"与Trinity网络断开连接,点击进行重连","callback-16":"添加通道失败,对端余额不足","callback-17":"未与该Uri建立通道","callback-18":"该通道未Open或者未连接上websocket","callback-19":"通道有收款消息,需要你解锁钱包.<br/>点击进行解锁","callback-20":"转账确认","callback-21":"收款确认","callback-22":"路由为空,没有可用的通道","callback-23":"通道已关闭","callback-24":"断开连接","callback-25":"转账失败",verifyFail:"对端签名验证未通过,停止交易.",switchLang:"switch Language",scan:"扫一扫"}}};s.default.use(tt.a);const nt=new tt.a({locale:localStorage.lang||"cn",messages:st});et.a.i18n((e,t)=>nt.vm._t(e,t));var ot=nt,rt=(a("7xIN"),{state:{version:"0.3.0",baseChain:"ETH",isTestNet:!0,isLogin:!1,activeNavIndex:"1-1",isNavShow:!0,isMessageBoxShow:!1,isChannelFormShow:!1,gasPrice:5e9,isMobile:!0,isNotifyShow:!1,isOneStepPayment:"",RSMCNum:0,HTLCNum:0,HTLCRNum:0,nodeList:[],walletInfo:{keyStore:"",publicKey:"",address:"",keyStorePass:""},NEOwalletInfo:{keyStore:"",publicKey:"",address:"",keyStorePass:""},balanceData:{Chain:{TNC:0,ETH:0,NEO:0,GAS:0},Channel:{TNC:0,ETH:0,NEO:0,GAS:0}},activeAssetInfo:{assetType:"",channelName:""},addChannelInfo:[],txOnChannelInfo:[],closeChannelInfo:[],channelList:[],webSocketList:[],contactList:{},txList:[],recordList:[],RList:[],eventList:[],NetMagic:"",NodeUriWebSocketIp:"",NodeUriWebSocket:"",tncContractAddress:"",tncContractAbi:[],trinityContractAddress:"",trinityDataContractAddress:"",trinityContractAbi:[],spvPort:"",delayBlock:"",nodeWebSocketIp:"",NodeRpcUri:""},getters:{channelList:e=>!e.channelList},mutations:{switch_dialog(e){e.show=!e.show}},actions:{switch_dialog(e){e.commit("switch_dialog")}}});s.default.use(ze.a);var it=new ze.a.Store({modules:{vuexStore:rt}});s.default.use(Qe.a),s.default.use(ze.a),s.default.config.productionTip=!1,new s.default({el:"#app",router:je,store:it,i18n:ot,components:{App:i},template:"<App/>"})},OHZR:function(e,t){},SFN9:function(e,t){},SHvM:function(e,t){},SKcX:function(e,t,a){"use strict";var s={name:"tabbar",data(){return{MessageValue:0,tabbarList:[{index:"0",icon:"el-icon-ETH-qianbao",name:this.$t("tabbar.wallet"),router:"/wallet"},{index:"1",icon:"el-icon-ETH-comment",name:this.$t("tabbar.message"),router:"/message"},{index:"2",icon:"./../../assets/img/Trinity.png"},{index:"3",icon:"el-icon-ETH-discover",name:this.$t("tabbar.discover"),router:"/discover"},{index:"4",icon:"el-icon-ETH-wode",name:this.$t("tabbar.setting"),router:"/setting"}],tabbarSelected:0,isTabbarShow:!1}},mounted(){this.$nextTick(function(){document.querySelector(".tabbar").style.top=document.documentElement.clientHeight-48+"px"})},computed:{},watch:{"$route.path":"showTabbar","$i18n.locale":"changeLang"},methods:{selectItems(e,t){this.tabbarSelected=e,this.$router.push(t)},showChannelForm(){this.$store.state.vuexStore.isChannelFormShow=!0},showTabbar(){let e=this.$route.path;this.isTabbarShow="/start"!=e&&"/create"!=e&&"/loginByPrivateKey"!=e&&"/loginByKeyStore"!=e&&"/scan"!=e&&"/setting/language"!=e&&"/discover/ranking"!=e&&"/back"!=e&&"/setting/firstBackup"!=e&&"/loginByMnemonic"!=e},changeLang(){this.tabbarList[0].name=this.$t("tabbar.wallet"),this.tabbarList[1].name=this.$t("tabbar.message"),this.tabbarList[3].name=this.$t("tabbar.discover"),this.tabbarList[4].name=this.$t("tabbar.setting")}}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"show",rawName:"v-show",value:e.isTabbarShow,expression:"isTabbarShow"}],staticClass:"tabbar"},e._l(e.tabbarList,function(t,s){return a("div",{key:s,staticStyle:{flex:"1"}},[2!=s&&1!=s?a("a",{staticClass:"tab-item",class:{"is-selected":e.tabbarSelected==s},on:{click:function(a){a.stopPropagation(),e.selectItems(s,t.router)}}},[a("div",{staticClass:"tab-item-icon"},[a("i",{class:t.icon})]),e._v(" "),a("div",{staticClass:"tab-item-label"},[a("p",[a("span",[e._v(e._s(t.name))])])])]):e._e(),e._v(" "),1==s?a("a",{staticClass:"tab-item",class:{"is-selected":e.tabbarSelected==s},on:{click:function(a){a.stopPropagation(),e.selectItems(s,t.router)}}},[a("el-badge",{staticClass:"item",attrs:{hidden:0==e.MessageValue,value:e.MessageValue,max:99}},[a("div",{staticClass:"tab-item-icon"},[a("i",{class:t.icon})]),e._v(" "),a("div",{staticClass:"tab-item-label"},[a("p",[a("span",[e._v(e._s(t.name))])])])])],1):e._e(),e._v(" "),2==s?a("a",{staticClass:"tab-item",on:{click:function(t){t.stopPropagation(),e.showChannelForm()}}},[e._m(0,!0)]):e._e()])}))},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"TrinityButton"},[t("img",{attrs:{src:a("N+8p"),alt:"Trinity"}})])}]};var o=a("VU/8")(s,n,!1,function(e){a("tVza")},"data-v-c247d2bc",null);t.a=o.exports},TsFg:function(e,t){},VR0t:function(e,t,a){"use strict";var s={name:"dialogForm",data:()=>({}),filters:{},methods:{}},n={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"dialogForm"})},staticRenderFns:[]};var o=a("VU/8")(s,n,!1,function(e){a("5Znf")},"data-v-7a57ce5f",null);t.a=o.exports},a4pD:function(e,t){},cToj:function(e,t){},ey8z:function(e,t,a){e.exports=a.p+"static/img/ranking.e1a7f0b.png"},fhdw:function(e,t){},fz4B:function(e,t){},hWNH:function(e,t,a){e.exports=a.p+"static/img/Trinity.9d7f65f.png"},jQdT:function(e,t){},lGmd:function(e,t,a){"use strict";(function(e){var s=a("qKYu");t.a={name:"createForm",data:()=>({isDisable:!1,backForm:{pass:""}}),components:{},computed:{baseChain(){return this.$store.state.vuexStore.baseChain},keyStore(){return"ETH"==this.baseChain?this.$store.state.vuexStore.walletInfo.keyStore:"NEO"==this.baseChain?this.$store.state.vuexStore.NEOwalletInfo.keyStore:void 0}},mounted(){this.$nextTick(function(){})},methods:{toLoginForm(){let t=this;t.isDisable=!0,setTimeout(()=>{t.isDisable=!1},2e3);let a,n=t.backForm.pass;if(console.log(!n),n){try{"ETH"==t.baseChain?(console.log(),a=web3.eth.accounts.decrypt(this.keyStore,n)):"NEO"==t.baseChain&&(a=scrypt_module_factory(DecryptWalletByPassword,{},{WalletScript:this.keyStore.accounts[0].key,password:n,address:this.keyStore.accounts[0].address}))}catch(e){}if(a)if("ETH"==this.baseChain){let t=new e(a.privateKey.substring(2),"hex").toString("hex");console.log(t);let o=web3.eth.accounts.privateKeyToAccount("0x"+t).address;o=web3.utils.toChecksumAddress(o),web3.utils.checkAddressChecksum(o)?(this.$store.state.vuexStore.isLogin=!0,this.$store.state.vuexStore.walletInfo.keyStorePass=n,this.$notify({title:this.$t("loginByKeyStore.callback-10"),dangerouslyUseHTMLString:!0,message:this.$t("loginByKeyStore.callback-11"),duration:3e3,type:"success"}),s.a.$emit("getAddressInfo",!0),this.$router.push("/wallet")):this.$notify.error({title:this.$t("loginByKeyStore.callback-12"),dangerouslyUseHTMLString:!0,message:this.$t("loginByKeyStore.callback-13"),duration:3e3})}else"NEO"==this.baseChain&&(this.$store.state.vuexStore.isLogin=!0,this.$notify({title:this.$t("loginByKeyStore.callback-10"),dangerouslyUseHTMLString:!0,message:this.$t("loginByKeyStore.callback-11"),duration:3e3,type:"success"}),this.keyStoreContent="",this.keyStorePass="",this.$router.push("/wallet"));else alert("钱包解锁失败,可能是密码错误")}else alert("钱包密码不能为空，否则将无法恢复");this.backForm.pass=""},test(){console.log(1)}}}}).call(t,a("EuP9").Buffer)},mB2j:function(e,t){},"mI+2":function(e,t){},mx98:function(e,t){},ox10:function(e,t){},"pG/9":function(e,t){},qKYu:function(e,t,a){"use strict";var s=a("7+uW");t.a=new s.default},qvUZ:function(e,t){},rXUA:function(e,t){},"s/ph":function(e,t,a){"use strict";(function(e){var s=a("LumP"),n=a("qKYu");t.a={name:"loginByKeyStoreForm",data:()=>({fileList:[],keyStoreContent:"",keyStorePass:""}),mounted(){this.$nextTick(function(){})},components:{headBox:s.a},methods:{handleChange(e,t){var a=this;if(e.raw){let t=new FileReader;t.onload=function(e){"ETH"==a.$store.state.vuexStore.baseChain?(a.keyStoreContent=JSON.parse(e.target.result),40!==a.keyStoreContent.address.length&&(a.$notify.error({title:a.$t("loginByKeyStore.callback-1"),dangerouslyUseHTMLString:!0,message:a.$t("loginByKeyStore.callback-2"),duration:3e3}),a.keyStoreContent="")):"NEO"==a.$store.state.vuexStore.baseChain&&(a.keyStoreContent=JSON.parse(e.target.result),34!==a.keyStoreContent.accounts[0].address.length&&(a.$notify.error({title:a.$t("loginByKeyStore.callback-1"),dangerouslyUseHTMLString:!0,message:a.$t("loginByKeyStore.callback-2"),duration:3e3}),a.keyStoreContent=""))},t.readAsText(e.raw,"gb2312")}},login(){return""==this.keyStoreContent?(this.$notify.error({title:this.$t("loginByKeyStore.callback-3"),dangerouslyUseHTMLString:!0,message:this.$t("loginByKeyStore.callback-4"),duration:3e3}),!1):""==this.keyStorePass?(this.$notify.error({title:this.$t("loginByKeyStore.callback-5"),dangerouslyUseHTMLString:!0,message:this.$t("loginByKeyStore.callback-6"),duration:3e3}),!1):void this.loginByKeyStore()},loginByKeyStore(){if("ETH"==this.$store.state.vuexStore.baseChain){let t;try{t=web3.eth.accounts.decrypt(this.keyStoreContent,this.keyStorePass)}catch(e){return"Key derivation failed - possibly wrong password"==e.message?(this.$notify.error({title:this.$t("loginByKeyStore.callback-7"),dangerouslyUseHTMLString:!0,message:this.$t("loginByKeyStore.callback-8"),duration:3e3}),!1):(this.$notify.error({title:this.$t("loginByKeyStore.callback-9"),dangerouslyUseHTMLString:!0,message:e.message,duration:3e3}),!1)}let a=new e(t.privateKey.substring(2),"hex").toString("hex");console.log(a);let s=web3.eth.accounts.privateKeyToAccount("0x"+a).address;s=web3.utils.toChecksumAddress(s),web3.utils.checkAddressChecksum(s)?(this.$store.state.vuexStore.walletInfo.keyStore=this.keyStoreContent,this.$store.state.vuexStore.walletInfo.address=s,this.$store.state.vuexStore.isLogin=!0,this.$notify({title:this.$t("loginByKeyStore.callback-10"),dangerouslyUseHTMLString:!0,message:this.$t("loginByKeyStore.callback-11"),duration:3e3,type:"success"}),n.a.$emit("getAddressInfo",!0),this.$parent.$parent.saveAsString("isLogin",this.$store.state.vuexStore.isLogin),this.$parent.$parent.saveAsArray("walletInfo",this.$store.state.vuexStore.walletInfo),this.$router.push("/wallet")):this.$notify.error({title:this.$t("loginByKeyStore.callback-12"),dangerouslyUseHTMLString:!0,message:this.$t("loginByKeyStore.callback-13"),duration:3e3})}else if("NEO"==this.$store.state.vuexStore.baseChain){let e;console.log(this.keyStoreContent);try{e=scrypt_module_factory(DecryptWalletByPassword,{},{WalletScript:this.keyStoreContent.accounts[0].key,password:this.keyStorePass,address:this.keyStoreContent.accounts[0].address}),console.log(e)}catch(e){return this.$notify.error({title:this.$t("loginByKeyStore.callback-9"),dangerouslyUseHTMLString:!0,message:e.message,duration:3e3}),!1}n.a.$emit("getAddressInfo",!0),this.$store.state.vuexStore.NEOwalletInfo.keyStore=this.keyStoreContent,this.$store.state.vuexStore.NEOwalletInfo.publicKey=getPublicKeyEncoded(ab2hexstring(getPublicKey(e,0))),console.log(this.$store.state.vuexStore.NEOwalletInfo.publicKey),this.$store.state.vuexStore.NEOwalletInfo.address=this.keyStoreContent.accounts[0].address,this.$store.state.vuexStore.isLogin=!0,this.$notify({title:this.$t("loginByKeyStore.callback-10"),dangerouslyUseHTMLString:!0,message:this.$t("loginByKeyStore.callback-11"),duration:3e3,type:"success"}),n.a.$emit("getAddressInfo",!0),this.$parent.$parent.saveAsString("isLogin",this.$store.state.vuexStore.isLogin),this.$parent.$parent.saveAsArray("walletInfo",this.$store.state.vuexStore.NEOwalletInfo),this.$router.push("/wallet")}this.keyStoreContent="",this.keyStorePass=""}}}}).call(t,a("EuP9").Buffer)},"sH/u":function(e,t){},soYl:function(e,t){},tVza:function(e,t){},tvR6:function(e,t){},xJD8:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_Vue__=__webpack_require__("TXMN"),__WEBPACK_IMPORTED_MODULE_1__components_tabbar_channel__=__webpack_require__("JSzE"),__WEBPACK_IMPORTED_MODULE_2__components_common_footer__=__webpack_require__("SKcX"),__WEBPACK_IMPORTED_MODULE_3__components_common_config__=__webpack_require__("0NEh"),__WEBPACK_IMPORTED_MODULE_4__components_common_notify__=__webpack_require__("9HGa"),__WEBPACK_IMPORTED_MODULE_5__components_common_dialog__=__webpack_require__("VR0t");__webpack_exports__.a={name:"App",data:()=>({startX:0,endX:0,isFeeInfoBoxShow:!1,isSignOutBoxShow:!1,transitionName:"",isDisable:!1}),components:{footerBox:__WEBPACK_IMPORTED_MODULE_2__components_common_footer__.a,channel:__WEBPACK_IMPORTED_MODULE_1__components_tabbar_channel__.a,config:__WEBPACK_IMPORTED_MODULE_3__components_common_config__.a,notify:__WEBPACK_IMPORTED_MODULE_4__components_common_notify__.a,dialogBox:__WEBPACK_IMPORTED_MODULE_5__components_common_dialog__.a},mounted(){this.$nextTick(function(){this.browserRedirect(),this.backFun()})},created(){},computed:{baseChain(){return this.$store.state.vuexStore.baseChain},trinityContractAddress(){return this.$store.state.vuexStore.trinityContractAddress},trinityDataContractAddress(){return this.$store.state.vuexStore.trinityDataContractAddress},tncContractAddress(){return this.$store.state.vuexStore.tncContractAddress},isTestNet(){return this.$store.state.vuexStore.isTestNet},isOneStepPayment(){return this.$store.state.vuexStore.isOneStepPayment}},watch:{$route(e,t){e.meta.index>t.meta.index?this.transitionName="slide-left":e.meta.index<t.meta.index?this.transitionName="slide-right":this.transitionName=""}},methods:{connectWebSocketForNodeUri(){let e=this;if("ETH"==e.baseChain){let t=e.$store.state.vuexStore.NodeUriWebSocketIp;e.$store.state.vuexStore.NodeUriWebSocket=new WebSocket(t),e.$store.state.vuexStore.NodeUriWebSocket.onmessage=e.nodeUriWebsocketOnMessage,e.$store.state.vuexStore.NodeUriWebSocket.onclose=e.nodeUriWebsocketClose}else"NEO"==e.baseChain&&axios({method:"post",url:e.$store.state.vuexStore.NodeRpcUri,headers:{"Content-Type":"application/json;charset=UTF-8"},data:JSON.stringify({jsonrpc:"2.0",method:"getBalance",params:["AW25dxZZRJYjgXApEacYAEQDNPGDuFGCWF"],id:1})}).then(function(t){e.loseWebSocketForNodeUriNotify&&(e.loseWebSocketForNodeUriNotify.close(),e.loseWebSocketForNodeUriNotify=void 0),console.log("连接全节点成功")})},backToStart(){this.$router.push("/start")},closeNav(){window.screen.width<1024&&this.$store.state.vuexStore.isNavShow&&(this.$store.state.vuexStore.isNavShow=!1)},touchStart(e){this.startX=e.touches[0].clientX,console.log("开始X:"+this.startX)},touchEnd(e){window.screen.width<1024&&(this.endX=e.changedTouches[0].clientX,console.log("结束X:"+this.endX),this.startX>300&&this.startX-this.endX>0&&this.$store.state.vuexStore.isNavShow&&(this.$store.state.vuexStore.isNavShow=!1),this.startX<50&&this.startX-this.endX<-50&&!this.$store.state.vuexStore.isNavShow&&(this.$store.state.vuexStore.isNavShow=!0),this.startX=0,this.endX=0)},fetchAsArray:function(e){let t=e.toString();return"walletInfo"==t?JSON.parse(window.localStorage.getItem(t)||"{}"):JSON.parse(window.localStorage.getItem(t)||"[]")},fetchAsString:function(e){let t=e.toString();return window.localStorage.getItem(t)||""},saveAsArray:function(e,t){let a=e.toString();window.localStorage.setItem(a,JSON.stringify(t))},saveAsString:function(e,t){let a=e.toString();window.localStorage.setItem(a,t)},keepDecimalPlaces(e,t){let a;return a=isNaN(e)?NaN:parseInt(e*Math.pow(10,t))/Math.pow(10,t)},sendWebsocket(e,t){let a=this.uri2Ip(e);this.$store.state.vuexStore.webSocketList.every(function(e,s){if(e.Ip==a&&""!=e.websock)return e.websock.send(JSON.stringify(t)),!1})},getChannelBalance(){let e=this,t=0,a=0;e.$store.state.vuexStore.channelList.forEach(function(s,n){s.isTestNet==e.isTestNet&&3==s.State&&"TNC"==s.assetType?t+=s.SelfBalance:s.isTestNet==e.isTestNet&&3==s.State&&"ETH"==s.assetType&&(a+=s.SelfBalance)}),__WEBPACK_IMPORTED_MODULE_0_Vue__.a.set(e.$store.state.vuexStore.balanceData.Channel,"TNC",e.keepDecimalPlaces(t/1e8,3)),__WEBPACK_IMPORTED_MODULE_0_Vue__.a.set(e.$store.state.vuexStore.balanceData.Channel,"ETH",e.keepDecimalPlaces(a/1e8,3))},showLoading:function(){loading=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)",target:document.querySelector(".appBox")})},closeLoading(){loading.close()},showSignOutBox(){this.isSignOutBoxShow=!0},SignOut(){this.$store.state.vuexStore.walletInfo={keyStore:"",publicKey:"",address:"",keyStorePass:""},this.$store.state.vuexStore.isLogin=!1,this.saveAsString("isLogin",this.$store.state.vuexStore.isLogin),this.saveAsArray("walletInfo",this.$store.state.vuexStore.walletInfo),location.reload()},decryptPrivateKey(e,t){let a,s=this;try{a=web3.eth.accounts.decrypt(e,t)}catch(e){return"Key derivation failed - possibly wrong password"==e.message?(s.$notify.error({title:s.$t("common.warning"),dangerouslyUseHTMLString:!0,message:s.$t("common.callback-2"),duration:3e3}),!1):(s.$notify.error({title:s.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.message,duration:3e3}),!1)}return a},verifyPassword(e,t){let a;try{a=web3.eth.accounts.decrypt(e,t)}catch(e){return console.log(e),!1}return a},async signDataForERC20Contract(e,t,a,s,n,o){let r,i=this,l=a.join(",");if(a.length==s.length){console.log(e),console.log(t),console.log(`${t}(${l})`),console.log(a),console.log(s),console.log(n),console.log(o),console.log("________________________");let c=i.decryptPrivateKey(i.$store.state.vuexStore.walletInfo.keyStore,n);await web3.eth.getTransactionCount(i.$store.state.vuexStore.walletInfo.address,web3.eth.defaultBlock.pending).then(async function(n){console.log(n);let d=web3.eth.abi.encodeFunctionSignature(`${t}(${l})`);console.log(d);let h=web3.eth.abi.encodeParameters(a,s);console.log(h),"number"!=typeof o&&(o=i.$store.state.vuexStore.gasPrice);try{await web3.eth.estimateGas({to:e,from:i.$store.state.vuexStore.walletInfo.address,data:d+h.substr(2)}).then(function(t){if("number"==typeof t){console.log(t);var a={nonce:web3.utils.toHex(n++),gasPrice:web3.utils.toHex(o),gasLimit:web3.utils.toHex(t+5e3),to:e,from:i.$store.state.vuexStore.walletInfo.address,value:"0x00",data:d+h.substr(2)};console.log(a),r=signData(a,c.privateKey),console.log(r)}else console.log("模拟上链失败"),console.log(t)})}catch(e){console.log(e)}})}return r},ecSignForTrinityContract(dataTypeList,dataList,password){let _this=this,result;if(dataTypeList.length==dataList.length){console.log(dataTypeList),console.log(dataList),console.log(password),console.log("________________________");let decryptPK=_this.decryptPrivateKey(_this.$store.state.vuexStore.walletInfo.keyStore,password),soliditySha3Data="web3.utils.soliditySha3(";for(let e=0;e<dataTypeList.length;e++){let t="{'t' : dataTypeList["+e+"],'v' : dataList["+e+"]},";soliditySha3Data+=t}soliditySha3Data+=")",console.log(soliditySha3Data);let txData=eval(soliditySha3Data);console.log(txData);let signedData=ecSign(txData,decryptPK.privateKey);console.log(signedData),result={txData:txData,signedData:signedData}}else console.log("参数长度不一致"),result=!1;return console.log(result),result},uri2Ip(e,t){let a=e.split("@")[1];return a=null==t?a.split(":")[0]:a.split(":")[0]+":"+t},assetContractAddress2AssetType(e){let t="";if(console.log(this.isTestNet),this.isTestNet)switch(console.log(1),console.log(e),e){case"65096f2B7A8dc1592479F1911cd2B98dae4d2218":t="TNC";break;case"ETH":t="ETH";break;default:t=Error}else switch(e){case"65096f2B7A8dc1592479F1911cd2B98dae4d2218":t="TNC";break;case"ETH":t="0x602c79718b16e442de58778e148d0b1084e3b2dffd5de6b7b16cee7969282de7";break;default:t=Error}return console.log(t),t},AssetType2AssetContractAddress(e){let t="";if(this.isTestNet)switch(e){case"TNC":t=this.tncContractAddress;break;case"ETH":t="0x602c79718b16e442de58778e148d0b1084e3b2dffd5de6b7b16cee7969282de7";break;default:t=Error}else switch(e){case"TNC":t="08e8c4400f1af2c20c28e0018f29535eb85d15b6";break;case"ETH":t="0x602c79718b16e442de58778e148d0b1084e3b2dffd5de6b7b16cee7969282de7";break;default:t=Error}return t},AssetTypeToAssetId(e){let t="";if(console.log(this.isTestNet),this.isTestNet)switch(e){case"TNC":t="0x849d095d07950b9e56d0c895ec48ec5100cfdff1";break;case"GAS":t="0x602c79718b16e442de58778e148d0b1084e3b2dffd5de6b7b16cee7969282de7";break;case"NEO":t="0xc56f33fc6ecfcd0c225c4ab356fee59390af8560be0e930faebe74a6daff7c9b";break;default:t=Error}else switch(e){case"TNC":t="0x08e8c4400f1af2c20c28e0018f29535eb85d15b6";break;case"GAS":t="0x602c79718b16e442de58778e148d0b1084e3b2dffd5de6b7b16cee7969282de7";break;case"NEO":t="0xc56f33fc6ecfcd0c225c4ab356fee59390af8560be0e930faebe74a6daff7c9b";break;default:t=Error}return t},AssetTypeToAssetId1(e){let t="";if(this.isTestNet)switch(e){case"TNC":t="849d095d07950b9e56d0c895ec48ec5100cfdff1";break;case"GAS":t="0x602c79718b16e442de58778e148d0b1084e3b2dffd5de6b7b16cee7969282de7";break;case"NEO":t="0xc56f33fc6ecfcd0c225c4ab356fee59390af8560be0e930faebe74a6daff7c9b";break;default:t=Error}else switch(e){case"TNC":t="08e8c4400f1af2c20c28e0018f29535eb85d15b6";break;case"GAS":t="0x602c79718b16e442de58778e148d0b1084e3b2dffd5de6b7b16cee7969282de7";break;case"NEO":t="0xc56f33fc6ecfcd0c225c4ab356fee59390af8560be0e930faebe74a6daff7c9b";break;default:t=Error}return t},AssetIdToAssetType(e){let t="";if(this.isTestNet)switch(e){case"849d095d07950b9e56d0c895ec48ec5100cfdff1":t="TNC";break;case"602c79718b16e442de58778e148d0b1084e3b2dffd5de6b7b16cee7969282de7":t="GAS";break;case"c56f33fc6ecfcd0c225c4ab356fee59390af8560be0e930faebe74a6daff7c9b":t="NEO";break;default:t=Error}else switch(e){case"08e8c4400f1af2c20c28e0018f29535eb85d15b6":t="TNC";break;case"602c79718b16e442de58778e148d0b1084e3b2dffd5de6b7b16cee7969282de7":t="GAS";break;case"c56f33fc6ecfcd0c225c4ab356fee59390af8560be0e930faebe74a6daff7c9b":t="NEO";break;default:t=Error}return t},getChannelSerial(e,t,a,s){let n=this,o=-1;return n.$store.state.vuexStore.channelList.forEach(function(r,i){if(r[e]==t&&r.isTestNet==n.isTestNet){if(null==a)return void(o=i);if("open"==a){if(3==r.State&&1==r.isConnect)return void(o=i);o=-2,!1!==s&&n.$notify.error({title:n.$t("common.warning"),dangerouslyUseHTMLString:!0,message:n.$t("common.callback-18"),duration:3e3})}}else o=-1,!1!==s&&n.$notify.error({title:n.$t("common.warning"),dangerouslyUseHTMLString:!0,message:n.$t("common.callback-17"),duration:3e3})}),o},cycleGetTransactionReceipt(e){let t=this;setTimeout(function(){web3.eth.getTransactionReceipt(e).then(function(a){return null==a?t.cycleGetTransactionReceipt(e):(console.log(a),1==a.status?(t.$notify({title:t.$t("common.success"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-4"),duration:3e3,type:"success"}),t.$store.state.vuexStore.recordList.forEach(function(e,s){e.transactionHash==a.transactionHash&&(e.blockHash=a.blockHash,e.state=1,console.log("修改状态成功"),t.StoreData("recordList"))}),t.$store.state.vuexStore.channelList.forEach(function(e,s){e.closeHash==a.transactionHash&&(t.$store.state.vuexStore.channelList.splice(s,1),t.StoreData("channelList"),console.log("存储通道信息"))}),a):0==a.status?(t.$notify({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-5"),duration:3e3,type:"error"}),t.$store.state.vuexStore.recordList.forEach(function(e,s){e.transactionHash==a.transactionHash&&(e.blockHash=a.blockHash,e.state=-1,console.log("修改状态成功"),t.StoreData("recordList"))}),a):void 0)})},4e3)},monitorEventByNodeUri(e,t){let a=this;for(var s=0;s<t.length;s++){let n={messageType:t[s],walletAddress:a.$store.state.vuexStore.walletInfo.address,chainType:a.baseChain,playload:e,comments:""};a.$store.state.vuexStore.NodeUriWebSocket.send(JSON.stringify(n))}},nodeUriWebsocketOnMessage(e){let t=this;if("connected to server"===e.data)t.loseWebSocketForNodeUriNotify&&t.loseWebSocketForNodeUriNotify.close(),console.log("连接全节点成功");else{let a=JSON.parse(e.data),s=a.messageType;switch(console.log(a),s){case"monitorAddress":t.OnMesMonitorAddress(a);break;case"monitorDeposit":t.OnMesMonitorDeposit(a);break;case"monitorQuickCloseChannel":t.OnMesMonitorQuickCloseChannel(a);break;case"monitorCloseChannel":t.OnMesMonitorCloseChannel(a);break;case"monitorUpdateTransaction":t.OnMesMonitorUpdateTransaction(a);break;case"monitorSettle":t.OnMesMonitorSettle(a);break;case"monitorWithdraw":t.OnMesMonitorWithdraw(a);break;case"monitorWithdrawUpdate":t.OnMesMonitorWithdrawUpdate(a);break;case"monitorWithdrawSettle":t.OnMesMonitorWithdrawSettle(a)}}},OnMesMonitorAddress(e){let t=e.playload;this.monitorEventByNodeUri(t,["monitorAddress"]),this.$notify({title:"收款",dangerouslyUseHTMLString:!0,message:"收款"+e.value+e.assetType+", 发送者: "+e.addressFrom,duration:3e3,type:"info"});let a={date:(new Date).getTime(),name:e.addressFrom,Amount:Number(e.value).mul(1e8),assetType:e.chainType,isOnChannel:!1,isPay:!1,state:1,isTestNet:this.isTestNet,transactionHash:e.txId,blockHash:""};this.$store.state.vuexStore.recordList.push(a),this.StoreData("recordList")},OnMesMonitorDeposit(e){console.log(e);let t=this,a=t.getChannelSerial("ChannelName",e.channelId);if(console.log(a),null!==a){if(console.log(e.amountA),console.log(e.amountB),console.log(t.$store.state.vuexStore.channelList[a].SelfBalance),console.log(t.$store.state.vuexStore.channelList[a].OtherBalance),e.amountA==t.$store.state.vuexStore.channelList[a].SelfBalance&&e.amountB==t.$store.state.vuexStore.channelList[a].OtherBalance){t.$notify({title:t.$t("common.success"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-8"),duration:3e3,type:"success"});let e=t.$store.state.vuexStore.channelList[a];e.State=3,__WEBPACK_IMPORTED_MODULE_0_Vue__.a.set(t.$store.state.vuexStore.channelList,a,e),console.log(t.$store.state.vuexStore.channelList[a]),t.StoreData("channelList"),t.getChannelBalance()}}else t.$notify.error({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-7"),duration:3e3})},OnMesMonitorQuickCloseChannel(e){let t=this,a=t.getChannelSerial("ChannelName",e.channelId);if(console.log(a),a>=0){console.log(e.amountA),console.log(e.amountB);let s=t.$store.state.vuexStore.channelList[a].SelfBalance,n=t.$store.state.vuexStore.channelList[a].OtherBalance;console.log(s),console.log(n),e.amountA==s&&e.amountB==n&&(t.$notify({title:t.$t("common.success"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-9"),duration:3e3,type:"success"}),t.$store.state.vuexStore.channelList.splice(a,1),t.StoreData("channelList"),t.getChannelBalance())}},OnMesMonitorCloseChannel(e){let t=this,a=t.getChannelSerial("ChannelName",e.playload);if(e.invoker==t.$store.state.vuexStore.walletInfo.address.toLowerCase()){let s={messageType:"monitorSelfCloseChannel",baseChain:"ETH",channelName:e.playload,blockNumber:e.blockNumber,selfBalance:t.$store.state.vuexStore.channelList[a].SelfBalance,otherBalance:t.$store.state.vuexStore.channelList[a].OtherBalance};t.$store.state.vuexStore.eventList.push(s),t.StoreData("eventList"),console.log(t.$store.state.vuexStore.eventList)}else{console.log("对端nonce:"+e.nonce),console.log("本端nonce:"+t.$store.state.vuexStore.channelList[a].TxNonce),t.$store.state.vuexStore.channelList[a].TxNonce<=e.nonce?t.$notify.info({title:t.$t("common.info"),dangerouslyUseHTMLString:!0,message:e.channelId+t.$t("common.callback-10"),duration:3e3}):(e.type="",t.sendUpdateTransaction(e));let s=["monitorSettle"];t.monitorEventByNodeUri(e.playload,s)}},OnMesMonitorUpdateTransaction(e){let t=this.getChannelSerial("ChannelName",e.playload);this.$store.state.vuexStore.channelList.splice(t,1),this.StoreData("channelList"),this.$notify({title:this.$t("common.success"),dangerouslyUseHTMLString:!0,message:this.$t("common.callback-12"),duration:3e3,type:"success"})},OnMesMonitorSettle(e){let t=this.getChannelSerial("ChannelName",e.playload);this.$store.state.vuexStore.channelList.splice(t,1),this.StoreData("channelList"),this.$notify({title:this.$t("common.success"),dangerouslyUseHTMLString:!0,message:this.$t("common.callback-12"),duration:3e3,type:"success"})},OnMesMonitorWithdraw(e){let t=this,a=e.playload;if(t.monitorEventByNodeUri(a,["monitorWithdraw"]),e.invoker==t.$store.state.vuexStore.walletInfo.address.toLowerCase()){let s={messageType:"monitorUnlockAmount",baseChain:"ETH",channelName:a,blockNumber:e.blockNumber,HashR:e.lockHash};t.$store.state.vuexStore.eventList.push(s),t.StoreData("eventList")}else console.log("收到对端HTLC作弊"),e.secret&&(console.log(e.secret),t.$store.state.vuexStore.txList.forEach(function(s,n){s.channelName==a&&s.history.length&&s.history.forEach(function(s,n){if(s.HashR==e.lockHash&&void 0==s.delayBlock){console.log("找到对应R交易");let n=s;n.channelName=a,n.R=e.secret,t.sendUpdateTransaction(n)}})}))},OnMesMonitorWithdrawUpdate(e){console.log(e)},OnMesMonitorWithdrawSettle(e){let t=this;e.hashLock&&(console.log(e.hashLock),t.$store.state.vuexStore.txList.forEach(function(t,a){t.channelName==e.playload&&t.forEach(function(t,a){t.HashR==e.hashLock&&void 0!=t.delayBlock&&console.log("对端HTLC上链成功,更新余额")})}))},async sendUpdateTransaction(e){let t=this;console.log(e);let a=t.$store.state.vuexStore.walletInfo.keyStorePass;if("monitorCloseChannel"==e.messageType){let a=e.playload;t.$store.state.vuexStore.txList.forEach(function(e,s){if(e.channelName==a&&e.history[e.history.length-1].founderSignedData&&e.history[e.history.length-1].peerSignedData){console.log(e.history[e.history.length-1].founder),console.log(t.$store.state.vuexStore.walletInfo.address);e.history[e.history.length-1].nonce,e.history[e.history.length-1].founder,e.history[e.history.length-1].founderBalance,e.history[e.history.length-1].founderSignedData,e.history[e.history.length-1].peer,e.history[e.history.length-1].peerBalance,e.history[e.history.length-1].peerSignedData,addPreZero(0,64),addPreZero(0,64)}})}else{console.log("H交易制裁");let{channelName:t,nonce:a,founder:s,founderBalance:n,founderSignedData:o,peer:r,peerBalance:i,peerSignedData:l,HashR:c,R:d}=e}let s=t.getChannelSerial("ChannelName",channelName,"open",!1);console.log(s);let n=[channelName,nonce,founder,founderBalance,peer,peerBalance,R,secret,founderSignedData,peerSignedData],o=await t.signDataForERC20Contract(t.trinityContractAddress,"updateTransaction",["bytes32","uint256","address","uint256","address","uint256","bytes32","bytes32","bytes","bytes"],n,a);console.log(o);(new Date).getTime();web3.eth.sendSignedTransaction("0x"+o).on("transactionHash",function(e){console.log(e),t.$notify({title:t.$t("common.success"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-14"),duration:3e3,type:"success"}),t.cycleGetTransactionReceipt(e),t.$store.state.vuexStore.channelList.splice(s,1),t.StoreData("channelList")}).on("receipt",console.log).on("error",function(e){console.log(e)})},nodeUriWebsocketClose(e){console.log("已断开websocket"),console.log(e)},getblockHeight(){let e=this;web3.eth.getBlockNumber().then(function(t){console.log("当前块高:"+t),e.$store.state.vuexStore.eventList.forEach(function(a,s){if(a.blockNumber<t&&t-a.blockNumber<5760)switch(console.log("监控到事件"+a.messageType),a.messageType){case"monitorSelfCloseChannel":e.OnMesMonitorSelfCloseChannel(a);break;case"monitorSendUnlockAmount":e.OnMesMonitorSendUnlockAmount(a);break;case"monitorUnlockAmount":e.OnMesMonitorUnlockAmount(a)}})})},blockHeightCycle(){setInterval(this.getblockHeight,12e4)},async OnMesMonitorSelfCloseChannel(e){let t=this,a=e.channelName,s=t.$store.state.vuexStore.walletInfo.keyStorePass,n=t.getChannelSerial("ChannelName",a),o=[a],r=await t.signDataForERC20Contract(t.trinityContractAddress,"settleTransaction",["bytes32"],o,s);console.log(r);(new Date).getTime();web3.eth.sendSignedTransaction("0x"+r).on("transactionHash",function(e){console.log(e),t.$notify({title:t.$t("common.success"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-14"),duration:3e3,type:"success"}),t.$store.state.vuexStore.channelList[n].closeHash=e,t.$store.state.vuexStore.eventList.forEach(function(e,s){e.channelName==a&&(console.log("通道关闭,停止监听"),t.$store.state.vuexStore.eventList.splice(s,1),t.StoreData("eventList"))}),t.cycleGetTransactionReceipt(e)}).on("receipt",console.log).on("error",function(e){console.log(e)})},async OnMesMonitorSendUnlockAmount(e){let t=this;console.log(e);t.getChannelSerial("ChannelName",e.channelName);let a=t.$store.state.vuexStore.walletInfo.keyStorePass,s=[e.channelName,t.$store.state.vuexStore.walletInfo.address,e.data.peer,e.data.delayBlock,e.data.paymentCount,e.data.HashR,e.data.founderDelaySignedData,e.data.peerDelaySignedData,e.data.R?e.data.R:"0x"+addPreZero(0,64)],n=await t.signDataForERC20Contract(t.trinityContractAddress,"withdraw",["bytes32","address","address","uint256","uint256","bytes32","bytes","bytes","bytes32"],s,a);console.log(n);(new Date).getTime();web3.eth.sendSignedTransaction("0x"+n).on("transactionHash",function(a){console.log(a),t.$notify({title:t.$t("common.success"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-14"),duration:3e3,type:"success"}),t.cycleGetTransactionReceipt(a),t.$store.state.vuexStore.eventList.forEach(function(a,s){a.channelName==e.channelName&&"monitorSendUnlockAmount"==a.messageType&&a.blockNumber==e.data.delayBlock&&(console.log("withdraw成功,停止监听"),t.$store.state.vuexStore.eventList.splice(s,1),t.StoreData("eventList"))})}).on("receipt",console.log).on("error",function(e){console.log(e)})},async OnMesMonitorUnlockAmount(e){let t=this,a=e.channelName,s=e.HashR,n=[a,s],o=t.$store.state.vuexStore.walletInfo.keyStorePass,r=await t.signDataForERC20Contract(t.trinityContractAddress,"withdrawSettle",["bytes32","bytes32"],n,o);console.log(r);(new Date).getTime();web3.eth.sendSignedTransaction("0x"+r).on("transactionHash",function(e){console.log(e),t.$notify({title:t.$t("common.success"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-14"),duration:3e3,type:"success"}),t.$store.state.vuexStore.eventList.forEach(function(e,s){e.channelName==a&&"monitorUnlockAmount"==e.messageType&&(console.log("withdrawSettle,停止监听"),t.$store.state.vuexStore.eventList.splice(s,1),t.StoreData("eventList"))})}).on("receipt",console.log).on("error",function(e){console.log(e)})},websocketOnmessage(e){let t=this,a=JSON.parse(e.data),s=a.MessageType;switch(console.log(a),s){case"FounderSign":t.OnMesFounderSign(a);break;case"Rsmc":t.OnMesRsmc(a);break;case"RsmcSign":t.OnMesRsmcSign(a);break;case"AckRouterInfo":t.OnMesAckRouterInfo(a);break;case"Htlc":t.OnMesHtlc(a);break;case"HtlcSign":t.OnMesHtlcSign(a);break;case"RResponse":t.OnMesRResponse(a);break;case"Settle":t.OnMesSettle(a);break;case"SettleSign":t.OnMesSettleSign(a);break;case"ChannelInfo":t.OnMesChannelInfo(a);break;case"AddChannel":t.OnMesAddChannel(a);break;case"DeleteChannel":t.OnMesDeleteChannel(a);break;case"Founder":t.OnMesFounder(a);break;case"UpdateChannel":t.OnMesUpdateChannel(a);break;case"RegisterChannelFail":t.OnMesRegisterChannelFail(a)}},async OnMesFounderSign(e){let t=this;if("ETH"==t.baseChain)if("RESPONSE_OK"==e.Status){let a=t.$store.state.vuexStore.addChannelInfo.txData,s=e.MessageBody.Commitment,n=e.Sender.split("@")[0],o=(e.Sender.split("@")[0],t.$store.state.vuexStore.addChannelInfo.selfDeposit.mul(1e8)),r=t.$store.state.vuexStore.walletInfo.keyStorePass;if(console.log(a),console.log(s),console.log(e.Sender.split("@")[0].toLowerCase()),ecRecover(a,s,n.toLowerCase())){t.showLoading();let a=["address","uint256"],s=[t.trinityDataContractAddress,o],n=await t.signDataForERC20Contract(t.tncContractAddress,"approve",a,s,r);console.log(n),web3.eth.sendSignedTransaction("0x"+n).on("transactionHash",function(e){console.log(e)}).on("receipt",function(a){console.log(a),t.confirmOtherApprove(e)}).on("error",function(e){console.log(e),t.$notify.error({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e,duration:3e3}),t.closeLoading()})}else console.log("对端签名验证未通过,停止交易"),t.$notify({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:t.$t("common.verifyFail"),duration:3e3,type:"error"})}else{console.log(e.Status),t.$notify.error({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.Status,duration:3e3});let a=t.getChannelSerial("ChannelName",e.ChannelName);t.$store.state.vuexStore.channelList.splice(a,1),t.StoreData("channelList")}else if("NEO"==t.baseChain){if(t.getChannelSerial("ChannelName",e.ChannelName)>=0){let a=e.MessageBody,s=a.Founder.originalData.witness.replace("{signOther}",a.Founder.txDataSign).replace("{signSelf}",t.$store.state.vuexStore.addChannelInfo.selfSignedData),n=a.Founder.originalData.txData+s;axios({method:"post",url:t.$store.state.vuexStore.NodeRpcUri,headers:{"Content-Type":"application/json;charset=UTF-8"},data:JSON.stringify({jsonrpc:"2.0",method:"sendRawTx",params:[n],id:1})}).then(function(e){1==e.data.result?t.$notify({title:t.$t("common.success"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-14"),duration:3e3,type:"success"}):t.$notify.error({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.data.result,duration:3e3})})}}},confirmOtherApprove(e){let t=this,a=t.$store.state.vuexStore.walletInfo.address,s=e.Sender.split("@")[0],n=t.$store.state.vuexStore.addChannelInfo.otherDeposit.mul(1e8);setTimeout(function(){web3.eth.getGasPrice().then(function(o){var r=new web3.eth.Contract(t.$store.state.vuexStore.tncContractAbi,t.tncContractAddress,{from:a,gasPrice:o});r.methods.balanceOf(s).call({from:s},function(o,i){if(o)console.log(o);else{if(console.log(i),!(i>n))return t.$notify.error({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-16"),duration:0}),!1;r.methods.allowance(s,t.trinityDataContractAddress).call({from:a},function(a,s){console.log(s),s>=n?(t.sendDeposit(e),t.closeLoading()):t.confirmOtherApprove(e)})}})})},3e3)},async sendDeposit(e){console.log(e);let t=this,a=t.$store.state.vuexStore.addChannelInfo.channelName,s=t.$store.state.vuexStore.walletInfo.address,n=t.$store.state.vuexStore.addChannelInfo.selfDeposit.mul(1e8),o=t.$store.state.vuexStore.addChannelInfo.uri.split("@")[0],r=t.$store.state.vuexStore.addChannelInfo.otherDeposit.mul(1e8),i=t.$store.state.vuexStore.addChannelInfo.selfSignedData,l=e.MessageBody.Commitment,c=t.$store.state.vuexStore.walletInfo.keyStorePass,d=[a,1,s,n,o,r,i,l],h=await t.signDataForERC20Contract(t.trinityContractAddress,"deposit",["bytes32","uint256","address","uint256","address","uint256","bytes","bytes"],d,c);console.log(h),console.log(l);let u={channelName:a,history:[{},{state:"confirmed",nonce:1,founder:s,founderBalance:n,peer:o,peerBalance:r,founderSignedData:i,peerSignedData:l,HashR:0,R:0}]};t.$store.state.vuexStore.txList.push(u),t.StoreData("txList");(new Date).getTime();web3.eth.sendSignedTransaction("0x"+h).on("transactionHash",function(e){console.log(e),t.$notify({title:t.$t("common.success"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-14"),duration:3e3,type:"success"});let s=t.getChannelSerial("ChannelName",a);t.$store.state.vuexStore.channelList[s].transactionHash=e,t.StoreData("channelList");t.monitorEventByNodeUri(a,["monitorDeposit","monitorQuickCloseChannel","monitorCloseChannel","monitorUpdateTransaction","monitorSettle","monitorWithdraw","monitorWithdrawUpdate","monitorWithdrawSettle"]),t.cycleGetTransactionReceipt(e)}).on("receipt",console.log).on("error",function(e){console.log(e);let s=t.getChannelSerial("ChannelName",a);t.$store.state.vuexStore.channelList.splice(s,1),t.StoreData("channelList")}),t.$store.state.vuexStore.txOnChannelInfo=[]},OnMesAddChannel(e){if("ETH"==this.baseChain&&null==this.baseChain.NodeUriWebSocket);else if("NEO"==this.baseChain){let t=this.getChannelSerial("ChannelName",e.MessageBody.ChannelName);if(t>=0){let a=this.$store.state.vuexStore.channelList[t];console.log(a),a.State=3,__WEBPACK_IMPORTED_MODULE_0_Vue__.a.set(this.$store.state.vuexStore.channelList,t,a),console.log(this.$store.state.vuexStore.channelList[t]),this.StoreData("channelList"),this.getChannelBalance(),this.$notify({title:this.$t("common.success"),dangerouslyUseHTMLString:!0,message:this.$t("common.callback-8"),duration:3e3,type:"success"});let s={channelName:this.$store.state.vuexStore.addChannelInfo.channelName,history:[{},{nonce:1,founder:this.$store.state.vuexStore.walletInfo.address,founderBalance:this.$store.state.vuexStore.addChannelInfo.selfDeposit.mul(1e8),peer:this.$store.state.vuexStore.addChannelInfo.uri.split("@")[0],peerBalance:this.$store.state.vuexStore.addChannelInfo.otherDeposit.mul(1e8),founderSignedData:this.$store.state.vuexStore.addChannelInfo.selfSignedData,peerSignedData:e.MessageBody.Commitment,HashR:0,R:0,addressFunding:this.$store.state.vuexStore.addChannelInfo.addressFunding,scriptFunding:this.$store.state.vuexStore.addChannelInfo.scriptFunding,txId:this.$store.state.vuexStore.addChannelInfo.txId}]};this.$store.state.vuexStore.txList.push(s),this.StoreData("txList")}}},OnMesRsmc(e){var t=this;let a=t.getChannelSerial("ChannelName",e.ChannelName,"open");if("ETH"==t.baseChain){if(a>=0){let s,n,o,r=e.ChannelName,i=t.$store.state.vuexStore.channelList[a].TxNonce+1,l=Number(e.MessageBody.PaymentCount),c=t.$store.state.vuexStore.channelList[a].OtherUri.split("@")[0],d=Number(t.$store.state.vuexStore.channelList[a].OtherBalance),h=t.$store.state.vuexStore.walletInfo.address,u=Number(t.$store.state.vuexStore.channelList[a].SelfBalance)+l,m=e.MessageBody.HashR,g=t.$store.state.vuexStore.NetMagic,p=t.$store.state.vuexStore.channelList[a].assetType,v=t.$store.state.vuexStore.walletInfo.keyStorePass;void 0==m?d=Number(d)-l:n=t.getRByHashR(m);let f,y=t.checkHistory(r,e.TxNonce);if(e.MessageBody.ResignBody){let s=e.MessageBody.ResignBody.Nonce;if("approveNonce"==(y=t.checkHistory(r,s)).type||e.TxNonce-s==1){console.log("同时回签1,2的签名"),o=i;let n,c,h,m=e.MessageBody.ResignBody.Commitment,g=e.MessageBody.ResignBody.DelayCommitment,p=["founder","founderBalance","peer","peerBalance","paymentCount","isFounder","nonce","HashR","R","delayBlock"],y=t.getTxListInfo(r,s,p),S=y.founder,x=y.founderBalance,C=y.peer,b=y.peerBalance,$=y.paymentCount,k=y.isFounder?C:S,T=y.HashR,_=y.R,w=y.delayBlock;if(w){let e=["bytes32","uint256","address","uint256","address","uint256","bytes32","bytes32"],a=[r,s,S,x,C,b,"0x"+addPreZero(0,64),"0x"+addPreZero(0,64)];c=t.ecSignForTrinityContract(e,a,v);let o=["bytes32","address","address","uint256","uint256","bytes32"],i=[r,S,C,w,$,T];h=t.ecSignForTrinityContract(o,i,v),console.log(k.toLowerCase()),console.log(ecRecover(c.txData,m,k.toLowerCase())),console.log(ecRecover(h.txData,g,k.toLowerCase())),n=ecRecover(c.txData,m,k.toLowerCase())&&ecRecover(h.txData,g,k.toLowerCase())}else{let e=["bytes32","uint256","address","uint256","address","uint256","bytes32","bytes32"],a=[r,s,S,x,C,b,T,_];c=t.ecSignForTrinityContract(e,a,v),console.log(k.toLowerCase()),n=ecRecover(c.txData,m,k.toLowerCase())}if(n){let e={state:"confirmed",founderSignedData:m,founderDelaySignedData:g};t.updateTxList1(r,s,e),f={Commitment:c.signedData,DelayCommitment:w?h.signedData:void 0,Nonce:s};let n=t.$store.state.vuexStore.channelList[a];n.SelfBalance=x,n.OtherBalance=b,__WEBPACK_IMPORTED_MODULE_0_Vue__.a.set(t.$store.state.vuexStore.channelList,a,n),console.log(t.$store.state.vuexStore.channelList[a]),t.StoreData("channelList"),t.getChannelBalance(),u=x+l,d=b-l}else console.log("签名验证失败")}else console.log(y.type)}else if("ResetTxNonce"==y.type)console.log("nonce错误,请求重设nonce"),o=y.ResetTxNonce;else if("Resign"==y.type){console.log("上次交易未确认,请求回签"),f=y.ResignBody,o=i,console.log(f.Nonce);let e=["paymentCount"],a=t.getTxListInfo(r,f.Nonce,e);d-=a.paymentCount,u+=a.paymentCount}else"approveNonce"==y.type?(console.log("对端发送的TxNonce作为nonce"),o=Number(e.TxNonce),console.log(o),t.updateTxListLength(r,o),console.log(t.$store.state.vuexStore.txList)):"Same"==y.type&&(console.log("检查正常"),o=i);let S=["bytes32","uint256","address","uint256","address","uint256","bytes32","bytes32"],x=[r,o,c,d,h,u,m||"0x"+addPreZero(0,64),n||"0x"+addPreZero(0,64)],C=t.ecSignForTrinityContract(S,x,v);console.log(C.txData),C?(s={MessageType:"RsmcSign",Sender:e.Receiver,Receiver:e.Sender,TxNonce:"ResetTxNonce"==y.type?e.TxNonce:o,ChannelName:r,NetMagic:g,AssetType:p,ResetTxNonce:"ResetTxNonce"==y.type?o:void 0,MessageBody:{PaymentCount:l,SenderBalance:d,ReceiverBalance:u,HashR:m,Commitment:"Resign"==y.type?void 0:C.signedData,RoleIndex:0,ResignBody:f},Comments:e.Comments,Status:"RESPONSE_OK"},console.log(s),t.sendWebsocket(e.Sender,s)):console.log("签名失败");let b={state:"confirming",nonce:o,founder:c,founderBalance:d,peer:h,peerBalance:u,paymentCount:l,isFounder:!1,founderSignedData:"",peerSignedData:C.signedData,HashR:m||"0x"+addPreZero(0,64),R:n||"0x"+addPreZero(0,64),txData:C.txData};console.log(t.$store.state.vuexStore.txList),t.newTxList(r,b);let $=t.$store.state.vuexStore.channelList[a];$.TxNonce=o,__WEBPACK_IMPORTED_MODULE_0_Vue__.a.set(t.$store.state.vuexStore.channelList,a,$),console.log(t.$store.state.vuexStore.channelList[a]),t.StoreData("channelList"),t.getChannelBalance()}}else if("NEO"==t.baseChain){console.log("NEO  RSMC");let s,n,o,r=e.MessageBody;if(0==r.RoleIndex){if(a>=0){let s,n,o;console.log(e);try{o=scrypt_module_factory(DecryptWalletByPassword,{},{WalletScript:t.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].key,password:keyStorePass,address:t.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].address})}catch(e){return t.$notify.error({title:t.$t("loginByKeyStore.callback-9"),dangerouslyUseHTMLString:!0,message:t.$t("loginByKeyStore.callback-8"),duration:3e3}),!1}console.log(o),e.MessageBody.Commitment&&(s=signatureData(e.MessageBody.Commitment.txData,o)),e.MessageBody.RevocableDelivery&&(n=signatureData(e.MessageBody.RevocableDelivery.txData,o));let r,i,l,c={MessageType:"RsmcSign",Sender:e.Receiver,Receiver:e.Sender,ChannelName:e.ChannelName,TxNonce:e.TxNonce,MessageBody:{Commitment:{txDataSign:s,originalData:e.MessageBody.Commitment},RevocableDelivery:{txDataSign:n,originalData:e.MessageBody.RevocableDelivery},AssetType:e.MessageBody.AssetType,Value:e.MessageBody.Value,RoleIndex:e.MessageBody.RoleIndex,Comments:e.MessageBody.Comments}};(s||n)&&(t.sendWebsocket(e.Sender,c),console.log(c)),console.log(t.$store.state.vuexStore.channelList[a]);let d=Number(t.$store.state.vuexStore.channelList[a].SelfBalance).div(1e8),h=Number(t.$store.state.vuexStore.channelList[a].OtherBalance).div(1e8);console.log(t.$store.state.vuexStore.txList),t.$store.state.vuexStore.txList.forEach(function(t,a){t.channelName==e.ChannelName&&t.history.length&&(console.log(t.history[t.history.length-1]),r=t.history[t.history.length-1].txId,console.log(r),i=t.history[t.history.length-1].addressFunding,console.log(i),l=t.history[t.history.length-1].scriptFunding,console.log(l))}),axios({method:"post",url:t.$store.state.vuexStore.NodeRpcUri,headers:{"Content-Type":"application/json;charset=UTF-8"},data:JSON.stringify({jsonrpc:"2.0",method:"FunderTransaction",params:[e.Sender.split("@")[0],e.Receiver.split("@")[0],i,l,h,d,r,e.MessageBody.AssetType],id:1})}).then(function(a){console.log(a);let s={MessageType:"Rsmc",Sender:e.Receiver,Receiver:e.Sender,TxNonce:e.TxNonce,ChannelName:e.ChannelName,MessageBody:{Commitment:a.data.result.C_TX,RevocableDelivery:a.data.result.R_TX,AssetType:e.MessageBody.AssetType,Value:e.MessageBody.Value,RoleIndex:e.MessageBody.RoleIndex+1,Comments:e.MessageBody.Comments}};t.sendWebsocket(e.Sender,s),console.log(JSON.stringify(s))})}return!1}3!=r.RoleIndex&&2!=r.RoleIndex||r.BreachRemedy&&t.$store.state.vuexStore.txList.forEach(function(t,a){if(t.channelName==e.ChannelName)return t.BreachRemedy=r.BreachRemedy,!1}),console.log(t.$store.state.vuexStore.txOnChannelInfo);try{o=scrypt_module_factory(DecryptWalletByPassword,{},{WalletScript:t.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].key,password:t.$store.state.vuexStore.txOnChannelInfo.keyStorePass,address:t.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].address})}catch(e){return t.$notify.error({title:t.$t("loginByKeyStore.callback-9"),dangerouslyUseHTMLString:!0,message:t.$t("loginByKeyStore.callback-8"),duration:3e3}),!1}console.log(o),r.Commitment&&(s=signatureData(r.Commitment.txData,o)),r.RevocableDelivery&&(n=signatureData(r.RevocableDelivery.txData,o));let i={MessageType:"RsmcSign",Sender:e.Receiver,Receiver:e.Sender,ChannelName:e.ChannelName,TxNonce:e.TxNonce,MessageBody:{Commitment:{txDataSign:s,originalData:r.Commitment},RevocableDelivery:{txDataSign:n,originalData:r.RevocableDelivery},AssetType:e.MessageBody.AssetType,Value:e.MessageBody.Value,RoleIndex:e.MessageBody.RoleIndex,Comments:e.MessageBody.Comments}};if((s||n)&&(t.sendWebsocket(e.Sender,i),console.log(i)),1==r.RoleIndex||2==r.RoleIndex){let a;r.RevocableDelivery&&(a=signatureData(t.$store.state.vuexStore.txOnChannelInfo.BreachRemedy.txData,o));let s={MessageType:"Rsmc",Sender:e.Receiver,Receiver:e.Sender,ChannelName:e.ChannelName,TxNonce:e.TxNonce,MessageBody:{BreachRemedy:{txDataSign:a,originalData:t.$store.state.vuexStore.txOnChannelInfo.BreachRemedy},AssetType:e.MessageBody.AssetType,Value:e.MessageBody.Value,RoleIndex:e.MessageBody.RoleIndex+1,Comments:e.MessageBody.Comments}};t.sendWebsocket(e.Sender,s),console.log(s)}}},OnMesRsmcSign(e){let t=this;if("ETH"==t.baseChain)if("RESPONSE_OK"==e.Status){let a=t.getChannelSerial("ChannelName",e.ChannelName);if(console.log(a),a>=0){let s,n=e.MessageBody.RoleIndex,o=t.$store.state.vuexStore.channelList[a].ChannelName,r=t.$store.state.vuexStore.channelList[a].TxNonce,i=Number(e.MessageBody.PaymentCount),l=t.$store.state.vuexStore.walletInfo.address,c=Number(t.$store.state.vuexStore.channelList[a].SelfBalance),d=t.$store.state.vuexStore.channelList[a].OtherUri.split("@")[0],h=Number(t.$store.state.vuexStore.channelList[a].OtherBalance)+i,u=e.MessageBody.HashR||"0x"+addPreZero(0,64),m=t.$store.state.vuexStore.NetMagic,g=t.$store.state.vuexStore.channelList[a].assetType,p=e.MessageBody.Commitment,v=t.$store.state.vuexStore.walletInfo.keyStorePass,f=!1;if(console.log(v),0==n){if(console.log(e),e.ResetTxNonce){let a=["state"];"INIT"==t.getTxListInfo(o,e.ResetTxNonce,a).state?(console.log("修改nonce为"+e.ResetTxNonce),r=e.ResetTxNonce,f=!0):console.log("当前nonce禁止更改")}let n,y,S,x,C,b,$,k,T,_,w;if(e.MessageBody.ResignBody){console.log("收到对端请求回签"),S=e.MessageBody.ResignBody.Nonce,x=e.MessageBody.ResignBody.Commitment,w=e.MessageBody.ResignBody.DelayCommitment;let s=["founder","founderBalance","peer","peerBalance","paymentCount","isFounder","nonce","HashR","R","delayBlock"],r=t.getTxListInfo(o,S,s);b=r.founder,$=r.founderBalance,k=r.peer,T=r.peerBalance,_=r.paymentCount;let i,l=r.isFounder?k:b,d=r.HashR,u=r.R,m=r.delayBlock;if(m){let e=["bytes32","uint256","address","uint256","address","uint256","bytes32","bytes32"],a=[o,S,b,$,k,T,"0x"+addPreZero(0,64),"0x"+addPreZero(0,64)];n=t.ecSignForTrinityContract(e,a,v);let s=["bytes32","address","address","uint256","uint256","bytes32"],r=[o,b,k,m,_,d];y=t.ecSignForTrinityContract(s,r,v),console.log(l.toLowerCase()),console.log(ecRecover(n.txData,x,l.toLowerCase())),console.log(ecRecover(y.txData,w,l.toLowerCase())),i=ecRecover(n.txData,x,l.toLowerCase())&&ecRecover(y.txData,w,l.toLowerCase())}else{let e=["bytes32","uint256","address","uint256","address","uint256","bytes32","bytes32"],a=[o,S,b,$,k,T,d,u];n=t.ecSignForTrinityContract(e,a,v),console.log(k.toLowerCase()),console.log(ecRecover(n.txData,x,l.toLowerCase())),i=ecRecover(n.txData,x,l.toLowerCase())}if(i){C={Commitment:n.signedData,DelayCommitment:m?y.signedData:void 0,Nonce:S};let e={state:"confirmed",founderDelaySignedData:w,founderSignedData:x};t.updateTxList1(o,S,e);let s=t.$store.state.vuexStore.channelList[a];if(s.SelfBalance=$,s.OtherBalance=T,__WEBPACK_IMPORTED_MODULE_0_Vue__.a.set(t.$store.state.vuexStore.channelList,a,s),console.log(t.$store.state.vuexStore.channelList[a]),t.StoreData("channelList"),t.getChannelBalance(),m?(console.log(c),console.log(h),r.isFounder?(c-=_,h=h):(c=c,h-=_),console.log(c),console.log(h)):(console.log(c),console.log(h),r.isFounder?(c-=_,h+=_):(c+=_,h-=_),console.log(c),console.log(h)),m){let e={messageType:"monitorSendUnlockAmount",baseChain:"ETH",channelName:o,blockNumber:m,HashR:d,data:r};t.$store.state.vuexStore.eventList.push(e),t.StoreData("eventList")}}else console.log("对端签名验证未通过,停止交易")}let B="0x"+addPreZero(0,64);if(u=="0x"+addPreZero(0,64))c-=i;else{let e=["R"];B=t.getTxListInfo(o,r-1,e).R,console.log("R:"+B)}if(p){console.log("进入正常签名");let n=["bytes32","uint256","address","uint256","address","uint256","bytes32","bytes32"],y=[o,r,l,c,d,h,u,B];console.log(v);let S=t.ecSignForTrinityContract(n,y,v);if(!S)return console.log("签名失败"),!1;if(console.log(r),console.log(S.txData),console.log(p),console.log(e.Sender.split("@")[0].toLowerCase()),ecRecover(S.txData,p,e.Sender.split("@")[0].toLowerCase())){if(s={MessageType:"RsmcSign",Sender:e.Receiver,Receiver:e.Sender,TxNonce:r,ChannelName:o,NetMagic:m,AssetType:g,MessageBody:{PaymentCount:i,SenderBalance:c,ReceiverBalance:h,HashR:u,R:B,Commitment:S.signedData,RoleIndex:1,ResignBody:C||""},Comments:e.Comments,Status:"RESPONSE_OK"},t.sendWebsocket(e.Sender,s),f){t.updateTxListLength(o,r);let e={state:"confirming",nonce:r,founder:l,peer:d,paymentCount:i,isFounder:!0,founderSignedData:"",peerSignedData:"",HashR:u||"0x"+addPreZero(0,64),R:B||"0x"+addPreZero(0,64),txData:S.txData};t.newTxList(o,e),console.log(t.$store.state.vuexStore.txList)}let n={state:"confirmed",founderSignedData:S.signedData,peerSignedData:p,founderBalance:c,peerBalance:h};console.log(n),t.updateTxList1(o,r,n);let v=t.$store.state.vuexStore.channelList[a];v.SelfBalance=c,v.OtherBalance=h,v.TxNonce=r,__WEBPACK_IMPORTED_MODULE_0_Vue__.a.set(t.$store.state.vuexStore.channelList,a,v),console.log(t.$store.state.vuexStore.channelList[a]),t.StoreData("channelList"),t.getChannelBalance(),console.log(u),u!="0x"+addPreZero(0,64)&&t.$store.state.vuexStore.eventList.forEach(function(e,a){e.HashR==u&&(console.log("H交易已完成,停止监听"),t.$store.state.vuexStore.eventList.splice(a,1),t.StoreData("eventList"))}),u=="0x"+addPreZero(0,64)?t.$store.state.vuexStore.RSMCNum+=1:t.$store.state.vuexStore.HTLCRNum+=1,t.$store.state.vuexStore.txOnChannelInfo=[],t.$notify({title:t.$t("common.success"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-20"),duration:3e3,type:"success"})}else console.log("对端签名验证未通过,停止交易")}else C&&(console.log($),console.log(T),s={MessageType:"RsmcSign",Sender:e.Receiver,Receiver:e.Sender,TxNonce:r,ChannelName:o,NetMagic:m,AssetType:g,MessageBody:{PaymentCount:i,SenderBalance:$-i,ReceiverBalance:T+i,HashR:u,R:e.MessageBody.R,Commitment:"",RoleIndex:1,ResignBody:C},Comments:{},Status:"RESPONSE_OK"},t.sendWebsocket(e.Sender,s))}else if(1==n){if(e.MessageBody.ResignBody){console.log("收到对端回签的消息");let s,n=e.MessageBody.ResignBody.Nonce,r=e.MessageBody.ResignBody.Commitment,i=e.MessageBody.ResignBody.DelayCommitment,l=["txData","founder","founderBalance","peerBalance","isFounder","delayTxData","delayBlock"],d=t.getTxListInfo(o,n,l),u=d.founderBalance,m=d.peerBalance,g=(d.paymentCount,d.delayBlock);if(console.log(d.founder.toLowerCase()),s=g?ecRecover(d.txData,r,d.founder.toLowerCase())&&ecRecover(d.delayTxData,i,d.founder.toLowerCase()):ecRecover(d.txData,r,d.founder.toLowerCase())){let e={state:"confirmed",founderDelaySignedData:i,founderSignedData:r};t.updateTxList1(o,n,e);let s=t.$store.state.vuexStore.channelList[a];s.SelfBalance=u,s.OtherBalance=m,__WEBPACK_IMPORTED_MODULE_0_Vue__.a.set(t.$store.state.vuexStore.channelList,a,s),console.log(t.$store.state.vuexStore.channelList[a]),t.StoreData("channelList"),t.getChannelBalance(),c=Number(u),h=Number(m)}}if(p){console.log("进入正常签名"),console.log(r);let s=["txData"],n=t.getTxListInfo(o,r,s);if(ecRecover(n.txData,p,e.Sender.split("@")[0].toLowerCase())){let s=t.$store.state.vuexStore.channelList[a];s.SelfBalance=e.MessageBody.ReceiverBalance,s.OtherBalance=e.MessageBody.SenderBalance,__WEBPACK_IMPORTED_MODULE_0_Vue__.a.set(t.$store.state.vuexStore.channelList,a,s),console.log(t.$store.state.vuexStore.channelList[a]),t.StoreData("channelList"),t.getChannelBalance();let n={state:"confirmed",founderSignedData:p};t.updateTxList1(o,r,n),t.$notify({title:t.$t("common.success"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-21"),duration:3e3,type:"success"})}else console.log("对端签名验证未通过,停止交易")}else if(e.MessageBody.ResignBody){let a="0x"+addPreZero(0,64);l=e.Sender.split("@")[0],d=e.Receiver.split("@")[0];let n=["bytes32","uint256","address","uint256","address","uint256","bytes32","bytes32"],p=[o,r,l,c-=i,d,h+=i,u,a],f=t.ecSignForTrinityContract(n,p,v);if(!f)return console.log("签名失败"),!1;s={MessageType:"RsmcSign",Sender:e.Receiver,Receiver:e.Sender,TxNonce:r,ChannelName:o,NetMagic:m,AssetType:g,MessageBody:{PaymentCount:i,SenderBalance:c,ReceiverBalance:h,HashR:u,R:e.MessageBody.R,Commitment:f.signedData,RoleIndex:0},Comments:{},Status:"RESPONSE_OK"},t.sendWebsocket(e.Sender,s);let y={peerSignedData:f.signedData,txData:f.txData};t.updateTxList1(o,r,y)}}}}else console.log(e.Status);else"NEO"==t.baseChain&&console.log("NEO")},OnMesAckRouterInfo(e){let t=this;if("ETH"==t.baseChain){if(null===e.RouterInfo)return t.$notify.error({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-22"),duration:3e3}),t.$store.state.vuexStore.txOnChannelInfo=[],!1;{let t=this,s=e.RouterInfo.FullPath;console.log(t.$store.state.vuexStore.txOnChannelInfo),t.$store.state.vuexStore.txOnChannelInfo.receiverUri.split(":")[1]==t.$store.state.vuexStore.spvPort?(s.unshift([t.$store.state.vuexStore.txOnChannelInfo.sendUri,0]),s.push([t.$store.state.vuexStore.txOnChannelInfo.receiverUri,0])):s.unshift([t.$store.state.vuexStore.txOnChannelInfo.sendUri,0]);let n=0;for(var a=0;a<s.length-1;a++)n+=e.RouterInfo.FullPath[a][1];n=1e8*parseFloat(n).toFixed(8),t.$store.state.vuexStore.txOnChannelInfo.Router=s,t.$store.state.vuexStore.txOnChannelInfo.Next=e.RouterInfo.Next,t.$store.state.vuexStore.txOnChannelInfo.fee=n,console.log(t.$store.state.vuexStore.txOnChannelInfo),console.log(t.isOneStepPayment),console.log(t.$store.state.vuexStore.walletInfo.keyStorePass),t.isOneStepPayment&&t.$store.state.vuexStore.walletInfo.keyStorePass?t.sendHtlcMes():t.isFeeInfoBoxShow=!0}}else if("NEO"==t.baseChain){if(null===e.RouterInfo)return t.$notify.error({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-22"),duration:3e3}),t.$store.state.vuexStore.txOnChannelInfo=[],!1;{let t=this,s=e.RouterInfo.FullPath;console.log(t.$store.state.vuexStore.txOnChannelInfo),t.$store.state.vuexStore.txOnChannelInfo.receiverUri.split(":")[1]==t.$store.state.vuexStore.spvPort?(s.unshift([t.$store.state.vuexStore.txOnChannelInfo.sendUri,0]),s.push([t.$store.state.vuexStore.txOnChannelInfo.receiverUri,0])):s.unshift([t.$store.state.vuexStore.txOnChannelInfo.sendUri,0]);let n=0;for(a=0;a<s.length-1;a++)n+=e.RouterInfo.FullPath[a][1];n=1e8*parseFloat(n).toFixed(8),t.$store.state.vuexStore.txOnChannelInfo.Router=s,t.$store.state.vuexStore.txOnChannelInfo.Next=e.RouterInfo.Next,t.$store.state.vuexStore.txOnChannelInfo.fee=n,console.log(t.$store.state.vuexStore.txOnChannelInfo),t.isFeeInfoBoxShow=!0}}},sendHtlcMes(){let e=this;if(e.isDisable=!0,setTimeout(()=>{e.isDisable=!1},2e3),"ETH"==e.baseChain){let t=e.$store.state.vuexStore.txOnChannelInfo.Next,a=e.getChannelSerial("OtherUri",t,"open");console.log(a),a>=0&&web3.eth.getBlockNumber().then(function(s){console.log(s);let n=e.$store.state.vuexStore.txOnChannelInfo.Router,o=e.$store.state.vuexStore.delayBlock,r=s+(n.length-1)*o,i=e.$store.state.vuexStore.channelList[a].ChannelName,l=e.$store.state.vuexStore.channelList[a].TxNonce+1,c=e.$store.state.vuexStore.channelList[a].SelfUri,d=e.$store.state.vuexStore.walletInfo.address,h=Number(e.$store.state.vuexStore.channelList[a].SelfBalance),u=e.$store.state.vuexStore.channelList[a].OtherUri.split("@")[0],m=Number(e.$store.state.vuexStore.channelList[a].OtherBalance),g=Number(e.$store.state.vuexStore.txOnChannelInfo.value)+Number(e.$store.state.vuexStore.txOnChannelInfo.fee),p=e.$store.state.vuexStore.channelList[a].assetType,v=e.$store.state.vuexStore.NetMagic,f=e.$store.state.vuexStore.txOnChannelInfo.hr;e.$store.state.vuexStore.txOnChannelInfo.keyStorePass;console.log(r),console.log(g);let y,S=e.checkHistory(i,l);if("Resign"==S.type){console.log("上次交易未确认,请求回签"),y=S.ResignBody,console.log(S);let t=["paymentCount","delayBlock"],a=e.getTxListInfo(i,y.Nonce,t);console.log(a.paymentCount),a.delayBlock?(h=h,m-=a.paymentCount):(h+=a.paymentCount,m-=a.paymentCount),console.log(h),console.log(m)}let x={MessageType:"Htlc",Sender:c,Receiver:t,TxNonce:l,ChannelName:i,AssetType:p,NetMagic:v,Router:n,Next:t,MessageBody:{SenderBalance:h-g,ReceiverBalance:m,Commitment:"",Payment:g,DelayBlock:r,DelayCommitment:"",HashR:f,RoleIndex:0,ResignBody:y}};e.sendWebsocket(t,x);let C={state:"INIT",nonce:l,founder:d,founderBalance:h-g,peer:u,peerBalance:m,paymentCount:g,isFounder:!0,txData:"",founderSignedData:"",peerSignedData:"",HashR:f,R:"0x"+addPreZero(0,64),delayBlock:r,delayTxData:"",founderDelaySignedData:"",peerDelaySignedData:""};e.newTxList(i,C),console.log(e.$store.state.vuexStore.txList);let b=e.$store.state.vuexStore.channelList[a];b.TxNonce=l,__WEBPACK_IMPORTED_MODULE_0_Vue__.a.set(e.$store.state.vuexStore.channelList,a,b),console.log(e.$store.state.vuexStore.channelList[a].TxNonce),e.isFeeInfoBoxShow=!1})}else if("NEO"==e.baseChain){let t=e.getChannelSerial("OtherUri",e.$store.state.vuexStore.txOnChannelInfo.Next,"open");if(console.log(t),t>=0){let a,s,n;console.log(e.$store.state.vuexStore.channelList[t]);let o=Number(e.$store.state.vuexStore.channelList[t].SelfBalance).div(1e8),r=Number(e.$store.state.vuexStore.channelList[t].OtherBalance).div(1e8);console.log(e.$store.state.vuexStore.txList),e.$store.state.vuexStore.txList.forEach(function(o,r){console.log(o.channelName),console.log(e.$store.state.vuexStore.channelList[t].ChannelName),console.log(o.history.length),o.channelName==e.$store.state.vuexStore.channelList[t].ChannelName&&o.history.length&&(console.log(o.history[o.history.length-1]),a=o.history[o.history.length-1].txId,console.log(a),s=o.history[o.history.length-1].addressFunding,console.log(s),n=o.history[o.history.length-1].scriptFunding,console.log(n))}),console.log(e.$store.state.vuexStore.txOnChannelInfo),axios({method:"post",url:e.$store.state.vuexStore.NodeRpcUri,headers:{"Content-Type":"application/json;charset=UTF-8"},data:JSON.stringify({jsonrpc:"2.0",method:"HTLCTransaction",params:[e.$store.state.vuexStore.NEOwalletInfo.publicKey,e.$store.state.vuexStore.txOnChannelInfo.Next.split("@")[0],Number(e.$store.state.vuexStore.txOnChannelInfo.value+e.$store.state.vuexStore.txOnChannelInfo.fee).div(1e8),o,r,e.$store.state.vuexStore.txOnChannelInfo.hr,s,n,e.$store.state.vuexStore.txOnChannelInfo.assetType],id:1})}).then(function(a){if(console.log(a),a){let s={MessageType:"Htlc",Sender:e.$store.state.vuexStore.channelList[t].SelfUri,Receiver:e.$store.state.vuexStore.txOnChannelInfo.Next,TxNonce:e.$store.state.vuexStore.channelList[t].TxNonce+1,ChannelName:e.$store.state.vuexStore.channelList[t].ChannelName,Router:e.$store.state.vuexStore.txOnChannelInfo.Router,Next:e.$store.state.vuexStore.txOnChannelInfo.Next,MessageBody:{HCTX:a.data.result.HCTX,RDTX:a.data.result.RDTX,HEDTX:a.data.result.HEDTX,HTTX:a.data.result.HTTX,HTDTX:a.data.result.HTDTX,HTRDTX:a.data.result.HTRDTX,RoleIndex:0,Comments:"",Count:Number(e.$store.state.vuexStore.txOnChannelInfo.value+e.$store.state.vuexStore.txOnChannelInfo.fee).div(1e8),AssetType:e.$store.state.vuexStore.txOnChannelInfo.assetType,HashR:e.$store.state.vuexStore.txOnChannelInfo.hr}};e.sendWebsocket(e.$store.state.vuexStore.txOnChannelInfo.Next,s),console.log(JSON.stringify(s)),e.isFeeInfoBoxShow=!1}})}}},OnMesHtlc(e){var t=this;if("ETH"==t.baseChain){let a=t.getChannelSerial("ChannelName",e.ChannelName,"open");if(a>=0){let s,n,o=e.ChannelName,r=t.$store.state.vuexStore.channelList[a].TxNonce+1,i=t.$store.state.vuexStore.channelList[a].OtherUri.split("@")[0],l=Number(t.$store.state.vuexStore.channelList[a].OtherBalance),c=t.$store.state.vuexStore.walletInfo.address,d=Number(t.$store.state.vuexStore.channelList[a].SelfBalance),h=Number(e.MessageBody.Payment),u=e.MessageBody.HashR,m="0x"+addPreZero(0,64),g=e.MessageBody.DelayBlock,p=t.$store.state.vuexStore.walletInfo.keyStorePass,v=t.checkHistory(o,e.TxNonce);if(e.MessageBody.ResignBody){let i=e.MessageBody.ResignBody.Nonce;if("approveNonce"==(v=t.checkHistory(o,i)).type||e.TxNonce-i==1){console.log("同时回签1,2的签名"),s=r;let c,h,u,m=e.MessageBody.ResignBody.Commitment,g=e.MessageBody.ResignBody.DelayCommitment,v=["founder","founderBalance","peer","peerBalance","paymentCount","isFounder","nonce","HashR","R","delayBlock"],f=t.getTxListInfo(o,i,v),y=f.founder,S=f.founderBalance,x=f.peer,C=f.peerBalance,b=f.paymentCount,$=f.isFounder?x:y,k=f.HashR,T=f.R,_=f.delayBlock;if(_){let e=["bytes32","uint256","address","uint256","address","uint256","bytes32","bytes32"],a=[o,i,y,S,x,C,"0x"+addPreZero(0,64),"0x"+addPreZero(0,64)];h=t.ecSignForTrinityContract(e,a,p);let s=["bytes32","address","address","uint256","uint256","bytes32"],n=[o,y,x,_,b,k];u=t.ecSignForTrinityContract(s,n,p),console.log($.toLowerCase()),console.log(ecRecover(h.txData,m,$.toLowerCase())),console.log(ecRecover(u.txData,g,$.toLowerCase())),c=ecRecover(h.txData,m,$.toLowerCase())&&ecRecover(u.txData,g,$.toLowerCase())}else{let e=["bytes32","uint256","address","uint256","address","uint256","bytes32","bytes32"],a=[o,i,y,S,x,C,k,T];h=t.ecSignForTrinityContract(e,a,p),console.log($.toLowerCase()),c=ecRecover(h.txData,m,$.toLowerCase())}if(c){let e={state:"confirmed",founderSignedData:m,founderDelaySignedData:g};t.updateTxList1(o,i,e),n={Commitment:h.signedData,DelayCommitment:_?u.signedData:void 0,Nonce:i};let s=t.$store.state.vuexStore.channelList[a];s.SelfBalance=S,s.OtherBalance=C,__WEBPACK_IMPORTED_MODULE_0_Vue__.a.set(t.$store.state.vuexStore.channelList,a,s),console.log(t.$store.state.vuexStore.channelList[a]),t.StoreData("channelList"),t.getChannelBalance(),d=S,l=C}else console.log("签名验证失败")}else console.log(v.type)}else if("ResetTxNonce"==v.type)console.log("nonce错误,请求重设nonce"),s=v.ResetTxNonce;else if("Resign"==v.type){console.log("上次交易未确认,请求回签"),n=v.ResignBody,s=r,console.log(n.Nonce);let e=["paymentCount","delayBlock"],a=t.getTxListInfo(o,n.Nonce,e);a.delayBlock?(l-=a.paymentCount,d=d):(l-=a.paymentCount,d+=a.paymentCount)}else"approveNonce"==v.type?(console.log("对端发送的TxNonce作为nonce"),s=Number(e.TxNonce),console.log(s),t.updateTxListLength(o,s),console.log(t.$store.state.vuexStore.txList)):"Same"==v.type&&(console.log("检查正常"),s=r);let f=["bytes32","uint256","address","uint256","address","uint256","bytes32","bytes32"],y=[o,s,i,l-h,c,d,"0x"+addPreZero(0,64),m],S=t.ecSignForTrinityContract(f,y,p),x=["bytes32","address","address","uint256","uint256","bytes32"],C=[o,i,c,g,h,u],b=t.ecSignForTrinityContract(x,C,p),$={MessageType:"HtlcSign",Sender:e.Receiver,Receiver:e.Sender,TxNonce:"ResetTxNonce"==v.type?e.TxNonce:s,ChannelName:o,AssetType:e.AssetType,ResetTxNonce:"ResetTxNonce"==v.type?s:void 0,NetMagic:t.$store.state.vuexStore.NetMagic,Router:e.Router,Next:e.Sender,MessageBody:{SenderBalance:l-h,ReceiverBalance:d,Commitment:"Resign"==v.type?void 0:S.signedData,Payment:h,DelayBlock:g,DelayCommitment:"Resign"==v.type?void 0:b.signedData,HashR:u,ResignBody:n,RoleIndex:0},Comments:{},Status:"RESPONSE_OK"};t.sendWebsocket(e.Sender,$);let k={state:"INIT",nonce:s,founder:i,founderBalance:l-h,peer:c,peerBalance:d,paymentCount:h,isFounder:!1,txData:S.txData,founderSignedData:"",peerSignedData:S.signedData,delayBlock:g,payment:h,HashR:u,R:m,delayTxData:b.txData,founderDelaySignedData:"",peerDelaySignedData:b.signedData};t.newTxList(o,k);let T=t.$store.state.vuexStore.channelList[a];T.TxNonce=s,__WEBPACK_IMPORTED_MODULE_0_Vue__.a.set(t.$store.state.vuexStore.channelList,a,T),console.log(t.$store.state.vuexStore.channelList[a]),t.StoreData("channelList"),t.getChannelBalance()}}else if("NEO"==t.baseChain){let a=e.MessageBody,s=a.RoleIndex,n=t.getChannelSerial("ChannelName",e.ChannelName,"open");if(0==s&&n>=0){let a,s,o,r,i,l,c=e.MessageBody;c.RoleIndex;try{a=scrypt_module_factory(DecryptWalletByPassword,{},{WalletScript:t.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].key,password:keyStorePass,address:t.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].address})}catch(e){return t.$notify.error({title:t.$t("loginByKeyStore.callback-9"),dangerouslyUseHTMLString:!0,message:t.$t("loginByKeyStore.callback-8"),duration:3e3}),!1}console.log(a),c.HCTX&&(s=signatureData(c.HCTX.txData,a),console.log("HCTX_sig:"+s)),c.HTTX&&(o=signatureData(c.HTTX.txData,a),console.log("HTTX_sig:"+o)),c.HTDTX&&(r=signatureData(c.HTDTX.txData,a),console.log("HTDTX_sig:"+r)),c.HTRDTX&&(i=signatureData(c.HTRDTX.txData,a),console.log("HTRDTX_sig:"+i)),c.RDTX&&(l=signatureData(c.RDTX.txData,a),console.log("RDTX_sig:"+l));let d,h,u,m={MessageType:"HtlcSign",Sender:e.Receiver,Receiver:e.Sender,TxNonce:e.TxNonce,ChannelName:e.ChannelName,Router:e.Router,Next:e.Next,MessageBody:{HCTX:{txDataSign:s,originalData:c.HCTX},RDTX:{txDataSign:l,originalData:c.RDTX},HTTX:{txDataSign:o,originalData:c.HTTX},HTRDTX:{txDataSign:i,originalData:c.HTRDTX},HEDTX:c.HEDTX,RoleIndex:c.RoleIndex,Comments:"",Count:c.Count,AssetType:c.AssetType,HashR:c.HashR}};t.sendWebsocket(e.Sender,m),console.log(m),console.log(t.$store.state.vuexStore.channelList[n]);let g=Number(t.$store.state.vuexStore.channelList[n].SelfBalance).div(1e8),p=Number(t.$store.state.vuexStore.channelList[n].OtherBalance).div(1e8);console.log(t.$store.state.vuexStore.txList),t.$store.state.vuexStore.txList.forEach(function(t,a){t.channelName==e.ChannelName&&t.history.length&&(console.log(t.history[t.history.length-1]),d=t.history[t.history.length-1].txId,console.log(d),h=t.history[t.history.length-1].addressFunding,console.log(h),u=t.history[t.history.length-1].scriptFunding,console.log(u))}),axios({method:"post",url:t.$store.state.vuexStore.NodeRpcUri,headers:{"Content-Type":"application/json;charset=UTF-8"},data:JSON.stringify({jsonrpc:"2.0",method:"HTLCTransaction",params:[t.$store.state.vuexStore.NEOwalletInfo.publicKey,e.Sender.split("@")[0],c.Count,g,p,c.HashR,h,u,c.AssetType],id:1})}).then(function(s){console.log(s);let n=signatureData(s.data.result.HETX.txData,a),o=signatureData(s.data.result.HERDTX.txData,a),r={MessageType:"Htlc",Sender:e.Receiver,Receiver:e.Sender,TxNonce:e.TxNonce,ChannelName:e.ChannelName,Router:e.Router,Next:e.Next,MessageBody:{HCTX:s.data.result.HCTX,RDTX:s.data.result.RDTX,HTDTX:s.data.result.HTDTX,HETX:{txDataSign:n,originalData:s.data.result.HETX},HERDTX:{txDataSign:o,originalData:s.data.result.HERDTX},RoleIndex:c.RoleIndex+1,Comments:"",Count:c.Count,AssetType:c.AssetType,HashR:c.HashR}};t.sendWebsocket(e.Sender,r),console.log(r)})}else if(1==s&&n>=0){let s,n,o,r,i,l;console.log("收到roleindex为1的HTLC,回签"),console.log(t.$store.state.vuexStore.txOnChannelInfo.keyStorePass);try{s=scrypt_module_factory(DecryptWalletByPassword,{},{WalletScript:t.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].key,password:t.$store.state.vuexStore.txOnChannelInfo.keyStorePass,address:t.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].address})}catch(e){return t.$notify.error({title:t.$t("loginByKeyStore.callback-9"),dangerouslyUseHTMLString:!0,message:t.$t("loginByKeyStore.callback-8"),duration:3e3}),!1}console.log(s),a.HCTX&&(n=signatureData(a.HCTX.txData,s),console.log("HCTX_sig:"+n)),a.HTTX&&(o=signatureData(a.HTTX.txData,s),console.log("HTTX_sig:"+o)),a.HTDTX&&(r=signatureData(a.HTDTX.txData,s),console.log("HTDTX_sig:"+r)),a.HTRDTX&&(i=signatureData(a.HTRDTX.txData,s),console.log("HTRDTX_sig:"+i)),a.RDTX&&(l=signatureData(a.RDTX.txData,s),console.log("RDTX_sig:"+l));let c={MessageType:"HtlcSign",Sender:e.Receiver,Receiver:e.Sender,TxNonce:e.TxNonce,ChannelName:e.ChannelName,Router:e.Router,Next:e.Next,MessageBody:{HCTX:{txDataSign:n,originalData:a.HCTX},RDTX:{txDataSign:l,originalData:a.RDTX},HTDTX:{txDataSign:r,originalData:a.HTDTX},HETX:a.HETX,HERDTX:a.HERDTX,RoleIndex:a.RoleIndex,Comments:"",Count:a.Count,AssetType:a.AssetType,HashR:a.HashR}};t.sendWebsocket(e.Sender,c),console.log(c)}}},OnMesHtlcSign(e){let t=this;if("ETH"==t.baseChain)if("RESPONSE_OK"==e.Status){console.log(e);let a=t.getChannelSerial("ChannelName",e.ChannelName);if(console.log(a),a>=0){let s,n=e.MessageBody.RoleIndex,o=t.$store.state.vuexStore.channelList[a].ChannelName,r=t.$store.state.vuexStore.channelList[a].TxNonce,i=e.MessageBody.Payment,l=t.$store.state.vuexStore.NetMagic,c=t.$store.state.vuexStore.channelList[a].assetType,d=e.MessageBody.DelayBlock,h=e.MessageBody.Commitment,u=e.MessageBody.DelayCommitment,m=t.$store.state.vuexStore.walletInfo.keyStorePass,g=e.Router,p=e.MessageBody.HashR,v="0x"+addPreZero(0,64),f=!1;if(0==n){let n,y,S,x,C,b,$,k,T,_,w,B=["founder","founderBalance","peer","peerBalance","paymentCount","isFounder","nonce","HashR","R","delayBlock"],N=t.getTxListInfo(o,r,B),D=N.founder,L=N.founderBalance,I=N.peer,O=N.peerBalance;if(e.ResetTxNonce){let a=["state"];"INIT"==t.getTxListInfo(o,e.ResetTxNonce,a).state?(console.log("修改nonce为"+e.ResetTxNonce),r=e.ResetTxNonce,f=!0):console.log("当前nonce禁止更改")}if(e.MessageBody.ResignBody){console.log("收到对端请求回签"),S=e.MessageBody.ResignBody.Nonce,x=e.MessageBody.ResignBody.Commitment,C=e.MessageBody.ResignBody.DelayCommitment;let s=["founder","founderBalance","peer","peerBalance","paymentCount","isFounder","nonce","HashR","R","delayBlock"],i=t.getTxListInfo(o,S,s);console.log(i),$=i.founder,k=i.founderBalance,T=i.peer,_=i.peerBalance,w=i.paymentCount;let l,c=i.isFounder?T:$,d=i.HashR,h=i.R,u=i.delayBlock,g=["bytes32","uint256","address","uint256","address","uint256","bytes32","bytes32"],p=[o,S,$,k,T,_,d,h];if(n=t.ecSignForTrinityContract(g,p,m),u){let e=["bytes32","address","address","uint256","uint256","bytes32"],a=[o,$,T,u,w,d];y=t.ecSignForTrinityContract(e,a,m),console.log(T.toLowerCase()),console.log(ecRecover(n.txData,x,c.toLowerCase())),console.log(ecRecover(y.txData,C,c.toLowerCase())),l=ecRecover(n.txData,x,c.toLowerCase())&&ecRecover(y.txData,C,c.toLowerCase())}else console.log(T.toLowerCase()),l=ecRecover(n.txData,x,c.toLowerCase());if(l){b={Commitment:n.signedData,DelayCommitment:u?y.signedData:void 0,Nonce:S};let e={state:"confirmed",founderSignedData:x,founderDelaySignedData:C};t.updateTxList1(o,S,e);let s=t.$store.state.vuexStore.channelList[a];if(s.SelfBalance=k,s.OtherBalance=_,__WEBPACK_IMPORTED_MODULE_0_Vue__.a.set(t.$store.state.vuexStore.channelList,a,s),console.log(t.$store.state.vuexStore.channelList[a]),t.StoreData("channelList"),t.getChannelBalance(),u){let e={messageType:"monitorSendUnlockAmount",baseChain:"ETH",channelName:o,blockNumber:u,HashR:d,data:i};t.$store.state.vuexStore.eventList.push(e),t.StoreData("eventList"),i.isFounder?(L-=w,O=O):(O-=w,L=L)}else console.log(d),d=="0x"+addPreZero(0,64)?i.isFounder?(L-=w,O+=w):(O-=w,L+=w):(i.isFounder?(L-=w,O=O):(O-=w,L=L),t.$store.state.vuexStore.eventList.forEach(function(e,a){e.HashR==d&&(console.log("H交易已完成,停止监听"),t.$store.state.vuexStore.eventList.splice(a,1),t.StoreData("eventList"))}));let l={founderBalance:L,peerBalance:O};console.log(l),console.log("修改余额"),t.updateTxList1(o,r,l)}else console.log("对端签名验证未通过,停止交易")}if(h){console.log("进入正常签名");let s=["founderBalance","peerBalance"],n=t.getTxListInfo(o,r,s);console.log(n),L=Number(n.founderBalance),O=Number(n.peerBalance),e.ResetTxNonce&&(L-=i,O+=i);let y=["bytes32","uint256","address","uint256","address","uint256","bytes32","bytes32"],S=[o,r,D,L,I,O,"0x"+addPreZero(0,64),v],x=t.ecSignForTrinityContract(y,S,m);t.$store.state.vuexStore.txOnChannelInfo.txData=x.txData;let C=["bytes32","address","address","uint256","uint256","bytes32"],$=[o,D,I,d,i,p],k=t.ecSignForTrinityContract(C,$,m);if(t.$store.state.vuexStore.txOnChannelInfo.delayTxData=k.txData,!x||!k)return console.log("签名失败"),!1;if(console.log(x.txData),console.log(h),console.log(e.Sender.split("@")[0].toLowerCase()),console.log(k.txData),console.log(u),console.log(ecRecover(x.txData,h,I.toLowerCase())),console.log(ecRecover(k.txData,u,I.toLowerCase())),ecRecover(x.txData,h,I.toLowerCase())&&ecRecover(k.txData,u,I.toLowerCase())){let s={MessageType:"HtlcSign",Sender:e.Receiver,Receiver:e.Sender,TxNonce:r,ChannelName:o,AssetType:c,NetMagic:l,Router:g,Next:e.Sender,MessageBody:{SenderBalance:L,ReceiverBalance:O,Commitment:x.signedData,Payment:i,DelayBlock:d,DelayCommitment:k.signedData,HashR:p,RoleIndex:1,ResignBody:b||void 0},Comments:{},Status:"RESPONSE_OK"};if(t.sendWebsocket(e.Sender,s),f){t.updateTxListLength(o,r);let e={state:"confirming",nonce:r,founder:D,peer:I,paymentCount:i,isFounder:!0,txData:x.txData,founderSignedData:"",peerSignedData:"",HashR:p||"0x"+addPreZero(0,64),R:v||"0x"+addPreZero(0,64),delayBlock:d,founderDelaySignedData:"",peerDelaySignedData:""};t.newTxList(o,e),console.log(t.$store.state.vuexStore.txList)}let n={state:"confirmed",founderSignedData:x.signedData,peerSignedData:h,founderBalance:L,peerBalance:O,founderDelaySignedData:k.signedData,peerDelaySignedData:u};t.updateTxList1(o,r,n);let m=t.$store.state.vuexStore.channelList[a];m.SelfBalance=L,m.OtherBalance=O,m.TxNonce=r,__WEBPACK_IMPORTED_MODULE_0_Vue__.a.set(t.$store.state.vuexStore.channelList,a,m),console.log(t.$store.state.vuexStore.channelList[a]),t.StoreData("channelList"),t.getChannelBalance();let y=["founder","founderBalance","peer","peerBalance","paymentCount","founderDelaySignedData","peerDelaySignedData","delayBlock","HashR","R"],S={messageType:"monitorSendUnlockAmount",baseChain:"ETH",channelName:o,blockNumber:d,HashR:p,data:t.getTxListInfo(o,r,y)};t.$store.state.vuexStore.eventList.push(S),t.StoreData("eventList"),t.$store.state.vuexStore.txOnChannelInfo=[]}else console.log("对端签名验证未通过,停止交易"),t.$notify({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:t.$t("common.verifyFail"),duration:3e3,type:"error"})}else b&&(s={MessageType:"HtlcSign",Sender:e.Receiver,Receiver:e.Sender,TxNonce:r,ChannelName:o,AssetType:c,NetMagic:l,Router:g,Next:e.Sender,MessageBody:{SenderBalance:L,ReceiverBalance:O,Commitment:"",Payment:i,DelayBlock:d,DelayCommitment:"",HashR:p,RoleIndex:1,ResignBody:b},Comments:{},Status:"RESPONSE_OK"},t.sendWebsocket(e.Sender,s))}else if(1==n){let n,v,f,y;if(e.MessageBody.ResignBody){console.log("收到对端回签的消息");let s,n=e.MessageBody.ResignBody.Nonce,r=e.MessageBody.ResignBody.Commitment,i=e.MessageBody.ResignBody.DelayCommitment,l=["txData","delayTxData","founder","founderBalance","peerBalance","isFounder","delayBlock"],c=t.getTxListInfo(o,n,l),d=c.founderBalance,h=c.peerBalance,u=(c.paymentCount,c.delayBlock);if(console.log(c.founder.toLowerCase()),u?(console.log(ecRecover(c.txData,r,c.founder.toLowerCase())),console.log(ecRecover(c.delayTxData,i,c.founder.toLowerCase())),s=ecRecover(c.txData,r,c.founder.toLowerCase())&&ecRecover(c.delayTxData,i,c.founder.toLowerCase())):(console.log(ecRecover(c.txData,r,c.founder.toLowerCase())),s=ecRecover(c.txData,r,c.founder.toLowerCase())),s){let e={state:"confirmed",founderSignedData:r,founderDelaySignedData:i};t.updateTxList1(o,n,e);let s=t.$store.state.vuexStore.channelList[a];s.SelfBalance=d,s.OtherBalance=h,__WEBPACK_IMPORTED_MODULE_0_Vue__.a.set(t.$store.state.vuexStore.channelList,a,s),console.log(t.$store.state.vuexStore.channelList[a]),t.StoreData("channelList"),t.getChannelBalance(),v=Number(d),y=Number(h)}}if(h){let s=["founder","founderBalance","peerBalance","isFounder","txData","delayTxData"],n=t.getTxListInfo(o,r,s);if(console.log(r),console.log(n),console.log(ecRecover(n.txData,h,n.founder.toLowerCase())),console.log(ecRecover(n.delayTxData,u,n.founder.toLowerCase())),ecRecover(n.txData,h,n.founder.toLowerCase())&&ecRecover(n.delayTxData,u,n.founder.toLowerCase())){let s=t.$store.state.vuexStore.channelList[a];console.log(n.isFounder),n.isFounder?(s.SelfBalance=v,s.OtherBalance=y):(console.log(n.founderBalance),console.log(n.peerBalance),s.SelfBalance=n.peerBalance,s.OtherBalance=n.founderBalance),__WEBPACK_IMPORTED_MODULE_0_Vue__.a.set(t.$store.state.vuexStore.channelList,a,s),console.log(t.$store.state.vuexStore.channelList[a]),t.StoreData("channelList"),t.getChannelBalance();let d={state:"confirmed",founderSignedData:h,founderDelaySignedData:u};console.log(d),t.updateTxList1(o,r,d);let m="";m=t.getRByHashR(p),console.log("此处回复RResponse");let g={MessageType:"RResponse",Sender:e.Receiver,Receiver:e.Sender,TxNonce:e.TxNonce,ChannelName:o,AssetType:c,NetMagic:l,Router:e.Router,Next:e.Next,MessageBody:{RoleIndex:0,Comments:"",PaymentCount:i,AssetType:c,R:m,HashR:p}};t.sendWebsocket(e.Sender,g)}else console.log("对端签名验证未通过,停止交易")}else if(e.MessageBody.ResignBody){let a="0x"+addPreZero(0,64);n=e.Sender.split("@")[0],f=e.Receiver.split("@")[0],v-=i,y=y,console.log(m);let h=["bytes32","address","address","uint256","uint256","bytes32"],u=[o,n,f,d,i,p],S=t.ecSignForTrinityContract(h,u,m);t.$store.state.vuexStore.txOnChannelInfo.delayTxData=S.txData;let x=["bytes32","uint256","address","uint256","address","uint256","bytes32","bytes32"],C=[o,r,n,v,f,y,"0x"+addPreZero(0,64),a],b=t.ecSignForTrinityContract(x,C,m);if(t.$store.state.vuexStore.txOnChannelInfo.txData=b.txData,!b||!S)return console.log("签名失败"),!1;s={MessageType:"HtlcSign",Sender:e.Receiver,Receiver:e.Sender,TxNonce:r,ChannelName:o,AssetType:c,NetMagic:l,Router:g,Next:e.Sender,MessageBody:{SenderBalance:v,ReceiverBalance:y,Commitment:b.signedData,Payment:i,DelayBlock:d,DelayCommitment:S.signedData,HashR:p,RoleIndex:0},Comments:{},Status:"RESPONSE_OK"},t.sendWebsocket(e.Sender,s)}}}}else console.log(e.Status),t.$notify.error({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:e.Status,duration:3e3});else if("NEO"==t.baseChain){let a=t.getChannelSerial("ChannelName",e.ChannelName,"open",!1),s=e.MessageBody,n=t.$store.state.vuexStore.channelList[a];if(n.TxNonce+=1,__WEBPACK_IMPORTED_MODULE_0_Vue__.a.set(t.$store.state.vuexStore.channelList,a,n),1==s.RoleIndex){let a="";if(console.log("HashR:"+e.MessageBody.HashR),a=t.getRByHashR(HashR),console.log("此处回复RResponse"),!a)return;let s={MessageType:"RResponse",Sender:e.Receiver,Receiver:e.Sender,TxNonce:e.TxNonce,ChannelName:e.ChannelName,Router:e.RouterInfo,Next:e.Next,MessageBody:{RoleIndex:0,Comments:"",Count:e.MessageBody.Count,AssetType:e.MessageBody.AssetType,R:a,HR:e.MessageBody.HashR}};t.sendWebsocket(e.Sender,s)}}},OnMesRResponse(e){var t=this;if("ETH"==t.baseChain){let a=e.MessageBody.R,s=web3.utils.keccak256(a),n=e.ChannelName;console.log(s),console.log(e.MessageBody.HashR),t.$store.state.vuexStore.txList.forEach(function(a,o){a.channelName==n&&a.history.forEach(function(a,o){if(a.HashR==s){console.log("进入R交易");e.MessageBody;let s={R:e.MessageBody.R};t.updateTxList(n,s,e.MessageBody.HashR);let o=t.getChannelSerial("ChannelName",n,"open");if(o>=0){console.log(o);let s=t.$store.state.vuexStore.channelList[o].TxNonce+1,r=Number(a.founderBalance),i=Number(a.peerBalance),l=Number(a.paymentCount),c=t.$store.state.vuexStore.NetMagic;console.log(t.$store.state.vuexStore.txOnChannelInfo);let d={MessageType:"RResponseAck",Sender:e.Receiver,Receiver:e.Sender,TxNonce:s,ChannelName:n,NetMagic:c,AssetType:e.AssetType,MessageBody:{HashR:e.MessageBody.HashR,R:e.MessageBody.R,PaymentCount:l},Comments:{}};t.sendWebsocket(e.Sender,d);let h={MessageType:"Rsmc",Sender:e.Receiver,Receiver:e.Sender,TxNonce:s,ChannelName:n,NetMagic:c,AssetType:e.AssetType,MessageBody:{PaymentCount:l,SenderBalance:r,ReceiverBalance:i+l,HashR:e.MessageBody.HashR,R:e.MessageBody.R,Commitment:""},Comments:{}};t.sendWebsocket(e.Sender,h);let u={state:"INIT",nonce:s,founder:e.Receiver.split("@")[0],founderBalance:r,peer:e.Sender.split("@")[0],peerBalance:i+l,paymentCount:l,isFounder:!0,founderSignedData:"",peerSignedData:"",HashR:e.MessageBody.HashR,R:e.MessageBody.R};t.newTxList(n,u),console.log(t.$store.state.vuexStore.txList);let m=t.$store.state.vuexStore.channelList[o];m.TxNonce=s,__WEBPACK_IMPORTED_MODULE_0_Vue__.a.set(t.$store.state.vuexStore.channelList,o,m),console.log(t.$store.state.vuexStore.channelList[o].TxNonce),t.StoreData("channelList")}}})})}else if("NEO"==t.baseChain){let a=createHr(e.MessageBody.R);if(console.log(a),console.log(e.MessageBody.HR),a==e.MessageBody.HR){console.log("进入R交易");let a,s,n,o=t.getChannelSerial("ChannelName",e.ChannelName);console.log(t.$store.state.vuexStore.channelList[o]);let r=Number(t.$store.state.vuexStore.channelList[o].SelfBalance).div(1e8),i=Number(t.$store.state.vuexStore.channelList[o].OtherBalance).div(1e8);console.log(t.$store.state.vuexStore.txList),t.$store.state.vuexStore.txList.forEach(function(t,o){t.channelName==e.ChannelName&&t.history.length&&(console.log(t.history[t.history.length-1]),a=t.history[t.history.length-1].txId,console.log(a),s=t.history[t.history.length-1].addressFunding,console.log(s),n=t.history[t.history.length-1].scriptFunding,console.log(n))}),axios({method:"post",url:t.$store.state.vuexStore.NodeRpcUri,headers:{"Content-Type":"application/json;charset=UTF-8"},data:JSON.stringify({jsonrpc:"2.0",method:"FunderTransaction",params:[e.Sender.split("@")[0],t.$store.state.vuexStore.NEOwalletInfo.publicKey,s,n,i,r,a,e.MessageBody.AssetType],id:1})}).then(function(a){console.log(a);let s={MessageType:"Rsmc",Sender:e.Receiver,Receiver:e.Sender,TxNonce:e.TxNonce+1,ChannelName:e.ChannelName,MessageBody:{Commitment:a.data.result.C_TX,RevocableDelivery:a.data.result.R_TX,AssetType:e.MessageBody.AssetType,Value:e.MessageBody.Count,RoleIndex:0,Comments:e.MessageBody.HR}};t.sendWebsocket(e.Sender,s),console.log(s),t.$store.state.vuexStore.txOnChannelInfo.BreachRemedy=a.data.result.BR_TX})}}},OnMesSettle(e){console.log(e);let t=this.getChannelSerial("ChannelName",e.ChannelName,"open");if(t>=0){let a=e.ChannelName,s=this.$store.state.vuexStore.walletInfo.keyStore,n=this.$store.state.vuexStore.walletInfo.keyStorePass,o=this.$store.state.vuexStore.channelList[t].OtherUri.split("@")[0],r=Number(this.$store.state.vuexStore.channelList[t].OtherBalance),i=this.$store.state.vuexStore.walletInfo.address,l=Number(this.$store.state.vuexStore.channelList[t].SelfBalance);if(e.SenderBalance!=this.$store.state.vuexStore.channelList[t].OtherBalance||e.ReceiverBalance!=this.$store.state.vuexStore.channelList[t].SelfBalance)return console.log("error submit!!"),!1;{let t=web3.utils.soliditySha3({t:"bytes32",v:a},{t:"uint256",v:0},{t:"address",v:o},{t:"uint256",v:r},{t:"address",v:i},{t:"uint256",v:l});console.log(t);let c=this.decryptPrivateKey(s,n),d=ecSign(t,c.privateKey);console.log(d);let h={MessageType:"SettleSign",NetMagic:e.NetMagic,Receiver:e.Sender,Sender:e.Receiver,ChannelName:e.ChannelName,AssetType:e.AssetType,MessageBody:{Commitment:d},Status:"RESPONSE_OK",TxNonce:0};this.sendWebsocket(e.Sender,h)}}},async OnMesSettleSign(e){var t=this;if("ETH"==t.baseChain)if("RESPONSE_OK"==e.Status){console.log(t.$store.state.vuexStore.closeChannelInfo.txData);let a=t.$store.state.vuexStore.closeChannelInfo.ChannelName;if(ecRecover(t.$store.state.vuexStore.closeChannelInfo.txData,e.MessageBody.Commitment,e.Sender.split("@")[0].toLowerCase())){let s=["bytes32","uint256","address","uint256","address","uint256","bytes","bytes"],n=[a,0,t.$store.state.vuexStore.walletInfo.address,Number(t.$store.state.vuexStore.closeChannelInfo.SelfBalance),t.$store.state.vuexStore.closeChannelInfo.OtherUri.split("@")[0],Number(t.$store.state.vuexStore.closeChannelInfo.OtherBalance),t.$store.state.vuexStore.closeChannelInfo.selfSignedData,e.MessageBody.Commitment],o=await t.signDataForERC20Contract(t.trinityContractAddress,"quickCloseChannel",s,n,t.$store.state.vuexStore.closeChannelInfo.keyStorePass);console.log(o);(new Date).getTime();web3.eth.sendSignedTransaction("0x"+o,function(e,a){e?console.log(e):(console.log(a),t.$notify({title:t.$t("common.success"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-14"),duration:3e3,type:"success"}),t.cycleGetTransactionReceipt(a))})}else console.log("对端签名验证未通过,停止交易"),t.$notify({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:t.$t("common.verifyFail"),duration:3e3,type:"error"})}else console.log(e.Status);else if("NEO"==t.baseChain){console.log(t.$store.state.vuexStore.closeChannelInfo.witness);let a=t.$store.state.vuexStore.closeChannelInfo.witness.replace("{signSelf}",t.$store.state.vuexStore.closeChannelInfo.selfSignedData).replace("{signOther}",e.MessageBody.Settlement.txDataSign),s=t.$store.state.vuexStore.closeChannelInfo.txData+a;axios({method:"post",url:t.$store.state.vuexStore.NodeRpcUri,headers:{"Content-Type":"application/json;charset=UTF-8"},data:JSON.stringify({jsonrpc:"2.0",method:"sendRawTx",params:[s],id:1})}).then(function(e){console.log(e),"true"==e.data.result?t.$notify({title:t.$t("common.success"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-14"),duration:3e3,type:"success"}):console.log(e.data)})}},OnMesDeleteChannel(e){let t=this;if("ETH"==t.baseChain);else if("NEO"==t.baseChain){console.log("NEO删除通道");let a=t.getChannelSerial("ChannelName",e.MessageBody.ChannelName);t.$notify({title:t.$t("common.success"),dangerouslyUseHTMLString:!0,message:t.$t("common.callback-23"),duration:3e3,type:"success"}),t.$store.state.vuexStore.channelList.splice(a,1),t.StoreData("channelList"),t.getChannelBalance()}},OnMesChannelInfo(e){},OnMesFounder(e){var t=this;let a=t.getChannelSerial("ChannelName",e.ChannelName);if(console.log(t.$store.state.vuexStore.addChannelInfo),console.log(a),a>=0){let s=scrypt_module_factory(DecryptWalletByPassword,{},{WalletScript:t.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].key,password:t.$store.state.vuexStore.addChannelInfo.keyStorePass,address:t.$store.state.vuexStore.NEOwalletInfo.keyStore.accounts[0].address}),n=e.MessageBody;t.$store.state.vuexStore.addChannelInfo.selfSignedData=signatureData(n.Founder.txData,s);let o=signatureData(n.Commitment.txData,s),r=signatureData(n.RevocableDelivery.txData,s),i={MessageType:"FounderSign",Sender:e.Receiver,Receiver:e.Sender,ChannelName:e.ChannelName,TxNonce:e.TxNonce,MessageBody:{Founder:{txDataSign:t.$store.state.vuexStore.addChannelInfo.selfSignedData,originalData:n.Founder},Commitment:{txDataSign:o,originalData:n.Commitment},RevocableDelivery:{txDataSign:r,originalData:n.RevocableDelivery},AssetType:e.MessageBody.AssetType,Deposit:e.MessageBody.Deposit,RoleIndex:e.MessageBody.RoleIndex}};console.log(i),t.sendWebsocket(e.Sender,i),axios({method:"post",url:t.$store.state.vuexStore.NodeRpcUri,headers:{"Content-Type":"application/json;charset=UTF-8"},data:JSON.stringify({jsonrpc:"2.0",method:"FunderTransaction",params:[e.Sender.split("@")[0],e.Receiver.split("@")[0],n.Founder.addressFunding,n.Founder.scriptFunding,e.MessageBody.Deposit,e.MessageBody.Deposit,n.Founder.txId,e.MessageBody.AssetType],id:1})}).then(function(a){let s={MessageType:"Founder",Sender:e.Receiver,Receiver:e.Sender,TxNonce:e.TxNonce,ChannelName:e.ChannelName,MessageBody:{Founder:n.Founder,Commitment:a.data.result.C_TX,RevocableDelivery:a.data.result.R_TX,AssetType:e.MessageBody.AssetType,Deposit:e.MessageBody.Deposit,RoleIndex:e.MessageBody.RoleIndex+1}};t.sendWebsocket(e.Sender,s),t.$store.state.vuexStore.addChannelInfo.txId=n.Founder.txId,t.$store.state.vuexStore.addChannelInfo.addressFunding=n.Founder.addressFunding,t.$store.state.vuexStore.addChannelInfo.scriptFunding=n.Founder.scriptFunding}),t.$store.state.vuexStore.channelList[a].transactionHash=n.Founder.txId}},OnMesUpdateChannel(e){if("NEO"==this.baseChain){let t=this.getChannelSerial("ChannelName",e.MessageBody.ChannelName,"open",!1),a=this.$store.state.vuexStore.channelList[t],s=a.SelfUri,n=a.OtherUri;a.SelfBalance=Number(e.MessageBody.Balance[s].TNC).mul(1e8),a.OtherBalance=Number(e.MessageBody.Balance[n].TNC).mul(1e8),a.TxNonce+=1,__WEBPACK_IMPORTED_MODULE_0_Vue__.a.set(this.$store.state.vuexStore.channelList,t,a),console.log(this.$store.state.vuexStore.channelList[t]),this.$notify({title:this.$t("common.success"),dangerouslyUseHTMLString:!0,message:"余额更新",duration:3e3,type:"success"})}},OnMesRegisterChannelFail(e){let t=this,a=t.getChannelSerial("ChannelName",e.ChannelName);a>=0&&(t.$store.state.vuexStore.channelList.splice(a,1),t.StoreData("channelList"),t.getChannelBalance(),t.$notify.error({title:t.$t("common.warning"),message:e.Error,duration:3e3}))},websocketClose(e){console.log("已断开websocket");let t=this,a=e.currentTarget.url.split("/")[2].split(":")[0];console.log(a);let s=t.getChannelSerial("Ip",a);if(console.log(s),null!==s){t.$notify.error({title:t.$t("common.warning"),dangerouslyUseHTMLString:!0,message:a+t.$t("common.callback-24"),duration:3e3});let e=t.$store.state.vuexStore.channelList[s];e.isConnect=!1,__WEBPACK_IMPORTED_MODULE_0_Vue__.a.set(t.$store.state.vuexStore.channelList,s,e)}},reconnectWebsocket(e,t){let a=this;const s="ws://"+e+":"+a.$store.state.vuexStore.spvPort+"/";var n=a.getChannelSerial("ChannelName",t);if(console.log(n),n>=0){var o={Ip:e,websock:new WebSocket(s)};o.websock.onmessage=a.websocketOnmessage,o.websock.onclose=a.websocketClose,console.log(o),a.$store.state.vuexStore.webSocketList.length?a.$store.state.vuexStore.webSocketList.forEach(function(t,s){if(t.Ip==e&&""!=t.websock)return console.log("websocket已存在,不重复连接"),!1;a.$store.state.vuexStore.webSocketList.push(o)}):a.$store.state.vuexStore.webSocketList.push(o),a.$store.state.vuexStore.channelList[n].isConnect=!0;let t={MessageType:"GetChannelInfo",Sender:a.$store.state.vuexStore.channelList[n].SelfUri,NetMagic:a.$store.state.vuexStore.NetMagic,MessageBody:{AssetType:"TNC"}};setTimeout(function(){a.sendWebsocket(a.$store.state.vuexStore.channelList[n].SelfUri,t)},2e3)}console.log(a.$store.state.vuexStore.webSocketList)},StoreData(e){let t=this.$store.state.vuexStore.walletInfo.address;"NEO"==this.baseChain&&(t=this.$store.state.vuexStore.NEOwalletInfo.address),console.log(this.$store.state.vuexStore[e]),this.saveAsArray(t+"@"+e,this.$store.state.vuexStore[e])},newTxList(e,t){let a=this;a.$store.state.vuexStore.txList.forEach(function(s,n){s.channelName==e&&(console.log("增加交易数据"),s.history.push(t),console.log(s.history)),a.StoreData("txList")})},updateTxList(e,t,a){this.$store.state.vuexStore.txList.forEach(function(s,n){s.channelName==e&&(console.log("更新H交易数据"),s.history.forEach(function(e,s){if(e.HashR==a)for(var n in t)e[n]=t[n]}))}),this.StoreData("txList")},updateTxList1(e,t,a){this.$store.state.vuexStore.txList.forEach(function(s,n){if(s.channelName==e){for(var o in a)s.history[t][o]=a[o];console.log(s.history[t])}}),this.StoreData("txList")},updateTxListLength(e,t){this.$store.state.vuexStore.txList.forEach(function(a,s){if(a.channelName==e)return a.history.length=1*t,console.log(a.history),!1}),this.StoreData("txList")},getTxListInfo(e,t,a){let s={};return this.$store.state.vuexStore.txList.forEach(function(n,o){if(n.channelName!=e);else for(var r in console.log("找到数据"),console.log(n.history),console.log(t),console.log(n.history[t]),a)n.history[t][a[r]]?s[a[r]]=n.history[t][a[r]]:s[a[r]]=""}),s},checkHistory(e,t){let a=this.getChannelSerial("ChannelName",e),s=1*this.$store.state.vuexStore.channelList[a].TxNonce,n={};return console.log(t),this.$store.state.vuexStore.txList.forEach(function(a,o){if(a.channelName==e)if(console.log(a.history),s+1==t)if(console.log("nonce相同"),console.log(a.history[s].state),"INIT"==a.history[s].state)console.log("上笔交易为INIT状态,直接替换数据"),n={type:"approveNonce",nonce:t};else if("confirming"==a.history[s].state){console.log("上笔交易为confirming状态,请求回签");let e=a.history[s],t=e.isFounder?e.founderSignedData:e.peerSignedData,o=a.isFounder?e.founderDelaySignedData:e.peerDelaySignedData;n={type:"Resign",ResignBody:{Nonce:s,Commitment:t,DelayCommitment:o}}}else"confirmed"==a.history[s].state&&(console.log("数据正确"),n.type="Same");else console.log("nonce不相同,请求更新nonce"),s+1>t?n={type:"approveNonce",nonce:t}:(n.type="ResetTxNonce",n.ResetTxNonce=s+1)}),console.log(n),n},getRByHashR(e){let t;return this.$store.state.vuexStore.RList.forEach(function(a,s){a.Hr===e&&(console.log(a.Hr),t=a.R)}),console.log("R:"+t),t},browserRedirect(){var e=navigator.userAgent.toLowerCase(),t="ipad"==e.match(/ipad/i),a="iphone os"==e.match(/iphone os/i),s="midp"==e.match(/midp/i),n="rv:1.2.3.4"==e.match(/rv:1.2.3.4/i),o="ucweb"==e.match(/ucweb/i),r="android"==e.match(/android/i),i="windows ce"==e.match(/windows ce/i),l="windows mobile"==e.match(/windows mobile/i);t||a||s||n||o||r||i||l?(console.log("手机端"),this.$store.state.vuexStore.isMobile=!0):(console.log("PC端"),this.$store.state.vuexStore.isMobile=!1)},backFun(){let e=this;document.addEventListener("plusready",function(){var t=plus.webview.currentWebview();plus.key.addEventListener("backbutton",function(){"/wallet"==e.$route.path||t.canBack(function(a){if(a.canBack)t.back(),"/scan"==e.$route.path&&scan.close();else{var s=null;plus.key.addEventListener("backbutton",function(){s?(new Date).getTime()-s<1500&&plus.runtime.quit():(s=(new Date).getTime(),console.log("再按一次退出应用"),setTimeout(function(){s=null},1e3))},!1)}})})})}}}},xu0g:function(e,t){},y3Ia:function(e,t){},yfsC:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIsAAAAwCAYAAAAhFIlJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTFBOEQ1MkNCQTI3MTFFODgyMjBBQjhBN0Y2RjZEODQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MkMzQjM2QzhCQTI3MTFFODgyMjBBQjhBN0Y2RjZEODQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDoxMUE4RDUyQUJBMjcxMUU4ODIyMEFCOEE3RjZGNkQ4NCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDoxMUE4RDUyQkJBMjcxMUU4ODIyMEFCOEE3RjZGNkQ4NCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PryQJ+oAABFvSURBVHja7JwJWFTXFcfPzMAszALKJuACigvijkKiJGazNY1LbKutSZrYmpjaNEnT2mptjEtrYrPULF3M0iRNbGzVNAtu0aioSSRNFBEYdhhg2JdhBhhmfdNzZh4Iw5uBYZiBYO/3nW/mzbx335t3f+/c/zn33uHBIJd7jsxV4Mv30B5AC0Pbhvbhe8sybZ7WZbN5fAjweDyPj3nn3Xc3Hk9Lqzpw8ODH/rjGb2rhDRIgAny5gwXkbjSJ0y5X0HaifeQJNP6A5eChQzI8T/GHhw+34mYiAmP6Pyzche8lJDPQnsW3lWgn0NZygEJlDtoHaJdx/7vReMPoHvwOAYvE13i0x336ZCLIg2H5qbt3nYp40NjXfm0P7N+jWvpi2GCdlzcAQCLoBe1+tLkDvG9fou1AL3NiKD0LepU4fMlDE31w6BB9RN5lMnqXOl94loF0kVzlP5IfME0drbybUhdtnfbZ757hvK7Nx2SQV6erM7UVjjnx6DS/eRYERIS2Gi0NN6vQ9noBCpUUtONYXwba0iH0Ki8QKN225Wh/GM5dQdacJz9t7NDxbGCD/Myc3S53bDF8Cu0mnqChfWrF0hcX+xwWbMiFaPvwbS09iGjL0AIG8bd3h+YWf9509Cp0vlUcX61fu2bNvOEIStm39wbmZOfc3rld397Cy56//d+9vMqvj06Eima6txCqCAFDReMRn8CCjRaLtg2tCDc/R3sYLcTH94F+2Fk8Z7o/oEFQSJC/7Eb0v4jA8IYbLLUlFWXtVmOPz5RZOWt67djUng4mq+PH8HlgaWqTlS/Zu9nb8wd0C3e/z+qQxUN4Pxaz0JwjTYOW7qPzPIQ20833N6FRI/x7uIBScsfz0y+cTo9x/lxr1sOlxC1XknL3zLF7lU1H74SsqnHd95HLZNCcW05d1h+98izYMDvYbubvQwxKZ2lAy0XdmOAjr0Je8vf92PVZ9C6S4QKLKqfwa5PNyvmdMk85G7uoIPtGje5fwPQU3ZIgCbRWNwqKFz79kVewTJV2BIr5zKP4PnMI74UG7U20nyAkr6Pdie//6qNzbQdHsrCvMh7t18MBlMLFex4sq1W7BLeDMUNNkarE9ou0TVCrU/TqPgIDgALfuuzS5aR7vNEsWydIjK8gNBdkAisl1c756R5QmLqfEnkIx9Nos9EImK1ocT7yKlPx5eceHLIZvcvYoYalIDPnVQbch+hBClkBqFuedi3DsItqNfLQwyi9FbhE7WMxYtMbCE3Z6EDLD3E7zQe/28BGVT9CMH6FFon2Fm4/h5bkh/v+oofRXJC3/by3JTdl51s1uia3UWuoWG6bnZqsBo2e02tYzOYuZOoLyuNR/0wejGiITrYuXGg+gNCYIkXmNezTb/Xi91L6nEK3+xAMgoTyWK/j9mtoS8DLLLIHXoW6toHkdO5B77JwyGDJzF7n7nsCIDFp9ssYKt/jah+j4VoEJcLWqMovvTyYeRa6hu+FBFgOIjQRY8XG+1gNYehnvRa0TyhngWAsR6tEewm3KU36AzSxn3MqgaxXGbBHGopQ+uvEzVktpna3+4wdFWGZOiPhBkrAudQ07fpuDc4DTXW9DHXQfYMFS/fyLamAIU+TFCsxUs5lD0VsHPtRp3oWbSNa1HvLMpciIGtZaOiz0CH05o+gTfHi+AXgGCT1W0EhGqbMy5vlbh8BNt+M1AUPQbsxGeJRs0+JABiD+pbfkxutpmdzKRghFF3JfXtAeZb+Js5EfCYFocm12HibSvXiCKSDoigV2nto7yMg1U7HhA+1OESvEs7mbLwtT6N3ef/AwYOt/rhudV5xgYExczQYH4JBBDJUDFPmJdaOXTxrPejN1+iIQljGhQBcxaYwWsCg7wBDR88OQYiY1Wh1gtwbdr6WmLF9gy9g6SyJATzb61OkHaX4fuX2W/P/C8O7UE4leBDqiWIjtd/6+oKLb3v29vNnzo3uKSYFEIF6m0AhMsRSCcTclfwAdFg+6S3LhQAzowEuVUJ9bT3nOYIRGdRDD+LbfsPijbiciDZ9OFOCXoXc+EN9Ciyz2cwwTH9E/BPoXSb6+rpLsvKOWYDpEo/hCMlkGAUhLChUYhZMywiUS/4Crka9pUKwRsqgVl3D+bUc69Ia23mXZ2655A9YvgnlJXe/sUOvb/3qy4yvThw7aq5UlfGbGhtqLVZLh5v6aIT6eV9ecP6i3TsqmuqEDm/ChzhEhDxKdxWiCBtli1yZ/CcwWOJ7hiW4lwS1fIgEIEIGzLSwi67SMwKsMQjPkJurnEf66LqGBb3Kd/HlFq7vtFpt/YVz6ZdPnzopqautJfEahJ6Fp2tpGaNWqSQNdbVNZpOpxUXVq9C73Oqr687LzH6Kph9IUCFMRFAkHEohKmXaPtQj+66JCWzG0QjIWNQr4VKkCZkWBxgCx4Wujpod73JujhRhoexvVUFp3nULC4JCofkLzp8jGKozp05mX0g/G6FtaZnHpdkoCdTW2hqqrigPqa2u0hkMHVyd/ksIjGCwr/vqvG3HG/RaHgEyAVVFAEfzhMdGm0Nvn1UHJqtD0xAYUXIAmcjhWbqF+2Bh5oTfMuMOcRD3SEEQOHJ4heWlYcW3PbfIFwL3m1CeQIvtbPyK8nJlvjJXiNIk3pNKsJtSkIlEYkPwqFHNUpksmv1qJisM/zaIoXLgxdPnlxIosQgKn2MSI5/Ph/D5kx8Gg/lv9vA4NMjR7fQuzXZYAvgZ4rjwL6MXTP2q9NyVBc47dXoti42B0qt5Z6DnRLCR71nQq1CDbrVarbb8POWV40eOVGdnXZnuKSjdi9FoENfX1kSry1UWnbalip1KuQu9y6DN86kvqyw2WcwwHhScoNi7n8SJ2pAbp94GjE1EmsQFKFRoOsJP7A8Mn/fdMatSfikPDbH1bnxel/cqb6wV5qfu/u11BYter9995fKl/BNHj2iLCwvnYJATPVh1I3ABTQ0NMSiGGU1zk9FqsQzKuBGN1RQWF48nUAJcNIlQJITw1IQVqFV+CBjlgNBlL1iO9h82zCegArHLehd1zmuc9bLns0/TvOxmmuZIhOV8+lmzurJyPj79Ppvdh16L39LcHIPR0/zBqK88tygznJFgH+BaBkUnTS0KmhS1C7ueAAh0K5eeZJOQsq4IiceLDVsyOytsQpSlNwDXEKjXt/CuJj310XUDy5tvvU1agqKVYl+dIyAw0KQICXn09PkLXo+U0xhNa12TVA5Cl/tIg2UwZmXyepAELASRW5mZhUbTYe/v8akYjzFYngtPiv8p6Z4e0bZTBblZ2StczXkZiZpF8c7+f6azIpS6Cetg1o8i94sgqTTy5Jmzf0bNovC2vmplyVuhjPtx1ajkhDS+XLwVpMK+Ji7RPNu9vRggwMxW6ajUhOQx0+N07ipotRigXqUuuF5C50cQmDUIjAFtC24nwyDMAhQKhe3BISFr0JssCg0L1yIo68DLwcW8hb/fxzS2B7hbvjUqOpyJPPXYChAJaNrrKiejgdofs0ZzkCicvrFXJZ3dVodlffiihOWBomtezMpminskBgsL40qXvBB3PYTOr6BlIzDkih9Zs3r15fvvu5eA+RXbl3s0PYIWhknl8jRszu9/cuasCSGh0etXwTFI6tWSEU2+eoPI1lN/CAQCkAXLIUgaBNSoYSuS1LZZ9+7v0iBs89tzat11quOBUHH/CDZxZ2EE0slRu2LmTSlRXcyZZI/0OByv0WaBCmXRVXCsoxq5ngXhaGPDxrvQlAjNL5etvBvQy1CXRGNF6f2tSyQWN6M2ufXT9HMrwiIiAUF5inJn4Jj9v87TddHdS0Hyrs+sze28TiAjoiIgce4MSL75Bvtr3JSJMDZ1JohDg8eDlbkXd1vZzb4Djsn1nUbe5GdoF1nN0rsI+J3eZXHksgUPBClkYEavYnUxHlBSVSErWrxn9UjvhggYmlfzBjimRVIm978ITRICQzfyNnAMLmpdqn4+3yZXKN40Ggxhn5w+k46QpMK1xf328SEE5WsvEnDBmtyKRZTnIEiSFs2H+OlTIHh0iH2dT1eJCcZ+AruJhnaA/i2TfYZNSLouWI8gUPBOdPK0E23gmnWCqDBLeWDEw8IW6nYq2fdzWWD2opeRIjQEEi01+cD5ILFEUomgzDqVfm59XPzkEASF8hMX2P3tTgG8nB9jrtdl800MTJ+TaIdEKOJInIoDoSvyoQVj9QgM0ycwqay0OMEFSVcxWCZG3JX0LyYowG2F1S0NAuWNu172Fyw02FU9RN6FVP/DTg/GL9iuaTkCU4NGg430XzK1qBWsiuDg3emffzEetUkOQkKCMQ96TnGwsd2PYaDXVf7tvSltZTXjZi6YDSGho9zE505NY7QA1LVRVNPXKf7IPig9Z05ZnYRsq+GV+NkJ+9zNFaUfm3s5++d+geXA8kyChVT1evbG+xuY4/jyD6ePabXexwjMYRoaQGAo25kgUygmnDyb/iRCEotGx5ELjnQ69mUEJcMrr1KnO5k4Yzp6sD50doe5tychUGpbadG7Oy8zldVUr/QAxeq0f02rPGHuzNjo4DC39GmMbbzMWVsz/NINITAmNFoPlMiKsy/8zAx5k1qOz8mj5CEwP8OuSTc6NKwOIdlEnge4VwFQkm+rNxdSddeffxoulCo4u51eogEbuFrL/bjrEJYqdJzNeupSuI7eyWq1erbb6b1HA3qpcs3SxBvnPSro459XcnNzU2jFo980CwJjQ/sYbRHbt6axP93X3oXmpWx08TUl1f5itVoJ4K/AsX7J1cq/h9Cr6L25FpGR2auQy/t/QGmTAwgXQhXaUKDWY6OrtQ4RrDM6wLAw5BE3dMGtN/cGRUOgmXkTYsY9MTFqvNslBHqrCaoLy1RDkmdBYOjfGVasTZtLopGe5h+xuQNfAfMhehCaVM65toZhmJQ+qvgrgpLu7XUoJkW9DSKhlSOZY0Br4A7NML6Viyo4cifWXh6TQW9kYLUJn6cDhTgHwXkMu7RZXd1YFYJVobl2TKVmctKdN61tO9z2TxvDsNXYeFanWaaaJs3oIU3KITSkY9YjNNvY7uJh9mn3VXf0LejfOufuhRpq82BcgPDV1Rvdff/5pMfLy1Sq8b08Ej8AJgWFu5y64K4EBAZCwsK5wCeN02Hm7O7kJv6+5br97idzGYZJ6IzQVKP9BhyL0alhanzgXRrYxJWnhbqfNl/fA+VNu2/ILy0eTy7f2TRmPRRoa6BN2wbtHpq2UQPlmfncoHSJXV2wfVF9H2VY5VkQGC0a/aFhLNqDPgDmEFduxU15A0E56Y/fXq4sSrfaGJfft4IJVKAFCzAe111TWQ31NfXud1JrnukPLDvdZTOHCBqKoP7uo+rJuzT3Yz/KD/nlLzeyU3bsVDfV9Rki6cEMpdBiB8fTUpJXBM2Nbn62piPA9siH77uFZfut+TvYJ3nYQeMjsUuisD9/YboBvUqLP64pPyt3W3/DQhrPqQCd3YwezL6gqaAFV/OgrqrWjXtrXmXbfGy0224IgWlxgqZthANDo7jH3OyyH0E56o9r+XrGlnMaQ5vHypW8SzFo7NDQe1s/gSnJL4bCnAIwm8xciUAehurn+6VZukFDWVdKG7ePYGY2uPCkdWzk5POSmbJdrlQqb/amDgKFgCmAJlDjVguGLaY+PE5jXQNkXrwEVSo1WMxOCbsKTaJt09GUfgtcBKYRbQvraUYkNOhdqtgcj3PZiF6lyR/XoKtpKOFa/D6QQqPEWuyYqrBTKEKPk4/wkCCuxu0GVDsahIhGmQ0okQmmDosJSkvKIOOzDMi5kgMVFWpoamrGiKsVDKp6zj+zdptnIWjwZcvOs9OeZ28sDSpJRxAzJKLpD4uWsNuHEZQPfHUyjn/jjrh5mN4YG6wbWOjs5Gmehf7/qc9w9y42e4hus1FOvXGAeZjrpniUZ2GhoaQZ/ZMALTrvGAHAVJhMJvoHy8fRqzT8HwnX5X8CDABdICEnb+l/sQAAAABJRU5ErkJggg=="}},["NHnr"]);